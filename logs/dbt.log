

============================== 2023-01-02 18:52:52.057749 | 9187c4b6-f37d-4632-bc29-b148471f3978 ==============================
[0m18:52:52.057749 [info ] [MainThread]: Running with dbt=1.3.1
[0m18:52:52.059752 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'D:\\2023\\Cloudthought\\data-migration-dbt\\stgo_dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:52:52.059752 [debug] [MainThread]: Tracking: tracking
[0m18:52:52.115747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D05F522280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D05F522880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D05F522C10>]}
[0m18:52:52.151830 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m18:52:52.152833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9187c4b6-f37d-4632-bc29-b148471f3978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D05F4FE0D0>]}
[0m18:52:53.698986 [debug] [MainThread]: Parsing macros\adapters.sql
[0m18:52:53.755977 [debug] [MainThread]: Parsing macros\catalog.sql
[0m18:52:53.764982 [debug] [MainThread]: Parsing macros\relations.sql
[0m18:52:53.770990 [debug] [MainThread]: Parsing macros\timestamps.sql
[0m18:52:53.780980 [debug] [MainThread]: Parsing macros\materializations\incremental_strategies.sql
[0m18:52:53.783978 [debug] [MainThread]: Parsing macros\materializations\snapshot_merge.sql
[0m18:52:53.788977 [debug] [MainThread]: Parsing macros\utils\any_value.sql
[0m18:52:53.791976 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m18:52:53.793977 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m18:52:53.806975 [debug] [MainThread]: Parsing macros\utils\last_day.sql
[0m18:52:53.808976 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m18:52:53.811521 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m18:52:53.816513 [debug] [MainThread]: Parsing macros\adapters\apply_grants.sql
[0m18:52:53.876088 [debug] [MainThread]: Parsing macros\adapters\columns.sql
[0m18:52:53.903086 [debug] [MainThread]: Parsing macros\adapters\freshness.sql
[0m18:52:53.912088 [debug] [MainThread]: Parsing macros\adapters\indexes.sql
[0m18:52:53.917835 [debug] [MainThread]: Parsing macros\adapters\metadata.sql
[0m18:52:53.942836 [debug] [MainThread]: Parsing macros\adapters\persist_docs.sql
[0m18:52:53.952834 [debug] [MainThread]: Parsing macros\adapters\relation.sql
[0m18:52:53.985833 [debug] [MainThread]: Parsing macros\adapters\schema.sql
[0m18:52:53.993358 [debug] [MainThread]: Parsing macros\adapters\timestamps.sql
[0m18:52:54.002356 [debug] [MainThread]: Parsing macros\etc\datetime.sql
[0m18:52:54.018358 [debug] [MainThread]: Parsing macros\etc\statement.sql
[0m18:52:54.029942 [debug] [MainThread]: Parsing macros\generic_test_sql\accepted_values.sql
[0m18:52:54.031941 [debug] [MainThread]: Parsing macros\generic_test_sql\not_null.sql
[0m18:52:54.033940 [debug] [MainThread]: Parsing macros\generic_test_sql\relationships.sql
[0m18:52:54.035949 [debug] [MainThread]: Parsing macros\generic_test_sql\unique.sql
[0m18:52:54.037940 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_alias.sql
[0m18:52:54.042939 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_database.sql
[0m18:52:54.045939 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_schema.sql
[0m18:52:54.052941 [debug] [MainThread]: Parsing macros\materializations\configs.sql
[0m18:52:54.057939 [debug] [MainThread]: Parsing macros\materializations\hooks.sql
[0m18:52:54.064940 [debug] [MainThread]: Parsing macros\materializations\models\incremental\column_helpers.sql
[0m18:52:54.079939 [debug] [MainThread]: Parsing macros\materializations\models\incremental\incremental.sql
[0m18:52:54.097453 [debug] [MainThread]: Parsing macros\materializations\models\incremental\is_incremental.sql
[0m18:52:54.100458 [debug] [MainThread]: Parsing macros\materializations\models\incremental\merge.sql
[0m18:52:54.127080 [debug] [MainThread]: Parsing macros\materializations\models\incremental\on_schema_change.sql
[0m18:52:54.154079 [debug] [MainThread]: Parsing macros\materializations\models\incremental\strategies.sql
[0m18:52:54.166930 [debug] [MainThread]: Parsing macros\materializations\models\table\create_table_as.sql
[0m18:52:54.174931 [debug] [MainThread]: Parsing macros\materializations\models\table\table.sql
[0m18:52:54.182926 [debug] [MainThread]: Parsing macros\materializations\models\view\create_or_replace_view.sql
[0m18:52:54.188930 [debug] [MainThread]: Parsing macros\materializations\models\view\create_view_as.sql
[0m18:52:54.193454 [debug] [MainThread]: Parsing macros\materializations\models\view\helpers.sql
[0m18:52:54.197451 [debug] [MainThread]: Parsing macros\materializations\models\view\view.sql
[0m18:52:54.206448 [debug] [MainThread]: Parsing macros\materializations\seeds\helpers.sql
[0m18:52:54.234448 [debug] [MainThread]: Parsing macros\materializations\seeds\seed.sql
[0m18:52:54.246449 [debug] [MainThread]: Parsing macros\materializations\snapshots\helpers.sql
[0m18:52:54.269450 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot.sql
[0m18:52:54.300449 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot_merge.sql
[0m18:52:54.307450 [debug] [MainThread]: Parsing macros\materializations\snapshots\strategies.sql
[0m18:52:54.365712 [debug] [MainThread]: Parsing macros\materializations\tests\helpers.sql
[0m18:52:54.380716 [debug] [MainThread]: Parsing macros\materializations\tests\test.sql
[0m18:52:54.395715 [debug] [MainThread]: Parsing macros\materializations\tests\where_subquery.sql
[0m18:52:54.403241 [debug] [MainThread]: Parsing macros\python_model\python.sql
[0m18:52:54.424765 [debug] [MainThread]: Parsing macros\utils\any_value.sql
[0m18:52:54.426753 [debug] [MainThread]: Parsing macros\utils\array_append.sql
[0m18:52:54.431752 [debug] [MainThread]: Parsing macros\utils\array_concat.sql
[0m18:52:54.447301 [debug] [MainThread]: Parsing macros\utils\array_construct.sql
[0m18:52:54.463618 [debug] [MainThread]: Parsing macros\utils\bool_or.sql
[0m18:52:54.471146 [debug] [MainThread]: Parsing macros\utils\cast_bool_to_text.sql
[0m18:52:54.484080 [debug] [MainThread]: Parsing macros\utils\concat.sql
[0m18:52:54.488448 [debug] [MainThread]: Parsing macros\utils\data_types.sql
[0m18:52:54.511814 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m18:52:54.515209 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m18:52:54.519733 [debug] [MainThread]: Parsing macros\utils\date_trunc.sql
[0m18:52:54.522728 [debug] [MainThread]: Parsing macros\utils\escape_single_quotes.sql
[0m18:52:54.525726 [debug] [MainThread]: Parsing macros\utils\except.sql
[0m18:52:54.528758 [debug] [MainThread]: Parsing macros\utils\hash.sql
[0m18:52:54.533726 [debug] [MainThread]: Parsing macros\utils\intersect.sql
[0m18:52:54.536727 [debug] [MainThread]: Parsing macros\utils\last_day.sql
[0m18:52:54.542741 [debug] [MainThread]: Parsing macros\utils\length.sql
[0m18:52:54.546604 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m18:52:54.554599 [debug] [MainThread]: Parsing macros\utils\literal.sql
[0m18:52:54.557601 [debug] [MainThread]: Parsing macros\utils\position.sql
[0m18:52:54.563601 [debug] [MainThread]: Parsing macros\utils\replace.sql
[0m18:52:54.566598 [debug] [MainThread]: Parsing macros\utils\right.sql
[0m18:52:54.569600 [debug] [MainThread]: Parsing macros\utils\safe_cast.sql
[0m18:52:54.574600 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m18:52:54.580599 [debug] [MainThread]: Parsing tests\generic\builtin.sql
[0m18:52:55.146148 [debug] [MainThread]: 1699: static parser successfully parsed example\my_first_dbt_model.sql
[0m18:52:55.178086 [debug] [MainThread]: 1699: static parser successfully parsed example\my_second_dbt_model.sql
[0m18:52:55.408682 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.learn_dbt.example

[0m18:52:55.431321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9187c4b6-f37d-4632-bc29-b148471f3978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D05F5A4220>]}
[0m18:52:55.507329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9187c4b6-f37d-4632-bc29-b148471f3978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D05F5A4910>]}
[0m18:52:55.508307 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m18:52:55.509311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9187c4b6-f37d-4632-bc29-b148471f3978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D05F63B1C0>]}
[0m18:52:55.512832 [info ] [MainThread]: 
[0m18:52:55.515834 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:52:55.518843 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m18:52:55.546832 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:52:55.548850 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:52:55.549860 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:52:57.693514 [debug] [ThreadPool]: SQL status: SELECT 11 in 2.14 seconds
[0m18:52:57.697229 [debug] [ThreadPool]: On list_postgres: Close
[0m18:52:57.702369 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m18:52:57.717379 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:52:57.718371 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m18:52:57.719373 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:53:00.072791 [debug] [ThreadPool]: SQL status: BEGIN in 2.35 seconds
[0m18:53:00.072947 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m18:53:00.073473 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m18:53:00.184038 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.11 seconds
[0m18:53:00.189057 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m18:53:00.235883 [debug] [ThreadPool]: On list_postgres_public: Close
[0m18:53:00.255563 [debug] [MainThread]: Using postgres connection "master"
[0m18:53:00.256564 [debug] [MainThread]: On master: BEGIN
[0m18:53:00.256564 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:53:02.325263 [debug] [MainThread]: SQL status: BEGIN in 2.07 seconds
[0m18:53:02.326264 [debug] [MainThread]: Using postgres connection "master"
[0m18:53:02.326264 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:53:02.398648 [debug] [MainThread]: SQL status: SELECT 0 in 0.07 seconds
[0m18:53:02.403317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9187c4b6-f37d-4632-bc29-b148471f3978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D05F401700>]}
[0m18:53:02.404033 [debug] [MainThread]: On master: ROLLBACK
[0m18:53:02.407541 [debug] [MainThread]: Using postgres connection "master"
[0m18:53:02.408066 [debug] [MainThread]: On master: BEGIN
[0m18:53:02.413459 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:53:02.414258 [debug] [MainThread]: On master: COMMIT
[0m18:53:02.414828 [debug] [MainThread]: Using postgres connection "master"
[0m18:53:02.414828 [debug] [MainThread]: On master: COMMIT
[0m18:53:02.419014 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:53:02.419705 [debug] [MainThread]: On master: Close
[0m18:53:02.421582 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:53:02.424582 [info ] [MainThread]: 
[0m18:53:02.504919 [debug] [Thread-1  ]: Began running node model.stgo_dbt.my_first_dbt_model
[0m18:53:02.506634 [info ] [Thread-1  ]: 1 of 2 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m18:53:02.510213 [debug] [Thread-1  ]: Acquiring new postgres connection "model.stgo_dbt.my_first_dbt_model"
[0m18:53:02.512216 [debug] [Thread-1  ]: Began compiling node model.stgo_dbt.my_first_dbt_model
[0m18:53:02.513209 [debug] [Thread-1  ]: Compiling model.stgo_dbt.my_first_dbt_model
[0m18:53:02.519200 [debug] [Thread-1  ]: Writing injected SQL for node "model.stgo_dbt.my_first_dbt_model"
[0m18:53:02.543204 [debug] [Thread-1  ]: finished collecting timing info
[0m18:53:02.543204 [debug] [Thread-1  ]: Began executing node model.stgo_dbt.my_first_dbt_model
[0m18:53:02.643761 [debug] [Thread-1  ]: Writing runtime sql for node "model.stgo_dbt.my_first_dbt_model"
[0m18:53:02.647764 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.my_first_dbt_model"
[0m18:53:02.648765 [debug] [Thread-1  ]: On model.stgo_dbt.my_first_dbt_model: BEGIN
[0m18:53:02.648765 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m18:53:05.027505 [debug] [Thread-1  ]: SQL status: BEGIN in 2.38 seconds
[0m18:53:05.028216 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.my_first_dbt_model"
[0m18:53:05.028784 [debug] [Thread-1  ]: On model.stgo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.my_first_dbt_model"} */

  
    

  create  table "postgres"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m18:53:05.056927 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.03 seconds
[0m18:53:05.070901 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.my_first_dbt_model"
[0m18:53:05.071887 [debug] [Thread-1  ]: On model.stgo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m18:53:05.076495 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:53:05.117828 [debug] [Thread-1  ]: On model.stgo_dbt.my_first_dbt_model: COMMIT
[0m18:53:05.117828 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.my_first_dbt_model"
[0m18:53:05.118830 [debug] [Thread-1  ]: On model.stgo_dbt.my_first_dbt_model: COMMIT
[0m18:53:05.142167 [debug] [Thread-1  ]: SQL status: COMMIT in 0.02 seconds
[0m18:53:05.152169 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.my_first_dbt_model"
[0m18:53:05.152726 [debug] [Thread-1  ]: On model.stgo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.my_first_dbt_model"} */
drop table if exists "postgres"."public"."my_first_dbt_model__dbt_backup" cascade
[0m18:53:05.156703 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m18:53:05.159456 [debug] [Thread-1  ]: finished collecting timing info
[0m18:53:05.160063 [debug] [Thread-1  ]: On model.stgo_dbt.my_first_dbt_model: Close
[0m18:53:05.161277 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9187c4b6-f37d-4632-bc29-b148471f3978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D05F6C6130>]}
[0m18:53:05.161831 [info ] [Thread-1  ]: 1 of 2 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 2.65s]
[0m18:53:05.164069 [debug] [Thread-1  ]: Finished running node model.stgo_dbt.my_first_dbt_model
[0m18:53:05.165236 [debug] [Thread-3  ]: Began running node model.stgo_dbt.my_second_dbt_model
[0m18:53:05.165789 [info ] [Thread-3  ]: 2 of 2 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m18:53:05.168580 [debug] [Thread-3  ]: Acquiring new postgres connection "model.stgo_dbt.my_second_dbt_model"
[0m18:53:05.168580 [debug] [Thread-3  ]: Began compiling node model.stgo_dbt.my_second_dbt_model
[0m18:53:05.169136 [debug] [Thread-3  ]: Compiling model.stgo_dbt.my_second_dbt_model
[0m18:53:05.179075 [debug] [Thread-3  ]: Writing injected SQL for node "model.stgo_dbt.my_second_dbt_model"
[0m18:53:05.181076 [debug] [Thread-3  ]: finished collecting timing info
[0m18:53:05.181076 [debug] [Thread-3  ]: Began executing node model.stgo_dbt.my_second_dbt_model
[0m18:53:05.231094 [debug] [Thread-3  ]: Writing runtime sql for node "model.stgo_dbt.my_second_dbt_model"
[0m18:53:05.234070 [debug] [Thread-3  ]: Using postgres connection "model.stgo_dbt.my_second_dbt_model"
[0m18:53:05.235072 [debug] [Thread-3  ]: On model.stgo_dbt.my_second_dbt_model: BEGIN
[0m18:53:05.236079 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m18:53:07.293253 [debug] [Thread-3  ]: SQL status: BEGIN in 2.06 seconds
[0m18:53:07.293558 [debug] [Thread-3  ]: Using postgres connection "model.stgo_dbt.my_second_dbt_model"
[0m18:53:07.294269 [debug] [Thread-3  ]: On model.stgo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.my_second_dbt_model"} */

  create view "postgres"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."public"."my_first_dbt_model"
where id = 1
  );
[0m18:53:07.336033 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.04 seconds
[0m18:53:07.342816 [debug] [Thread-3  ]: Using postgres connection "model.stgo_dbt.my_second_dbt_model"
[0m18:53:07.342816 [debug] [Thread-3  ]: On model.stgo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.my_second_dbt_model"} */
alter table "postgres"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m18:53:07.345813 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:53:07.351163 [debug] [Thread-3  ]: On model.stgo_dbt.my_second_dbt_model: COMMIT
[0m18:53:07.351693 [debug] [Thread-3  ]: Using postgres connection "model.stgo_dbt.my_second_dbt_model"
[0m18:53:07.351693 [debug] [Thread-3  ]: On model.stgo_dbt.my_second_dbt_model: COMMIT
[0m18:53:07.391270 [debug] [Thread-3  ]: SQL status: COMMIT in 0.04 seconds
[0m18:53:07.395048 [debug] [Thread-3  ]: Using postgres connection "model.stgo_dbt.my_second_dbt_model"
[0m18:53:07.395597 [debug] [Thread-3  ]: On model.stgo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.my_second_dbt_model"} */
drop view if exists "postgres"."public"."my_second_dbt_model__dbt_backup" cascade
[0m18:53:07.397240 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:53:07.398837 [debug] [Thread-3  ]: finished collecting timing info
[0m18:53:07.399381 [debug] [Thread-3  ]: On model.stgo_dbt.my_second_dbt_model: Close
[0m18:53:07.400508 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9187c4b6-f37d-4632-bc29-b148471f3978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D05F718940>]}
[0m18:53:07.401611 [info ] [Thread-3  ]: 2 of 2 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 2.23s]
[0m18:53:07.403921 [debug] [Thread-3  ]: Finished running node model.stgo_dbt.my_second_dbt_model
[0m18:53:07.406531 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m18:53:07.407079 [debug] [MainThread]: Using postgres connection "master"
[0m18:53:07.407631 [debug] [MainThread]: On master: BEGIN
[0m18:53:07.408188 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:53:09.504802 [debug] [MainThread]: SQL status: BEGIN in 2.1 seconds
[0m18:53:09.505998 [debug] [MainThread]: On master: COMMIT
[0m18:53:09.506573 [debug] [MainThread]: Using postgres connection "master"
[0m18:53:09.507150 [debug] [MainThread]: On master: COMMIT
[0m18:53:09.508795 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:53:09.509346 [debug] [MainThread]: On master: Close
[0m18:53:09.510451 [info ] [MainThread]: 
[0m18:53:09.511967 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 14.00 seconds (14.00s).
[0m18:53:09.513171 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:53:09.513171 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m18:53:09.514149 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m18:53:09.514675 [debug] [MainThread]: Connection 'model.stgo_dbt.my_first_dbt_model' was properly closed.
[0m18:53:09.514918 [debug] [MainThread]: Connection 'model.stgo_dbt.my_second_dbt_model' was properly closed.
[0m18:53:09.529414 [info ] [MainThread]: 
[0m18:53:09.531412 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:53:09.533413 [info ] [MainThread]: 
[0m18:53:09.534410 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m18:53:09.536406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D05F6E5160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D05F5A4370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D05F7B1B20>]}
[0m18:53:09.536406 [debug] [MainThread]: Flushing usage events


============================== 2023-01-02 19:02:09.453429 | 41da7548-94c9-401e-9609-eff467df3c5e ==============================
[0m19:02:09.453429 [info ] [MainThread]: Running with dbt=1.3.1
[0m19:02:09.455440 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'D:\\2023\\Cloudthought\\data-migration-dbt\\stgo_dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:02:09.455440 [debug] [MainThread]: Tracking: tracking
[0m19:02:09.503427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2D8FE1280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2D8FE1880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2D8FE1C10>]}
[0m19:02:09.577989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2D8FC8520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2D910DFA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D2D910D850>]}
[0m19:02:09.577989 [debug] [MainThread]: Flushing usage events
[0m19:02:10.816525 [error] [MainThread]: Encountered an error:
Parsing Error
  The schema file at models\example\schema.yml is invalid because the value of 'models' is not a list


============================== 2023-01-02 19:05:13.854214 | 1dbc8202-dcbf-4677-966e-db6985cb927f ==============================
[0m19:05:13.854214 [info ] [MainThread]: Running with dbt=1.3.1
[0m19:05:13.855211 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'D:\\2023\\Cloudthought\\data-migration-dbt\\stgo_dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:05:13.856211 [debug] [MainThread]: Tracking: tracking
[0m19:05:13.919211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252026DB9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252083118E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025208311220>]}
[0m19:05:14.080613 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 1 files changed.
[0m19:05:14.081156 [debug] [MainThread]: Partial parsing: added file: stgo_dbt://models\example\split_full_name.sql
[0m19:05:14.081693 [debug] [MainThread]: Partial parsing: added file: stgo_dbt://models\example\placeholder_from_airbyte.sql
[0m19:05:14.082243 [debug] [MainThread]: Partial parsing: added file: stgo_dbt://models\example\utils.sql
[0m19:05:14.083317 [debug] [MainThread]: Partial parsing: update schema file: stgo_dbt://models\example\schema.yml
[0m19:05:14.111103 [debug] [MainThread]: 1603: static parser failed on example\split_full_name.sql
[0m19:05:14.144104 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example\split_full_name.sql
[0m19:05:14.149103 [debug] [MainThread]: 1699: static parser successfully parsed example\placeholder_from_airbyte.sql
[0m19:05:14.159105 [debug] [MainThread]: 1699: static parser successfully parsed example\utils.sql
[0m19:05:14.167105 [debug] [MainThread]: 1699: static parser successfully parsed example\my_first_dbt_model.sql
[0m19:05:14.176103 [debug] [MainThread]: 1699: static parser successfully parsed example\my_second_dbt_model.sql
[0m19:05:14.238746 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'split_full_name.sql' in the 'models' section of file 'models\example\schema.yml'
[0m19:05:14.266089 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.stgo_dbt.not_null_split_full_name.sql_first_name.d83b9f940f' (models\example\schema.yml) depends on a node named 'split_full_name.sql' which was not found
[0m19:05:14.305092 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.learn_dbt.example

[0m19:05:14.324084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1dbc8202-dcbf-4677-966e-db6985cb927f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252084E8970>]}
[0m19:05:14.349791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1dbc8202-dcbf-4677-966e-db6985cb927f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252083BBEB0>]}
[0m19:05:14.350770 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m19:05:14.351766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1dbc8202-dcbf-4677-966e-db6985cb927f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252026DB9D0>]}
[0m19:05:14.354770 [info ] [MainThread]: 
[0m19:05:14.356766 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m19:05:14.361767 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m19:05:14.363765 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m19:05:14.388767 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:05:14.394767 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:05:14.394767 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:05:14.395770 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:05:14.395770 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:05:14.396767 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:05:16.473892 [debug] [ThreadPool]: SQL status: SELECT 11 in 2.08 seconds
[0m19:05:16.476876 [debug] [ThreadPool]: On list_postgres: Close
[0m19:05:16.477421 [debug] [ThreadPool]: SQL status: SELECT 11 in 2.08 seconds
[0m19:05:16.479108 [debug] [ThreadPool]: On list_postgres: Close
[0m19:05:16.482078 [debug] [ThreadPool]: Acquiring new postgres connection "create_postgres_public_public"
[0m19:05:16.483172 [debug] [ThreadPool]: Acquiring new postgres connection "create_postgres_public_public"
[0m19:05:16.483731 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='postgres', schema='public_public', identifier=None)"
[0m19:05:16.493159 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_public"
[0m19:05:16.493225 [debug] [ThreadPool]: On create_postgres_public_public: BEGIN
[0m19:05:16.493789 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:05:18.574325 [debug] [ThreadPool]: SQL status: BEGIN in 2.08 seconds
[0m19:05:18.575322 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_public"
[0m19:05:18.575322 [debug] [ThreadPool]: On create_postgres_public_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "create_postgres_public_public"} */
create schema if not exists "public_public"
[0m19:05:18.580322 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m19:05:18.582322 [debug] [ThreadPool]: On create_postgres_public_public: COMMIT
[0m19:05:18.582322 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_public"
[0m19:05:18.582322 [debug] [ThreadPool]: On create_postgres_public_public: COMMIT
[0m19:05:18.617410 [debug] [ThreadPool]: SQL status: COMMIT in 0.03 seconds
[0m19:05:18.617954 [debug] [ThreadPool]: On create_postgres_public_public: Close
[0m19:05:18.623075 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public_public"
[0m19:05:18.624733 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m19:05:18.634809 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m19:05:18.637811 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:05:18.637811 [debug] [ThreadPool]: On list_postgres_public_public: BEGIN
[0m19:05:18.638812 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m19:05:18.638812 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:05:18.638812 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:05:20.709067 [debug] [ThreadPool]: SQL status: BEGIN in 2.07 seconds
[0m19:05:20.710064 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m19:05:20.710064 [debug] [ThreadPool]: On list_postgres_public_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres_public_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
  
[0m19:05:20.717753 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.01 seconds
[0m19:05:20.717945 [debug] [ThreadPool]: SQL status: BEGIN in 2.08 seconds
[0m19:05:20.720115 [debug] [ThreadPool]: On list_postgres_public_public: ROLLBACK
[0m19:05:20.720692 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:05:20.721833 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m19:05:20.723136 [debug] [ThreadPool]: On list_postgres_public_public: Close
[0m19:05:20.727077 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
[0m19:05:20.729830 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m19:05:20.732043 [debug] [ThreadPool]: On list_postgres_public: Close
[0m19:05:20.740319 [debug] [MainThread]: Using postgres connection "master"
[0m19:05:20.740869 [debug] [MainThread]: On master: BEGIN
[0m19:05:20.741423 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:05:22.794925 [debug] [MainThread]: SQL status: BEGIN in 2.05 seconds
[0m19:05:22.795979 [debug] [MainThread]: Using postgres connection "master"
[0m19:05:22.795979 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:05:22.832177 [debug] [MainThread]: SQL status: SELECT 1 in 0.04 seconds
[0m19:05:22.834700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1dbc8202-dcbf-4677-966e-db6985cb927f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252084DA250>]}
[0m19:05:22.835696 [debug] [MainThread]: On master: ROLLBACK
[0m19:05:22.840555 [debug] [MainThread]: Using postgres connection "master"
[0m19:05:22.841094 [debug] [MainThread]: On master: BEGIN
[0m19:05:22.845077 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:05:22.845617 [debug] [MainThread]: On master: COMMIT
[0m19:05:22.846168 [debug] [MainThread]: Using postgres connection "master"
[0m19:05:22.846674 [debug] [MainThread]: On master: COMMIT
[0m19:05:22.848914 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:05:22.849447 [debug] [MainThread]: On master: Close
[0m19:05:22.850603 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:05:22.852320 [info ] [MainThread]: 
[0m19:05:22.864544 [debug] [Thread-1  ]: Began running node model.stgo_dbt.my_first_dbt_model
[0m19:05:22.864544 [debug] [Thread-2  ]: Began running node model.stgo_dbt.split_full_name
[0m19:05:22.865552 [info ] [Thread-1  ]: 1 of 4 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m19:05:22.866554 [debug] [Thread-3  ]: Began running node model.stgo_dbt.utils
[0m19:05:22.867544 [info ] [Thread-2  ]: 2 of 4 START sql view model public_public.split_full_name ...................... [RUN]
[0m19:05:22.871551 [debug] [Thread-1  ]: Acquiring new postgres connection "model.stgo_dbt.my_first_dbt_model"
[0m19:05:22.872545 [info ] [Thread-3  ]: 3 of 4 START sql view model public.utils ....................................... [RUN]
[0m19:05:22.873542 [debug] [Thread-1  ]: Began compiling node model.stgo_dbt.my_first_dbt_model
[0m19:05:22.875543 [debug] [Thread-2  ]: Acquiring new postgres connection "model.stgo_dbt.split_full_name"
[0m19:05:22.877545 [debug] [Thread-1  ]: Compiling model.stgo_dbt.my_first_dbt_model
[0m19:05:22.878544 [debug] [Thread-2  ]: Began compiling node model.stgo_dbt.split_full_name
[0m19:05:22.879542 [debug] [Thread-3  ]: Acquiring new postgres connection "model.stgo_dbt.utils"
[0m19:05:22.884542 [debug] [Thread-1  ]: Writing injected SQL for node "model.stgo_dbt.my_first_dbt_model"
[0m19:05:22.884542 [debug] [Thread-2  ]: Compiling model.stgo_dbt.split_full_name
[0m19:05:22.885542 [debug] [Thread-3  ]: Began compiling node model.stgo_dbt.utils
[0m19:05:22.895548 [debug] [Thread-2  ]: Writing injected SQL for node "model.stgo_dbt.split_full_name"
[0m19:05:22.896550 [debug] [Thread-3  ]: Compiling model.stgo_dbt.utils
[0m19:05:22.901542 [debug] [Thread-3  ]: Writing injected SQL for node "model.stgo_dbt.utils"
[0m19:05:22.903544 [debug] [Thread-1  ]: finished collecting timing info
[0m19:05:22.904544 [debug] [Thread-1  ]: Began executing node model.stgo_dbt.my_first_dbt_model
[0m19:05:22.916545 [debug] [Thread-3  ]: finished collecting timing info
[0m19:05:22.917544 [debug] [Thread-3  ]: Began executing node model.stgo_dbt.utils
[0m19:05:22.930546 [debug] [Thread-2  ]: finished collecting timing info
[0m19:05:22.946690 [debug] [Thread-2  ]: Began executing node model.stgo_dbt.split_full_name
[0m19:05:23.089434 [debug] [Thread-3  ]: Writing runtime sql for node "model.stgo_dbt.utils"
[0m19:05:23.093432 [debug] [Thread-2  ]: Writing runtime sql for node "model.stgo_dbt.split_full_name"
[0m19:05:23.098432 [debug] [Thread-1  ]: Writing runtime sql for node "model.stgo_dbt.my_first_dbt_model"
[0m19:05:23.114432 [debug] [Thread-3  ]: Using postgres connection "model.stgo_dbt.utils"
[0m19:05:23.114432 [debug] [Thread-2  ]: Using postgres connection "model.stgo_dbt.split_full_name"
[0m19:05:23.115438 [debug] [Thread-3  ]: On model.stgo_dbt.utils: BEGIN
[0m19:05:23.115438 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.my_first_dbt_model"
[0m19:05:23.116434 [debug] [Thread-2  ]: On model.stgo_dbt.split_full_name: BEGIN
[0m19:05:23.116434 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m19:05:23.117436 [debug] [Thread-1  ]: On model.stgo_dbt.my_first_dbt_model: BEGIN
[0m19:05:23.117436 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m19:05:23.118433 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m19:05:25.189423 [debug] [Thread-1  ]: SQL status: BEGIN in 2.07 seconds
[0m19:05:25.189423 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.my_first_dbt_model"
[0m19:05:25.190419 [debug] [Thread-1  ]: On model.stgo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.my_first_dbt_model"} */

  
    

  create  table "postgres"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m19:05:25.198871 [debug] [Thread-3  ]: SQL status: BEGIN in 2.08 seconds
[0m19:05:25.199394 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.01 seconds
[0m19:05:25.199953 [debug] [Thread-3  ]: Using postgres connection "model.stgo_dbt.utils"
[0m19:05:25.210946 [debug] [Thread-3  ]: On model.stgo_dbt.utils: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.utils"} */

  create view "postgres"."public"."utils__dbt_tmp" as (
    create or replace function split_name(full_name varchar)
returns table (first_name varchar, last_name varchar) as $$
  select
    trim(split_part(full_name, ' ', 1)),
    trim(split_part(full_name, ' ', 2))
  from (
    select full_name
  ) t;
$$ language sql;
Run the dbt model to create the view with the first_name and last_name columns.
Keep in mind that the split_name function will only work correctly if the full_name column follows a specific format, such as "First Last" or "Last, First". If the full_name column does not follow this format, you may need to modify the split_name function to handle different cases.
  );
[0m19:05:25.212163 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.my_first_dbt_model"
[0m19:05:25.212711 [debug] [Thread-1  ]: On model.stgo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m19:05:25.216412 [debug] [Thread-3  ]: Postgres adapter: Postgres error: syntax error at or near "create"
LINE 4:     create or replace function split_name(full_name varchar)
            ^

[0m19:05:25.216541 [debug] [Thread-2  ]: SQL status: BEGIN in 2.1 seconds
[0m19:05:25.217158 [debug] [Thread-3  ]: On model.stgo_dbt.utils: ROLLBACK
[0m19:05:25.217701 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:05:25.217701 [debug] [Thread-2  ]: Using postgres connection "model.stgo_dbt.split_full_name"
[0m19:05:25.222525 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.my_first_dbt_model"
[0m19:05:25.222525 [debug] [Thread-3  ]: finished collecting timing info
[0m19:05:25.223072 [debug] [Thread-2  ]: On model.stgo_dbt.split_full_name: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.split_full_name"} */

  create view "postgres"."public_public"."split_full_name__dbt_tmp" as (
    



select
  split_name(name) as (first_name, last_name)
from cdc_tut
  );
[0m19:05:25.223612 [debug] [Thread-1  ]: On model.stgo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m19:05:25.224152 [debug] [Thread-3  ]: On model.stgo_dbt.utils: Close
[0m19:05:25.226869 [debug] [Thread-3  ]: Database Error in model utils (models\example\utils.sql)
  syntax error at or near "create"
  LINE 4:     create or replace function split_name(full_name varchar)
              ^
  compiled Code at target\run\stgo_dbt\models\example\utils.sql
[0m19:05:25.228274 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dbc8202-dcbf-4677-966e-db6985cb927f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002520859BB20>]}
[0m19:05:25.228897 [error] [Thread-3  ]: 3 of 4 ERROR creating sql view model public.utils .............................. [[31mERROR[0m in 2.35s]
[0m19:05:25.229426 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:05:25.229971 [debug] [Thread-2  ]: Postgres adapter: Postgres error: syntax error at or near "("
LINE 9:   split_name(name) as (first_name, last_name)
                              ^

[0m19:05:25.277353 [debug] [Thread-2  ]: On model.stgo_dbt.split_full_name: ROLLBACK
[0m19:05:25.287285 [debug] [Thread-1  ]: On model.stgo_dbt.my_first_dbt_model: COMMIT
[0m19:05:25.287826 [debug] [Thread-2  ]: finished collecting timing info
[0m19:05:25.287826 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.my_first_dbt_model"
[0m19:05:25.288417 [debug] [Thread-3  ]: Finished running node model.stgo_dbt.utils
[0m19:05:25.288980 [debug] [Thread-2  ]: On model.stgo_dbt.split_full_name: Close
[0m19:05:25.290055 [debug] [Thread-1  ]: On model.stgo_dbt.my_first_dbt_model: COMMIT
[0m19:05:25.291926 [debug] [Thread-2  ]: Database Error in model split_full_name (models\example\split_full_name.sql)
  syntax error at or near "("
  LINE 9:   split_name(name) as (first_name, last_name)
                                ^
  compiled Code at target\run\stgo_dbt\models\example\split_full_name.sql
[0m19:05:25.292446 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dbc8202-dcbf-4677-966e-db6985cb927f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252085A1280>]}
[0m19:05:25.293445 [error] [Thread-2  ]: 2 of 4 ERROR creating sql view model public_public.split_full_name ............. [[31mERROR[0m in 2.42s]
[0m19:05:25.296162 [debug] [Thread-2  ]: Finished running node model.stgo_dbt.split_full_name
[0m19:05:25.317496 [debug] [Thread-1  ]: SQL status: COMMIT in 0.03 seconds
[0m19:05:25.328175 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.my_first_dbt_model"
[0m19:05:25.328703 [debug] [Thread-1  ]: On model.stgo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.my_first_dbt_model"} */
drop table if exists "postgres"."public"."my_first_dbt_model__dbt_backup" cascade
[0m19:05:25.368567 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.04 seconds
[0m19:05:25.371880 [debug] [Thread-1  ]: finished collecting timing info
[0m19:05:25.371880 [debug] [Thread-1  ]: On model.stgo_dbt.my_first_dbt_model: Close
[0m19:05:25.374141 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dbc8202-dcbf-4677-966e-db6985cb927f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002520856CC10>]}
[0m19:05:25.374684 [info ] [Thread-1  ]: 1 of 4 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 2.50s]
[0m19:05:25.376924 [debug] [Thread-1  ]: Finished running node model.stgo_dbt.my_first_dbt_model
[0m19:05:25.379071 [debug] [Thread-4  ]: Began running node model.stgo_dbt.my_second_dbt_model
[0m19:05:25.380899 [info ] [Thread-4  ]: 4 of 4 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m19:05:25.384610 [debug] [Thread-4  ]: Acquiring new postgres connection "model.stgo_dbt.my_second_dbt_model"
[0m19:05:25.385141 [debug] [Thread-4  ]: Began compiling node model.stgo_dbt.my_second_dbt_model
[0m19:05:25.385829 [debug] [Thread-4  ]: Compiling model.stgo_dbt.my_second_dbt_model
[0m19:05:25.392050 [debug] [Thread-4  ]: Writing injected SQL for node "model.stgo_dbt.my_second_dbt_model"
[0m19:05:25.393062 [debug] [Thread-4  ]: finished collecting timing info
[0m19:05:25.393062 [debug] [Thread-4  ]: Began executing node model.stgo_dbt.my_second_dbt_model
[0m19:05:25.407049 [debug] [Thread-4  ]: Writing runtime sql for node "model.stgo_dbt.my_second_dbt_model"
[0m19:05:25.409051 [debug] [Thread-4  ]: Using postgres connection "model.stgo_dbt.my_second_dbt_model"
[0m19:05:25.409051 [debug] [Thread-4  ]: On model.stgo_dbt.my_second_dbt_model: BEGIN
[0m19:05:25.410051 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m19:05:27.470473 [debug] [Thread-4  ]: SQL status: BEGIN in 2.06 seconds
[0m19:05:27.471029 [debug] [Thread-4  ]: Using postgres connection "model.stgo_dbt.my_second_dbt_model"
[0m19:05:27.471615 [debug] [Thread-4  ]: On model.stgo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.my_second_dbt_model"} */

  create view "postgres"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."public"."my_first_dbt_model"
where id = 1
  );
[0m19:05:27.479502 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.01 seconds
[0m19:05:27.483390 [debug] [Thread-4  ]: Using postgres connection "model.stgo_dbt.my_second_dbt_model"
[0m19:05:27.483390 [debug] [Thread-4  ]: On model.stgo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.my_second_dbt_model"} */
alter table "postgres"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m19:05:27.486344 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:05:27.489100 [debug] [Thread-4  ]: On model.stgo_dbt.my_second_dbt_model: COMMIT
[0m19:05:27.489617 [debug] [Thread-4  ]: Using postgres connection "model.stgo_dbt.my_second_dbt_model"
[0m19:05:27.490167 [debug] [Thread-4  ]: On model.stgo_dbt.my_second_dbt_model: COMMIT
[0m19:05:27.517412 [debug] [Thread-4  ]: SQL status: COMMIT in 0.03 seconds
[0m19:05:27.520932 [debug] [Thread-4  ]: Using postgres connection "model.stgo_dbt.my_second_dbt_model"
[0m19:05:27.520932 [debug] [Thread-4  ]: On model.stgo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.my_second_dbt_model"} */
drop view if exists "postgres"."public"."my_second_dbt_model__dbt_backup" cascade
[0m19:05:27.522878 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m19:05:27.525379 [debug] [Thread-4  ]: finished collecting timing info
[0m19:05:27.525400 [debug] [Thread-4  ]: On model.stgo_dbt.my_second_dbt_model: Close
[0m19:05:27.526480 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dbc8202-dcbf-4677-966e-db6985cb927f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002520860F5E0>]}
[0m19:05:27.527575 [info ] [Thread-4  ]: 4 of 4 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 2.14s]
[0m19:05:27.528673 [debug] [Thread-4  ]: Finished running node model.stgo_dbt.my_second_dbt_model
[0m19:05:27.531954 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m19:05:27.532589 [debug] [MainThread]: Using postgres connection "master"
[0m19:05:27.533198 [debug] [MainThread]: On master: BEGIN
[0m19:05:27.534148 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:05:29.595997 [debug] [MainThread]: SQL status: BEGIN in 2.06 seconds
[0m19:05:29.596996 [debug] [MainThread]: On master: COMMIT
[0m19:05:29.596996 [debug] [MainThread]: Using postgres connection "master"
[0m19:05:29.597996 [debug] [MainThread]: On master: COMMIT
[0m19:05:29.607363 [debug] [MainThread]: SQL status: COMMIT in 0.01 seconds
[0m19:05:29.607363 [debug] [MainThread]: On master: Close
[0m19:05:29.609055 [info ] [MainThread]: 
[0m19:05:29.611051 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 15.25 seconds (15.25s).
[0m19:05:29.613051 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:05:29.613051 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m19:05:29.614049 [debug] [MainThread]: Connection 'create_postgres_public_public' was properly closed.
[0m19:05:29.614049 [debug] [MainThread]: Connection 'list_postgres_public_public' was properly closed.
[0m19:05:29.615053 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m19:05:29.615053 [debug] [MainThread]: Connection 'model.stgo_dbt.my_first_dbt_model' was properly closed.
[0m19:05:29.616052 [debug] [MainThread]: Connection 'model.stgo_dbt.split_full_name' was properly closed.
[0m19:05:29.616052 [debug] [MainThread]: Connection 'model.stgo_dbt.utils' was properly closed.
[0m19:05:29.616052 [debug] [MainThread]: Connection 'model.stgo_dbt.my_second_dbt_model' was properly closed.
[0m19:05:29.635519 [info ] [MainThread]: 
[0m19:05:29.637456 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m19:05:29.643979 [info ] [MainThread]: 
[0m19:05:29.646985 [error] [MainThread]: [33mDatabase Error in model utils (models\example\utils.sql)[0m
[0m19:05:29.661980 [error] [MainThread]:   syntax error at or near "create"
[0m19:05:29.666983 [error] [MainThread]:   LINE 4:     create or replace function split_name(full_name varchar)
[0m19:05:29.670983 [error] [MainThread]:               ^
[0m19:05:29.681980 [error] [MainThread]:   compiled Code at target\run\stgo_dbt\models\example\utils.sql
[0m19:05:29.688987 [info ] [MainThread]: 
[0m19:05:29.692982 [error] [MainThread]: [33mDatabase Error in model split_full_name (models\example\split_full_name.sql)[0m
[0m19:05:29.698981 [error] [MainThread]:   syntax error at or near "("
[0m19:05:29.699990 [error] [MainThread]:   LINE 9:   split_name(name) as (first_name, last_name)
[0m19:05:29.702985 [error] [MainThread]:                                 ^
[0m19:05:29.706989 [error] [MainThread]:   compiled Code at target\run\stgo_dbt\models\example\split_full_name.sql
[0m19:05:29.710991 [info ] [MainThread]: 
[0m19:05:29.714993 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m19:05:29.719994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025208507FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025208581EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025208593130>]}
[0m19:05:29.720984 [debug] [MainThread]: Flushing usage events


============================== 2023-01-02 19:06:03.076985 | 53d5ca12-91bb-4325-9cc0-e02004c9d17d ==============================
[0m19:06:03.076985 [info ] [MainThread]: Running with dbt=1.3.1
[0m19:06:03.087986 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'D:\\2023\\Cloudthought\\data-migration-dbt\\stgo_dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:06:03.087986 [debug] [MainThread]: Tracking: tracking
[0m19:06:03.167987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2ED1B22B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2ED1B2880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2ED1B2C10>]}
[0m19:06:03.596000 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:06:03.597001 [debug] [MainThread]: Partial parsing: update schema file: stgo_dbt://models\example\schema.yml
[0m19:06:03.694000 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.learn_dbt.example

[0m19:06:03.785006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '53d5ca12-91bb-4325-9cc0-e02004c9d17d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2EAD7B370>]}
[0m19:06:03.807005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53d5ca12-91bb-4325-9cc0-e02004c9d17d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2ED2E0F40>]}
[0m19:06:03.808000 [info ] [MainThread]: Found 5 models, 1 test, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m19:06:03.809000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53d5ca12-91bb-4325-9cc0-e02004c9d17d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2E9B7EAC0>]}
[0m19:06:03.812000 [info ] [MainThread]: 
[0m19:06:03.814001 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m19:06:03.818003 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m19:06:03.826000 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m19:06:03.876615 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:06:03.881608 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:06:03.881608 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:06:03.881608 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:06:03.882607 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:06:03.883607 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:06:06.220292 [debug] [ThreadPool]: SQL status: SELECT 12 in 2.34 seconds
[0m19:06:06.222454 [debug] [ThreadPool]: On list_postgres: Close
[0m19:06:06.223012 [debug] [ThreadPool]: SQL status: SELECT 12 in 2.34 seconds
[0m19:06:06.225757 [debug] [ThreadPool]: On list_postgres: Close
[0m19:06:06.230837 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m19:06:06.243836 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:06:06.243836 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public_public"
[0m19:06:06.244843 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m19:06:06.247838 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m19:06:06.248836 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:06:06.248836 [debug] [ThreadPool]: On list_postgres_public_public: BEGIN
[0m19:06:06.248836 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:06:08.314660 [debug] [ThreadPool]: SQL status: BEGIN in 2.07 seconds
[0m19:06:08.315233 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:06:08.315875 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m19:06:08.323404 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
[0m19:06:08.326219 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m19:06:08.328982 [debug] [ThreadPool]: On list_postgres_public: Close
[0m19:06:08.331262 [debug] [ThreadPool]: SQL status: BEGIN in 2.08 seconds
[0m19:06:08.331812 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m19:06:08.332332 [debug] [ThreadPool]: On list_postgres_public_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres_public_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
  
[0m19:06:08.339980 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.01 seconds
[0m19:06:08.342171 [debug] [ThreadPool]: On list_postgres_public_public: ROLLBACK
[0m19:06:08.344369 [debug] [ThreadPool]: On list_postgres_public_public: Close
[0m19:06:08.353297 [debug] [MainThread]: Using postgres connection "master"
[0m19:06:08.353837 [debug] [MainThread]: On master: BEGIN
[0m19:06:08.353837 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:06:10.427278 [debug] [MainThread]: SQL status: BEGIN in 2.07 seconds
[0m19:06:10.427818 [debug] [MainThread]: Using postgres connection "master"
[0m19:06:10.427818 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:06:10.456410 [debug] [MainThread]: SQL status: SELECT 1 in 0.03 seconds
[0m19:06:10.458023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53d5ca12-91bb-4325-9cc0-e02004c9d17d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2ED36E550>]}
[0m19:06:10.458556 [debug] [MainThread]: On master: ROLLBACK
[0m19:06:10.460159 [debug] [MainThread]: Using postgres connection "master"
[0m19:06:10.460695 [debug] [MainThread]: On master: BEGIN
[0m19:06:10.463967 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:06:10.464494 [debug] [MainThread]: On master: COMMIT
[0m19:06:10.464494 [debug] [MainThread]: Using postgres connection "master"
[0m19:06:10.465092 [debug] [MainThread]: On master: COMMIT
[0m19:06:10.466925 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:06:10.467468 [debug] [MainThread]: On master: Close
[0m19:06:10.468574 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:06:10.469660 [info ] [MainThread]: 
[0m19:06:10.484476 [debug] [Thread-1  ]: Began running node model.stgo_dbt.my_first_dbt_model
[0m19:06:10.484476 [debug] [Thread-2  ]: Began running node model.stgo_dbt.split_full_name
[0m19:06:10.485484 [debug] [Thread-3  ]: Began running node model.stgo_dbt.utils
[0m19:06:10.486475 [info ] [Thread-1  ]: 1 of 4 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m19:06:10.486475 [info ] [Thread-2  ]: 2 of 4 START sql view model public_public.split_full_name ...................... [RUN]
[0m19:06:10.487482 [info ] [Thread-3  ]: 3 of 4 START sql view model public.utils ....................................... [RUN]
[0m19:06:10.489473 [debug] [Thread-1  ]: Acquiring new postgres connection "model.stgo_dbt.my_first_dbt_model"
[0m19:06:10.490471 [debug] [Thread-1  ]: Began compiling node model.stgo_dbt.my_first_dbt_model
[0m19:06:10.491477 [debug] [Thread-2  ]: Acquiring new postgres connection "model.stgo_dbt.split_full_name"
[0m19:06:10.492477 [debug] [Thread-1  ]: Compiling model.stgo_dbt.my_first_dbt_model
[0m19:06:10.494474 [debug] [Thread-3  ]: Acquiring new postgres connection "model.stgo_dbt.utils"
[0m19:06:10.494474 [debug] [Thread-2  ]: Began compiling node model.stgo_dbt.split_full_name
[0m19:06:10.500997 [debug] [Thread-1  ]: Writing injected SQL for node "model.stgo_dbt.my_first_dbt_model"
[0m19:06:10.501999 [debug] [Thread-3  ]: Began compiling node model.stgo_dbt.utils
[0m19:06:10.501999 [debug] [Thread-2  ]: Compiling model.stgo_dbt.split_full_name
[0m19:06:10.502998 [debug] [Thread-3  ]: Compiling model.stgo_dbt.utils
[0m19:06:10.507999 [debug] [Thread-2  ]: Writing injected SQL for node "model.stgo_dbt.split_full_name"
[0m19:06:10.513001 [debug] [Thread-3  ]: Writing injected SQL for node "model.stgo_dbt.utils"
[0m19:06:10.514007 [debug] [Thread-1  ]: finished collecting timing info
[0m19:06:10.515002 [debug] [Thread-1  ]: Began executing node model.stgo_dbt.my_first_dbt_model
[0m19:06:10.571775 [debug] [Thread-2  ]: finished collecting timing info
[0m19:06:10.571775 [debug] [Thread-3  ]: finished collecting timing info
[0m19:06:10.591292 [debug] [Thread-1  ]: Writing runtime sql for node "model.stgo_dbt.my_first_dbt_model"
[0m19:06:10.592292 [debug] [Thread-2  ]: Began executing node model.stgo_dbt.split_full_name
[0m19:06:10.592292 [debug] [Thread-3  ]: Began executing node model.stgo_dbt.utils
[0m19:06:10.623294 [debug] [Thread-2  ]: Writing runtime sql for node "model.stgo_dbt.split_full_name"
[0m19:06:10.630293 [debug] [Thread-3  ]: Writing runtime sql for node "model.stgo_dbt.utils"
[0m19:06:10.631293 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.my_first_dbt_model"
[0m19:06:10.632295 [debug] [Thread-1  ]: On model.stgo_dbt.my_first_dbt_model: BEGIN
[0m19:06:10.632295 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m19:06:10.633294 [debug] [Thread-2  ]: Using postgres connection "model.stgo_dbt.split_full_name"
[0m19:06:10.633294 [debug] [Thread-3  ]: Using postgres connection "model.stgo_dbt.utils"
[0m19:06:10.634295 [debug] [Thread-2  ]: On model.stgo_dbt.split_full_name: BEGIN
[0m19:06:10.634295 [debug] [Thread-3  ]: On model.stgo_dbt.utils: BEGIN
[0m19:06:10.634295 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m19:06:10.634295 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m19:06:12.698986 [debug] [Thread-2  ]: SQL status: BEGIN in 2.06 seconds
[0m19:06:12.699982 [debug] [Thread-2  ]: Using postgres connection "model.stgo_dbt.split_full_name"
[0m19:06:12.699982 [debug] [Thread-2  ]: On model.stgo_dbt.split_full_name: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.split_full_name"} */

  create view "postgres"."public_public"."split_full_name__dbt_tmp" as (
    



select
  split_name(name) as (first_name, last_name)
from cdc_tut
  );
[0m19:06:12.704294 [debug] [Thread-2  ]: Postgres adapter: Postgres error: syntax error at or near "("
LINE 9:   split_name(name) as (first_name, last_name)
                              ^

[0m19:06:12.704815 [debug] [Thread-2  ]: On model.stgo_dbt.split_full_name: ROLLBACK
[0m19:06:12.709832 [debug] [Thread-2  ]: finished collecting timing info
[0m19:06:12.710963 [debug] [Thread-2  ]: On model.stgo_dbt.split_full_name: Close
[0m19:06:12.712695 [debug] [Thread-2  ]: Database Error in model split_full_name (models\example\split_full_name.sql)
  syntax error at or near "("
  LINE 9:   split_name(name) as (first_name, last_name)
                                ^
  compiled Code at target\run\stgo_dbt\models\example\split_full_name.sql
[0m19:06:12.713890 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53d5ca12-91bb-4325-9cc0-e02004c9d17d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2ED3E3E80>]}
[0m19:06:12.715202 [error] [Thread-2  ]: 2 of 4 ERROR creating sql view model public_public.split_full_name ............. [[31mERROR[0m in 2.22s]
[0m19:06:12.717771 [debug] [Thread-2  ]: Finished running node model.stgo_dbt.split_full_name
[0m19:06:12.720867 [debug] [Thread-3  ]: SQL status: BEGIN in 2.09 seconds
[0m19:06:12.721393 [debug] [Thread-3  ]: Using postgres connection "model.stgo_dbt.utils"
[0m19:06:12.722387 [debug] [Thread-3  ]: On model.stgo_dbt.utils: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.utils"} */

  create view "postgres"."public"."utils__dbt_tmp" as (
    create or replace function split_name(full_name varchar)
returns table (first_name varchar, last_name varchar) as $$
  select
    trim(split_part(full_name, ' ', 1)),
    trim(split_part(full_name, ' ', 2))
  from (
    select full_name
  ) t;
$$ language sql;
Run the dbt model to create the view with the first_name and last_name columns.
Keep in mind that the split_name function will only work correctly if the full_name column follows a specific format, such as "First Last" or "Last, First". If the full_name column does not follow this format, you may need to modify the split_name function to handle different cases.
  );
[0m19:06:12.725202 [debug] [Thread-3  ]: Postgres adapter: Postgres error: syntax error at or near "create"
LINE 4:     create or replace function split_name(full_name varchar)
            ^

[0m19:06:12.726065 [debug] [Thread-3  ]: On model.stgo_dbt.utils: ROLLBACK
[0m19:06:12.727600 [debug] [Thread-1  ]: SQL status: BEGIN in 2.1 seconds
[0m19:06:12.728168 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.my_first_dbt_model"
[0m19:06:12.728809 [debug] [Thread-1  ]: On model.stgo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.my_first_dbt_model"} */

  
    

  create  table "postgres"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m19:06:12.730486 [debug] [Thread-3  ]: finished collecting timing info
[0m19:06:12.731082 [debug] [Thread-3  ]: On model.stgo_dbt.utils: Close
[0m19:06:12.732970 [debug] [Thread-3  ]: Database Error in model utils (models\example\utils.sql)
  syntax error at or near "create"
  LINE 4:     create or replace function split_name(full_name varchar)
              ^
  compiled Code at target\run\stgo_dbt\models\example\utils.sql
[0m19:06:12.733522 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53d5ca12-91bb-4325-9cc0-e02004c9d17d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2ED1CFBB0>]}
[0m19:06:12.734512 [error] [Thread-3  ]: 3 of 4 ERROR creating sql view model public.utils .............................. [[31mERROR[0m in 2.24s]
[0m19:06:12.735349 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.01 seconds
[0m19:06:12.754351 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.my_first_dbt_model"
[0m19:06:12.755351 [debug] [Thread-3  ]: Finished running node model.stgo_dbt.utils
[0m19:06:12.755351 [debug] [Thread-1  ]: On model.stgo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m19:06:12.760403 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:06:12.768005 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.my_first_dbt_model"
[0m19:06:12.768546 [debug] [Thread-1  ]: On model.stgo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m19:06:12.772848 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:06:12.830925 [debug] [Thread-1  ]: On model.stgo_dbt.my_first_dbt_model: COMMIT
[0m19:06:12.831919 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.my_first_dbt_model"
[0m19:06:12.831919 [debug] [Thread-1  ]: On model.stgo_dbt.my_first_dbt_model: COMMIT
[0m19:06:12.857429 [debug] [Thread-1  ]: SQL status: COMMIT in 0.03 seconds
[0m19:06:12.869950 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.my_first_dbt_model"
[0m19:06:12.870948 [debug] [Thread-1  ]: On model.stgo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.my_first_dbt_model"} */
drop table if exists "postgres"."public"."my_first_dbt_model__dbt_backup" cascade
[0m19:06:12.900044 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.03 seconds
[0m19:06:12.902049 [debug] [Thread-1  ]: finished collecting timing info
[0m19:06:12.903043 [debug] [Thread-1  ]: On model.stgo_dbt.my_first_dbt_model: Close
[0m19:06:12.904042 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53d5ca12-91bb-4325-9cc0-e02004c9d17d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2ED399670>]}
[0m19:06:12.905043 [info ] [Thread-1  ]: 1 of 4 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 2.42s]
[0m19:06:12.907045 [debug] [Thread-1  ]: Finished running node model.stgo_dbt.my_first_dbt_model
[0m19:06:12.908051 [debug] [Thread-4  ]: Began running node model.stgo_dbt.my_second_dbt_model
[0m19:06:12.909050 [info ] [Thread-4  ]: 4 of 4 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m19:06:12.911045 [debug] [Thread-4  ]: Acquiring new postgres connection "model.stgo_dbt.my_second_dbt_model"
[0m19:06:12.912045 [debug] [Thread-4  ]: Began compiling node model.stgo_dbt.my_second_dbt_model
[0m19:06:12.912045 [debug] [Thread-4  ]: Compiling model.stgo_dbt.my_second_dbt_model
[0m19:06:12.919650 [debug] [Thread-4  ]: Writing injected SQL for node "model.stgo_dbt.my_second_dbt_model"
[0m19:06:12.921653 [debug] [Thread-4  ]: finished collecting timing info
[0m19:06:12.922661 [debug] [Thread-4  ]: Began executing node model.stgo_dbt.my_second_dbt_model
[0m19:06:12.935654 [debug] [Thread-4  ]: Writing runtime sql for node "model.stgo_dbt.my_second_dbt_model"
[0m19:06:12.938660 [debug] [Thread-4  ]: Using postgres connection "model.stgo_dbt.my_second_dbt_model"
[0m19:06:12.939652 [debug] [Thread-4  ]: On model.stgo_dbt.my_second_dbt_model: BEGIN
[0m19:06:12.940650 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m19:06:14.980483 [debug] [Thread-4  ]: SQL status: BEGIN in 2.04 seconds
[0m19:06:14.981023 [debug] [Thread-4  ]: Using postgres connection "model.stgo_dbt.my_second_dbt_model"
[0m19:06:14.981585 [debug] [Thread-4  ]: On model.stgo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.my_second_dbt_model"} */

  create view "postgres"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."public"."my_first_dbt_model"
where id = 1
  );
[0m19:06:14.988831 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.01 seconds
[0m19:06:14.993286 [debug] [Thread-4  ]: Using postgres connection "model.stgo_dbt.my_second_dbt_model"
[0m19:06:14.993286 [debug] [Thread-4  ]: On model.stgo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.my_second_dbt_model"} */
alter table "postgres"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m19:06:14.996173 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:06:14.999535 [debug] [Thread-4  ]: On model.stgo_dbt.my_second_dbt_model: COMMIT
[0m19:06:14.999535 [debug] [Thread-4  ]: Using postgres connection "model.stgo_dbt.my_second_dbt_model"
[0m19:06:15.000090 [debug] [Thread-4  ]: On model.stgo_dbt.my_second_dbt_model: COMMIT
[0m19:06:15.048896 [debug] [Thread-4  ]: SQL status: COMMIT in 0.05 seconds
[0m19:06:15.051894 [debug] [Thread-4  ]: Using postgres connection "model.stgo_dbt.my_second_dbt_model"
[0m19:06:15.052891 [debug] [Thread-4  ]: On model.stgo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.my_second_dbt_model"} */
drop view if exists "postgres"."public"."my_second_dbt_model__dbt_backup" cascade
[0m19:06:15.054891 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m19:06:15.056891 [debug] [Thread-4  ]: finished collecting timing info
[0m19:06:15.056891 [debug] [Thread-4  ]: On model.stgo_dbt.my_second_dbt_model: Close
[0m19:06:15.058758 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53d5ca12-91bb-4325-9cc0-e02004c9d17d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2ED328460>]}
[0m19:06:15.059695 [info ] [Thread-4  ]: 4 of 4 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 2.15s]
[0m19:06:15.061498 [debug] [Thread-4  ]: Finished running node model.stgo_dbt.my_second_dbt_model
[0m19:06:15.064443 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m19:06:15.064996 [debug] [MainThread]: Using postgres connection "master"
[0m19:06:15.064996 [debug] [MainThread]: On master: BEGIN
[0m19:06:15.065581 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:06:17.157269 [debug] [MainThread]: SQL status: BEGIN in 2.09 seconds
[0m19:06:17.157821 [debug] [MainThread]: On master: COMMIT
[0m19:06:17.158579 [debug] [MainThread]: Using postgres connection "master"
[0m19:06:17.158579 [debug] [MainThread]: On master: COMMIT
[0m19:06:17.161495 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:06:17.162021 [debug] [MainThread]: On master: Close
[0m19:06:17.163014 [info ] [MainThread]: 
[0m19:06:17.164554 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 13.35 seconds (13.35s).
[0m19:06:17.166073 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:06:17.166989 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m19:06:17.167514 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m19:06:17.167549 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m19:06:17.168099 [debug] [MainThread]: Connection 'list_postgres_public_public' was properly closed.
[0m19:06:17.168796 [debug] [MainThread]: Connection 'model.stgo_dbt.my_first_dbt_model' was properly closed.
[0m19:06:17.169318 [debug] [MainThread]: Connection 'model.stgo_dbt.split_full_name' was properly closed.
[0m19:06:17.169981 [debug] [MainThread]: Connection 'model.stgo_dbt.utils' was properly closed.
[0m19:06:17.170505 [debug] [MainThread]: Connection 'model.stgo_dbt.my_second_dbt_model' was properly closed.
[0m19:06:17.192227 [info ] [MainThread]: 
[0m19:06:17.194227 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m19:06:17.196224 [info ] [MainThread]: 
[0m19:06:17.198225 [error] [MainThread]: [33mDatabase Error in model split_full_name (models\example\split_full_name.sql)[0m
[0m19:06:17.199225 [error] [MainThread]:   syntax error at or near "("
[0m19:06:17.200224 [error] [MainThread]:   LINE 9:   split_name(name) as (first_name, last_name)
[0m19:06:17.202225 [error] [MainThread]:                                 ^
[0m19:06:17.205225 [error] [MainThread]:   compiled Code at target\run\stgo_dbt\models\example\split_full_name.sql
[0m19:06:17.206227 [info ] [MainThread]: 
[0m19:06:17.208224 [error] [MainThread]: [33mDatabase Error in model utils (models\example\utils.sql)[0m
[0m19:06:17.210226 [error] [MainThread]:   syntax error at or near "create"
[0m19:06:17.213226 [error] [MainThread]:   LINE 4:     create or replace function split_name(full_name varchar)
[0m19:06:17.214223 [error] [MainThread]:               ^
[0m19:06:17.217230 [error] [MainThread]:   compiled Code at target\run\stgo_dbt\models\example\utils.sql
[0m19:06:17.219226 [info ] [MainThread]: 
[0m19:06:17.221228 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m19:06:17.225226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2EB5E1970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2ED3D00D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2ED3D05B0>]}
[0m19:06:17.225226 [debug] [MainThread]: Flushing usage events


============================== 2023-01-02 19:09:58.697146 | 07b9df49-e062-472b-8cae-bbe48846b9e6 ==============================
[0m19:09:58.697146 [info ] [MainThread]: Running with dbt=1.3.1
[0m19:09:58.699147 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'D:\\2023\\Cloudthought\\data-migration-dbt\\stgo_dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:09:58.700146 [debug] [MainThread]: Tracking: tracking
[0m19:09:58.759145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276797BB880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276797BB0A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276797BB1F0>]}
[0m19:09:58.945951 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m19:09:58.947951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '07b9df49-e062-472b-8cae-bbe48846b9e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276798F12E0>]}
[0m19:09:59.104064 [debug] [MainThread]: Parsing macros\adapters.sql
[0m19:09:59.179065 [debug] [MainThread]: Parsing macros\catalog.sql
[0m19:09:59.184066 [debug] [MainThread]: Parsing macros\relations.sql
[0m19:09:59.188396 [debug] [MainThread]: Parsing macros\timestamps.sql
[0m19:09:59.195400 [debug] [MainThread]: Parsing macros\materializations\incremental_strategies.sql
[0m19:09:59.200404 [debug] [MainThread]: Parsing macros\materializations\snapshot_merge.sql
[0m19:09:59.205399 [debug] [MainThread]: Parsing macros\utils\any_value.sql
[0m19:09:59.207396 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m19:09:59.208394 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m19:09:59.221398 [debug] [MainThread]: Parsing macros\utils\last_day.sql
[0m19:09:59.224397 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m19:09:59.226395 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m19:09:59.228396 [debug] [MainThread]: Parsing macros\adapters\apply_grants.sql
[0m19:09:59.263397 [debug] [MainThread]: Parsing macros\adapters\columns.sql
[0m19:09:59.278396 [debug] [MainThread]: Parsing macros\adapters\freshness.sql
[0m19:09:59.283395 [debug] [MainThread]: Parsing macros\adapters\indexes.sql
[0m19:09:59.288397 [debug] [MainThread]: Parsing macros\adapters\metadata.sql
[0m19:09:59.300401 [debug] [MainThread]: Parsing macros\adapters\persist_docs.sql
[0m19:09:59.306399 [debug] [MainThread]: Parsing macros\adapters\relation.sql
[0m19:09:59.329290 [debug] [MainThread]: Parsing macros\adapters\schema.sql
[0m19:09:59.332300 [debug] [MainThread]: Parsing macros\adapters\timestamps.sql
[0m19:09:59.338289 [debug] [MainThread]: Parsing macros\etc\datetime.sql
[0m19:09:59.353293 [debug] [MainThread]: Parsing macros\etc\statement.sql
[0m19:09:59.361288 [debug] [MainThread]: Parsing macros\generic_test_sql\accepted_values.sql
[0m19:09:59.363288 [debug] [MainThread]: Parsing macros\generic_test_sql\not_null.sql
[0m19:09:59.365289 [debug] [MainThread]: Parsing macros\generic_test_sql\relationships.sql
[0m19:09:59.366289 [debug] [MainThread]: Parsing macros\generic_test_sql\unique.sql
[0m19:09:59.368288 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_alias.sql
[0m19:09:59.370288 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_database.sql
[0m19:09:59.372289 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_schema.sql
[0m19:09:59.376288 [debug] [MainThread]: Parsing macros\materializations\configs.sql
[0m19:09:59.380293 [debug] [MainThread]: Parsing macros\materializations\hooks.sql
[0m19:09:59.385289 [debug] [MainThread]: Parsing macros\materializations\models\incremental\column_helpers.sql
[0m19:09:59.398290 [debug] [MainThread]: Parsing macros\materializations\models\incremental\incremental.sql
[0m19:09:59.414288 [debug] [MainThread]: Parsing macros\materializations\models\incremental\is_incremental.sql
[0m19:09:59.416288 [debug] [MainThread]: Parsing macros\materializations\models\incremental\merge.sql
[0m19:09:59.436291 [debug] [MainThread]: Parsing macros\materializations\models\incremental\on_schema_change.sql
[0m19:09:59.468289 [debug] [MainThread]: Parsing macros\materializations\models\incremental\strategies.sql
[0m19:09:59.479290 [debug] [MainThread]: Parsing macros\materializations\models\table\create_table_as.sql
[0m19:09:59.484291 [debug] [MainThread]: Parsing macros\materializations\models\table\table.sql
[0m19:09:59.492287 [debug] [MainThread]: Parsing macros\materializations\models\view\create_or_replace_view.sql
[0m19:09:59.497301 [debug] [MainThread]: Parsing macros\materializations\models\view\create_view_as.sql
[0m19:09:59.501291 [debug] [MainThread]: Parsing macros\materializations\models\view\helpers.sql
[0m19:09:59.503289 [debug] [MainThread]: Parsing macros\materializations\models\view\view.sql
[0m19:09:59.509288 [debug] [MainThread]: Parsing macros\materializations\seeds\helpers.sql
[0m19:09:59.570287 [debug] [MainThread]: Parsing macros\materializations\seeds\seed.sql
[0m19:09:59.580901 [debug] [MainThread]: Parsing macros\materializations\snapshots\helpers.sql
[0m19:09:59.598904 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot.sql
[0m19:09:59.613900 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot_merge.sql
[0m19:09:59.615901 [debug] [MainThread]: Parsing macros\materializations\snapshots\strategies.sql
[0m19:09:59.639901 [debug] [MainThread]: Parsing macros\materializations\tests\helpers.sql
[0m19:09:59.642899 [debug] [MainThread]: Parsing macros\materializations\tests\test.sql
[0m19:09:59.648900 [debug] [MainThread]: Parsing macros\materializations\tests\where_subquery.sql
[0m19:09:59.651903 [debug] [MainThread]: Parsing macros\python_model\python.sql
[0m19:09:59.661902 [debug] [MainThread]: Parsing macros\utils\any_value.sql
[0m19:09:59.663898 [debug] [MainThread]: Parsing macros\utils\array_append.sql
[0m19:09:59.664900 [debug] [MainThread]: Parsing macros\utils\array_concat.sql
[0m19:09:59.666900 [debug] [MainThread]: Parsing macros\utils\array_construct.sql
[0m19:09:59.668901 [debug] [MainThread]: Parsing macros\utils\bool_or.sql
[0m19:09:59.670905 [debug] [MainThread]: Parsing macros\utils\cast_bool_to_text.sql
[0m19:09:59.673902 [debug] [MainThread]: Parsing macros\utils\concat.sql
[0m19:09:59.674901 [debug] [MainThread]: Parsing macros\utils\data_types.sql
[0m19:09:59.683901 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m19:09:59.686901 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m19:09:59.688901 [debug] [MainThread]: Parsing macros\utils\date_trunc.sql
[0m19:09:59.690900 [debug] [MainThread]: Parsing macros\utils\escape_single_quotes.sql
[0m19:09:59.691902 [debug] [MainThread]: Parsing macros\utils\except.sql
[0m19:09:59.693901 [debug] [MainThread]: Parsing macros\utils\hash.sql
[0m19:09:59.695901 [debug] [MainThread]: Parsing macros\utils\intersect.sql
[0m19:09:59.697900 [debug] [MainThread]: Parsing macros\utils\last_day.sql
[0m19:09:59.701901 [debug] [MainThread]: Parsing macros\utils\length.sql
[0m19:09:59.702900 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m19:09:59.705900 [debug] [MainThread]: Parsing macros\utils\literal.sql
[0m19:09:59.707900 [debug] [MainThread]: Parsing macros\utils\position.sql
[0m19:09:59.708900 [debug] [MainThread]: Parsing macros\utils\replace.sql
[0m19:09:59.711900 [debug] [MainThread]: Parsing macros\utils\right.sql
[0m19:09:59.714901 [debug] [MainThread]: Parsing macros\utils\safe_cast.sql
[0m19:09:59.716899 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m19:09:59.719900 [debug] [MainThread]: Parsing tests\generic\builtin.sql
[0m19:10:00.146662 [debug] [MainThread]: 1699: static parser successfully parsed my_first_dbt_model.sql
[0m19:10:00.168661 [debug] [MainThread]: 1699: static parser successfully parsed my_second_dbt_model.sql
[0m19:10:00.172661 [debug] [MainThread]: 1699: static parser successfully parsed placeholder_from_airbyte.sql
[0m19:10:00.177661 [debug] [MainThread]: 1603: static parser failed on split_full_name.sql
[0m19:10:00.182661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276799F8FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276799E7F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276799E7FD0>]}
[0m19:10:00.183664 [debug] [MainThread]: Flushing usage events
[0m19:10:01.325094 [error] [MainThread]: Encountered an error:
Compilation Error in model split_full_name (models\split_full_name.sql)
  expected token 'end of print statement', got 'string'
    line 16
      import "utils.sql"


============================== 2023-01-02 19:10:38.528685 | bf9ef8e4-4b41-4764-9ee9-641b33ccd0b2 ==============================
[0m19:10:38.528685 [info ] [MainThread]: Running with dbt=1.3.1
[0m19:10:38.529684 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'D:\\2023\\Cloudthought\\data-migration-dbt\\stgo_dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:10:38.529684 [debug] [MainThread]: Tracking: tracking
[0m19:10:38.568686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002618D0DBF40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002618758CE20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002618758CE50>]}
[0m19:10:38.621706 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m19:10:38.622695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bf9ef8e4-4b41-4764-9ee9-641b33ccd0b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002618D2122B0>]}
[0m19:10:38.724279 [debug] [MainThread]: Parsing macros\adapters.sql
[0m19:10:38.767281 [debug] [MainThread]: Parsing macros\catalog.sql
[0m19:10:38.771281 [debug] [MainThread]: Parsing macros\relations.sql
[0m19:10:38.772280 [debug] [MainThread]: Parsing macros\timestamps.sql
[0m19:10:38.776279 [debug] [MainThread]: Parsing macros\materializations\incremental_strategies.sql
[0m19:10:38.779279 [debug] [MainThread]: Parsing macros\materializations\snapshot_merge.sql
[0m19:10:38.781285 [debug] [MainThread]: Parsing macros\utils\any_value.sql
[0m19:10:38.782280 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m19:10:38.783280 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m19:10:38.793282 [debug] [MainThread]: Parsing macros\utils\last_day.sql
[0m19:10:38.795281 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m19:10:38.797282 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m19:10:38.799279 [debug] [MainThread]: Parsing macros\adapters\apply_grants.sql
[0m19:10:38.820279 [debug] [MainThread]: Parsing macros\adapters\columns.sql
[0m19:10:38.833281 [debug] [MainThread]: Parsing macros\adapters\freshness.sql
[0m19:10:38.836281 [debug] [MainThread]: Parsing macros\adapters\indexes.sql
[0m19:10:38.842279 [debug] [MainThread]: Parsing macros\adapters\metadata.sql
[0m19:10:38.853282 [debug] [MainThread]: Parsing macros\adapters\persist_docs.sql
[0m19:10:38.862279 [debug] [MainThread]: Parsing macros\adapters\relation.sql
[0m19:10:38.890283 [debug] [MainThread]: Parsing macros\adapters\schema.sql
[0m19:10:38.893286 [debug] [MainThread]: Parsing macros\adapters\timestamps.sql
[0m19:10:38.899292 [debug] [MainThread]: Parsing macros\etc\datetime.sql
[0m19:10:38.912290 [debug] [MainThread]: Parsing macros\etc\statement.sql
[0m19:10:38.920280 [debug] [MainThread]: Parsing macros\generic_test_sql\accepted_values.sql
[0m19:10:38.922279 [debug] [MainThread]: Parsing macros\generic_test_sql\not_null.sql
[0m19:10:38.923280 [debug] [MainThread]: Parsing macros\generic_test_sql\relationships.sql
[0m19:10:38.925282 [debug] [MainThread]: Parsing macros\generic_test_sql\unique.sql
[0m19:10:38.926279 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_alias.sql
[0m19:10:38.928281 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_database.sql
[0m19:10:38.931280 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_schema.sql
[0m19:10:38.934280 [debug] [MainThread]: Parsing macros\materializations\configs.sql
[0m19:10:38.938279 [debug] [MainThread]: Parsing macros\materializations\hooks.sql
[0m19:10:38.943279 [debug] [MainThread]: Parsing macros\materializations\models\incremental\column_helpers.sql
[0m19:10:38.957282 [debug] [MainThread]: Parsing macros\materializations\models\incremental\incremental.sql
[0m19:10:38.973934 [debug] [MainThread]: Parsing macros\materializations\models\incremental\is_incremental.sql
[0m19:10:38.975934 [debug] [MainThread]: Parsing macros\materializations\models\incremental\merge.sql
[0m19:10:38.999933 [debug] [MainThread]: Parsing macros\materializations\models\incremental\on_schema_change.sql
[0m19:10:39.020934 [debug] [MainThread]: Parsing macros\materializations\models\incremental\strategies.sql
[0m19:10:39.030933 [debug] [MainThread]: Parsing macros\materializations\models\table\create_table_as.sql
[0m19:10:39.036933 [debug] [MainThread]: Parsing macros\materializations\models\table\table.sql
[0m19:10:39.044933 [debug] [MainThread]: Parsing macros\materializations\models\view\create_or_replace_view.sql
[0m19:10:39.049933 [debug] [MainThread]: Parsing macros\materializations\models\view\create_view_as.sql
[0m19:10:39.052936 [debug] [MainThread]: Parsing macros\materializations\models\view\helpers.sql
[0m19:10:39.055726 [debug] [MainThread]: Parsing macros\materializations\models\view\view.sql
[0m19:10:39.065792 [debug] [MainThread]: Parsing macros\materializations\seeds\helpers.sql
[0m19:10:39.160793 [debug] [MainThread]: Parsing macros\materializations\seeds\seed.sql
[0m19:10:39.182792 [debug] [MainThread]: Parsing macros\materializations\snapshots\helpers.sql
[0m19:10:39.217792 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot.sql
[0m19:10:39.249451 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot_merge.sql
[0m19:10:39.252450 [debug] [MainThread]: Parsing macros\materializations\snapshots\strategies.sql
[0m19:10:39.289884 [debug] [MainThread]: Parsing macros\materializations\tests\helpers.sql
[0m19:10:39.292884 [debug] [MainThread]: Parsing macros\materializations\tests\test.sql
[0m19:10:39.299885 [debug] [MainThread]: Parsing macros\materializations\tests\where_subquery.sql
[0m19:10:39.301882 [debug] [MainThread]: Parsing macros\python_model\python.sql
[0m19:10:39.309882 [debug] [MainThread]: Parsing macros\utils\any_value.sql
[0m19:10:39.311883 [debug] [MainThread]: Parsing macros\utils\array_append.sql
[0m19:10:39.313884 [debug] [MainThread]: Parsing macros\utils\array_concat.sql
[0m19:10:39.315883 [debug] [MainThread]: Parsing macros\utils\array_construct.sql
[0m19:10:39.318882 [debug] [MainThread]: Parsing macros\utils\bool_or.sql
[0m19:10:39.319882 [debug] [MainThread]: Parsing macros\utils\cast_bool_to_text.sql
[0m19:10:39.321884 [debug] [MainThread]: Parsing macros\utils\concat.sql
[0m19:10:39.323882 [debug] [MainThread]: Parsing macros\utils\data_types.sql
[0m19:10:39.333882 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m19:10:39.336882 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m19:10:39.338884 [debug] [MainThread]: Parsing macros\utils\date_trunc.sql
[0m19:10:39.340881 [debug] [MainThread]: Parsing macros\utils\escape_single_quotes.sql
[0m19:10:39.342882 [debug] [MainThread]: Parsing macros\utils\except.sql
[0m19:10:39.343884 [debug] [MainThread]: Parsing macros\utils\hash.sql
[0m19:10:39.345883 [debug] [MainThread]: Parsing macros\utils\intersect.sql
[0m19:10:39.346882 [debug] [MainThread]: Parsing macros\utils\last_day.sql
[0m19:10:39.349884 [debug] [MainThread]: Parsing macros\utils\length.sql
[0m19:10:39.350883 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m19:10:39.356883 [debug] [MainThread]: Parsing macros\utils\literal.sql
[0m19:10:39.358882 [debug] [MainThread]: Parsing macros\utils\position.sql
[0m19:10:39.359883 [debug] [MainThread]: Parsing macros\utils\replace.sql
[0m19:10:39.361882 [debug] [MainThread]: Parsing macros\utils\right.sql
[0m19:10:39.363881 [debug] [MainThread]: Parsing macros\utils\safe_cast.sql
[0m19:10:39.365883 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m19:10:39.369882 [debug] [MainThread]: Parsing tests\generic\builtin.sql
[0m19:10:39.810883 [debug] [MainThread]: 1699: static parser successfully parsed my_first_dbt_model.sql
[0m19:10:39.830884 [debug] [MainThread]: 1699: static parser successfully parsed my_second_dbt_model.sql
[0m19:10:39.838881 [debug] [MainThread]: 1699: static parser successfully parsed placeholder_from_airbyte.sql
[0m19:10:39.847884 [debug] [MainThread]: 1603: static parser failed on split_full_name.sql
[0m19:10:39.854884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002618D319F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002618D306F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002618D306FA0>]}
[0m19:10:39.855885 [debug] [MainThread]: Flushing usage events
[0m19:10:40.905517 [error] [MainThread]: Encountered an error:
Compilation Error in model split_full_name (models\split_full_name.sql)
  expected token 'end of print statement', got 'string'
    line 16
      import "utils.sql";


============================== 2023-01-02 19:11:30.289853 | 46ca4df6-b75e-44f2-98fa-31c74d39cad5 ==============================
[0m19:11:30.289853 [info ] [MainThread]: Running with dbt=1.3.1
[0m19:11:30.291840 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'D:\\2023\\Cloudthought\\data-migration-dbt\\stgo_dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:11:30.291840 [debug] [MainThread]: Tracking: tracking
[0m19:11:30.337835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001825574B8B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001825574B0A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001825574B850>]}
[0m19:11:30.388833 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m19:11:30.389838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '46ca4df6-b75e-44f2-98fa-31c74d39cad5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018255882310>]}
[0m19:11:30.512836 [debug] [MainThread]: Parsing macros\adapters.sql
[0m19:11:30.547835 [debug] [MainThread]: Parsing macros\catalog.sql
[0m19:11:30.551833 [debug] [MainThread]: Parsing macros\relations.sql
[0m19:11:30.552836 [debug] [MainThread]: Parsing macros\timestamps.sql
[0m19:11:30.556835 [debug] [MainThread]: Parsing macros\materializations\incremental_strategies.sql
[0m19:11:30.557836 [debug] [MainThread]: Parsing macros\materializations\snapshot_merge.sql
[0m19:11:30.560837 [debug] [MainThread]: Parsing macros\utils\any_value.sql
[0m19:11:30.561835 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m19:11:30.562835 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m19:11:30.571835 [debug] [MainThread]: Parsing macros\utils\last_day.sql
[0m19:11:30.574834 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m19:11:30.576837 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m19:11:30.578835 [debug] [MainThread]: Parsing macros\adapters\apply_grants.sql
[0m19:11:30.599834 [debug] [MainThread]: Parsing macros\adapters\columns.sql
[0m19:11:30.614833 [debug] [MainThread]: Parsing macros\adapters\freshness.sql
[0m19:11:30.617449 [debug] [MainThread]: Parsing macros\adapters\indexes.sql
[0m19:11:30.621448 [debug] [MainThread]: Parsing macros\adapters\metadata.sql
[0m19:11:30.631449 [debug] [MainThread]: Parsing macros\adapters\persist_docs.sql
[0m19:11:30.637449 [debug] [MainThread]: Parsing macros\adapters\relation.sql
[0m19:11:30.660449 [debug] [MainThread]: Parsing macros\adapters\schema.sql
[0m19:11:30.668449 [debug] [MainThread]: Parsing macros\adapters\timestamps.sql
[0m19:11:30.674447 [debug] [MainThread]: Parsing macros\etc\datetime.sql
[0m19:11:30.690447 [debug] [MainThread]: Parsing macros\etc\statement.sql
[0m19:11:30.698448 [debug] [MainThread]: Parsing macros\generic_test_sql\accepted_values.sql
[0m19:11:30.700449 [debug] [MainThread]: Parsing macros\generic_test_sql\not_null.sql
[0m19:11:30.702449 [debug] [MainThread]: Parsing macros\generic_test_sql\relationships.sql
[0m19:11:30.703448 [debug] [MainThread]: Parsing macros\generic_test_sql\unique.sql
[0m19:11:30.705449 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_alias.sql
[0m19:11:30.708449 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_database.sql
[0m19:11:30.710451 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_schema.sql
[0m19:11:30.714449 [debug] [MainThread]: Parsing macros\materializations\configs.sql
[0m19:11:30.718448 [debug] [MainThread]: Parsing macros\materializations\hooks.sql
[0m19:11:30.724450 [debug] [MainThread]: Parsing macros\materializations\models\incremental\column_helpers.sql
[0m19:11:30.735448 [debug] [MainThread]: Parsing macros\materializations\models\incremental\incremental.sql
[0m19:11:30.750447 [debug] [MainThread]: Parsing macros\materializations\models\incremental\is_incremental.sql
[0m19:11:30.752448 [debug] [MainThread]: Parsing macros\materializations\models\incremental\merge.sql
[0m19:11:30.778449 [debug] [MainThread]: Parsing macros\materializations\models\incremental\on_schema_change.sql
[0m19:11:30.800450 [debug] [MainThread]: Parsing macros\materializations\models\incremental\strategies.sql
[0m19:11:30.810451 [debug] [MainThread]: Parsing macros\materializations\models\table\create_table_as.sql
[0m19:11:30.815450 [debug] [MainThread]: Parsing macros\materializations\models\table\table.sql
[0m19:11:30.825456 [debug] [MainThread]: Parsing macros\materializations\models\view\create_or_replace_view.sql
[0m19:11:30.829449 [debug] [MainThread]: Parsing macros\materializations\models\view\create_view_as.sql
[0m19:11:30.832451 [debug] [MainThread]: Parsing macros\materializations\models\view\helpers.sql
[0m19:11:30.834448 [debug] [MainThread]: Parsing macros\materializations\models\view\view.sql
[0m19:11:30.842450 [debug] [MainThread]: Parsing macros\materializations\seeds\helpers.sql
[0m19:11:30.903161 [debug] [MainThread]: Parsing macros\materializations\seeds\seed.sql
[0m19:11:30.915160 [debug] [MainThread]: Parsing macros\materializations\snapshots\helpers.sql
[0m19:11:30.933159 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot.sql
[0m19:11:30.948161 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot_merge.sql
[0m19:11:30.950159 [debug] [MainThread]: Parsing macros\materializations\snapshots\strategies.sql
[0m19:11:30.972164 [debug] [MainThread]: Parsing macros\materializations\tests\helpers.sql
[0m19:11:30.975161 [debug] [MainThread]: Parsing macros\materializations\tests\test.sql
[0m19:11:30.981162 [debug] [MainThread]: Parsing macros\materializations\tests\where_subquery.sql
[0m19:11:30.983161 [debug] [MainThread]: Parsing macros\python_model\python.sql
[0m19:11:30.993160 [debug] [MainThread]: Parsing macros\utils\any_value.sql
[0m19:11:30.995162 [debug] [MainThread]: Parsing macros\utils\array_append.sql
[0m19:11:30.996160 [debug] [MainThread]: Parsing macros\utils\array_concat.sql
[0m19:11:30.999162 [debug] [MainThread]: Parsing macros\utils\array_construct.sql
[0m19:11:31.002163 [debug] [MainThread]: Parsing macros\utils\bool_or.sql
[0m19:11:31.004159 [debug] [MainThread]: Parsing macros\utils\cast_bool_to_text.sql
[0m19:11:31.005161 [debug] [MainThread]: Parsing macros\utils\concat.sql
[0m19:11:31.007160 [debug] [MainThread]: Parsing macros\utils\data_types.sql
[0m19:11:31.020160 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m19:11:31.022161 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m19:11:31.025162 [debug] [MainThread]: Parsing macros\utils\date_trunc.sql
[0m19:11:31.026161 [debug] [MainThread]: Parsing macros\utils\escape_single_quotes.sql
[0m19:11:31.029160 [debug] [MainThread]: Parsing macros\utils\except.sql
[0m19:11:31.030160 [debug] [MainThread]: Parsing macros\utils\hash.sql
[0m19:11:31.032162 [debug] [MainThread]: Parsing macros\utils\intersect.sql
[0m19:11:31.033160 [debug] [MainThread]: Parsing macros\utils\last_day.sql
[0m19:11:31.036160 [debug] [MainThread]: Parsing macros\utils\length.sql
[0m19:11:31.038171 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m19:11:31.043161 [debug] [MainThread]: Parsing macros\utils\literal.sql
[0m19:11:31.044167 [debug] [MainThread]: Parsing macros\utils\position.sql
[0m19:11:31.046162 [debug] [MainThread]: Parsing macros\utils\replace.sql
[0m19:11:31.048161 [debug] [MainThread]: Parsing macros\utils\right.sql
[0m19:11:31.049161 [debug] [MainThread]: Parsing macros\utils\safe_cast.sql
[0m19:11:31.051161 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m19:11:31.056160 [debug] [MainThread]: Parsing tests\generic\builtin.sql
[0m19:11:31.458727 [debug] [MainThread]: 1699: static parser successfully parsed my_first_dbt_model.sql
[0m19:11:31.480729 [debug] [MainThread]: 1699: static parser successfully parsed my_second_dbt_model.sql
[0m19:11:31.485726 [debug] [MainThread]: 1699: static parser successfully parsed placeholder_from_airbyte.sql
[0m19:11:31.489728 [debug] [MainThread]: 1603: static parser failed on split_full_name.sql
[0m19:11:31.495731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018255989FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018255976F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018255976FD0>]}
[0m19:11:31.496728 [debug] [MainThread]: Flushing usage events
[0m19:11:32.697438 [error] [MainThread]: Encountered an error:
Compilation Error in model split_full_name (models\split_full_name.sql)
  expected token 'end of print statement', got 'string'
    line 16
      import "utils.sql"


============================== 2023-01-02 19:12:46.223622 | 6d99227b-7df5-4788-a563-a5ec2444a4de ==============================
[0m19:12:46.223622 [info ] [MainThread]: Running with dbt=1.3.1
[0m19:12:46.226627 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'D:\\2023\\Cloudthought\\data-migration-dbt\\stgo_dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:12:46.226627 [debug] [MainThread]: Tracking: tracking
[0m19:12:46.281625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE0566B190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE0564ABB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE0566BBB0>]}
[0m19:12:46.338474 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m19:12:46.339473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6d99227b-7df5-4788-a563-a5ec2444a4de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE0566A340>]}
[0m19:12:46.445473 [debug] [MainThread]: Parsing macros\adapters.sql
[0m19:12:46.486474 [debug] [MainThread]: Parsing macros\catalog.sql
[0m19:12:46.489478 [debug] [MainThread]: Parsing macros\relations.sql
[0m19:12:46.491473 [debug] [MainThread]: Parsing macros\timestamps.sql
[0m19:12:46.494476 [debug] [MainThread]: Parsing macros\materializations\incremental_strategies.sql
[0m19:12:46.496476 [debug] [MainThread]: Parsing macros\materializations\snapshot_merge.sql
[0m19:12:46.499473 [debug] [MainThread]: Parsing macros\utils\any_value.sql
[0m19:12:46.500475 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m19:12:46.501476 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m19:12:46.513483 [debug] [MainThread]: Parsing macros\utils\last_day.sql
[0m19:12:46.514476 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m19:12:46.516475 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m19:12:46.518473 [debug] [MainThread]: Parsing macros\adapters\apply_grants.sql
[0m19:12:46.540474 [debug] [MainThread]: Parsing macros\adapters\columns.sql
[0m19:12:46.555473 [debug] [MainThread]: Parsing macros\adapters\freshness.sql
[0m19:12:46.558154 [debug] [MainThread]: Parsing macros\adapters\indexes.sql
[0m19:12:46.563151 [debug] [MainThread]: Parsing macros\adapters\metadata.sql
[0m19:12:46.573153 [debug] [MainThread]: Parsing macros\adapters\persist_docs.sql
[0m19:12:46.580154 [debug] [MainThread]: Parsing macros\adapters\relation.sql
[0m19:12:46.603151 [debug] [MainThread]: Parsing macros\adapters\schema.sql
[0m19:12:46.607150 [debug] [MainThread]: Parsing macros\adapters\timestamps.sql
[0m19:12:46.612150 [debug] [MainThread]: Parsing macros\etc\datetime.sql
[0m19:12:46.625151 [debug] [MainThread]: Parsing macros\etc\statement.sql
[0m19:12:46.634152 [debug] [MainThread]: Parsing macros\generic_test_sql\accepted_values.sql
[0m19:12:46.637152 [debug] [MainThread]: Parsing macros\generic_test_sql\not_null.sql
[0m19:12:46.638151 [debug] [MainThread]: Parsing macros\generic_test_sql\relationships.sql
[0m19:12:46.641153 [debug] [MainThread]: Parsing macros\generic_test_sql\unique.sql
[0m19:12:46.642152 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_alias.sql
[0m19:12:46.645152 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_database.sql
[0m19:12:46.647150 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_schema.sql
[0m19:12:46.651153 [debug] [MainThread]: Parsing macros\materializations\configs.sql
[0m19:12:46.656153 [debug] [MainThread]: Parsing macros\materializations\hooks.sql
[0m19:12:46.662151 [debug] [MainThread]: Parsing macros\materializations\models\incremental\column_helpers.sql
[0m19:12:46.673152 [debug] [MainThread]: Parsing macros\materializations\models\incremental\incremental.sql
[0m19:12:46.688153 [debug] [MainThread]: Parsing macros\materializations\models\incremental\is_incremental.sql
[0m19:12:46.691154 [debug] [MainThread]: Parsing macros\materializations\models\incremental\merge.sql
[0m19:12:46.713151 [debug] [MainThread]: Parsing macros\materializations\models\incremental\on_schema_change.sql
[0m19:12:46.739150 [debug] [MainThread]: Parsing macros\materializations\models\incremental\strategies.sql
[0m19:12:46.750150 [debug] [MainThread]: Parsing macros\materializations\models\table\create_table_as.sql
[0m19:12:46.755152 [debug] [MainThread]: Parsing macros\materializations\models\table\table.sql
[0m19:12:46.765151 [debug] [MainThread]: Parsing macros\materializations\models\view\create_or_replace_view.sql
[0m19:12:46.770155 [debug] [MainThread]: Parsing macros\materializations\models\view\create_view_as.sql
[0m19:12:46.775155 [debug] [MainThread]: Parsing macros\materializations\models\view\helpers.sql
[0m19:12:46.778154 [debug] [MainThread]: Parsing macros\materializations\models\view\view.sql
[0m19:12:46.787153 [debug] [MainThread]: Parsing macros\materializations\seeds\helpers.sql
[0m19:12:46.846802 [debug] [MainThread]: Parsing macros\materializations\seeds\seed.sql
[0m19:12:46.858802 [debug] [MainThread]: Parsing macros\materializations\snapshots\helpers.sql
[0m19:12:46.877801 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot.sql
[0m19:12:46.892801 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot_merge.sql
[0m19:12:46.895801 [debug] [MainThread]: Parsing macros\materializations\snapshots\strategies.sql
[0m19:12:46.921799 [debug] [MainThread]: Parsing macros\materializations\tests\helpers.sql
[0m19:12:46.924801 [debug] [MainThread]: Parsing macros\materializations\tests\test.sql
[0m19:12:46.929799 [debug] [MainThread]: Parsing macros\materializations\tests\where_subquery.sql
[0m19:12:46.933802 [debug] [MainThread]: Parsing macros\python_model\python.sql
[0m19:12:46.942803 [debug] [MainThread]: Parsing macros\utils\any_value.sql
[0m19:12:46.944800 [debug] [MainThread]: Parsing macros\utils\array_append.sql
[0m19:12:46.946802 [debug] [MainThread]: Parsing macros\utils\array_concat.sql
[0m19:12:46.948800 [debug] [MainThread]: Parsing macros\utils\array_construct.sql
[0m19:12:46.951801 [debug] [MainThread]: Parsing macros\utils\bool_or.sql
[0m19:12:46.952804 [debug] [MainThread]: Parsing macros\utils\cast_bool_to_text.sql
[0m19:12:46.954800 [debug] [MainThread]: Parsing macros\utils\concat.sql
[0m19:12:46.955800 [debug] [MainThread]: Parsing macros\utils\data_types.sql
[0m19:12:46.968801 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m19:12:46.970799 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m19:12:46.972803 [debug] [MainThread]: Parsing macros\utils\date_trunc.sql
[0m19:12:46.974800 [debug] [MainThread]: Parsing macros\utils\escape_single_quotes.sql
[0m19:12:46.976801 [debug] [MainThread]: Parsing macros\utils\except.sql
[0m19:12:46.978799 [debug] [MainThread]: Parsing macros\utils\hash.sql
[0m19:12:46.980799 [debug] [MainThread]: Parsing macros\utils\intersect.sql
[0m19:12:46.981799 [debug] [MainThread]: Parsing macros\utils\last_day.sql
[0m19:12:46.985801 [debug] [MainThread]: Parsing macros\utils\length.sql
[0m19:12:46.986803 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m19:12:46.990799 [debug] [MainThread]: Parsing macros\utils\literal.sql
[0m19:12:46.991799 [debug] [MainThread]: Parsing macros\utils\position.sql
[0m19:12:46.993806 [debug] [MainThread]: Parsing macros\utils\replace.sql
[0m19:12:46.995800 [debug] [MainThread]: Parsing macros\utils\right.sql
[0m19:12:46.997801 [debug] [MainThread]: Parsing macros\utils\safe_cast.sql
[0m19:12:46.999802 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m19:12:47.002799 [debug] [MainThread]: Parsing tests\generic\builtin.sql
[0m19:12:47.413276 [debug] [MainThread]: 1699: static parser successfully parsed my_first_dbt_model.sql
[0m19:12:47.432276 [debug] [MainThread]: 1699: static parser successfully parsed my_second_dbt_model.sql
[0m19:12:47.436278 [debug] [MainThread]: 1699: static parser successfully parsed placeholder_from_airbyte.sql
[0m19:12:47.441276 [debug] [MainThread]: 1603: static parser failed on split_full_name.sql
[0m19:12:47.445275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE058A9F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE0589CEB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE0589CF40>]}
[0m19:12:47.446277 [debug] [MainThread]: Flushing usage events
[0m19:12:48.781063 [error] [MainThread]: Encountered an error:
Compilation Error in model split_full_name (models\split_full_name.sql)
  expected token 'end of print statement', got 'string'
    line 16
      import "utils.sql"


============================== 2023-01-02 19:14:37.420960 | ef4cfbb0-9fd0-44de-9704-56fb9abe3f09 ==============================
[0m19:14:37.420960 [info ] [MainThread]: Running with dbt=1.3.1
[0m19:14:37.422938 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'D:\\2023\\Cloudthought\\data-migration-dbt\\stgo_dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:14:37.422938 [debug] [MainThread]: Tracking: tracking
[0m19:14:37.476935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DF39F11C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DF39F1AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DF39F1130>]}
[0m19:14:37.526935 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m19:14:37.527935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ef4cfbb0-9fd0-44de-9704-56fb9abe3f09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DF3A10190>]}
[0m19:14:37.709207 [debug] [MainThread]: Parsing macros\adapters.sql
[0m19:14:37.780205 [debug] [MainThread]: Parsing macros\catalog.sql
[0m19:14:37.784205 [debug] [MainThread]: Parsing macros\relations.sql
[0m19:14:37.788204 [debug] [MainThread]: Parsing macros\timestamps.sql
[0m19:14:37.793204 [debug] [MainThread]: Parsing macros\materializations\incremental_strategies.sql
[0m19:14:37.795206 [debug] [MainThread]: Parsing macros\materializations\snapshot_merge.sql
[0m19:14:37.798206 [debug] [MainThread]: Parsing macros\utils\any_value.sql
[0m19:14:37.800205 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m19:14:37.803204 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m19:14:37.816206 [debug] [MainThread]: Parsing macros\utils\last_day.sql
[0m19:14:37.819203 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m19:14:37.822206 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m19:14:37.825205 [debug] [MainThread]: Parsing macros\adapters\apply_grants.sql
[0m19:14:37.862209 [debug] [MainThread]: Parsing macros\adapters\columns.sql
[0m19:14:37.886771 [debug] [MainThread]: Parsing macros\adapters\freshness.sql
[0m19:14:37.889772 [debug] [MainThread]: Parsing macros\adapters\indexes.sql
[0m19:14:37.897409 [debug] [MainThread]: Parsing macros\adapters\metadata.sql
[0m19:14:37.911404 [debug] [MainThread]: Parsing macros\adapters\persist_docs.sql
[0m19:14:37.919405 [debug] [MainThread]: Parsing macros\adapters\relation.sql
[0m19:14:37.955404 [debug] [MainThread]: Parsing macros\adapters\schema.sql
[0m19:14:37.959408 [debug] [MainThread]: Parsing macros\adapters\timestamps.sql
[0m19:14:37.969408 [debug] [MainThread]: Parsing macros\etc\datetime.sql
[0m19:14:37.997405 [debug] [MainThread]: Parsing macros\etc\statement.sql
[0m19:14:38.011405 [debug] [MainThread]: Parsing macros\generic_test_sql\accepted_values.sql
[0m19:14:38.015410 [debug] [MainThread]: Parsing macros\generic_test_sql\not_null.sql
[0m19:14:38.017406 [debug] [MainThread]: Parsing macros\generic_test_sql\relationships.sql
[0m19:14:38.020404 [debug] [MainThread]: Parsing macros\generic_test_sql\unique.sql
[0m19:14:38.021406 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_alias.sql
[0m19:14:38.024403 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_database.sql
[0m19:14:38.028634 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_schema.sql
[0m19:14:38.034151 [debug] [MainThread]: Parsing macros\materializations\configs.sql
[0m19:14:38.040153 [debug] [MainThread]: Parsing macros\materializations\hooks.sql
[0m19:14:38.047152 [debug] [MainThread]: Parsing macros\materializations\models\incremental\column_helpers.sql
[0m19:14:38.059151 [debug] [MainThread]: Parsing macros\materializations\models\incremental\incremental.sql
[0m19:14:38.074152 [debug] [MainThread]: Parsing macros\materializations\models\incremental\is_incremental.sql
[0m19:14:38.076151 [debug] [MainThread]: Parsing macros\materializations\models\incremental\merge.sql
[0m19:14:38.097153 [debug] [MainThread]: Parsing macros\materializations\models\incremental\on_schema_change.sql
[0m19:14:38.121152 [debug] [MainThread]: Parsing macros\materializations\models\incremental\strategies.sql
[0m19:14:38.131153 [debug] [MainThread]: Parsing macros\materializations\models\table\create_table_as.sql
[0m19:14:38.137153 [debug] [MainThread]: Parsing macros\materializations\models\table\table.sql
[0m19:14:38.145152 [debug] [MainThread]: Parsing macros\materializations\models\view\create_or_replace_view.sql
[0m19:14:38.150750 [debug] [MainThread]: Parsing macros\materializations\models\view\create_view_as.sql
[0m19:14:38.153751 [debug] [MainThread]: Parsing macros\materializations\models\view\helpers.sql
[0m19:14:38.155750 [debug] [MainThread]: Parsing macros\materializations\models\view\view.sql
[0m19:14:38.164753 [debug] [MainThread]: Parsing macros\materializations\seeds\helpers.sql
[0m19:14:38.224749 [debug] [MainThread]: Parsing macros\materializations\seeds\seed.sql
[0m19:14:38.234752 [debug] [MainThread]: Parsing macros\materializations\snapshots\helpers.sql
[0m19:14:38.255751 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot.sql
[0m19:14:38.278752 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot_merge.sql
[0m19:14:38.285752 [debug] [MainThread]: Parsing macros\materializations\snapshots\strategies.sql
[0m19:14:38.316751 [debug] [MainThread]: Parsing macros\materializations\tests\helpers.sql
[0m19:14:38.319755 [debug] [MainThread]: Parsing macros\materializations\tests\test.sql
[0m19:14:38.328754 [debug] [MainThread]: Parsing macros\materializations\tests\where_subquery.sql
[0m19:14:38.331754 [debug] [MainThread]: Parsing macros\python_model\python.sql
[0m19:14:38.345751 [debug] [MainThread]: Parsing macros\utils\any_value.sql
[0m19:14:38.347752 [debug] [MainThread]: Parsing macros\utils\array_append.sql
[0m19:14:38.350750 [debug] [MainThread]: Parsing macros\utils\array_concat.sql
[0m19:14:38.353751 [debug] [MainThread]: Parsing macros\utils\array_construct.sql
[0m19:14:38.355750 [debug] [MainThread]: Parsing macros\utils\bool_or.sql
[0m19:14:38.357752 [debug] [MainThread]: Parsing macros\utils\cast_bool_to_text.sql
[0m19:14:38.359748 [debug] [MainThread]: Parsing macros\utils\concat.sql
[0m19:14:38.361753 [debug] [MainThread]: Parsing macros\utils\data_types.sql
[0m19:14:38.378752 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m19:14:38.381751 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m19:14:38.383750 [debug] [MainThread]: Parsing macros\utils\date_trunc.sql
[0m19:14:38.385751 [debug] [MainThread]: Parsing macros\utils\escape_single_quotes.sql
[0m19:14:38.387753 [debug] [MainThread]: Parsing macros\utils\except.sql
[0m19:14:38.390753 [debug] [MainThread]: Parsing macros\utils\hash.sql
[0m19:14:38.394753 [debug] [MainThread]: Parsing macros\utils\intersect.sql
[0m19:14:38.396758 [debug] [MainThread]: Parsing macros\utils\last_day.sql
[0m19:14:38.401503 [debug] [MainThread]: Parsing macros\utils\length.sql
[0m19:14:38.403505 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m19:14:38.407500 [debug] [MainThread]: Parsing macros\utils\literal.sql
[0m19:14:38.408501 [debug] [MainThread]: Parsing macros\utils\position.sql
[0m19:14:38.410502 [debug] [MainThread]: Parsing macros\utils\replace.sql
[0m19:14:38.412502 [debug] [MainThread]: Parsing macros\utils\right.sql
[0m19:14:38.416503 [debug] [MainThread]: Parsing macros\utils\safe_cast.sql
[0m19:14:38.419502 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m19:14:38.422504 [debug] [MainThread]: Parsing tests\generic\builtin.sql
[0m19:14:38.849625 [debug] [MainThread]: 1699: static parser successfully parsed my_first_dbt_model.sql
[0m19:14:38.871627 [debug] [MainThread]: 1699: static parser successfully parsed my_second_dbt_model.sql
[0m19:14:38.875624 [debug] [MainThread]: 1699: static parser successfully parsed placeholder_from_airbyte.sql
[0m19:14:38.879625 [debug] [MainThread]: 1603: static parser failed on split_full_name.sql
[0m19:14:38.888626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DF3B19FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DF3B06F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DF3B06FD0>]}
[0m19:14:38.889628 [debug] [MainThread]: Flushing usage events
[0m19:14:40.043590 [error] [MainThread]: Encountered an error:
Compilation Error in model split_full_name (models\split_full_name.sql)
  expected token 'end of print statement', got 'string'
    line 6
      import "utils.sql"


============================== 2023-01-02 19:14:59.363731 | 1f94ccf6-33f2-4fab-bfb4-8c85c14968b3 ==============================
[0m19:14:59.363731 [info ] [MainThread]: Running with dbt=1.3.1
[0m19:14:59.365734 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'D:\\2023\\Cloudthought\\data-migration-dbt\\stgo_dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:14:59.365734 [debug] [MainThread]: Tracking: tracking
[0m19:14:59.407731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FD9D411C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FD9D41100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FD9D41130>]}
[0m19:14:59.462736 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m19:14:59.463736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1f94ccf6-33f2-4fab-bfb4-8c85c14968b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FD9D29850>]}
[0m19:14:59.568734 [debug] [MainThread]: Parsing macros\adapters.sql
[0m19:14:59.608024 [debug] [MainThread]: Parsing macros\catalog.sql
[0m19:14:59.612023 [debug] [MainThread]: Parsing macros\relations.sql
[0m19:14:59.614023 [debug] [MainThread]: Parsing macros\timestamps.sql
[0m19:14:59.616022 [debug] [MainThread]: Parsing macros\materializations\incremental_strategies.sql
[0m19:14:59.618023 [debug] [MainThread]: Parsing macros\materializations\snapshot_merge.sql
[0m19:14:59.620024 [debug] [MainThread]: Parsing macros\utils\any_value.sql
[0m19:14:59.621026 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m19:14:59.622023 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m19:14:59.630021 [debug] [MainThread]: Parsing macros\utils\last_day.sql
[0m19:14:59.632021 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m19:14:59.634021 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m19:14:59.636025 [debug] [MainThread]: Parsing macros\adapters\apply_grants.sql
[0m19:14:59.656022 [debug] [MainThread]: Parsing macros\adapters\columns.sql
[0m19:14:59.669022 [debug] [MainThread]: Parsing macros\adapters\freshness.sql
[0m19:14:59.672023 [debug] [MainThread]: Parsing macros\adapters\indexes.sql
[0m19:14:59.677022 [debug] [MainThread]: Parsing macros\adapters\metadata.sql
[0m19:14:59.688034 [debug] [MainThread]: Parsing macros\adapters\persist_docs.sql
[0m19:14:59.699024 [debug] [MainThread]: Parsing macros\adapters\relation.sql
[0m19:14:59.724024 [debug] [MainThread]: Parsing macros\adapters\schema.sql
[0m19:14:59.726022 [debug] [MainThread]: Parsing macros\adapters\timestamps.sql
[0m19:14:59.732022 [debug] [MainThread]: Parsing macros\etc\datetime.sql
[0m19:14:59.745022 [debug] [MainThread]: Parsing macros\etc\statement.sql
[0m19:14:59.752025 [debug] [MainThread]: Parsing macros\generic_test_sql\accepted_values.sql
[0m19:14:59.754025 [debug] [MainThread]: Parsing macros\generic_test_sql\not_null.sql
[0m19:14:59.755024 [debug] [MainThread]: Parsing macros\generic_test_sql\relationships.sql
[0m19:14:59.757024 [debug] [MainThread]: Parsing macros\generic_test_sql\unique.sql
[0m19:14:59.758022 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_alias.sql
[0m19:14:59.760022 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_database.sql
[0m19:14:59.763024 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_schema.sql
[0m19:14:59.767024 [debug] [MainThread]: Parsing macros\materializations\configs.sql
[0m19:14:59.771024 [debug] [MainThread]: Parsing macros\materializations\hooks.sql
[0m19:14:59.777024 [debug] [MainThread]: Parsing macros\materializations\models\incremental\column_helpers.sql
[0m19:14:59.790022 [debug] [MainThread]: Parsing macros\materializations\models\incremental\incremental.sql
[0m19:14:59.804025 [debug] [MainThread]: Parsing macros\materializations\models\incremental\is_incremental.sql
[0m19:14:59.806027 [debug] [MainThread]: Parsing macros\materializations\models\incremental\merge.sql
[0m19:14:59.826023 [debug] [MainThread]: Parsing macros\materializations\models\incremental\on_schema_change.sql
[0m19:14:59.847604 [debug] [MainThread]: Parsing macros\materializations\models\incremental\strategies.sql
[0m19:14:59.856602 [debug] [MainThread]: Parsing macros\materializations\models\table\create_table_as.sql
[0m19:14:59.863608 [debug] [MainThread]: Parsing macros\materializations\models\table\table.sql
[0m19:14:59.870601 [debug] [MainThread]: Parsing macros\materializations\models\view\create_or_replace_view.sql
[0m19:14:59.876601 [debug] [MainThread]: Parsing macros\materializations\models\view\create_view_as.sql
[0m19:14:59.879601 [debug] [MainThread]: Parsing macros\materializations\models\view\helpers.sql
[0m19:14:59.881601 [debug] [MainThread]: Parsing macros\materializations\models\view\view.sql
[0m19:14:59.893601 [debug] [MainThread]: Parsing macros\materializations\seeds\helpers.sql
[0m19:14:59.953604 [debug] [MainThread]: Parsing macros\materializations\seeds\seed.sql
[0m19:14:59.963603 [debug] [MainThread]: Parsing macros\materializations\snapshots\helpers.sql
[0m19:14:59.984600 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot.sql
[0m19:15:00.001602 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot_merge.sql
[0m19:15:00.003602 [debug] [MainThread]: Parsing macros\materializations\snapshots\strategies.sql
[0m19:15:00.030604 [debug] [MainThread]: Parsing macros\materializations\tests\helpers.sql
[0m19:15:00.035604 [debug] [MainThread]: Parsing macros\materializations\tests\test.sql
[0m19:15:00.042604 [debug] [MainThread]: Parsing macros\materializations\tests\where_subquery.sql
[0m19:15:00.045607 [debug] [MainThread]: Parsing macros\python_model\python.sql
[0m19:15:00.055612 [debug] [MainThread]: Parsing macros\utils\any_value.sql
[0m19:15:00.056607 [debug] [MainThread]: Parsing macros\utils\array_append.sql
[0m19:15:00.058608 [debug] [MainThread]: Parsing macros\utils\array_concat.sql
[0m19:15:00.060604 [debug] [MainThread]: Parsing macros\utils\array_construct.sql
[0m19:15:00.064618 [debug] [MainThread]: Parsing macros\utils\bool_or.sql
[0m19:15:00.065612 [debug] [MainThread]: Parsing macros\utils\cast_bool_to_text.sql
[0m19:15:00.067607 [debug] [MainThread]: Parsing macros\utils\concat.sql
[0m19:15:00.069609 [debug] [MainThread]: Parsing macros\utils\data_types.sql
[0m19:15:00.080216 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m19:15:00.082217 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m19:15:00.083217 [debug] [MainThread]: Parsing macros\utils\date_trunc.sql
[0m19:15:00.085217 [debug] [MainThread]: Parsing macros\utils\escape_single_quotes.sql
[0m19:15:00.087219 [debug] [MainThread]: Parsing macros\utils\except.sql
[0m19:15:00.089221 [debug] [MainThread]: Parsing macros\utils\hash.sql
[0m19:15:00.091218 [debug] [MainThread]: Parsing macros\utils\intersect.sql
[0m19:15:00.092218 [debug] [MainThread]: Parsing macros\utils\last_day.sql
[0m19:15:00.095218 [debug] [MainThread]: Parsing macros\utils\length.sql
[0m19:15:00.097217 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m19:15:00.101219 [debug] [MainThread]: Parsing macros\utils\literal.sql
[0m19:15:00.103217 [debug] [MainThread]: Parsing macros\utils\position.sql
[0m19:15:00.104217 [debug] [MainThread]: Parsing macros\utils\replace.sql
[0m19:15:00.107218 [debug] [MainThread]: Parsing macros\utils\right.sql
[0m19:15:00.108217 [debug] [MainThread]: Parsing macros\utils\safe_cast.sql
[0m19:15:00.110217 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m19:15:00.114218 [debug] [MainThread]: Parsing tests\generic\builtin.sql
[0m19:15:00.599664 [debug] [MainThread]: 1699: static parser successfully parsed my_first_dbt_model.sql
[0m19:15:00.618663 [debug] [MainThread]: 1699: static parser successfully parsed my_second_dbt_model.sql
[0m19:15:00.622665 [debug] [MainThread]: 1699: static parser successfully parsed placeholder_from_airbyte.sql
[0m19:15:00.626664 [debug] [MainThread]: 1603: static parser failed on split_full_name.sql
[0m19:15:00.630665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FD9E68FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FD9E280A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020FD9E28130>]}
[0m19:15:00.630665 [debug] [MainThread]: Flushing usage events
[0m19:15:01.698641 [error] [MainThread]: Encountered an error:
Compilation Error in model split_full_name (models\split_full_name.sql)
  expected token 'end of print statement', got 'string'
    line 6
      import "utils.sql"


============================== 2023-01-02 19:16:27.247569 | 3bcaf06d-6763-4f9e-a998-1917e9471d3c ==============================
[0m19:16:27.247569 [info ] [MainThread]: Running with dbt=1.3.1
[0m19:16:27.248569 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'D:\\2023\\Cloudthought\\data-migration-dbt\\stgo_dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:16:27.248569 [debug] [MainThread]: Tracking: tracking
[0m19:16:27.295569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC992511C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC99251A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC99251130>]}
[0m19:16:27.343569 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m19:16:27.344569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3bcaf06d-6763-4f9e-a998-1917e9471d3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC99270160>]}
[0m19:16:27.458569 [debug] [MainThread]: Parsing macros\adapters.sql
[0m19:16:27.501146 [debug] [MainThread]: Parsing macros\catalog.sql
[0m19:16:27.507151 [debug] [MainThread]: Parsing macros\relations.sql
[0m19:16:27.510146 [debug] [MainThread]: Parsing macros\timestamps.sql
[0m19:16:27.515147 [debug] [MainThread]: Parsing macros\materializations\incremental_strategies.sql
[0m19:16:27.517147 [debug] [MainThread]: Parsing macros\materializations\snapshot_merge.sql
[0m19:16:27.520145 [debug] [MainThread]: Parsing macros\utils\any_value.sql
[0m19:16:27.520145 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m19:16:27.522147 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m19:16:27.530148 [debug] [MainThread]: Parsing macros\utils\last_day.sql
[0m19:16:27.532144 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m19:16:27.535149 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m19:16:27.536147 [debug] [MainThread]: Parsing macros\adapters\apply_grants.sql
[0m19:16:27.559145 [debug] [MainThread]: Parsing macros\adapters\columns.sql
[0m19:16:27.572147 [debug] [MainThread]: Parsing macros\adapters\freshness.sql
[0m19:16:27.575943 [debug] [MainThread]: Parsing macros\adapters\indexes.sql
[0m19:16:27.579947 [debug] [MainThread]: Parsing macros\adapters\metadata.sql
[0m19:16:27.591944 [debug] [MainThread]: Parsing macros\adapters\persist_docs.sql
[0m19:16:27.597942 [debug] [MainThread]: Parsing macros\adapters\relation.sql
[0m19:16:27.622941 [debug] [MainThread]: Parsing macros\adapters\schema.sql
[0m19:16:27.627944 [debug] [MainThread]: Parsing macros\adapters\timestamps.sql
[0m19:16:27.638943 [debug] [MainThread]: Parsing macros\etc\datetime.sql
[0m19:16:27.654944 [debug] [MainThread]: Parsing macros\etc\statement.sql
[0m19:16:27.662944 [debug] [MainThread]: Parsing macros\generic_test_sql\accepted_values.sql
[0m19:16:27.664943 [debug] [MainThread]: Parsing macros\generic_test_sql\not_null.sql
[0m19:16:27.667941 [debug] [MainThread]: Parsing macros\generic_test_sql\relationships.sql
[0m19:16:27.669944 [debug] [MainThread]: Parsing macros\generic_test_sql\unique.sql
[0m19:16:27.671943 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_alias.sql
[0m19:16:27.674943 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_database.sql
[0m19:16:27.677944 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_schema.sql
[0m19:16:27.683943 [debug] [MainThread]: Parsing macros\materializations\configs.sql
[0m19:16:27.689943 [debug] [MainThread]: Parsing macros\materializations\hooks.sql
[0m19:16:27.701944 [debug] [MainThread]: Parsing macros\materializations\models\incremental\column_helpers.sql
[0m19:16:27.717837 [debug] [MainThread]: Parsing macros\materializations\models\incremental\incremental.sql
[0m19:16:27.737836 [debug] [MainThread]: Parsing macros\materializations\models\incremental\is_incremental.sql
[0m19:16:27.740838 [debug] [MainThread]: Parsing macros\materializations\models\incremental\merge.sql
[0m19:16:27.777844 [debug] [MainThread]: Parsing macros\materializations\models\incremental\on_schema_change.sql
[0m19:16:27.819199 [debug] [MainThread]: Parsing macros\materializations\models\incremental\strategies.sql
[0m19:16:27.836206 [debug] [MainThread]: Parsing macros\materializations\models\table\create_table_as.sql
[0m19:16:27.844202 [debug] [MainThread]: Parsing macros\materializations\models\table\table.sql
[0m19:16:27.853198 [debug] [MainThread]: Parsing macros\materializations\models\view\create_or_replace_view.sql
[0m19:16:27.860198 [debug] [MainThread]: Parsing macros\materializations\models\view\create_view_as.sql
[0m19:16:27.865199 [debug] [MainThread]: Parsing macros\materializations\models\view\helpers.sql
[0m19:16:27.871200 [debug] [MainThread]: Parsing macros\materializations\models\view\view.sql
[0m19:16:27.885198 [debug] [MainThread]: Parsing macros\materializations\seeds\helpers.sql
[0m19:16:27.968847 [debug] [MainThread]: Parsing macros\materializations\seeds\seed.sql
[0m19:16:27.983845 [debug] [MainThread]: Parsing macros\materializations\snapshots\helpers.sql
[0m19:16:28.007846 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot.sql
[0m19:16:28.023845 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot_merge.sql
[0m19:16:28.027845 [debug] [MainThread]: Parsing macros\materializations\snapshots\strategies.sql
[0m19:16:28.050845 [debug] [MainThread]: Parsing macros\materializations\tests\helpers.sql
[0m19:16:28.054364 [debug] [MainThread]: Parsing macros\materializations\tests\test.sql
[0m19:16:28.059367 [debug] [MainThread]: Parsing macros\materializations\tests\where_subquery.sql
[0m19:16:28.062364 [debug] [MainThread]: Parsing macros\python_model\python.sql
[0m19:16:28.072365 [debug] [MainThread]: Parsing macros\utils\any_value.sql
[0m19:16:28.074363 [debug] [MainThread]: Parsing macros\utils\array_append.sql
[0m19:16:28.076363 [debug] [MainThread]: Parsing macros\utils\array_concat.sql
[0m19:16:28.078364 [debug] [MainThread]: Parsing macros\utils\array_construct.sql
[0m19:16:28.081365 [debug] [MainThread]: Parsing macros\utils\bool_or.sql
[0m19:16:28.082365 [debug] [MainThread]: Parsing macros\utils\cast_bool_to_text.sql
[0m19:16:28.084364 [debug] [MainThread]: Parsing macros\utils\concat.sql
[0m19:16:28.085367 [debug] [MainThread]: Parsing macros\utils\data_types.sql
[0m19:16:28.096366 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m19:16:28.098364 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m19:16:28.100367 [debug] [MainThread]: Parsing macros\utils\date_trunc.sql
[0m19:16:28.102364 [debug] [MainThread]: Parsing macros\utils\escape_single_quotes.sql
[0m19:16:28.104364 [debug] [MainThread]: Parsing macros\utils\except.sql
[0m19:16:28.105366 [debug] [MainThread]: Parsing macros\utils\hash.sql
[0m19:16:28.107365 [debug] [MainThread]: Parsing macros\utils\intersect.sql
[0m19:16:28.109365 [debug] [MainThread]: Parsing macros\utils\last_day.sql
[0m19:16:28.112365 [debug] [MainThread]: Parsing macros\utils\length.sql
[0m19:16:28.114365 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m19:16:28.117365 [debug] [MainThread]: Parsing macros\utils\literal.sql
[0m19:16:28.118364 [debug] [MainThread]: Parsing macros\utils\position.sql
[0m19:16:28.120365 [debug] [MainThread]: Parsing macros\utils\replace.sql
[0m19:16:28.122365 [debug] [MainThread]: Parsing macros\utils\right.sql
[0m19:16:28.124364 [debug] [MainThread]: Parsing macros\utils\safe_cast.sql
[0m19:16:28.127366 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m19:16:28.130371 [debug] [MainThread]: Parsing tests\generic\builtin.sql
[0m19:16:28.547715 [debug] [MainThread]: 1699: static parser successfully parsed my_first_dbt_model.sql
[0m19:16:28.565719 [debug] [MainThread]: 1699: static parser successfully parsed my_second_dbt_model.sql
[0m19:16:28.569716 [debug] [MainThread]: 1699: static parser successfully parsed placeholder_from_airbyte.sql
[0m19:16:28.572716 [debug] [MainThread]: 1603: static parser failed on split_full_name.sql
[0m19:16:28.581714 [debug] [MainThread]: 1602: parser fallback to jinja rendering on split_full_name.sql
[0m19:16:28.582713 [debug] [MainThread]: 1699: static parser successfully parsed utils.sql
[0m19:16:28.587714 [debug] [MainThread]: 1603: static parser failed on example\placeholder_from_airbyte.sql
[0m19:16:28.603714 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example\placeholder_from_airbyte.sql
[0m19:16:28.603714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC99379F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC99342250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC99342310>]}
[0m19:16:28.604720 [debug] [MainThread]: Flushing usage events
[0m19:16:29.714078 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two models with the name "placeholder_from_airbyte".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for ref("placeholder_from_airbyte").
  
  To fix this, change the name of one of these resources:
  - model.stgo_dbt.placeholder_from_airbyte (models\example\placeholder_from_airbyte.sql)
  - model.stgo_dbt.placeholder_from_airbyte (models\placeholder_from_airbyte.sql)


============================== 2023-01-02 19:16:53.461355 | bc447984-f265-4d9c-9fce-4e4a60778cbb ==============================
[0m19:16:53.461355 [info ] [MainThread]: Running with dbt=1.3.1
[0m19:16:53.463357 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'D:\\2023\\Cloudthought\\data-migration-dbt\\stgo_dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:16:53.463357 [debug] [MainThread]: Tracking: tracking
[0m19:16:53.512354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253480F11C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253480F1AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253480F1130>]}
[0m19:16:53.560354 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m19:16:53.561355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bc447984-f265-4d9c-9fce-4e4a60778cbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025348110190>]}
[0m19:16:53.670531 [debug] [MainThread]: Parsing macros\adapters.sql
[0m19:16:53.705531 [debug] [MainThread]: Parsing macros\catalog.sql
[0m19:16:53.709533 [debug] [MainThread]: Parsing macros\relations.sql
[0m19:16:53.711533 [debug] [MainThread]: Parsing macros\timestamps.sql
[0m19:16:53.716533 [debug] [MainThread]: Parsing macros\materializations\incremental_strategies.sql
[0m19:16:53.718532 [debug] [MainThread]: Parsing macros\materializations\snapshot_merge.sql
[0m19:16:53.723531 [debug] [MainThread]: Parsing macros\utils\any_value.sql
[0m19:16:53.724531 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m19:16:53.726534 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m19:16:53.738532 [debug] [MainThread]: Parsing macros\utils\last_day.sql
[0m19:16:53.740535 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m19:16:53.744531 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m19:16:53.746538 [debug] [MainThread]: Parsing macros\adapters\apply_grants.sql
[0m19:16:53.767534 [debug] [MainThread]: Parsing macros\adapters\columns.sql
[0m19:16:53.782532 [debug] [MainThread]: Parsing macros\adapters\freshness.sql
[0m19:16:53.787536 [debug] [MainThread]: Parsing macros\adapters\indexes.sql
[0m19:16:53.792533 [debug] [MainThread]: Parsing macros\adapters\metadata.sql
[0m19:16:53.804531 [debug] [MainThread]: Parsing macros\adapters\persist_docs.sql
[0m19:16:53.810531 [debug] [MainThread]: Parsing macros\adapters\relation.sql
[0m19:16:53.831532 [debug] [MainThread]: Parsing macros\adapters\schema.sql
[0m19:16:53.834536 [debug] [MainThread]: Parsing macros\adapters\timestamps.sql
[0m19:16:53.842108 [debug] [MainThread]: Parsing macros\etc\datetime.sql
[0m19:16:53.854112 [debug] [MainThread]: Parsing macros\etc\statement.sql
[0m19:16:53.860108 [debug] [MainThread]: Parsing macros\generic_test_sql\accepted_values.sql
[0m19:16:53.863109 [debug] [MainThread]: Parsing macros\generic_test_sql\not_null.sql
[0m19:16:53.865108 [debug] [MainThread]: Parsing macros\generic_test_sql\relationships.sql
[0m19:16:53.867110 [debug] [MainThread]: Parsing macros\generic_test_sql\unique.sql
[0m19:16:53.868113 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_alias.sql
[0m19:16:53.872114 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_database.sql
[0m19:16:53.875115 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_schema.sql
[0m19:16:53.880121 [debug] [MainThread]: Parsing macros\materializations\configs.sql
[0m19:16:53.883111 [debug] [MainThread]: Parsing macros\materializations\hooks.sql
[0m19:16:53.889111 [debug] [MainThread]: Parsing macros\materializations\models\incremental\column_helpers.sql
[0m19:16:53.902108 [debug] [MainThread]: Parsing macros\materializations\models\incremental\incremental.sql
[0m19:16:53.916108 [debug] [MainThread]: Parsing macros\materializations\models\incremental\is_incremental.sql
[0m19:16:53.919112 [debug] [MainThread]: Parsing macros\materializations\models\incremental\merge.sql
[0m19:16:53.938108 [debug] [MainThread]: Parsing macros\materializations\models\incremental\on_schema_change.sql
[0m19:16:53.962108 [debug] [MainThread]: Parsing macros\materializations\models\incremental\strategies.sql
[0m19:16:53.977109 [debug] [MainThread]: Parsing macros\materializations\models\table\create_table_as.sql
[0m19:16:53.983235 [debug] [MainThread]: Parsing macros\materializations\models\table\table.sql
[0m19:16:53.997158 [debug] [MainThread]: Parsing macros\materializations\models\view\create_or_replace_view.sql
[0m19:16:54.004164 [debug] [MainThread]: Parsing macros\materializations\models\view\create_view_as.sql
[0m19:16:54.009160 [debug] [MainThread]: Parsing macros\materializations\models\view\helpers.sql
[0m19:16:54.013157 [debug] [MainThread]: Parsing macros\materializations\models\view\view.sql
[0m19:16:54.025161 [debug] [MainThread]: Parsing macros\materializations\seeds\helpers.sql
[0m19:16:54.111158 [debug] [MainThread]: Parsing macros\materializations\seeds\seed.sql
[0m19:16:54.127158 [debug] [MainThread]: Parsing macros\materializations\snapshots\helpers.sql
[0m19:16:54.156158 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot.sql
[0m19:16:54.178157 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot_merge.sql
[0m19:16:54.181159 [debug] [MainThread]: Parsing macros\materializations\snapshots\strategies.sql
[0m19:16:54.205157 [debug] [MainThread]: Parsing macros\materializations\tests\helpers.sql
[0m19:16:54.207157 [debug] [MainThread]: Parsing macros\materializations\tests\test.sql
[0m19:16:54.214158 [debug] [MainThread]: Parsing macros\materializations\tests\where_subquery.sql
[0m19:16:54.217157 [debug] [MainThread]: Parsing macros\python_model\python.sql
[0m19:16:54.226159 [debug] [MainThread]: Parsing macros\utils\any_value.sql
[0m19:16:54.228156 [debug] [MainThread]: Parsing macros\utils\array_append.sql
[0m19:16:54.230157 [debug] [MainThread]: Parsing macros\utils\array_concat.sql
[0m19:16:54.232155 [debug] [MainThread]: Parsing macros\utils\array_construct.sql
[0m19:16:54.234159 [debug] [MainThread]: Parsing macros\utils\bool_or.sql
[0m19:16:54.236157 [debug] [MainThread]: Parsing macros\utils\cast_bool_to_text.sql
[0m19:16:54.238158 [debug] [MainThread]: Parsing macros\utils\concat.sql
[0m19:16:54.240157 [debug] [MainThread]: Parsing macros\utils\data_types.sql
[0m19:16:54.252156 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m19:16:54.254157 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m19:16:54.256159 [debug] [MainThread]: Parsing macros\utils\date_trunc.sql
[0m19:16:54.259160 [debug] [MainThread]: Parsing macros\utils\escape_single_quotes.sql
[0m19:16:54.260156 [debug] [MainThread]: Parsing macros\utils\except.sql
[0m19:16:54.262158 [debug] [MainThread]: Parsing macros\utils\hash.sql
[0m19:16:54.264161 [debug] [MainThread]: Parsing macros\utils\intersect.sql
[0m19:16:54.265156 [debug] [MainThread]: Parsing macros\utils\last_day.sql
[0m19:16:54.269158 [debug] [MainThread]: Parsing macros\utils\length.sql
[0m19:16:54.271157 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m19:16:54.275155 [debug] [MainThread]: Parsing macros\utils\literal.sql
[0m19:16:54.278159 [debug] [MainThread]: Parsing macros\utils\position.sql
[0m19:16:54.280160 [debug] [MainThread]: Parsing macros\utils\replace.sql
[0m19:16:54.282161 [debug] [MainThread]: Parsing macros\utils\right.sql
[0m19:16:54.284158 [debug] [MainThread]: Parsing macros\utils\safe_cast.sql
[0m19:16:54.286155 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m19:16:54.290158 [debug] [MainThread]: Parsing tests\generic\builtin.sql
[0m19:16:54.718505 [debug] [MainThread]: 1699: static parser successfully parsed my_first_dbt_model.sql
[0m19:16:54.737507 [debug] [MainThread]: 1699: static parser successfully parsed my_second_dbt_model.sql
[0m19:16:54.742504 [debug] [MainThread]: 1699: static parser successfully parsed placeholder_from_airbyte.sql
[0m19:16:54.748505 [debug] [MainThread]: 1603: static parser failed on split_full_name.sql
[0m19:16:54.755504 [debug] [MainThread]: 1602: parser fallback to jinja rendering on split_full_name.sql
[0m19:16:54.759508 [debug] [MainThread]: 1699: static parser successfully parsed utils.sql
[0m19:16:54.843504 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.learn_dbt.split_full_name

[0m19:16:54.855508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc447984-f265-4d9c-9fce-4e4a60778cbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025348280DF0>]}
[0m19:16:54.871504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc447984-f265-4d9c-9fce-4e4a60778cbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253480F11C0>]}
[0m19:16:54.872505 [info ] [MainThread]: Found 5 models, 1 test, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m19:16:54.873507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc447984-f265-4d9c-9fce-4e4a60778cbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025348110160>]}
[0m19:16:54.875506 [info ] [MainThread]: 
[0m19:16:54.879505 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m19:16:54.883767 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m19:16:54.898761 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m19:16:54.909765 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:16:54.914761 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:16:54.915763 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:16:54.916762 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:16:54.917766 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:16:54.918765 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:16:57.028231 [debug] [ThreadPool]: SQL status: SELECT 12 in 2.11 seconds
[0m19:16:57.031122 [debug] [ThreadPool]: On list_postgres: Close
[0m19:16:57.031397 [debug] [ThreadPool]: SQL status: SELECT 12 in 2.11 seconds
[0m19:16:57.034021 [debug] [ThreadPool]: On list_postgres: Close
[0m19:16:57.041087 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public_public"
[0m19:16:57.050193 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m19:16:57.058932 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:16:57.061932 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m19:16:57.062932 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m19:16:57.062932 [debug] [ThreadPool]: On list_postgres_public_public: BEGIN
[0m19:16:57.062932 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:16:57.063932 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:16:59.116587 [debug] [ThreadPool]: SQL status: BEGIN in 2.05 seconds
[0m19:16:59.117111 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:16:59.117172 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m19:16:59.123732 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
[0m19:16:59.126727 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m19:16:59.128727 [debug] [ThreadPool]: On list_postgres_public: Close
[0m19:16:59.144717 [debug] [ThreadPool]: SQL status: BEGIN in 2.08 seconds
[0m19:16:59.145796 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m19:16:59.146232 [debug] [ThreadPool]: On list_postgres_public_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres_public_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
  
[0m19:16:59.153359 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.01 seconds
[0m19:16:59.155757 [debug] [ThreadPool]: On list_postgres_public_public: ROLLBACK
[0m19:16:59.157981 [debug] [ThreadPool]: On list_postgres_public_public: Close
[0m19:16:59.169355 [debug] [MainThread]: Using postgres connection "master"
[0m19:16:59.170355 [debug] [MainThread]: On master: BEGIN
[0m19:16:59.170355 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:17:01.242421 [debug] [MainThread]: SQL status: BEGIN in 2.07 seconds
[0m19:17:01.242963 [debug] [MainThread]: Using postgres connection "master"
[0m19:17:01.243514 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:17:01.272406 [debug] [MainThread]: SQL status: SELECT 1 in 0.03 seconds
[0m19:17:01.274717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc447984-f265-4d9c-9fce-4e4a60778cbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025348280760>]}
[0m19:17:01.275277 [debug] [MainThread]: On master: ROLLBACK
[0m19:17:01.277653 [debug] [MainThread]: Using postgres connection "master"
[0m19:17:01.278210 [debug] [MainThread]: On master: BEGIN
[0m19:17:01.282855 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:17:01.283418 [debug] [MainThread]: On master: COMMIT
[0m19:17:01.284101 [debug] [MainThread]: Using postgres connection "master"
[0m19:17:01.284657 [debug] [MainThread]: On master: COMMIT
[0m19:17:01.286824 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:17:01.287367 [debug] [MainThread]: On master: Close
[0m19:17:01.289602 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:17:01.290694 [info ] [MainThread]: 
[0m19:17:01.307003 [debug] [Thread-1  ]: Began running node model.stgo_dbt.my_first_dbt_model
[0m19:17:01.307003 [debug] [Thread-2  ]: Began running node model.stgo_dbt.split_full_name
[0m19:17:01.308004 [info ] [Thread-1  ]: 1 of 4 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m19:17:01.310004 [info ] [Thread-2  ]: 2 of 4 START sql view model public_public.split_full_name ...................... [RUN]
[0m19:17:01.311002 [debug] [Thread-3  ]: Began running node model.stgo_dbt.utils
[0m19:17:01.316004 [debug] [Thread-1  ]: Acquiring new postgres connection "model.stgo_dbt.my_first_dbt_model"
[0m19:17:01.317002 [info ] [Thread-3  ]: 3 of 4 START sql view model public.utils ....................................... [RUN]
[0m19:17:01.317002 [debug] [Thread-1  ]: Began compiling node model.stgo_dbt.my_first_dbt_model
[0m19:17:01.320002 [debug] [Thread-2  ]: Acquiring new postgres connection "model.stgo_dbt.split_full_name"
[0m19:17:01.321003 [debug] [Thread-1  ]: Compiling model.stgo_dbt.my_first_dbt_model
[0m19:17:01.323004 [debug] [Thread-3  ]: Acquiring new postgres connection "model.stgo_dbt.utils"
[0m19:17:01.323004 [debug] [Thread-2  ]: Began compiling node model.stgo_dbt.split_full_name
[0m19:17:01.330003 [debug] [Thread-1  ]: Writing injected SQL for node "model.stgo_dbt.my_first_dbt_model"
[0m19:17:01.331004 [debug] [Thread-3  ]: Began compiling node model.stgo_dbt.utils
[0m19:17:01.333005 [debug] [Thread-2  ]: Compiling model.stgo_dbt.split_full_name
[0m19:17:01.335006 [debug] [Thread-3  ]: Compiling model.stgo_dbt.utils
[0m19:17:01.344002 [debug] [Thread-1  ]: finished collecting timing info
[0m19:17:01.347001 [debug] [Thread-2  ]: Writing injected SQL for node "model.stgo_dbt.split_full_name"
[0m19:17:01.353001 [debug] [Thread-3  ]: Writing injected SQL for node "model.stgo_dbt.utils"
[0m19:17:01.353001 [debug] [Thread-1  ]: Began executing node model.stgo_dbt.my_first_dbt_model
[0m19:17:01.437003 [debug] [Thread-3  ]: finished collecting timing info
[0m19:17:01.437003 [debug] [Thread-2  ]: finished collecting timing info
[0m19:17:01.458003 [debug] [Thread-1  ]: Writing runtime sql for node "model.stgo_dbt.my_first_dbt_model"
[0m19:17:01.458003 [debug] [Thread-3  ]: Began executing node model.stgo_dbt.utils
[0m19:17:01.459002 [debug] [Thread-2  ]: Began executing node model.stgo_dbt.split_full_name
[0m19:17:01.495521 [debug] [Thread-3  ]: Writing runtime sql for node "model.stgo_dbt.utils"
[0m19:17:01.503520 [debug] [Thread-2  ]: Writing runtime sql for node "model.stgo_dbt.split_full_name"
[0m19:17:01.504520 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.my_first_dbt_model"
[0m19:17:01.504520 [debug] [Thread-1  ]: On model.stgo_dbt.my_first_dbt_model: BEGIN
[0m19:17:01.505520 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m19:17:01.548521 [debug] [Thread-3  ]: Using postgres connection "model.stgo_dbt.utils"
[0m19:17:01.548521 [debug] [Thread-3  ]: On model.stgo_dbt.utils: BEGIN
[0m19:17:01.549522 [debug] [Thread-2  ]: Using postgres connection "model.stgo_dbt.split_full_name"
[0m19:17:01.549522 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m19:17:01.549522 [debug] [Thread-2  ]: On model.stgo_dbt.split_full_name: BEGIN
[0m19:17:01.550520 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m19:17:03.570743 [debug] [Thread-1  ]: SQL status: BEGIN in 2.07 seconds
[0m19:17:03.570743 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.my_first_dbt_model"
[0m19:17:03.571742 [debug] [Thread-1  ]: On model.stgo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.my_first_dbt_model"} */

  
    

  create  table "postgres"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m19:17:03.581868 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.01 seconds
[0m19:17:03.602341 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.my_first_dbt_model"
[0m19:17:03.603427 [debug] [Thread-1  ]: On model.stgo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m19:17:03.608662 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:17:03.615837 [debug] [Thread-2  ]: SQL status: BEGIN in 2.07 seconds
[0m19:17:03.618890 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.my_first_dbt_model"
[0m19:17:03.619547 [debug] [Thread-2  ]: Using postgres connection "model.stgo_dbt.split_full_name"
[0m19:17:03.620067 [debug] [Thread-1  ]: On model.stgo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m19:17:03.620624 [debug] [Thread-2  ]: On model.stgo_dbt.split_full_name: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.split_full_name"} */

  create view "postgres"."public_public"."split_full_name__dbt_tmp" as (
    



select
  name
from cdc_tut;
  );
[0m19:17:03.623869 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:17:03.624478 [debug] [Thread-2  ]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 10: from cdc_tut;
                     ^

[0m19:17:03.661873 [debug] [Thread-3  ]: SQL status: BEGIN in 2.11 seconds
[0m19:17:03.686872 [debug] [Thread-1  ]: On model.stgo_dbt.my_first_dbt_model: COMMIT
[0m19:17:03.686872 [debug] [Thread-2  ]: On model.stgo_dbt.split_full_name: ROLLBACK
[0m19:17:03.686872 [debug] [Thread-3  ]: Using postgres connection "model.stgo_dbt.utils"
[0m19:17:03.687873 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.my_first_dbt_model"
[0m19:17:03.687873 [debug] [Thread-3  ]: On model.stgo_dbt.utils: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.utils"} */

  create view "postgres"."public"."utils__dbt_tmp" as (
    create or replace function split_name(full_name varchar)
returns table (first_name varchar, last_name varchar) as $$
  select
    trim(split_part(full_name, ' ', 1)),
    trim(split_part(full_name, ' ', 2))
  from (
    select full_name
  ) t;
$$ language sql;
  );
[0m19:17:03.688639 [debug] [Thread-1  ]: On model.stgo_dbt.my_first_dbt_model: COMMIT
[0m19:17:03.690860 [debug] [Thread-2  ]: finished collecting timing info
[0m19:17:03.691695 [debug] [Thread-2  ]: On model.stgo_dbt.split_full_name: Close
[0m19:17:03.692249 [debug] [Thread-3  ]: Postgres adapter: Postgres error: syntax error at or near "create"
LINE 4:     create or replace function split_name(full_name varchar)
            ^

[0m19:17:03.693867 [debug] [Thread-2  ]: Database Error in model split_full_name (models\split_full_name.sql)
  syntax error at or near ";"
  LINE 10: from cdc_tut;
                       ^
  compiled Code at target\run\stgo_dbt\models\split_full_name.sql
[0m19:17:03.694450 [debug] [Thread-3  ]: On model.stgo_dbt.utils: ROLLBACK
[0m19:17:03.695630 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc447984-f265-4d9c-9fce-4e4a60778cbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253482F6520>]}
[0m19:17:03.697490 [error] [Thread-2  ]: 2 of 4 ERROR creating sql view model public_public.split_full_name ............. [[31mERROR[0m in 2.38s]
[0m19:17:03.698265 [debug] [Thread-3  ]: finished collecting timing info
[0m19:17:03.699450 [debug] [Thread-3  ]: On model.stgo_dbt.utils: Close
[0m19:17:03.701555 [debug] [Thread-3  ]: Database Error in model utils (models\utils.sql)
  syntax error at or near "create"
  LINE 4:     create or replace function split_name(full_name varchar)
              ^
  compiled Code at target\run\stgo_dbt\models\utils.sql
[0m19:17:03.702253 [debug] [Thread-2  ]: Finished running node model.stgo_dbt.split_full_name
[0m19:17:03.703542 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc447984-f265-4d9c-9fce-4e4a60778cbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253482F6D90>]}
[0m19:17:03.704726 [error] [Thread-3  ]: 3 of 4 ERROR creating sql view model public.utils .............................. [[31mERROR[0m in 2.38s]
[0m19:17:03.707223 [debug] [Thread-3  ]: Finished running node model.stgo_dbt.utils
[0m19:17:03.726301 [debug] [Thread-1  ]: SQL status: COMMIT in 0.04 seconds
[0m19:17:03.734821 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.my_first_dbt_model"
[0m19:17:03.735820 [debug] [Thread-1  ]: On model.stgo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.my_first_dbt_model"} */
drop table if exists "postgres"."public"."my_first_dbt_model__dbt_backup" cascade
[0m19:17:03.779325 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.04 seconds
[0m19:17:03.783329 [debug] [Thread-1  ]: finished collecting timing info
[0m19:17:03.783329 [debug] [Thread-1  ]: On model.stgo_dbt.my_first_dbt_model: Close
[0m19:17:03.785926 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc447984-f265-4d9c-9fce-4e4a60778cbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002534833D760>]}
[0m19:17:03.787868 [info ] [Thread-1  ]: 1 of 4 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 2.47s]
[0m19:17:03.791390 [debug] [Thread-1  ]: Finished running node model.stgo_dbt.my_first_dbt_model
[0m19:17:03.793389 [debug] [Thread-4  ]: Began running node model.stgo_dbt.my_second_dbt_model
[0m19:17:03.794390 [info ] [Thread-4  ]: 4 of 4 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m19:17:03.796391 [debug] [Thread-4  ]: Acquiring new postgres connection "model.stgo_dbt.my_second_dbt_model"
[0m19:17:03.796391 [debug] [Thread-4  ]: Began compiling node model.stgo_dbt.my_second_dbt_model
[0m19:17:03.797392 [debug] [Thread-4  ]: Compiling model.stgo_dbt.my_second_dbt_model
[0m19:17:03.804054 [debug] [Thread-4  ]: Writing injected SQL for node "model.stgo_dbt.my_second_dbt_model"
[0m19:17:03.805055 [debug] [Thread-4  ]: finished collecting timing info
[0m19:17:03.806052 [debug] [Thread-4  ]: Began executing node model.stgo_dbt.my_second_dbt_model
[0m19:17:03.821073 [debug] [Thread-4  ]: Writing runtime sql for node "model.stgo_dbt.my_second_dbt_model"
[0m19:17:03.824052 [debug] [Thread-4  ]: Using postgres connection "model.stgo_dbt.my_second_dbt_model"
[0m19:17:03.824052 [debug] [Thread-4  ]: On model.stgo_dbt.my_second_dbt_model: BEGIN
[0m19:17:03.824052 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m19:17:05.895854 [debug] [Thread-4  ]: SQL status: BEGIN in 2.07 seconds
[0m19:17:05.895873 [debug] [Thread-4  ]: Using postgres connection "model.stgo_dbt.my_second_dbt_model"
[0m19:17:05.896424 [debug] [Thread-4  ]: On model.stgo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.my_second_dbt_model"} */

  create view "postgres"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."public"."my_first_dbt_model"
where id = 1
  );
[0m19:17:05.902880 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.01 seconds
[0m19:17:05.907841 [debug] [Thread-4  ]: Using postgres connection "model.stgo_dbt.my_second_dbt_model"
[0m19:17:05.907865 [debug] [Thread-4  ]: On model.stgo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.my_second_dbt_model"} */
alter table "postgres"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m19:17:05.910480 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:17:05.913930 [debug] [Thread-4  ]: On model.stgo_dbt.my_second_dbt_model: COMMIT
[0m19:17:05.914449 [debug] [Thread-4  ]: Using postgres connection "model.stgo_dbt.my_second_dbt_model"
[0m19:17:05.914476 [debug] [Thread-4  ]: On model.stgo_dbt.my_second_dbt_model: COMMIT
[0m19:17:05.968539 [debug] [Thread-4  ]: SQL status: COMMIT in 0.05 seconds
[0m19:17:05.971657 [debug] [Thread-4  ]: Using postgres connection "model.stgo_dbt.my_second_dbt_model"
[0m19:17:05.971657 [debug] [Thread-4  ]: On model.stgo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.my_second_dbt_model"} */
drop view if exists "postgres"."public"."my_second_dbt_model__dbt_backup" cascade
[0m19:17:05.974496 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
[0m19:17:05.976391 [debug] [Thread-4  ]: finished collecting timing info
[0m19:17:05.976928 [debug] [Thread-4  ]: On model.stgo_dbt.my_second_dbt_model: Close
[0m19:17:05.978593 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc447984-f265-4d9c-9fce-4e4a60778cbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253482E6760>]}
[0m19:17:05.979682 [info ] [Thread-4  ]: 4 of 4 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 2.18s]
[0m19:17:05.982055 [debug] [Thread-4  ]: Finished running node model.stgo_dbt.my_second_dbt_model
[0m19:17:05.984415 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m19:17:05.984960 [debug] [MainThread]: Using postgres connection "master"
[0m19:17:05.985510 [debug] [MainThread]: On master: BEGIN
[0m19:17:05.985510 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:17:08.038044 [debug] [MainThread]: SQL status: BEGIN in 2.05 seconds
[0m19:17:08.038044 [debug] [MainThread]: On master: COMMIT
[0m19:17:08.039044 [debug] [MainThread]: Using postgres connection "master"
[0m19:17:08.039044 [debug] [MainThread]: On master: COMMIT
[0m19:17:08.041042 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:17:08.042047 [debug] [MainThread]: On master: Close
[0m19:17:08.044045 [info ] [MainThread]: 
[0m19:17:08.047047 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 13.17 seconds (13.17s).
[0m19:17:08.048538 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:17:08.049060 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m19:17:08.049540 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m19:17:08.050068 [debug] [MainThread]: Connection 'list_postgres_public_public' was properly closed.
[0m19:17:08.050595 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m19:17:08.050595 [debug] [MainThread]: Connection 'model.stgo_dbt.my_first_dbt_model' was properly closed.
[0m19:17:08.051386 [debug] [MainThread]: Connection 'model.stgo_dbt.split_full_name' was properly closed.
[0m19:17:08.051912 [debug] [MainThread]: Connection 'model.stgo_dbt.utils' was properly closed.
[0m19:17:08.051912 [debug] [MainThread]: Connection 'model.stgo_dbt.my_second_dbt_model' was properly closed.
[0m19:17:08.069051 [info ] [MainThread]: 
[0m19:17:08.073047 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m19:17:08.082637 [info ] [MainThread]: 
[0m19:17:08.089639 [error] [MainThread]: [33mDatabase Error in model split_full_name (models\split_full_name.sql)[0m
[0m19:17:08.098635 [error] [MainThread]:   syntax error at or near ";"
[0m19:17:08.101635 [error] [MainThread]:   LINE 10: from cdc_tut;
[0m19:17:08.113636 [error] [MainThread]:                        ^
[0m19:17:08.116637 [error] [MainThread]:   compiled Code at target\run\stgo_dbt\models\split_full_name.sql
[0m19:17:08.122636 [info ] [MainThread]: 
[0m19:17:08.128638 [error] [MainThread]: [33mDatabase Error in model utils (models\utils.sql)[0m
[0m19:17:08.133634 [error] [MainThread]:   syntax error at or near "create"
[0m19:17:08.139635 [error] [MainThread]:   LINE 4:     create or replace function split_name(full_name varchar)
[0m19:17:08.145637 [error] [MainThread]:               ^
[0m19:17:08.153636 [error] [MainThread]:   compiled Code at target\run\stgo_dbt\models\utils.sql
[0m19:17:08.159638 [info ] [MainThread]: 
[0m19:17:08.171634 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m19:17:08.173634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025348280790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253482D2B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253482E6370>]}
[0m19:17:08.174635 [debug] [MainThread]: Flushing usage events


============================== 2023-01-02 19:19:09.009051 | 9628140b-f1fb-4a20-8741-086a7b920390 ==============================
[0m19:19:09.009051 [info ] [MainThread]: Running with dbt=1.3.1
[0m19:19:09.011056 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'D:\\2023\\Cloudthought\\data-migration-dbt\\stgo_dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:19:09.011056 [debug] [MainThread]: Tracking: tracking
[0m19:19:09.064576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC17E311C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC17E31A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC17E31130>]}
[0m19:19:09.130574 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m19:19:09.133575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9628140b-f1fb-4a20-8741-086a7b920390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC17E50160>]}
[0m19:19:09.262555 [debug] [MainThread]: Parsing macros\adapters.sql
[0m19:19:09.298556 [debug] [MainThread]: Parsing macros\catalog.sql
[0m19:19:09.302556 [debug] [MainThread]: Parsing macros\relations.sql
[0m19:19:09.304569 [debug] [MainThread]: Parsing macros\timestamps.sql
[0m19:19:09.307562 [debug] [MainThread]: Parsing macros\materializations\incremental_strategies.sql
[0m19:19:09.308556 [debug] [MainThread]: Parsing macros\materializations\snapshot_merge.sql
[0m19:19:09.310557 [debug] [MainThread]: Parsing macros\utils\any_value.sql
[0m19:19:09.311558 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m19:19:09.313555 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m19:19:09.322560 [debug] [MainThread]: Parsing macros\utils\last_day.sql
[0m19:19:09.324562 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m19:19:09.326558 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m19:19:09.328557 [debug] [MainThread]: Parsing macros\adapters\apply_grants.sql
[0m19:19:09.350556 [debug] [MainThread]: Parsing macros\adapters\columns.sql
[0m19:19:09.364555 [debug] [MainThread]: Parsing macros\adapters\freshness.sql
[0m19:19:09.367568 [debug] [MainThread]: Parsing macros\adapters\indexes.sql
[0m19:19:09.371556 [debug] [MainThread]: Parsing macros\adapters\metadata.sql
[0m19:19:09.383554 [debug] [MainThread]: Parsing macros\adapters\persist_docs.sql
[0m19:19:09.389556 [debug] [MainThread]: Parsing macros\adapters\relation.sql
[0m19:19:09.410202 [debug] [MainThread]: Parsing macros\adapters\schema.sql
[0m19:19:09.413200 [debug] [MainThread]: Parsing macros\adapters\timestamps.sql
[0m19:19:09.418200 [debug] [MainThread]: Parsing macros\etc\datetime.sql
[0m19:19:09.430198 [debug] [MainThread]: Parsing macros\etc\statement.sql
[0m19:19:09.438198 [debug] [MainThread]: Parsing macros\generic_test_sql\accepted_values.sql
[0m19:19:09.440198 [debug] [MainThread]: Parsing macros\generic_test_sql\not_null.sql
[0m19:19:09.441199 [debug] [MainThread]: Parsing macros\generic_test_sql\relationships.sql
[0m19:19:09.443199 [debug] [MainThread]: Parsing macros\generic_test_sql\unique.sql
[0m19:19:09.444199 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_alias.sql
[0m19:19:09.446199 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_database.sql
[0m19:19:09.449200 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_schema.sql
[0m19:19:09.453200 [debug] [MainThread]: Parsing macros\materializations\configs.sql
[0m19:19:09.456199 [debug] [MainThread]: Parsing macros\materializations\hooks.sql
[0m19:19:09.462199 [debug] [MainThread]: Parsing macros\materializations\models\incremental\column_helpers.sql
[0m19:19:09.477198 [debug] [MainThread]: Parsing macros\materializations\models\incremental\incremental.sql
[0m19:19:09.492199 [debug] [MainThread]: Parsing macros\materializations\models\incremental\is_incremental.sql
[0m19:19:09.494198 [debug] [MainThread]: Parsing macros\materializations\models\incremental\merge.sql
[0m19:19:09.514198 [debug] [MainThread]: Parsing macros\materializations\models\incremental\on_schema_change.sql
[0m19:19:09.539200 [debug] [MainThread]: Parsing macros\materializations\models\incremental\strategies.sql
[0m19:19:09.550198 [debug] [MainThread]: Parsing macros\materializations\models\table\create_table_as.sql
[0m19:19:09.556202 [debug] [MainThread]: Parsing macros\materializations\models\table\table.sql
[0m19:19:09.565199 [debug] [MainThread]: Parsing macros\materializations\models\view\create_or_replace_view.sql
[0m19:19:09.570206 [debug] [MainThread]: Parsing macros\materializations\models\view\create_view_as.sql
[0m19:19:09.574200 [debug] [MainThread]: Parsing macros\materializations\models\view\helpers.sql
[0m19:19:09.576199 [debug] [MainThread]: Parsing macros\materializations\models\view\view.sql
[0m19:19:09.585199 [debug] [MainThread]: Parsing macros\materializations\seeds\helpers.sql
[0m19:19:09.643199 [debug] [MainThread]: Parsing macros\materializations\seeds\seed.sql
[0m19:19:09.654199 [debug] [MainThread]: Parsing macros\materializations\snapshots\helpers.sql
[0m19:19:09.671824 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot.sql
[0m19:19:09.690823 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot_merge.sql
[0m19:19:09.693825 [debug] [MainThread]: Parsing macros\materializations\snapshots\strategies.sql
[0m19:19:09.716825 [debug] [MainThread]: Parsing macros\materializations\tests\helpers.sql
[0m19:19:09.719825 [debug] [MainThread]: Parsing macros\materializations\tests\test.sql
[0m19:19:09.726825 [debug] [MainThread]: Parsing macros\materializations\tests\where_subquery.sql
[0m19:19:09.728828 [debug] [MainThread]: Parsing macros\python_model\python.sql
[0m19:19:09.739824 [debug] [MainThread]: Parsing macros\utils\any_value.sql
[0m19:19:09.741824 [debug] [MainThread]: Parsing macros\utils\array_append.sql
[0m19:19:09.743824 [debug] [MainThread]: Parsing macros\utils\array_concat.sql
[0m19:19:09.745824 [debug] [MainThread]: Parsing macros\utils\array_construct.sql
[0m19:19:09.747824 [debug] [MainThread]: Parsing macros\utils\bool_or.sql
[0m19:19:09.748823 [debug] [MainThread]: Parsing macros\utils\cast_bool_to_text.sql
[0m19:19:09.750823 [debug] [MainThread]: Parsing macros\utils\concat.sql
[0m19:19:09.752825 [debug] [MainThread]: Parsing macros\utils\data_types.sql
[0m19:19:09.764822 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m19:19:09.766825 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m19:19:09.769826 [debug] [MainThread]: Parsing macros\utils\date_trunc.sql
[0m19:19:09.771824 [debug] [MainThread]: Parsing macros\utils\escape_single_quotes.sql
[0m19:19:09.773827 [debug] [MainThread]: Parsing macros\utils\except.sql
[0m19:19:09.774825 [debug] [MainThread]: Parsing macros\utils\hash.sql
[0m19:19:09.776826 [debug] [MainThread]: Parsing macros\utils\intersect.sql
[0m19:19:09.777823 [debug] [MainThread]: Parsing macros\utils\last_day.sql
[0m19:19:09.780825 [debug] [MainThread]: Parsing macros\utils\length.sql
[0m19:19:09.782827 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m19:19:09.786823 [debug] [MainThread]: Parsing macros\utils\literal.sql
[0m19:19:09.787826 [debug] [MainThread]: Parsing macros\utils\position.sql
[0m19:19:09.789824 [debug] [MainThread]: Parsing macros\utils\replace.sql
[0m19:19:09.791824 [debug] [MainThread]: Parsing macros\utils\right.sql
[0m19:19:09.793824 [debug] [MainThread]: Parsing macros\utils\safe_cast.sql
[0m19:19:09.795835 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m19:19:09.798823 [debug] [MainThread]: Parsing tests\generic\builtin.sql
[0m19:19:10.218988 [debug] [MainThread]: 1699: static parser successfully parsed my_first_dbt_model.sql
[0m19:19:10.239988 [debug] [MainThread]: 1699: static parser successfully parsed placeholder_from_airbyte.sql
[0m19:19:10.243987 [debug] [MainThread]: 1603: static parser failed on split_full_name.sql
[0m19:19:10.254513 [debug] [MainThread]: 1602: parser fallback to jinja rendering on split_full_name.sql
[0m19:19:10.257513 [debug] [MainThread]: 1699: static parser successfully parsed utils.sql
[0m19:19:10.363966 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.learn_dbt.placeholder_from_airbyte
- models.learn_dbt.split_full_name

[0m19:19:10.378969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9628140b-f1fb-4a20-8741-086a7b920390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC17FBEFA0>]}
[0m19:19:10.392485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9628140b-f1fb-4a20-8741-086a7b920390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC17E4C580>]}
[0m19:19:10.392485 [info ] [MainThread]: Found 4 models, 1 test, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m19:19:10.394491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9628140b-f1fb-4a20-8741-086a7b920390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC17FB4A90>]}
[0m19:19:10.397488 [info ] [MainThread]: 
[0m19:19:10.399486 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m19:19:10.403484 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m19:19:10.404488 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m19:19:10.428483 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:19:10.434485 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:19:10.435486 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:19:10.436486 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:19:10.436486 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:19:10.437485 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:19:12.501003 [debug] [ThreadPool]: SQL status: SELECT 12 in 2.06 seconds
[0m19:19:12.503004 [debug] [ThreadPool]: On list_postgres: Close
[0m19:19:12.515005 [debug] [ThreadPool]: SQL status: SELECT 12 in 2.08 seconds
[0m19:19:12.517003 [debug] [ThreadPool]: On list_postgres: Close
[0m19:19:12.519011 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m19:19:12.521005 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public_public"
[0m19:19:12.531006 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:19:12.534011 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m19:19:12.534011 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m19:19:12.535006 [debug] [ThreadPool]: On list_postgres_public_public: BEGIN
[0m19:19:12.535006 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:19:12.536006 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:19:14.595532 [debug] [ThreadPool]: SQL status: BEGIN in 2.06 seconds
[0m19:19:14.596311 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:19:14.596311 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m19:19:14.604699 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
[0m19:19:14.606699 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m19:19:14.609699 [debug] [ThreadPool]: On list_postgres_public: Close
[0m19:19:14.621701 [debug] [ThreadPool]: SQL status: BEGIN in 2.09 seconds
[0m19:19:14.621701 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m19:19:14.622701 [debug] [ThreadPool]: On list_postgres_public_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres_public_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
  
[0m19:19:14.629705 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.01 seconds
[0m19:19:14.631700 [debug] [ThreadPool]: On list_postgres_public_public: ROLLBACK
[0m19:19:14.633702 [debug] [ThreadPool]: On list_postgres_public_public: Close
[0m19:19:14.643189 [debug] [MainThread]: Using postgres connection "master"
[0m19:19:14.643843 [debug] [MainThread]: On master: BEGIN
[0m19:19:14.644350 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:19:16.717239 [debug] [MainThread]: SQL status: BEGIN in 2.07 seconds
[0m19:19:16.717239 [debug] [MainThread]: Using postgres connection "master"
[0m19:19:16.717790 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:19:16.741768 [debug] [MainThread]: SQL status: SELECT 1 in 0.02 seconds
[0m19:19:16.744134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9628140b-f1fb-4a20-8741-086a7b920390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC17FBE850>]}
[0m19:19:16.744691 [debug] [MainThread]: On master: ROLLBACK
[0m19:19:16.746343 [debug] [MainThread]: Using postgres connection "master"
[0m19:19:16.746877 [debug] [MainThread]: On master: BEGIN
[0m19:19:16.750718 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:19:16.751267 [debug] [MainThread]: On master: COMMIT
[0m19:19:16.751322 [debug] [MainThread]: Using postgres connection "master"
[0m19:19:16.751841 [debug] [MainThread]: On master: COMMIT
[0m19:19:16.753586 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:19:16.754126 [debug] [MainThread]: On master: Close
[0m19:19:16.755839 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:19:16.756961 [info ] [MainThread]: 
[0m19:19:16.768783 [debug] [Thread-1  ]: Began running node model.stgo_dbt.my_first_dbt_model
[0m19:19:16.768783 [info ] [Thread-1  ]: 1 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m19:19:16.770791 [debug] [Thread-2  ]: Began running node model.stgo_dbt.split_full_name
[0m19:19:16.770791 [debug] [Thread-3  ]: Began running node model.stgo_dbt.utils
[0m19:19:16.771783 [info ] [Thread-2  ]: 2 of 3 START sql view model public_public.split_full_name ...................... [RUN]
[0m19:19:16.772785 [debug] [Thread-1  ]: Acquiring new postgres connection "model.stgo_dbt.my_first_dbt_model"
[0m19:19:16.773786 [info ] [Thread-3  ]: 3 of 3 START sql view model public.utils ....................................... [RUN]
[0m19:19:16.774784 [debug] [Thread-1  ]: Began compiling node model.stgo_dbt.my_first_dbt_model
[0m19:19:16.775783 [debug] [Thread-2  ]: Acquiring new postgres connection "model.stgo_dbt.split_full_name"
[0m19:19:16.776783 [debug] [Thread-1  ]: Compiling model.stgo_dbt.my_first_dbt_model
[0m19:19:16.777783 [debug] [Thread-3  ]: Acquiring new postgres connection "model.stgo_dbt.utils"
[0m19:19:16.777783 [debug] [Thread-2  ]: Began compiling node model.stgo_dbt.split_full_name
[0m19:19:16.786783 [debug] [Thread-1  ]: Writing injected SQL for node "model.stgo_dbt.my_first_dbt_model"
[0m19:19:16.786783 [debug] [Thread-3  ]: Began compiling node model.stgo_dbt.utils
[0m19:19:16.787785 [debug] [Thread-2  ]: Compiling model.stgo_dbt.split_full_name
[0m19:19:16.788784 [debug] [Thread-3  ]: Compiling model.stgo_dbt.utils
[0m19:19:16.796793 [debug] [Thread-2  ]: Writing injected SQL for node "model.stgo_dbt.split_full_name"
[0m19:19:16.801784 [debug] [Thread-3  ]: Writing injected SQL for node "model.stgo_dbt.utils"
[0m19:19:16.802782 [debug] [Thread-1  ]: finished collecting timing info
[0m19:19:16.803783 [debug] [Thread-1  ]: Began executing node model.stgo_dbt.my_first_dbt_model
[0m19:19:16.803783 [debug] [Thread-2  ]: finished collecting timing info
[0m19:19:16.816783 [debug] [Thread-2  ]: Began executing node model.stgo_dbt.split_full_name
[0m19:19:16.832786 [debug] [Thread-3  ]: finished collecting timing info
[0m19:19:16.879783 [debug] [Thread-3  ]: Began executing node model.stgo_dbt.utils
[0m19:19:16.903782 [debug] [Thread-1  ]: Writing runtime sql for node "model.stgo_dbt.my_first_dbt_model"
[0m19:19:16.916784 [debug] [Thread-2  ]: Writing runtime sql for node "model.stgo_dbt.split_full_name"
[0m19:19:16.924781 [debug] [Thread-3  ]: Writing runtime sql for node "model.stgo_dbt.utils"
[0m19:19:16.925781 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.my_first_dbt_model"
[0m19:19:16.926781 [debug] [Thread-2  ]: Using postgres connection "model.stgo_dbt.split_full_name"
[0m19:19:16.926781 [debug] [Thread-1  ]: On model.stgo_dbt.my_first_dbt_model: BEGIN
[0m19:19:16.927783 [debug] [Thread-3  ]: Using postgres connection "model.stgo_dbt.utils"
[0m19:19:16.927783 [debug] [Thread-2  ]: On model.stgo_dbt.split_full_name: BEGIN
[0m19:19:16.927783 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m19:19:16.927783 [debug] [Thread-3  ]: On model.stgo_dbt.utils: BEGIN
[0m19:19:16.928783 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m19:19:16.928783 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m19:19:19.009419 [debug] [Thread-3  ]: SQL status: BEGIN in 2.08 seconds
[0m19:19:19.010416 [debug] [Thread-3  ]: Using postgres connection "model.stgo_dbt.utils"
[0m19:19:19.010416 [debug] [Thread-3  ]: On model.stgo_dbt.utils: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.utils"} */

  create view "postgres"."public"."utils__dbt_tmp" as (
    create or replace function split_name(full_name varchar)
returns table (first_name varchar, last_name varchar) as $$
  select
    trim(split_part(full_name, ' ', 1)),
    trim(split_part(full_name, ' ', 2))
  from (
    select full_name
  ) t;
$$ language sql;
  );
[0m19:19:19.013814 [debug] [Thread-2  ]: SQL status: BEGIN in 2.09 seconds
[0m19:19:19.015048 [debug] [Thread-2  ]: Using postgres connection "model.stgo_dbt.split_full_name"
[0m19:19:19.015570 [debug] [Thread-2  ]: On model.stgo_dbt.split_full_name: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.split_full_name"} */

  create view "postgres"."public_public"."split_full_name__dbt_tmp" as (
    



select
  name
from cdc_tut
  );
[0m19:19:19.016815 [debug] [Thread-3  ]: Postgres adapter: Postgres error: syntax error at or near "create"
LINE 4:     create or replace function split_name(full_name varchar)
            ^

[0m19:19:19.017370 [debug] [Thread-3  ]: On model.stgo_dbt.utils: ROLLBACK
[0m19:19:19.018046 [debug] [Thread-1  ]: SQL status: BEGIN in 2.09 seconds
[0m19:19:19.018815 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.my_first_dbt_model"
[0m19:19:19.019371 [debug] [Thread-1  ]: On model.stgo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.my_first_dbt_model"} */

  
    

  create  table "postgres"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m19:19:19.020987 [debug] [Thread-3  ]: finished collecting timing info
[0m19:19:19.021534 [debug] [Thread-3  ]: On model.stgo_dbt.utils: Close
[0m19:19:19.023179 [debug] [Thread-3  ]: Database Error in model utils (models\utils.sql)
  syntax error at or near "create"
  LINE 4:     create or replace function split_name(full_name varchar)
              ^
  compiled Code at target\run\stgo_dbt\models\utils.sql
[0m19:19:19.024185 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9628140b-f1fb-4a20-8741-086a7b920390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC18032D30>]}
[0m19:19:19.025372 [error] [Thread-3  ]: 3 of 3 ERROR creating sql view model public.utils .............................. [[31mERROR[0m in 2.25s]
[0m19:19:19.025847 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.01 seconds
[0m19:19:19.042700 [debug] [Thread-2  ]: Using postgres connection "model.stgo_dbt.split_full_name"
[0m19:19:19.043700 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.02 seconds
[0m19:19:19.043700 [debug] [Thread-2  ]: On model.stgo_dbt.split_full_name: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.split_full_name"} */
alter table "postgres"."public_public"."split_full_name__dbt_tmp" rename to "split_full_name"
[0m19:19:19.050700 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.my_first_dbt_model"
[0m19:19:19.051700 [debug] [Thread-1  ]: On model.stgo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m19:19:19.051700 [debug] [Thread-3  ]: Finished running node model.stgo_dbt.utils
[0m19:19:19.056427 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:19:19.056570 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.01 seconds
[0m19:19:19.062822 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.my_first_dbt_model"
[0m19:19:19.094304 [debug] [Thread-1  ]: On model.stgo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m19:19:19.108307 [debug] [Thread-2  ]: On model.stgo_dbt.split_full_name: COMMIT
[0m19:19:19.109304 [debug] [Thread-2  ]: Using postgres connection "model.stgo_dbt.split_full_name"
[0m19:19:19.110303 [debug] [Thread-2  ]: On model.stgo_dbt.split_full_name: COMMIT
[0m19:19:19.115300 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
[0m19:19:19.135301 [debug] [Thread-1  ]: On model.stgo_dbt.my_first_dbt_model: COMMIT
[0m19:19:19.136301 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.my_first_dbt_model"
[0m19:19:19.136301 [debug] [Thread-1  ]: On model.stgo_dbt.my_first_dbt_model: COMMIT
[0m19:19:19.144724 [debug] [Thread-2  ]: SQL status: COMMIT in 0.03 seconds
[0m19:19:19.157731 [debug] [Thread-2  ]: Using postgres connection "model.stgo_dbt.split_full_name"
[0m19:19:19.158730 [debug] [Thread-2  ]: On model.stgo_dbt.split_full_name: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.split_full_name"} */
drop view if exists "postgres"."public_public"."split_full_name__dbt_backup" cascade
[0m19:19:19.162368 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m19:19:19.165090 [debug] [Thread-2  ]: finished collecting timing info
[0m19:19:19.165090 [debug] [Thread-2  ]: On model.stgo_dbt.split_full_name: Close
[0m19:19:19.166881 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9628140b-f1fb-4a20-8741-086a7b920390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC180329A0>]}
[0m19:19:19.168073 [info ] [Thread-2  ]: 2 of 3 OK created sql view model public_public.split_full_name ................. [[32mCREATE VIEW[0m in 2.39s]
[0m19:19:19.169912 [debug] [Thread-2  ]: Finished running node model.stgo_dbt.split_full_name
[0m19:19:19.183909 [debug] [Thread-1  ]: SQL status: COMMIT in 0.05 seconds
[0m19:19:19.194569 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.my_first_dbt_model"
[0m19:19:19.194569 [debug] [Thread-1  ]: On model.stgo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.my_first_dbt_model"} */
drop table if exists "postgres"."public"."my_first_dbt_model__dbt_backup" cascade
[0m19:19:19.234494 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.04 seconds
[0m19:19:19.236660 [debug] [Thread-1  ]: finished collecting timing info
[0m19:19:19.236660 [debug] [Thread-1  ]: On model.stgo_dbt.my_first_dbt_model: Close
[0m19:19:19.239422 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9628140b-f1fb-4a20-8741-086a7b920390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC1811CAC0>]}
[0m19:19:19.239958 [info ] [Thread-1  ]: 1 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 2.47s]
[0m19:19:19.242951 [debug] [Thread-1  ]: Finished running node model.stgo_dbt.my_first_dbt_model
[0m19:19:19.248035 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m19:19:19.250938 [debug] [MainThread]: Using postgres connection "master"
[0m19:19:19.251936 [debug] [MainThread]: On master: BEGIN
[0m19:19:19.252934 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:19:21.304125 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:19:21.304968 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m19:19:21.305968 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m19:19:21.305968 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m19:19:21.306965 [debug] [MainThread]: Connection 'list_postgres_public_public' was properly closed.
[0m19:19:21.307522 [debug] [MainThread]: Connection 'model.stgo_dbt.my_first_dbt_model' was properly closed.
[0m19:19:21.307522 [debug] [MainThread]: Connection 'model.stgo_dbt.split_full_name' was properly closed.
[0m19:19:21.308086 [debug] [MainThread]: Connection 'model.stgo_dbt.utils' was properly closed.
[0m19:19:21.308655 [debug] [MainThread]: Flushing usage events
[0m19:19:22.482962 [info ] [MainThread]: ctrl-c


============================== 2023-01-02 19:19:31.167573 | 99308006-a636-4fef-af3c-55b684bc9540 ==============================
[0m19:19:31.167573 [info ] [MainThread]: Running with dbt=1.3.1
[0m19:19:31.168572 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'D:\\2023\\Cloudthought\\data-migration-dbt\\stgo_dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:19:31.168572 [debug] [MainThread]: Tracking: tracking
[0m19:19:31.221581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020684B8AFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020684CA83D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020684CA8820>]}
[0m19:19:31.397368 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m19:19:31.398368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '99308006-a636-4fef-af3c-55b684bc9540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020684CE08E0>]}
[0m19:19:31.541368 [debug] [MainThread]: Parsing macros\adapters.sql
[0m19:19:31.588668 [debug] [MainThread]: Parsing macros\catalog.sql
[0m19:19:31.593667 [debug] [MainThread]: Parsing macros\relations.sql
[0m19:19:31.595671 [debug] [MainThread]: Parsing macros\timestamps.sql
[0m19:19:31.598668 [debug] [MainThread]: Parsing macros\materializations\incremental_strategies.sql
[0m19:19:31.600670 [debug] [MainThread]: Parsing macros\materializations\snapshot_merge.sql
[0m19:19:31.604669 [debug] [MainThread]: Parsing macros\utils\any_value.sql
[0m19:19:31.605667 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m19:19:31.606670 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m19:19:31.618669 [debug] [MainThread]: Parsing macros\utils\last_day.sql
[0m19:19:31.621667 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m19:19:31.623669 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m19:19:31.625668 [debug] [MainThread]: Parsing macros\adapters\apply_grants.sql
[0m19:19:31.650666 [debug] [MainThread]: Parsing macros\adapters\columns.sql
[0m19:19:31.666670 [debug] [MainThread]: Parsing macros\adapters\freshness.sql
[0m19:19:31.672669 [debug] [MainThread]: Parsing macros\adapters\indexes.sql
[0m19:19:31.684668 [debug] [MainThread]: Parsing macros\adapters\metadata.sql
[0m19:19:31.824669 [debug] [MainThread]: Parsing macros\adapters\persist_docs.sql
[0m19:19:31.836672 [debug] [MainThread]: Parsing macros\adapters\relation.sql
[0m19:19:31.874668 [debug] [MainThread]: Parsing macros\adapters\schema.sql
[0m19:19:31.878667 [debug] [MainThread]: Parsing macros\adapters\timestamps.sql
[0m19:19:31.886667 [debug] [MainThread]: Parsing macros\etc\datetime.sql
[0m19:19:31.902667 [debug] [MainThread]: Parsing macros\etc\statement.sql
[0m19:19:31.946671 [debug] [MainThread]: Parsing macros\generic_test_sql\accepted_values.sql
[0m19:19:31.952669 [debug] [MainThread]: Parsing macros\generic_test_sql\not_null.sql
[0m19:19:31.955667 [debug] [MainThread]: Parsing macros\generic_test_sql\relationships.sql
[0m19:19:31.958677 [debug] [MainThread]: Parsing macros\generic_test_sql\unique.sql
[0m19:19:31.959669 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_alias.sql
[0m19:19:31.965672 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_database.sql
[0m19:19:31.971668 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_schema.sql
[0m19:19:31.982669 [debug] [MainThread]: Parsing macros\materializations\configs.sql
[0m19:19:31.990668 [debug] [MainThread]: Parsing macros\materializations\hooks.sql
[0m19:19:32.002675 [debug] [MainThread]: Parsing macros\materializations\models\incremental\column_helpers.sql
[0m19:19:32.023668 [debug] [MainThread]: Parsing macros\materializations\models\incremental\incremental.sql
[0m19:19:32.053667 [debug] [MainThread]: Parsing macros\materializations\models\incremental\is_incremental.sql
[0m19:19:32.058670 [debug] [MainThread]: Parsing macros\materializations\models\incremental\merge.sql
[0m19:19:32.092273 [debug] [MainThread]: Parsing macros\materializations\models\incremental\on_schema_change.sql
[0m19:19:32.117271 [debug] [MainThread]: Parsing macros\materializations\models\incremental\strategies.sql
[0m19:19:32.127271 [debug] [MainThread]: Parsing macros\materializations\models\table\create_table_as.sql
[0m19:19:32.132273 [debug] [MainThread]: Parsing macros\materializations\models\table\table.sql
[0m19:19:32.142275 [debug] [MainThread]: Parsing macros\materializations\models\view\create_or_replace_view.sql
[0m19:19:32.147270 [debug] [MainThread]: Parsing macros\materializations\models\view\create_view_as.sql
[0m19:19:32.153278 [debug] [MainThread]: Parsing macros\materializations\models\view\helpers.sql
[0m19:19:32.156269 [debug] [MainThread]: Parsing macros\materializations\models\view\view.sql
[0m19:19:32.169270 [debug] [MainThread]: Parsing macros\materializations\seeds\helpers.sql
[0m19:19:32.244270 [debug] [MainThread]: Parsing macros\materializations\seeds\seed.sql
[0m19:19:32.253268 [debug] [MainThread]: Parsing macros\materializations\snapshots\helpers.sql
[0m19:19:32.278271 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot.sql
[0m19:19:32.298270 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot_merge.sql
[0m19:19:32.301268 [debug] [MainThread]: Parsing macros\materializations\snapshots\strategies.sql
[0m19:19:32.339139 [debug] [MainThread]: Parsing macros\materializations\tests\helpers.sql
[0m19:19:32.341138 [debug] [MainThread]: Parsing macros\materializations\tests\test.sql
[0m19:19:32.350136 [debug] [MainThread]: Parsing macros\materializations\tests\where_subquery.sql
[0m19:19:32.353137 [debug] [MainThread]: Parsing macros\python_model\python.sql
[0m19:19:32.362136 [debug] [MainThread]: Parsing macros\utils\any_value.sql
[0m19:19:32.364134 [debug] [MainThread]: Parsing macros\utils\array_append.sql
[0m19:19:32.366136 [debug] [MainThread]: Parsing macros\utils\array_concat.sql
[0m19:19:32.368138 [debug] [MainThread]: Parsing macros\utils\array_construct.sql
[0m19:19:32.372138 [debug] [MainThread]: Parsing macros\utils\bool_or.sql
[0m19:19:32.374135 [debug] [MainThread]: Parsing macros\utils\cast_bool_to_text.sql
[0m19:19:32.376136 [debug] [MainThread]: Parsing macros\utils\concat.sql
[0m19:19:32.378135 [debug] [MainThread]: Parsing macros\utils\data_types.sql
[0m19:19:32.393136 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m19:19:32.395141 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m19:19:32.398138 [debug] [MainThread]: Parsing macros\utils\date_trunc.sql
[0m19:19:32.399137 [debug] [MainThread]: Parsing macros\utils\escape_single_quotes.sql
[0m19:19:32.402138 [debug] [MainThread]: Parsing macros\utils\except.sql
[0m19:19:32.404136 [debug] [MainThread]: Parsing macros\utils\hash.sql
[0m19:19:32.407137 [debug] [MainThread]: Parsing macros\utils\intersect.sql
[0m19:19:32.409136 [debug] [MainThread]: Parsing macros\utils\last_day.sql
[0m19:19:32.412137 [debug] [MainThread]: Parsing macros\utils\length.sql
[0m19:19:32.413136 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m19:19:32.419137 [debug] [MainThread]: Parsing macros\utils\literal.sql
[0m19:19:32.422136 [debug] [MainThread]: Parsing macros\utils\position.sql
[0m19:19:32.424136 [debug] [MainThread]: Parsing macros\utils\replace.sql
[0m19:19:32.426134 [debug] [MainThread]: Parsing macros\utils\right.sql
[0m19:19:32.429138 [debug] [MainThread]: Parsing macros\utils\safe_cast.sql
[0m19:19:32.432138 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m19:19:32.436136 [debug] [MainThread]: Parsing tests\generic\builtin.sql
[0m19:19:33.049823 [debug] [MainThread]: 1699: static parser successfully parsed my_first_dbt_model.sql
[0m19:19:33.076823 [debug] [MainThread]: 1699: static parser successfully parsed placeholder_from_airbyte.sql
[0m19:19:33.080824 [debug] [MainThread]: 1603: static parser failed on split_full_name.sql
[0m19:19:33.088823 [debug] [MainThread]: 1602: parser fallback to jinja rendering on split_full_name.sql
[0m19:19:33.090823 [debug] [MainThread]: 1699: static parser successfully parsed utils.sql
[0m19:19:33.179027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99308006-a636-4fef-af3c-55b684bc9540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020684E4CDC0>]}
[0m19:19:33.189025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '99308006-a636-4fef-af3c-55b684bc9540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002068288BAC0>]}
[0m19:19:33.190027 [info ] [MainThread]: Found 4 models, 1 test, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m19:19:33.191025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99308006-a636-4fef-af3c-55b684bc9540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020684E35F40>]}
[0m19:19:33.193025 [info ] [MainThread]: 
[0m19:19:33.195026 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m19:19:33.198026 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m19:19:33.209028 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m19:19:33.226025 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:19:33.227023 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:19:33.227023 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:19:33.227023 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:19:33.227023 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:19:33.228025 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:19:35.302719 [debug] [ThreadPool]: SQL status: SELECT 12 in 2.08 seconds
[0m19:19:35.302726 [debug] [ThreadPool]: SQL status: SELECT 12 in 2.07 seconds
[0m19:19:35.304908 [debug] [ThreadPool]: On list_postgres: Close
[0m19:19:35.306535 [debug] [ThreadPool]: On list_postgres: Close
[0m19:19:35.311031 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m19:19:35.322702 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:19:35.323702 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public_public"
[0m19:19:35.323702 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m19:19:35.326701 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m19:19:35.327701 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:19:35.327701 [debug] [ThreadPool]: On list_postgres_public_public: BEGIN
[0m19:19:35.327701 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:19:37.361365 [debug] [ThreadPool]: SQL status: BEGIN in 2.03 seconds
[0m19:19:37.361912 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_public"
[0m19:19:37.362475 [debug] [ThreadPool]: On list_postgres_public_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres_public_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
  
[0m19:19:37.370377 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.01 seconds
[0m19:19:37.372001 [debug] [ThreadPool]: On list_postgres_public_public: ROLLBACK
[0m19:19:37.374233 [debug] [ThreadPool]: On list_postgres_public_public: Close
[0m19:19:37.419634 [debug] [ThreadPool]: SQL status: BEGIN in 2.09 seconds
[0m19:19:37.420156 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:19:37.420709 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m19:19:37.426247 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
[0m19:19:37.427926 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m19:19:37.430082 [debug] [ThreadPool]: On list_postgres_public: Close
[0m19:19:37.439081 [debug] [MainThread]: Using postgres connection "master"
[0m19:19:37.439081 [debug] [MainThread]: On master: BEGIN
[0m19:19:37.439081 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:19:39.489608 [debug] [MainThread]: SQL status: BEGIN in 2.05 seconds
[0m19:19:39.490113 [debug] [MainThread]: Using postgres connection "master"
[0m19:19:39.490145 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:19:39.517013 [debug] [MainThread]: SQL status: SELECT 1 in 0.03 seconds
[0m19:19:39.519205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99308006-a636-4fef-af3c-55b684bc9540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020684E6FF10>]}
[0m19:19:39.519729 [debug] [MainThread]: On master: ROLLBACK
[0m19:19:39.521339 [debug] [MainThread]: Using postgres connection "master"
[0m19:19:39.521866 [debug] [MainThread]: On master: BEGIN
[0m19:19:39.525910 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:19:39.526449 [debug] [MainThread]: On master: COMMIT
[0m19:19:39.526999 [debug] [MainThread]: Using postgres connection "master"
[0m19:19:39.526999 [debug] [MainThread]: On master: COMMIT
[0m19:19:39.529243 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:19:39.529791 [debug] [MainThread]: On master: Close
[0m19:19:39.530860 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:19:39.531997 [info ] [MainThread]: 
[0m19:19:39.544957 [debug] [Thread-1  ]: Began running node model.stgo_dbt.my_first_dbt_model
[0m19:19:39.545483 [info ] [Thread-1  ]: 1 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m19:19:39.545483 [debug] [Thread-2  ]: Began running node model.stgo_dbt.split_full_name
[0m19:19:39.546481 [debug] [Thread-3  ]: Began running node model.stgo_dbt.utils
[0m19:19:39.548483 [info ] [Thread-2  ]: 2 of 3 START sql view model public_public.split_full_name ...................... [RUN]
[0m19:19:39.550489 [debug] [Thread-1  ]: Acquiring new postgres connection "model.stgo_dbt.my_first_dbt_model"
[0m19:19:39.551482 [info ] [Thread-3  ]: 3 of 3 START sql view model public.utils ....................................... [RUN]
[0m19:19:39.552482 [debug] [Thread-1  ]: Began compiling node model.stgo_dbt.my_first_dbt_model
[0m19:19:39.554478 [debug] [Thread-2  ]: Acquiring new postgres connection "model.stgo_dbt.split_full_name"
[0m19:19:39.554478 [debug] [Thread-1  ]: Compiling model.stgo_dbt.my_first_dbt_model
[0m19:19:39.556479 [debug] [Thread-3  ]: Acquiring new postgres connection "model.stgo_dbt.utils"
[0m19:19:39.556479 [debug] [Thread-2  ]: Began compiling node model.stgo_dbt.split_full_name
[0m19:19:39.562023 [debug] [Thread-1  ]: Writing injected SQL for node "model.stgo_dbt.my_first_dbt_model"
[0m19:19:39.563020 [debug] [Thread-3  ]: Began compiling node model.stgo_dbt.utils
[0m19:19:39.563020 [debug] [Thread-2  ]: Compiling model.stgo_dbt.split_full_name
[0m19:19:39.564030 [debug] [Thread-3  ]: Compiling model.stgo_dbt.utils
[0m19:19:39.571019 [debug] [Thread-2  ]: Writing injected SQL for node "model.stgo_dbt.split_full_name"
[0m19:19:39.575019 [debug] [Thread-3  ]: Writing injected SQL for node "model.stgo_dbt.utils"
[0m19:19:39.575019 [debug] [Thread-1  ]: finished collecting timing info
[0m19:19:39.576017 [debug] [Thread-1  ]: Began executing node model.stgo_dbt.my_first_dbt_model
[0m19:19:39.620023 [debug] [Thread-3  ]: finished collecting timing info
[0m19:19:39.636027 [debug] [Thread-2  ]: finished collecting timing info
[0m19:19:39.655533 [debug] [Thread-1  ]: Writing runtime sql for node "model.stgo_dbt.my_first_dbt_model"
[0m19:19:39.656532 [debug] [Thread-3  ]: Began executing node model.stgo_dbt.utils
[0m19:19:39.656532 [debug] [Thread-2  ]: Began executing node model.stgo_dbt.split_full_name
[0m19:19:39.689533 [debug] [Thread-3  ]: Writing runtime sql for node "model.stgo_dbt.utils"
[0m19:19:39.696532 [debug] [Thread-2  ]: Writing runtime sql for node "model.stgo_dbt.split_full_name"
[0m19:19:39.697532 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.my_first_dbt_model"
[0m19:19:39.698534 [debug] [Thread-1  ]: On model.stgo_dbt.my_first_dbt_model: BEGIN
[0m19:19:39.699533 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m19:19:39.700532 [debug] [Thread-3  ]: Using postgres connection "model.stgo_dbt.utils"
[0m19:19:39.700532 [debug] [Thread-3  ]: On model.stgo_dbt.utils: BEGIN
[0m19:19:39.700532 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m19:19:39.701533 [debug] [Thread-2  ]: Using postgres connection "model.stgo_dbt.split_full_name"
[0m19:19:39.702531 [debug] [Thread-2  ]: On model.stgo_dbt.split_full_name: BEGIN
[0m19:19:39.702531 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m19:19:41.772511 [debug] [Thread-1  ]: SQL status: BEGIN in 2.07 seconds
[0m19:19:41.773511 [debug] [Thread-2  ]: SQL status: BEGIN in 2.07 seconds
[0m19:19:41.773511 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.my_first_dbt_model"
[0m19:19:41.774511 [debug] [Thread-2  ]: Using postgres connection "model.stgo_dbt.split_full_name"
[0m19:19:41.774511 [debug] [Thread-1  ]: On model.stgo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.my_first_dbt_model"} */

  
    

  create  table "postgres"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m19:19:41.775513 [debug] [Thread-2  ]: On model.stgo_dbt.split_full_name: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.split_full_name"} */

  create view "postgres"."public_public"."split_full_name__dbt_tmp" as (
    



select
  name
from cdc_tut
  );
[0m19:19:41.777920 [debug] [Thread-3  ]: SQL status: BEGIN in 2.08 seconds
[0m19:19:41.778446 [debug] [Thread-3  ]: Using postgres connection "model.stgo_dbt.utils"
[0m19:19:41.779216 [debug] [Thread-3  ]: On model.stgo_dbt.utils: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.utils"} */

  create view "postgres"."public"."utils__dbt_tmp" as (
    create or replace function split_name(full_name varchar)
returns table (first_name varchar, last_name varchar) as $$
  select
    trim(split_part(full_name, ' ', 1)),
    trim(split_part(full_name, ' ', 2))
  from (
    select full_name
  ) t;
$$ language sql;
  );
[0m19:19:41.781610 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
[0m19:19:41.782287 [debug] [Thread-3  ]: Postgres adapter: Postgres error: syntax error at or near "create"
LINE 4:     create or replace function split_name(full_name varchar)
            ^

[0m19:19:41.782882 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.01 seconds
[0m19:19:41.794939 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.my_first_dbt_model"
[0m19:19:41.794939 [debug] [Thread-3  ]: On model.stgo_dbt.utils: ROLLBACK
[0m19:19:41.798937 [debug] [Thread-2  ]: Using postgres connection "model.stgo_dbt.split_full_name"
[0m19:19:41.799936 [debug] [Thread-1  ]: On model.stgo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m19:19:41.799936 [debug] [Thread-2  ]: On model.stgo_dbt.split_full_name: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.split_full_name"} */
alter table "postgres"."public_public"."split_full_name" rename to "split_full_name__dbt_backup"
[0m19:19:41.801937 [debug] [Thread-3  ]: finished collecting timing info
[0m19:19:41.801937 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:19:41.802936 [debug] [Thread-3  ]: On model.stgo_dbt.utils: Close
[0m19:19:41.802936 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:19:41.807946 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.my_first_dbt_model"
[0m19:19:41.813938 [debug] [Thread-2  ]: Using postgres connection "model.stgo_dbt.split_full_name"
[0m19:19:41.814938 [debug] [Thread-3  ]: Database Error in model utils (models\utils.sql)
  syntax error at or near "create"
  LINE 4:     create or replace function split_name(full_name varchar)
              ^
  compiled Code at target\run\stgo_dbt\models\utils.sql
[0m19:19:41.815939 [debug] [Thread-1  ]: On model.stgo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m19:19:41.815939 [debug] [Thread-2  ]: On model.stgo_dbt.split_full_name: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.split_full_name"} */
alter table "postgres"."public_public"."split_full_name__dbt_tmp" rename to "split_full_name"
[0m19:19:41.815939 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99308006-a636-4fef-af3c-55b684bc9540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020684EC1C10>]}
[0m19:19:41.816938 [error] [Thread-3  ]: 3 of 3 ERROR creating sql view model public.utils .............................. [[31mERROR[0m in 2.26s]
[0m19:19:41.818938 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:19:41.818938 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:19:41.853938 [debug] [Thread-3  ]: Finished running node model.stgo_dbt.utils
[0m19:19:41.863946 [debug] [Thread-1  ]: On model.stgo_dbt.my_first_dbt_model: COMMIT
[0m19:19:41.867938 [debug] [Thread-2  ]: On model.stgo_dbt.split_full_name: COMMIT
[0m19:19:41.868937 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.my_first_dbt_model"
[0m19:19:41.869938 [debug] [Thread-2  ]: Using postgres connection "model.stgo_dbt.split_full_name"
[0m19:19:41.869938 [debug] [Thread-1  ]: On model.stgo_dbt.my_first_dbt_model: COMMIT
[0m19:19:41.869938 [debug] [Thread-2  ]: On model.stgo_dbt.split_full_name: COMMIT
[0m19:19:41.949734 [debug] [Thread-1  ]: SQL status: COMMIT in 0.08 seconds
[0m19:19:41.959438 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.my_first_dbt_model"
[0m19:19:41.959955 [debug] [Thread-1  ]: On model.stgo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.my_first_dbt_model"} */
drop table if exists "postgres"."public"."my_first_dbt_model__dbt_backup" cascade
[0m19:19:41.983792 [debug] [Thread-2  ]: SQL status: COMMIT in 0.11 seconds
[0m19:19:41.987104 [debug] [Thread-2  ]: Using postgres connection "model.stgo_dbt.split_full_name"
[0m19:19:41.987642 [debug] [Thread-2  ]: On model.stgo_dbt.split_full_name: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.split_full_name"} */
drop view if exists "postgres"."public_public"."split_full_name__dbt_backup" cascade
[0m19:19:42.017938 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.06 seconds
[0m19:19:42.020662 [debug] [Thread-1  ]: finished collecting timing info
[0m19:19:42.020662 [debug] [Thread-1  ]: On model.stgo_dbt.my_first_dbt_model: Close
[0m19:19:42.022296 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99308006-a636-4fef-af3c-55b684bc9540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020684EC17C0>]}
[0m19:19:42.023347 [info ] [Thread-1  ]: 1 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 2.47s]
[0m19:19:42.025611 [debug] [Thread-1  ]: Finished running node model.stgo_dbt.my_first_dbt_model
[0m19:19:42.050726 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.06 seconds
[0m19:19:42.053727 [debug] [Thread-2  ]: finished collecting timing info
[0m19:19:42.054727 [debug] [Thread-2  ]: On model.stgo_dbt.split_full_name: Close
[0m19:19:42.055728 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99308006-a636-4fef-af3c-55b684bc9540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020684F31E20>]}
[0m19:19:42.056725 [info ] [Thread-2  ]: 2 of 3 OK created sql view model public_public.split_full_name ................. [[32mCREATE VIEW[0m in 2.50s]
[0m19:19:42.059725 [debug] [Thread-2  ]: Finished running node model.stgo_dbt.split_full_name
[0m19:19:42.063723 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m19:19:42.063723 [debug] [MainThread]: Using postgres connection "master"
[0m19:19:42.064726 [debug] [MainThread]: On master: BEGIN
[0m19:19:42.064726 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:19:44.118045 [debug] [MainThread]: SQL status: BEGIN in 2.05 seconds
[0m19:19:44.118589 [debug] [MainThread]: On master: COMMIT
[0m19:19:44.119129 [debug] [MainThread]: Using postgres connection "master"
[0m19:19:44.119129 [debug] [MainThread]: On master: COMMIT
[0m19:19:44.121373 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:19:44.121926 [debug] [MainThread]: On master: Close
[0m19:19:44.123064 [info ] [MainThread]: 
[0m19:19:44.124204 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 10.93 seconds (10.93s).
[0m19:19:44.125621 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:19:44.126223 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m19:19:44.126747 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m19:19:44.127039 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m19:19:44.127604 [debug] [MainThread]: Connection 'list_postgres_public_public' was properly closed.
[0m19:19:44.128150 [debug] [MainThread]: Connection 'model.stgo_dbt.my_first_dbt_model' was properly closed.
[0m19:19:44.128657 [debug] [MainThread]: Connection 'model.stgo_dbt.split_full_name' was properly closed.
[0m19:19:44.128701 [debug] [MainThread]: Connection 'model.stgo_dbt.utils' was properly closed.
[0m19:19:44.147865 [info ] [MainThread]: 
[0m19:19:44.148846 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:19:44.149846 [info ] [MainThread]: 
[0m19:19:44.151846 [error] [MainThread]: [33mDatabase Error in model utils (models\utils.sql)[0m
[0m19:19:44.153844 [error] [MainThread]:   syntax error at or near "create"
[0m19:19:44.154844 [error] [MainThread]:   LINE 4:     create or replace function split_name(full_name varchar)
[0m19:19:44.155846 [error] [MainThread]:               ^
[0m19:19:44.157845 [error] [MainThread]:   compiled Code at target\run\stgo_dbt\models\utils.sql
[0m19:19:44.158846 [info ] [MainThread]: 
[0m19:19:44.159843 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m19:19:44.160843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020684E7FFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020684EC12B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020684F0B220>]}
[0m19:19:44.160843 [debug] [MainThread]: Flushing usage events


============================== 2023-01-02 19:23:45.748669 | 780b36e3-c5b3-43fc-8559-40a8cc73bcd7 ==============================
[0m19:23:45.748669 [info ] [MainThread]: Running with dbt=1.3.1
[0m19:23:45.749667 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'D:\\2023\\Cloudthought\\data-migration-dbt\\stgo_dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:23:45.750668 [debug] [MainThread]: Tracking: tracking
[0m19:23:45.798184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D3FD4B730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D3FD4B310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D3A24BDC0>]}
[0m19:23:45.959919 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m19:23:45.959919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '780b36e3-c5b3-43fc-8559-40a8cc73bcd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D3A24BE50>]}
[0m19:23:46.076915 [debug] [MainThread]: Parsing macros\adapters.sql
[0m19:23:46.113917 [debug] [MainThread]: Parsing macros\catalog.sql
[0m19:23:46.117918 [debug] [MainThread]: Parsing macros\relations.sql
[0m19:23:46.119916 [debug] [MainThread]: Parsing macros\timestamps.sql
[0m19:23:46.123918 [debug] [MainThread]: Parsing macros\materializations\incremental_strategies.sql
[0m19:23:46.125921 [debug] [MainThread]: Parsing macros\materializations\snapshot_merge.sql
[0m19:23:46.127917 [debug] [MainThread]: Parsing macros\utils\any_value.sql
[0m19:23:46.128925 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m19:23:46.129919 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m19:23:46.139917 [debug] [MainThread]: Parsing macros\utils\last_day.sql
[0m19:23:46.140922 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m19:23:46.142917 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m19:23:46.144917 [debug] [MainThread]: Parsing macros\adapters\apply_grants.sql
[0m19:23:46.164923 [debug] [MainThread]: Parsing macros\adapters\columns.sql
[0m19:23:46.179926 [debug] [MainThread]: Parsing macros\adapters\freshness.sql
[0m19:23:46.182917 [debug] [MainThread]: Parsing macros\adapters\indexes.sql
[0m19:23:46.185917 [debug] [MainThread]: Parsing macros\adapters\metadata.sql
[0m19:23:46.198515 [debug] [MainThread]: Parsing macros\adapters\persist_docs.sql
[0m19:23:46.205511 [debug] [MainThread]: Parsing macros\adapters\relation.sql
[0m19:23:46.226510 [debug] [MainThread]: Parsing macros\adapters\schema.sql
[0m19:23:46.230512 [debug] [MainThread]: Parsing macros\adapters\timestamps.sql
[0m19:23:46.236036 [debug] [MainThread]: Parsing macros\etc\datetime.sql
[0m19:23:46.247035 [debug] [MainThread]: Parsing macros\etc\statement.sql
[0m19:23:46.255037 [debug] [MainThread]: Parsing macros\generic_test_sql\accepted_values.sql
[0m19:23:46.257037 [debug] [MainThread]: Parsing macros\generic_test_sql\not_null.sql
[0m19:23:46.258036 [debug] [MainThread]: Parsing macros\generic_test_sql\relationships.sql
[0m19:23:46.260035 [debug] [MainThread]: Parsing macros\generic_test_sql\unique.sql
[0m19:23:46.261036 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_alias.sql
[0m19:23:46.263036 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_database.sql
[0m19:23:46.265035 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_schema.sql
[0m19:23:46.269034 [debug] [MainThread]: Parsing macros\materializations\configs.sql
[0m19:23:46.274037 [debug] [MainThread]: Parsing macros\materializations\hooks.sql
[0m19:23:46.280035 [debug] [MainThread]: Parsing macros\materializations\models\incremental\column_helpers.sql
[0m19:23:46.293036 [debug] [MainThread]: Parsing macros\materializations\models\incremental\incremental.sql
[0m19:23:46.312036 [debug] [MainThread]: Parsing macros\materializations\models\incremental\is_incremental.sql
[0m19:23:46.315035 [debug] [MainThread]: Parsing macros\materializations\models\incremental\merge.sql
[0m19:23:46.338040 [debug] [MainThread]: Parsing macros\materializations\models\incremental\on_schema_change.sql
[0m19:23:46.359043 [debug] [MainThread]: Parsing macros\materializations\models\incremental\strategies.sql
[0m19:23:46.370037 [debug] [MainThread]: Parsing macros\materializations\models\table\create_table_as.sql
[0m19:23:46.376043 [debug] [MainThread]: Parsing macros\materializations\models\table\table.sql
[0m19:23:46.384034 [debug] [MainThread]: Parsing macros\materializations\models\view\create_or_replace_view.sql
[0m19:23:46.389038 [debug] [MainThread]: Parsing macros\materializations\models\view\create_view_as.sql
[0m19:23:46.393036 [debug] [MainThread]: Parsing macros\materializations\models\view\helpers.sql
[0m19:23:46.395038 [debug] [MainThread]: Parsing macros\materializations\models\view\view.sql
[0m19:23:46.403036 [debug] [MainThread]: Parsing macros\materializations\seeds\helpers.sql
[0m19:23:46.459915 [debug] [MainThread]: Parsing macros\materializations\seeds\seed.sql
[0m19:23:46.470917 [debug] [MainThread]: Parsing macros\materializations\snapshots\helpers.sql
[0m19:23:46.487914 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot.sql
[0m19:23:46.502917 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot_merge.sql
[0m19:23:46.505916 [debug] [MainThread]: Parsing macros\materializations\snapshots\strategies.sql
[0m19:23:46.529916 [debug] [MainThread]: Parsing macros\materializations\tests\helpers.sql
[0m19:23:46.531914 [debug] [MainThread]: Parsing macros\materializations\tests\test.sql
[0m19:23:46.539914 [debug] [MainThread]: Parsing macros\materializations\tests\where_subquery.sql
[0m19:23:46.542918 [debug] [MainThread]: Parsing macros\python_model\python.sql
[0m19:23:46.551919 [debug] [MainThread]: Parsing macros\utils\any_value.sql
[0m19:23:46.552916 [debug] [MainThread]: Parsing macros\utils\array_append.sql
[0m19:23:46.554914 [debug] [MainThread]: Parsing macros\utils\array_concat.sql
[0m19:23:46.556918 [debug] [MainThread]: Parsing macros\utils\array_construct.sql
[0m19:23:46.558918 [debug] [MainThread]: Parsing macros\utils\bool_or.sql
[0m19:23:46.560915 [debug] [MainThread]: Parsing macros\utils\cast_bool_to_text.sql
[0m19:23:46.562916 [debug] [MainThread]: Parsing macros\utils\concat.sql
[0m19:23:46.564919 [debug] [MainThread]: Parsing macros\utils\data_types.sql
[0m19:23:46.575917 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m19:23:46.578917 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m19:23:46.579917 [debug] [MainThread]: Parsing macros\utils\date_trunc.sql
[0m19:23:46.581916 [debug] [MainThread]: Parsing macros\utils\escape_single_quotes.sql
[0m19:23:46.582915 [debug] [MainThread]: Parsing macros\utils\except.sql
[0m19:23:46.584916 [debug] [MainThread]: Parsing macros\utils\hash.sql
[0m19:23:46.585916 [debug] [MainThread]: Parsing macros\utils\intersect.sql
[0m19:23:46.587917 [debug] [MainThread]: Parsing macros\utils\last_day.sql
[0m19:23:46.591915 [debug] [MainThread]: Parsing macros\utils\length.sql
[0m19:23:46.593920 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m19:23:46.596915 [debug] [MainThread]: Parsing macros\utils\literal.sql
[0m19:23:46.597916 [debug] [MainThread]: Parsing macros\utils\position.sql
[0m19:23:46.599916 [debug] [MainThread]: Parsing macros\utils\replace.sql
[0m19:23:46.601919 [debug] [MainThread]: Parsing macros\utils\right.sql
[0m19:23:46.603916 [debug] [MainThread]: Parsing macros\utils\safe_cast.sql
[0m19:23:46.605917 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m19:23:46.608914 [debug] [MainThread]: Parsing tests\generic\builtin.sql
[0m19:23:47.012539 [debug] [MainThread]: 1699: static parser successfully parsed my_first_dbt_model.sql
[0m19:23:47.033077 [debug] [MainThread]: 1699: static parser successfully parsed placeholder_from_airbyte.sql
[0m19:23:47.038062 [debug] [MainThread]: 1603: static parser failed on split_full_name.sql
[0m19:23:47.045064 [debug] [MainThread]: 1602: parser fallback to jinja rendering on split_full_name.sql
[0m19:23:47.048063 [debug] [MainThread]: 1699: static parser successfully parsed utils.sql
[0m19:23:47.139064 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stgo_dbt.placeholder_from_airbyte, my_first_dbt_model

[0m19:23:47.149071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '780b36e3-c5b3-43fc-8559-40a8cc73bcd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D3FFEFF70>]}
[0m19:23:47.172064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '780b36e3-c5b3-43fc-8559-40a8cc73bcd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D3FE655E0>]}
[0m19:23:47.173063 [info ] [MainThread]: Found 4 models, 1 test, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m19:23:47.173063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '780b36e3-c5b3-43fc-8559-40a8cc73bcd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D3FFD6F70>]}
[0m19:23:47.177067 [info ] [MainThread]: 
[0m19:23:47.179067 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m19:23:47.184069 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m19:23:47.208065 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:23:47.208065 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:23:47.209062 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:23:49.283687 [debug] [ThreadPool]: SQL status: SELECT 11 in 2.07 seconds
[0m19:23:49.286602 [debug] [ThreadPool]: On list_postgres: Close
[0m19:23:49.290194 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m19:23:49.304547 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:23:49.304547 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m19:23:49.305537 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:23:51.374143 [debug] [ThreadPool]: SQL status: BEGIN in 2.07 seconds
[0m19:23:51.374677 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:23:51.375236 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m19:23:51.381940 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
[0m19:23:51.384109 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m19:23:51.386263 [debug] [ThreadPool]: On list_postgres_public: Close
[0m19:23:51.395214 [debug] [MainThread]: Using postgres connection "master"
[0m19:23:51.395753 [debug] [MainThread]: On master: BEGIN
[0m19:23:51.395753 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:23:53.434391 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:23:53.434945 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m19:23:53.435492 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m19:23:53.435492 [debug] [MainThread]: Flushing usage events
[0m19:23:54.060023 [info ] [MainThread]: ctrl-c


============================== 2023-01-02 19:24:14.164497 | e7f38856-9c12-4191-9e08-7de2877a1cd7 ==============================
[0m19:24:14.165497 [info ] [MainThread]: Running with dbt=1.3.1
[0m19:24:14.166503 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'D:\\2023\\Cloudthought\\data-migration-dbt\\stgo_dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:24:14.166503 [debug] [MainThread]: Tracking: tracking
[0m19:24:14.218501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136C7B9B190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136C7B7ABB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136C7B9BBB0>]}
[0m19:24:14.408506 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m19:24:14.409500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e7f38856-9c12-4191-9e08-7de2877a1cd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136C7B9A340>]}
[0m19:24:14.554500 [debug] [MainThread]: Parsing macros\adapters.sql
[0m19:24:14.619501 [debug] [MainThread]: Parsing macros\catalog.sql
[0m19:24:14.623506 [debug] [MainThread]: Parsing macros\relations.sql
[0m19:24:14.626498 [debug] [MainThread]: Parsing macros\timestamps.sql
[0m19:24:14.629499 [debug] [MainThread]: Parsing macros\materializations\incremental_strategies.sql
[0m19:24:14.631499 [debug] [MainThread]: Parsing macros\materializations\snapshot_merge.sql
[0m19:24:14.633498 [debug] [MainThread]: Parsing macros\utils\any_value.sql
[0m19:24:14.634498 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m19:24:14.635498 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m19:24:14.646169 [debug] [MainThread]: Parsing macros\utils\last_day.sql
[0m19:24:14.648165 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m19:24:14.650164 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m19:24:14.652165 [debug] [MainThread]: Parsing macros\adapters\apply_grants.sql
[0m19:24:14.674166 [debug] [MainThread]: Parsing macros\adapters\columns.sql
[0m19:24:14.687166 [debug] [MainThread]: Parsing macros\adapters\freshness.sql
[0m19:24:14.689166 [debug] [MainThread]: Parsing macros\adapters\indexes.sql
[0m19:24:14.693166 [debug] [MainThread]: Parsing macros\adapters\metadata.sql
[0m19:24:14.702163 [debug] [MainThread]: Parsing macros\adapters\persist_docs.sql
[0m19:24:14.710168 [debug] [MainThread]: Parsing macros\adapters\relation.sql
[0m19:24:14.742165 [debug] [MainThread]: Parsing macros\adapters\schema.sql
[0m19:24:14.745166 [debug] [MainThread]: Parsing macros\adapters\timestamps.sql
[0m19:24:14.753170 [debug] [MainThread]: Parsing macros\etc\datetime.sql
[0m19:24:14.768165 [debug] [MainThread]: Parsing macros\etc\statement.sql
[0m19:24:14.781169 [debug] [MainThread]: Parsing macros\generic_test_sql\accepted_values.sql
[0m19:24:14.784173 [debug] [MainThread]: Parsing macros\generic_test_sql\not_null.sql
[0m19:24:14.787167 [debug] [MainThread]: Parsing macros\generic_test_sql\relationships.sql
[0m19:24:14.789165 [debug] [MainThread]: Parsing macros\generic_test_sql\unique.sql
[0m19:24:14.791165 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_alias.sql
[0m19:24:14.794172 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_database.sql
[0m19:24:14.797171 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_schema.sql
[0m19:24:14.803171 [debug] [MainThread]: Parsing macros\materializations\configs.sql
[0m19:24:14.806171 [debug] [MainThread]: Parsing macros\materializations\hooks.sql
[0m19:24:14.814173 [debug] [MainThread]: Parsing macros\materializations\models\incremental\column_helpers.sql
[0m19:24:14.826170 [debug] [MainThread]: Parsing macros\materializations\models\incremental\incremental.sql
[0m19:24:14.847168 [debug] [MainThread]: Parsing macros\materializations\models\incremental\is_incremental.sql
[0m19:24:14.849164 [debug] [MainThread]: Parsing macros\materializations\models\incremental\merge.sql
[0m19:24:14.878164 [debug] [MainThread]: Parsing macros\materializations\models\incremental\on_schema_change.sql
[0m19:24:14.908015 [debug] [MainThread]: Parsing macros\materializations\models\incremental\strategies.sql
[0m19:24:14.921016 [debug] [MainThread]: Parsing macros\materializations\models\table\create_table_as.sql
[0m19:24:14.927018 [debug] [MainThread]: Parsing macros\materializations\models\table\table.sql
[0m19:24:14.937017 [debug] [MainThread]: Parsing macros\materializations\models\view\create_or_replace_view.sql
[0m19:24:14.942017 [debug] [MainThread]: Parsing macros\materializations\models\view\create_view_as.sql
[0m19:24:14.946016 [debug] [MainThread]: Parsing macros\materializations\models\view\helpers.sql
[0m19:24:14.948017 [debug] [MainThread]: Parsing macros\materializations\models\view\view.sql
[0m19:24:14.955017 [debug] [MainThread]: Parsing macros\materializations\seeds\helpers.sql
[0m19:24:15.019016 [debug] [MainThread]: Parsing macros\materializations\seeds\seed.sql
[0m19:24:15.030014 [debug] [MainThread]: Parsing macros\materializations\snapshots\helpers.sql
[0m19:24:15.050016 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot.sql
[0m19:24:15.073016 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot_merge.sql
[0m19:24:15.075016 [debug] [MainThread]: Parsing macros\materializations\snapshots\strategies.sql
[0m19:24:15.101016 [debug] [MainThread]: Parsing macros\materializations\tests\helpers.sql
[0m19:24:15.103018 [debug] [MainThread]: Parsing macros\materializations\tests\test.sql
[0m19:24:15.111016 [debug] [MainThread]: Parsing macros\materializations\tests\where_subquery.sql
[0m19:24:15.114026 [debug] [MainThread]: Parsing macros\python_model\python.sql
[0m19:24:15.123017 [debug] [MainThread]: Parsing macros\utils\any_value.sql
[0m19:24:15.126019 [debug] [MainThread]: Parsing macros\utils\array_append.sql
[0m19:24:15.127019 [debug] [MainThread]: Parsing macros\utils\array_concat.sql
[0m19:24:15.129016 [debug] [MainThread]: Parsing macros\utils\array_construct.sql
[0m19:24:15.132015 [debug] [MainThread]: Parsing macros\utils\bool_or.sql
[0m19:24:15.134016 [debug] [MainThread]: Parsing macros\utils\cast_bool_to_text.sql
[0m19:24:15.136017 [debug] [MainThread]: Parsing macros\utils\concat.sql
[0m19:24:15.139015 [debug] [MainThread]: Parsing macros\utils\data_types.sql
[0m19:24:15.154016 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m19:24:15.157017 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m19:24:15.160017 [debug] [MainThread]: Parsing macros\utils\date_trunc.sql
[0m19:24:15.163016 [debug] [MainThread]: Parsing macros\utils\escape_single_quotes.sql
[0m19:24:15.166016 [debug] [MainThread]: Parsing macros\utils\except.sql
[0m19:24:15.168017 [debug] [MainThread]: Parsing macros\utils\hash.sql
[0m19:24:15.171207 [debug] [MainThread]: Parsing macros\utils\intersect.sql
[0m19:24:15.174192 [debug] [MainThread]: Parsing macros\utils\last_day.sql
[0m19:24:15.179193 [debug] [MainThread]: Parsing macros\utils\length.sql
[0m19:24:15.181193 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m19:24:15.188190 [debug] [MainThread]: Parsing macros\utils\literal.sql
[0m19:24:15.190190 [debug] [MainThread]: Parsing macros\utils\position.sql
[0m19:24:15.192190 [debug] [MainThread]: Parsing macros\utils\replace.sql
[0m19:24:15.196191 [debug] [MainThread]: Parsing macros\utils\right.sql
[0m19:24:15.198196 [debug] [MainThread]: Parsing macros\utils\safe_cast.sql
[0m19:24:15.200195 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m19:24:15.205190 [debug] [MainThread]: Parsing tests\generic\builtin.sql
[0m19:24:15.820156 [debug] [MainThread]: 1699: static parser successfully parsed my_first_dbt_model.sql
[0m19:24:15.841156 [debug] [MainThread]: 1699: static parser successfully parsed placeholder_from_airbyte.sql
[0m19:24:15.846155 [debug] [MainThread]: 1603: static parser failed on split_full_name.sql
[0m19:24:15.853156 [debug] [MainThread]: 1602: parser fallback to jinja rendering on split_full_name.sql
[0m19:24:15.855156 [debug] [MainThread]: 1699: static parser successfully parsed utils.sql
[0m19:24:15.962154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7f38856-9c12-4191-9e08-7de2877a1cd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136C7E3DDC0>]}
[0m19:24:15.975732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7f38856-9c12-4191-9e08-7de2877a1cd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136C7CAA5B0>]}
[0m19:24:15.976732 [info ] [MainThread]: Found 4 models, 1 test, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m19:24:15.977730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7f38856-9c12-4191-9e08-7de2877a1cd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136C7CCD1F0>]}
[0m19:24:15.979727 [info ] [MainThread]: 
[0m19:24:15.980730 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m19:24:15.984735 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m19:24:16.017729 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:24:16.018731 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:24:16.018731 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:24:18.297130 [debug] [ThreadPool]: SQL status: SELECT 11 in 2.28 seconds
[0m19:24:18.299131 [debug] [ThreadPool]: On list_postgres: Close
[0m19:24:18.304128 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m19:24:18.318133 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:24:18.319130 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m19:24:18.319130 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:24:20.373373 [debug] [ThreadPool]: SQL status: BEGIN in 2.05 seconds
[0m19:24:20.373373 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:24:20.374374 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m19:24:20.381374 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
[0m19:24:20.382374 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m19:24:20.384380 [debug] [ThreadPool]: On list_postgres_public: Close
[0m19:24:20.393376 [debug] [MainThread]: Using postgres connection "master"
[0m19:24:20.394373 [debug] [MainThread]: On master: BEGIN
[0m19:24:20.394373 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:24:22.470259 [debug] [MainThread]: SQL status: BEGIN in 2.08 seconds
[0m19:24:22.471247 [debug] [MainThread]: Using postgres connection "master"
[0m19:24:22.471247 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:24:22.497831 [debug] [MainThread]: SQL status: SELECT 0 in 0.03 seconds
[0m19:24:22.499460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7f38856-9c12-4191-9e08-7de2877a1cd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136C7CEFD90>]}
[0m19:24:22.500008 [debug] [MainThread]: On master: ROLLBACK
[0m19:24:22.502153 [debug] [MainThread]: Using postgres connection "master"
[0m19:24:22.502153 [debug] [MainThread]: On master: BEGIN
[0m19:24:22.505525 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:24:22.506065 [debug] [MainThread]: On master: COMMIT
[0m19:24:22.506610 [debug] [MainThread]: Using postgres connection "master"
[0m19:24:22.506610 [debug] [MainThread]: On master: COMMIT
[0m19:24:22.508812 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:24:22.509357 [debug] [MainThread]: On master: Close
[0m19:24:22.510466 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:24:22.511563 [info ] [MainThread]: 
[0m19:24:22.522821 [debug] [Thread-1  ]: Began running node model.stgo_dbt.my_first_dbt_model
[0m19:24:22.523375 [debug] [Thread-2  ]: Began running node model.stgo_dbt.split_full_name
[0m19:24:22.523375 [debug] [Thread-3  ]: Began running node model.stgo_dbt.utils
[0m19:24:22.523910 [info ] [Thread-1  ]: 1 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m19:24:22.524973 [info ] [Thread-2  ]: 2 of 3 START sql view model public.split_full_name ............................. [RUN]
[0m19:24:22.525972 [info ] [Thread-3  ]: 3 of 3 START sql view model public.utils ....................................... [RUN]
[0m19:24:22.529866 [debug] [Thread-1  ]: Acquiring new postgres connection "model.stgo_dbt.my_first_dbt_model"
[0m19:24:22.529866 [debug] [Thread-1  ]: Began compiling node model.stgo_dbt.my_first_dbt_model
[0m19:24:22.530865 [debug] [Thread-2  ]: Acquiring new postgres connection "model.stgo_dbt.split_full_name"
[0m19:24:22.531863 [debug] [Thread-1  ]: Compiling model.stgo_dbt.my_first_dbt_model
[0m19:24:22.532860 [debug] [Thread-2  ]: Began compiling node model.stgo_dbt.split_full_name
[0m19:24:22.533861 [debug] [Thread-3  ]: Acquiring new postgres connection "model.stgo_dbt.utils"
[0m19:24:22.541859 [debug] [Thread-1  ]: Writing injected SQL for node "model.stgo_dbt.my_first_dbt_model"
[0m19:24:22.541859 [debug] [Thread-2  ]: Compiling model.stgo_dbt.split_full_name
[0m19:24:22.541859 [debug] [Thread-3  ]: Began compiling node model.stgo_dbt.utils
[0m19:24:22.550863 [debug] [Thread-2  ]: Writing injected SQL for node "model.stgo_dbt.split_full_name"
[0m19:24:22.551860 [debug] [Thread-3  ]: Compiling model.stgo_dbt.utils
[0m19:24:22.555867 [debug] [Thread-3  ]: Writing injected SQL for node "model.stgo_dbt.utils"
[0m19:24:22.556868 [debug] [Thread-1  ]: finished collecting timing info
[0m19:24:22.557860 [debug] [Thread-1  ]: Began executing node model.stgo_dbt.my_first_dbt_model
[0m19:24:22.583758 [debug] [Thread-2  ]: finished collecting timing info
[0m19:24:22.584758 [debug] [Thread-3  ]: finished collecting timing info
[0m19:24:22.627758 [debug] [Thread-2  ]: Began executing node model.stgo_dbt.split_full_name
[0m19:24:22.645519 [debug] [Thread-1  ]: Writing runtime sql for node "model.stgo_dbt.my_first_dbt_model"
[0m19:24:22.645519 [debug] [Thread-3  ]: Began executing node model.stgo_dbt.utils
[0m19:24:22.694176 [debug] [Thread-2  ]: Writing runtime sql for node "model.stgo_dbt.split_full_name"
[0m19:24:22.706178 [debug] [Thread-3  ]: Writing runtime sql for node "model.stgo_dbt.utils"
[0m19:24:22.707177 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.my_first_dbt_model"
[0m19:24:22.710179 [debug] [Thread-2  ]: Using postgres connection "model.stgo_dbt.split_full_name"
[0m19:24:22.711178 [debug] [Thread-1  ]: On model.stgo_dbt.my_first_dbt_model: BEGIN
[0m19:24:22.712176 [debug] [Thread-2  ]: On model.stgo_dbt.split_full_name: BEGIN
[0m19:24:22.712176 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m19:24:22.713178 [debug] [Thread-3  ]: Using postgres connection "model.stgo_dbt.utils"
[0m19:24:22.713178 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m19:24:22.715176 [debug] [Thread-3  ]: On model.stgo_dbt.utils: BEGIN
[0m19:24:22.716179 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m19:24:24.755137 [debug] [Thread-1  ]: SQL status: BEGIN in 2.04 seconds
[0m19:24:24.755137 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.my_first_dbt_model"
[0m19:24:24.755137 [debug] [Thread-1  ]: On model.stgo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.my_first_dbt_model"} */

  
    

  create  table "postgres"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m19:24:24.766134 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.01 seconds
[0m19:24:24.783407 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.my_first_dbt_model"
[0m19:24:24.783976 [debug] [Thread-2  ]: SQL status: BEGIN in 2.07 seconds
[0m19:24:24.784495 [debug] [Thread-1  ]: On model.stgo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m19:24:24.785116 [debug] [Thread-2  ]: Using postgres connection "model.stgo_dbt.split_full_name"
[0m19:24:24.785637 [debug] [Thread-2  ]: On model.stgo_dbt.split_full_name: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.split_full_name"} */

  create view "postgres"."public"."split_full_name__dbt_tmp" as (
    



select
  name, 
  id as renamed_id
from cdc_tut
  );
[0m19:24:24.788366 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:24.795991 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.my_first_dbt_model"
[0m19:24:24.796539 [debug] [Thread-3  ]: SQL status: BEGIN in 2.08 seconds
[0m19:24:24.797045 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.01 seconds
[0m19:24:24.797081 [debug] [Thread-1  ]: On model.stgo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m19:24:24.797627 [debug] [Thread-3  ]: Using postgres connection "model.stgo_dbt.utils"
[0m19:24:24.801929 [debug] [Thread-2  ]: Using postgres connection "model.stgo_dbt.split_full_name"
[0m19:24:24.802672 [debug] [Thread-3  ]: On model.stgo_dbt.utils: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.utils"} */

  create view "postgres"."public"."utils__dbt_tmp" as (
    create or replace function split_name(full_name varchar)
returns table (first_name varchar, last_name varchar) as $$
  select
    trim(split_part(full_name, ' ', 1)),
    trim(split_part(full_name, ' ', 2))
  from (
    select full_name
  ) t;
$$ language sql;
  );
[0m19:24:24.803222 [debug] [Thread-2  ]: On model.stgo_dbt.split_full_name: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.split_full_name"} */
alter table "postgres"."public"."split_full_name__dbt_tmp" rename to "split_full_name"
[0m19:24:24.806555 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:24.807243 [debug] [Thread-3  ]: Postgres adapter: Postgres error: syntax error at or near "create"
LINE 4:     create or replace function split_name(full_name varchar)
            ^

[0m19:24:24.807787 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:24.850052 [debug] [Thread-1  ]: On model.stgo_dbt.my_first_dbt_model: COMMIT
[0m19:24:24.850052 [debug] [Thread-3  ]: On model.stgo_dbt.utils: ROLLBACK
[0m19:24:24.853053 [debug] [Thread-2  ]: On model.stgo_dbt.split_full_name: COMMIT
[0m19:24:24.854052 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.my_first_dbt_model"
[0m19:24:24.854052 [debug] [Thread-2  ]: Using postgres connection "model.stgo_dbt.split_full_name"
[0m19:24:24.854732 [debug] [Thread-1  ]: On model.stgo_dbt.my_first_dbt_model: COMMIT
[0m19:24:24.855256 [debug] [Thread-2  ]: On model.stgo_dbt.split_full_name: COMMIT
[0m19:24:24.856335 [debug] [Thread-3  ]: finished collecting timing info
[0m19:24:24.857127 [debug] [Thread-3  ]: On model.stgo_dbt.utils: Close
[0m19:24:24.858975 [debug] [Thread-3  ]: Database Error in model utils (models\utils.sql)
  syntax error at or near "create"
  LINE 4:     create or replace function split_name(full_name varchar)
              ^
  compiled Code at target\run\stgo_dbt\models\utils.sql
[0m19:24:24.859568 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7f38856-9c12-4191-9e08-7de2877a1cd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136C7F4CC70>]}
[0m19:24:24.860131 [error] [Thread-3  ]: 3 of 3 ERROR creating sql view model public.utils .............................. [[31mERROR[0m in 2.33s]
[0m19:24:24.864136 [debug] [Thread-3  ]: Finished running node model.stgo_dbt.utils
[0m19:24:24.888075 [debug] [Thread-2  ]: SQL status: COMMIT in 0.03 seconds
[0m19:24:24.888625 [debug] [Thread-1  ]: SQL status: COMMIT in 0.03 seconds
[0m19:24:24.899533 [debug] [Thread-2  ]: Using postgres connection "model.stgo_dbt.split_full_name"
[0m19:24:24.905055 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.my_first_dbt_model"
[0m19:24:24.906073 [debug] [Thread-2  ]: On model.stgo_dbt.split_full_name: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.split_full_name"} */
drop view if exists "postgres"."public"."split_full_name__dbt_backup" cascade
[0m19:24:24.907056 [debug] [Thread-1  ]: On model.stgo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.my_first_dbt_model"} */
drop table if exists "postgres"."public"."my_first_dbt_model__dbt_backup" cascade
[0m19:24:24.910702 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m19:24:24.914136 [debug] [Thread-2  ]: finished collecting timing info
[0m19:24:24.914672 [debug] [Thread-2  ]: On model.stgo_dbt.split_full_name: Close
[0m19:24:24.916309 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7f38856-9c12-4191-9e08-7de2877a1cd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136C7E70F10>]}
[0m19:24:24.916851 [info ] [Thread-2  ]: 2 of 3 OK created sql view model public.split_full_name ........................ [[32mCREATE VIEW[0m in 2.39s]
[0m19:24:24.919054 [debug] [Thread-2  ]: Finished running node model.stgo_dbt.split_full_name
[0m19:24:24.939531 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.03 seconds
[0m19:24:24.941730 [debug] [Thread-1  ]: finished collecting timing info
[0m19:24:24.942274 [debug] [Thread-1  ]: On model.stgo_dbt.my_first_dbt_model: Close
[0m19:24:24.944023 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7f38856-9c12-4191-9e08-7de2877a1cd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136C7EE5D30>]}
[0m19:24:24.945070 [info ] [Thread-1  ]: 1 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 2.42s]
[0m19:24:24.947416 [debug] [Thread-1  ]: Finished running node model.stgo_dbt.my_first_dbt_model
[0m19:24:24.950194 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m19:24:24.951180 [debug] [MainThread]: Using postgres connection "master"
[0m19:24:24.951180 [debug] [MainThread]: On master: BEGIN
[0m19:24:24.952178 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:24:27.029685 [debug] [MainThread]: SQL status: BEGIN in 2.08 seconds
[0m19:24:27.030684 [debug] [MainThread]: On master: COMMIT
[0m19:24:27.030684 [debug] [MainThread]: Using postgres connection "master"
[0m19:24:27.030684 [debug] [MainThread]: On master: COMMIT
[0m19:24:27.032686 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:24:27.033682 [debug] [MainThread]: On master: Close
[0m19:24:27.034683 [info ] [MainThread]: 
[0m19:24:27.035682 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 11.05 seconds (11.05s).
[0m19:24:27.037684 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:24:27.037684 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m19:24:27.038684 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m19:24:27.038684 [debug] [MainThread]: Connection 'model.stgo_dbt.my_first_dbt_model' was properly closed.
[0m19:24:27.038684 [debug] [MainThread]: Connection 'model.stgo_dbt.split_full_name' was properly closed.
[0m19:24:27.038684 [debug] [MainThread]: Connection 'model.stgo_dbt.utils' was properly closed.
[0m19:24:27.059685 [info ] [MainThread]: 
[0m19:24:27.061683 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:24:27.063684 [info ] [MainThread]: 
[0m19:24:27.064685 [error] [MainThread]: [33mDatabase Error in model utils (models\utils.sql)[0m
[0m19:24:27.065683 [error] [MainThread]:   syntax error at or near "create"
[0m19:24:27.066683 [error] [MainThread]:   LINE 4:     create or replace function split_name(full_name varchar)
[0m19:24:27.067705 [error] [MainThread]:               ^
[0m19:24:27.069709 [error] [MainThread]:   compiled Code at target\run\stgo_dbt\models\utils.sql
[0m19:24:27.072699 [info ] [MainThread]: 
[0m19:24:27.073689 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m19:24:27.075686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136C7F99910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136C7F99700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136C7F993D0>]}
[0m19:24:27.076686 [debug] [MainThread]: Flushing usage events


============================== 2023-01-02 19:26:40.251106 | 8e00c644-1a1b-4631-b625-dd3ec6dd6239 ==============================
[0m19:26:40.251106 [info ] [MainThread]: Running with dbt=1.3.1
[0m19:26:40.253108 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'D:\\2023\\Cloudthought\\data-migration-dbt\\stgo_dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'exclude': ['my_first_dbt_model'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:26:40.253108 [debug] [MainThread]: Tracking: tracking
[0m19:26:40.304108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A3F4E11C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A3F4E1A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A3F4E1130>]}
[0m19:26:40.557751 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:26:40.557751 [debug] [MainThread]: Partial parsing: updated file: stgo_dbt://models\split_full_name.sql
[0m19:26:40.580734 [debug] [MainThread]: 1603: static parser failed on split_full_name.sql
[0m19:26:40.607736 [debug] [MainThread]: 1602: parser fallback to jinja rendering on split_full_name.sql
[0m19:26:40.705734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e00c644-1a1b-4631-b625-dd3ec6dd6239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A3F4ABB80>]}
[0m19:26:40.716734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e00c644-1a1b-4631-b625-dd3ec6dd6239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A3F5FB910>]}
[0m19:26:40.717734 [info ] [MainThread]: Found 4 models, 1 test, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m19:26:40.718738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e00c644-1a1b-4631-b625-dd3ec6dd6239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A3F5FB8E0>]}
[0m19:26:40.720736 [info ] [MainThread]: 
[0m19:26:40.721736 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m19:26:40.724736 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m19:26:40.742736 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:26:40.742736 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:26:40.742736 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:26:42.798750 [debug] [ThreadPool]: SQL status: SELECT 11 in 2.06 seconds
[0m19:26:42.800750 [debug] [ThreadPool]: On list_postgres: Close
[0m19:26:42.806419 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m19:26:42.822301 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:26:42.822301 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m19:26:42.823302 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:26:44.887722 [debug] [ThreadPool]: SQL status: BEGIN in 2.06 seconds
[0m19:26:44.887722 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:26:44.888342 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m19:26:44.893982 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
[0m19:26:44.896185 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m19:26:44.898384 [debug] [ThreadPool]: On list_postgres_public: Close
[0m19:26:44.906555 [debug] [MainThread]: Using postgres connection "master"
[0m19:26:44.907099 [debug] [MainThread]: On master: BEGIN
[0m19:26:44.907757 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:26:46.994811 [debug] [MainThread]: SQL status: BEGIN in 2.09 seconds
[0m19:26:46.994811 [debug] [MainThread]: Using postgres connection "master"
[0m19:26:46.994811 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:26:47.021812 [debug] [MainThread]: SQL status: SELECT 1 in 0.03 seconds
[0m19:26:47.024812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e00c644-1a1b-4631-b625-dd3ec6dd6239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A3F4E1850>]}
[0m19:26:47.024812 [debug] [MainThread]: On master: ROLLBACK
[0m19:26:47.026810 [debug] [MainThread]: Using postgres connection "master"
[0m19:26:47.027812 [debug] [MainThread]: On master: BEGIN
[0m19:26:47.030814 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:26:47.031813 [debug] [MainThread]: On master: COMMIT
[0m19:26:47.031813 [debug] [MainThread]: Using postgres connection "master"
[0m19:26:47.032816 [debug] [MainThread]: On master: COMMIT
[0m19:26:47.034810 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:26:47.034810 [debug] [MainThread]: On master: Close
[0m19:26:47.036810 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:26:47.037813 [info ] [MainThread]: 
[0m19:26:47.048811 [debug] [Thread-1  ]: Began running node model.stgo_dbt.split_full_name
[0m19:26:47.048811 [debug] [Thread-2  ]: Began running node model.stgo_dbt.utils
[0m19:26:47.048811 [info ] [Thread-1  ]: 1 of 2 START sql table model public.split_full_name ............................ [RUN]
[0m19:26:47.049814 [info ] [Thread-2  ]: 2 of 2 START sql view model public.utils ....................................... [RUN]
[0m19:26:47.052813 [debug] [Thread-1  ]: Acquiring new postgres connection "model.stgo_dbt.split_full_name"
[0m19:26:47.053811 [debug] [Thread-1  ]: Began compiling node model.stgo_dbt.split_full_name
[0m19:26:47.053811 [debug] [Thread-1  ]: Compiling model.stgo_dbt.split_full_name
[0m19:26:47.063331 [debug] [Thread-1  ]: Writing injected SQL for node "model.stgo_dbt.split_full_name"
[0m19:26:47.064325 [debug] [Thread-2  ]: Acquiring new postgres connection "model.stgo_dbt.utils"
[0m19:26:47.064325 [debug] [Thread-2  ]: Began compiling node model.stgo_dbt.utils
[0m19:26:47.064325 [debug] [Thread-2  ]: Compiling model.stgo_dbt.utils
[0m19:26:47.067330 [debug] [Thread-2  ]: Writing injected SQL for node "model.stgo_dbt.utils"
[0m19:26:47.068329 [debug] [Thread-1  ]: finished collecting timing info
[0m19:26:47.069329 [debug] [Thread-1  ]: Began executing node model.stgo_dbt.split_full_name
[0m19:26:47.076337 [debug] [Thread-2  ]: finished collecting timing info
[0m19:26:47.123455 [debug] [Thread-2  ]: Began executing node model.stgo_dbt.utils
[0m19:26:47.147454 [debug] [Thread-1  ]: Writing runtime sql for node "model.stgo_dbt.split_full_name"
[0m19:26:47.176456 [debug] [Thread-2  ]: Writing runtime sql for node "model.stgo_dbt.utils"
[0m19:26:47.177459 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.split_full_name"
[0m19:26:47.178459 [debug] [Thread-1  ]: On model.stgo_dbt.split_full_name: BEGIN
[0m19:26:47.178459 [debug] [Thread-2  ]: Using postgres connection "model.stgo_dbt.utils"
[0m19:26:47.178459 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m19:26:47.179455 [debug] [Thread-2  ]: On model.stgo_dbt.utils: BEGIN
[0m19:26:47.179455 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m19:26:49.242801 [debug] [Thread-1  ]: SQL status: BEGIN in 2.06 seconds
[0m19:26:49.243336 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.split_full_name"
[0m19:26:49.243878 [debug] [Thread-1  ]: On model.stgo_dbt.split_full_name: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.split_full_name"} */

  
    

  create  table "postgres"."public"."split_full_name__dbt_tmp"
  as (
    



select
  name, 
  id as renamed_id
from cdc_tut
  );
  
[0m19:26:49.254440 [debug] [Thread-2  ]: SQL status: BEGIN in 2.07 seconds
[0m19:26:49.254976 [debug] [Thread-2  ]: Using postgres connection "model.stgo_dbt.utils"
[0m19:26:49.255555 [debug] [Thread-2  ]: On model.stgo_dbt.utils: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.utils"} */

  create view "postgres"."public"."utils__dbt_tmp" as (
    create or replace function split_name(full_name varchar)
returns table (first_name varchar, last_name varchar) as $$
  select
    trim(split_part(full_name, ' ', 1)),
    trim(split_part(full_name, ' ', 2))
  from (
    select full_name
  ) t;
$$ language sql;
  );
[0m19:26:49.258314 [debug] [Thread-2  ]: Postgres adapter: Postgres error: syntax error at or near "create"
LINE 4:     create or replace function split_name(full_name varchar)
            ^

[0m19:26:49.258314 [debug] [Thread-2  ]: On model.stgo_dbt.utils: ROLLBACK
[0m19:26:49.260494 [debug] [Thread-2  ]: finished collecting timing info
[0m19:26:49.261027 [debug] [Thread-2  ]: On model.stgo_dbt.utils: Close
[0m19:26:49.262137 [debug] [Thread-2  ]: Database Error in model utils (models\utils.sql)
  syntax error at or near "create"
  LINE 4:     create or replace function split_name(full_name varchar)
              ^
  compiled Code at target\run\stgo_dbt\models\utils.sql
[0m19:26:49.262552 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e00c644-1a1b-4631-b625-dd3ec6dd6239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A3F3F9A30>]}
[0m19:26:49.263672 [error] [Thread-2  ]: 2 of 2 ERROR creating sql view model public.utils .............................. [[31mERROR[0m in 2.20s]
[0m19:26:49.265308 [debug] [Thread-2  ]: Finished running node model.stgo_dbt.utils
[0m19:26:49.332526 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.09 seconds
[0m19:26:49.346529 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.split_full_name"
[0m19:26:49.346529 [debug] [Thread-1  ]: On model.stgo_dbt.split_full_name: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.split_full_name"} */
alter table "postgres"."public"."split_full_name" rename to "split_full_name__dbt_backup"
[0m19:26:49.349531 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:26:49.358426 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.split_full_name"
[0m19:26:49.358426 [debug] [Thread-1  ]: On model.stgo_dbt.split_full_name: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.split_full_name"} */
alter table "postgres"."public"."split_full_name__dbt_tmp" rename to "split_full_name"
[0m19:26:49.361117 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:26:49.380642 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.split_full_name"
[0m19:26:49.381631 [debug] [Thread-1  ]: On model.stgo_dbt.split_full_name: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.split_full_name"} */

    create unique index if not exists
  "8aef7f2a89266fe505c163465bf4f8f0"
  on "postgres"."public"."split_full_name" 
  (_airbyte_unique_key);
  
[0m19:26:49.397878 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "_airbyte_unique_key" does not exist

[0m19:26:49.398400 [debug] [Thread-1  ]: On model.stgo_dbt.split_full_name: ROLLBACK
[0m19:26:49.400056 [debug] [Thread-1  ]: finished collecting timing info
[0m19:26:49.400573 [debug] [Thread-1  ]: On model.stgo_dbt.split_full_name: Close
[0m19:26:49.402337 [debug] [Thread-1  ]: Database Error in model split_full_name (models\split_full_name.sql)
  column "_airbyte_unique_key" does not exist
  compiled Code at target\run\stgo_dbt\models\split_full_name.sql
[0m19:26:49.403247 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e00c644-1a1b-4631-b625-dd3ec6dd6239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A3F773B80>]}
[0m19:26:49.403929 [error] [Thread-1  ]: 1 of 2 ERROR creating sql table model public.split_full_name ................... [[31mERROR[0m in 2.35s]
[0m19:26:49.406142 [debug] [Thread-1  ]: Finished running node model.stgo_dbt.split_full_name
[0m19:26:49.408336 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m19:26:49.408875 [debug] [MainThread]: Using postgres connection "master"
[0m19:26:49.409417 [debug] [MainThread]: On master: BEGIN
[0m19:26:49.409417 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:26:51.481527 [debug] [MainThread]: SQL status: BEGIN in 2.07 seconds
[0m19:26:51.482066 [debug] [MainThread]: On master: COMMIT
[0m19:26:51.482066 [debug] [MainThread]: Using postgres connection "master"
[0m19:26:51.482623 [debug] [MainThread]: On master: COMMIT
[0m19:26:51.484588 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:26:51.485124 [debug] [MainThread]: On master: Close
[0m19:26:51.486752 [info ] [MainThread]: 
[0m19:26:51.487864 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 10.77 seconds (10.77s).
[0m19:26:51.489760 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:26:51.490296 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m19:26:51.490296 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m19:26:51.490820 [debug] [MainThread]: Connection 'model.stgo_dbt.split_full_name' was properly closed.
[0m19:26:51.490820 [debug] [MainThread]: Connection 'model.stgo_dbt.utils' was properly closed.
[0m19:26:51.504834 [info ] [MainThread]: 
[0m19:26:51.505837 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m19:26:51.507836 [info ] [MainThread]: 
[0m19:26:51.508834 [error] [MainThread]: [33mDatabase Error in model utils (models\utils.sql)[0m
[0m19:26:51.510836 [error] [MainThread]:   syntax error at or near "create"
[0m19:26:51.512835 [error] [MainThread]:   LINE 4:     create or replace function split_name(full_name varchar)
[0m19:26:51.514835 [error] [MainThread]:               ^
[0m19:26:51.515833 [error] [MainThread]:   compiled Code at target\run\stgo_dbt\models\utils.sql
[0m19:26:51.516835 [info ] [MainThread]: 
[0m19:26:51.517836 [error] [MainThread]: [33mDatabase Error in model split_full_name (models\split_full_name.sql)[0m
[0m19:26:51.518837 [error] [MainThread]:   column "_airbyte_unique_key" does not exist
[0m19:26:51.519835 [error] [MainThread]:   compiled Code at target\run\stgo_dbt\models\split_full_name.sql
[0m19:26:51.522856 [info ] [MainThread]: 
[0m19:26:51.524839 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m19:26:51.526837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A3F4C1490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A3F4CA850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A3F4BE2B0>]}
[0m19:26:51.527837 [debug] [MainThread]: Flushing usage events


============================== 2023-01-02 19:28:39.665043 | a432b098-4e9e-469d-a172-2b5436eeb62c ==============================
[0m19:28:39.665043 [info ] [MainThread]: Running with dbt=1.3.1
[0m19:28:39.666043 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'D:\\2023\\Cloudthought\\data-migration-dbt\\stgo_dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'exclude': ['my_first_dbt_model'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:28:39.666043 [debug] [MainThread]: Tracking: tracking
[0m19:28:39.713045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001729E2711C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001729E271AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001729E271130>]}
[0m19:28:39.943292 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:28:39.943292 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:28:39.954289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a432b098-4e9e-469d-a172-2b5436eeb62c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001729E3DB970>]}
[0m19:28:39.966292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a432b098-4e9e-469d-a172-2b5436eeb62c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001729E330B80>]}
[0m19:28:39.966292 [info ] [MainThread]: Found 4 models, 1 test, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m19:28:39.967289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a432b098-4e9e-469d-a172-2b5436eeb62c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001729E330AC0>]}
[0m19:28:39.969291 [info ] [MainThread]: 
[0m19:28:39.971297 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m19:28:39.973296 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m19:28:39.995294 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:28:39.996289 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:28:39.996289 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:28:42.077888 [debug] [ThreadPool]: SQL status: SELECT 11 in 2.08 seconds
[0m19:28:42.079513 [debug] [ThreadPool]: On list_postgres: Close
[0m19:28:42.083025 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m19:28:42.091729 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:28:42.092282 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m19:28:42.092816 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:28:44.161936 [debug] [ThreadPool]: SQL status: BEGIN in 2.07 seconds
[0m19:28:44.162580 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:28:44.162580 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m19:28:44.170310 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.01 seconds
[0m19:28:44.172471 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m19:28:44.175247 [debug] [ThreadPool]: On list_postgres_public: Close
[0m19:28:44.186455 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:44.186988 [debug] [MainThread]: On master: BEGIN
[0m19:28:44.187532 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:28:46.262112 [debug] [MainThread]: SQL status: BEGIN in 2.07 seconds
[0m19:28:46.262638 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:46.262691 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:28:46.291305 [debug] [MainThread]: SQL status: SELECT 0 in 0.03 seconds
[0m19:28:46.293544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a432b098-4e9e-469d-a172-2b5436eeb62c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001729E330A00>]}
[0m19:28:46.294092 [debug] [MainThread]: On master: ROLLBACK
[0m19:28:46.296278 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:46.296815 [debug] [MainThread]: On master: BEGIN
[0m19:28:46.300978 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:28:46.301633 [debug] [MainThread]: On master: COMMIT
[0m19:28:46.301633 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:46.302174 [debug] [MainThread]: On master: COMMIT
[0m19:28:46.304406 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:28:46.304979 [debug] [MainThread]: On master: Close
[0m19:28:46.306207 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:28:46.307313 [info ] [MainThread]: 
[0m19:28:46.323223 [debug] [Thread-1  ]: Began running node model.stgo_dbt.split_full_name
[0m19:28:46.324224 [debug] [Thread-2  ]: Began running node model.stgo_dbt.utils
[0m19:28:46.325224 [info ] [Thread-1  ]: 1 of 2 START sql table model public.split_full_name ............................ [RUN]
[0m19:28:46.326223 [info ] [Thread-2  ]: 2 of 2 START sql view model public.utils ....................................... [RUN]
[0m19:28:46.328227 [debug] [Thread-1  ]: Acquiring new postgres connection "model.stgo_dbt.split_full_name"
[0m19:28:46.329226 [debug] [Thread-1  ]: Began compiling node model.stgo_dbt.split_full_name
[0m19:28:46.330230 [debug] [Thread-1  ]: Compiling model.stgo_dbt.split_full_name
[0m19:28:46.383225 [debug] [Thread-2  ]: Acquiring new postgres connection "model.stgo_dbt.utils"
[0m19:28:46.389222 [debug] [Thread-1  ]: Writing injected SQL for node "model.stgo_dbt.split_full_name"
[0m19:28:46.390221 [debug] [Thread-2  ]: Began compiling node model.stgo_dbt.utils
[0m19:28:46.390221 [debug] [Thread-2  ]: Compiling model.stgo_dbt.utils
[0m19:28:46.395226 [debug] [Thread-2  ]: Writing injected SQL for node "model.stgo_dbt.utils"
[0m19:28:46.395226 [debug] [Thread-1  ]: finished collecting timing info
[0m19:28:46.396226 [debug] [Thread-1  ]: Began executing node model.stgo_dbt.split_full_name
[0m19:28:46.407222 [debug] [Thread-2  ]: finished collecting timing info
[0m19:28:46.455222 [debug] [Thread-2  ]: Began executing node model.stgo_dbt.utils
[0m19:28:46.466231 [debug] [Thread-1  ]: Writing runtime sql for node "model.stgo_dbt.split_full_name"
[0m19:28:46.498223 [debug] [Thread-2  ]: Writing runtime sql for node "model.stgo_dbt.utils"
[0m19:28:46.500223 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.split_full_name"
[0m19:28:46.500223 [debug] [Thread-1  ]: On model.stgo_dbt.split_full_name: BEGIN
[0m19:28:46.501222 [debug] [Thread-2  ]: Using postgres connection "model.stgo_dbt.utils"
[0m19:28:46.501222 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m19:28:46.501222 [debug] [Thread-2  ]: On model.stgo_dbt.utils: BEGIN
[0m19:28:46.502301 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m19:28:48.577419 [debug] [Thread-1  ]: SQL status: BEGIN in 2.08 seconds
[0m19:28:48.577419 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.split_full_name"
[0m19:28:48.578006 [debug] [Thread-1  ]: On model.stgo_dbt.split_full_name: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.split_full_name"} */

  
    

  create  table "postgres"."public"."split_full_name__dbt_tmp"
  as (
    



select
  name, 
  id as renamed_id
from cdc_tut
  );
  
[0m19:28:48.579609 [debug] [Thread-2  ]: SQL status: BEGIN in 2.08 seconds
[0m19:28:48.579609 [debug] [Thread-2  ]: Using postgres connection "model.stgo_dbt.utils"
[0m19:28:48.580309 [debug] [Thread-2  ]: On model.stgo_dbt.utils: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.utils"} */

  create view "postgres"."public"."utils__dbt_tmp" as (
    create or replace function split_name(full_name varchar)
returns table (first_name varchar, last_name varchar) as $$
  select
    trim(split_part(full_name, ' ', 1)),
    trim(split_part(full_name, ' ', 2))
  from (
    select full_name
  ) t;
$$ language sql;
  );
[0m19:28:48.583527 [debug] [Thread-2  ]: Postgres adapter: Postgres error: syntax error at or near "create"
LINE 4:     create or replace function split_name(full_name varchar)
            ^

[0m19:28:48.584082 [debug] [Thread-2  ]: On model.stgo_dbt.utils: ROLLBACK
[0m19:28:48.586315 [debug] [Thread-2  ]: finished collecting timing info
[0m19:28:48.586871 [debug] [Thread-2  ]: On model.stgo_dbt.utils: Close
[0m19:28:48.587960 [debug] [Thread-2  ]: Database Error in model utils (models\utils.sql)
  syntax error at or near "create"
  LINE 4:     create or replace function split_name(full_name varchar)
              ^
  compiled Code at target\run\stgo_dbt\models\utils.sql
[0m19:28:48.588510 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a432b098-4e9e-469d-a172-2b5436eeb62c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001729E229220>]}
[0m19:28:48.589058 [error] [Thread-2  ]: 2 of 2 ERROR creating sql view model public.utils .............................. [[31mERROR[0m in 2.21s]
[0m19:28:48.590667 [debug] [Thread-2  ]: Finished running node model.stgo_dbt.utils
[0m19:28:48.686391 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.11 seconds
[0m19:28:48.696135 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.split_full_name"
[0m19:28:48.696178 [debug] [Thread-1  ]: On model.stgo_dbt.split_full_name: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.split_full_name"} */
alter table "postgres"."public"."split_full_name__dbt_tmp" rename to "split_full_name"
[0m19:28:48.698368 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:28:48.718226 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.split_full_name"
[0m19:28:48.718226 [debug] [Thread-1  ]: On model.stgo_dbt.split_full_name: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.split_full_name"} */

    create unique index if not exists
  "380ce0a86901469ab7f20ed377b87e51"
  on "postgres"."public"."split_full_name" 
  (_airbyte_unique_key);
  
[0m19:28:48.722226 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "_airbyte_unique_key" does not exist

[0m19:28:48.723229 [debug] [Thread-1  ]: On model.stgo_dbt.split_full_name: ROLLBACK
[0m19:28:48.725228 [debug] [Thread-1  ]: finished collecting timing info
[0m19:28:48.725228 [debug] [Thread-1  ]: On model.stgo_dbt.split_full_name: Close
[0m19:28:48.727230 [debug] [Thread-1  ]: Database Error in model split_full_name (models\split_full_name.sql)
  column "_airbyte_unique_key" does not exist
  compiled Code at target\run\stgo_dbt\models\split_full_name.sql
[0m19:28:48.727230 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a432b098-4e9e-469d-a172-2b5436eeb62c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001729E467220>]}
[0m19:28:48.728227 [error] [Thread-1  ]: 1 of 2 ERROR creating sql table model public.split_full_name ................... [[31mERROR[0m in 2.40s]
[0m19:28:48.730228 [debug] [Thread-1  ]: Finished running node model.stgo_dbt.split_full_name
[0m19:28:48.733228 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m19:28:48.733228 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:48.734227 [debug] [MainThread]: On master: BEGIN
[0m19:28:48.734227 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:28:50.790944 [debug] [MainThread]: SQL status: BEGIN in 2.06 seconds
[0m19:28:50.791518 [debug] [MainThread]: On master: COMMIT
[0m19:28:50.792105 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:50.792105 [debug] [MainThread]: On master: COMMIT
[0m19:28:50.794337 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:28:50.794888 [debug] [MainThread]: On master: Close
[0m19:28:50.796022 [info ] [MainThread]: 
[0m19:28:50.796544 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 10.83 seconds (10.83s).
[0m19:28:50.798472 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:28:50.799027 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m19:28:50.799570 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m19:28:50.799570 [debug] [MainThread]: Connection 'model.stgo_dbt.split_full_name' was properly closed.
[0m19:28:50.799570 [debug] [MainThread]: Connection 'model.stgo_dbt.utils' was properly closed.
[0m19:28:50.816043 [info ] [MainThread]: 
[0m19:28:50.818042 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m19:28:50.819043 [info ] [MainThread]: 
[0m19:28:50.821045 [error] [MainThread]: [33mDatabase Error in model utils (models\utils.sql)[0m
[0m19:28:50.823042 [error] [MainThread]:   syntax error at or near "create"
[0m19:28:50.824043 [error] [MainThread]:   LINE 4:     create or replace function split_name(full_name varchar)
[0m19:28:50.825045 [error] [MainThread]:               ^
[0m19:28:50.826046 [error] [MainThread]:   compiled Code at target\run\stgo_dbt\models\utils.sql
[0m19:28:50.827045 [info ] [MainThread]: 
[0m19:28:50.829044 [error] [MainThread]: [33mDatabase Error in model split_full_name (models\split_full_name.sql)[0m
[0m19:28:50.830062 [error] [MainThread]:   column "_airbyte_unique_key" does not exist
[0m19:28:50.832042 [error] [MainThread]:   compiled Code at target\run\stgo_dbt\models\split_full_name.sql
[0m19:28:50.833043 [info ] [MainThread]: 
[0m19:28:50.835042 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m19:28:50.838042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001729E4A0D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001729E4A07F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001729E4A0D90>]}
[0m19:28:50.838042 [debug] [MainThread]: Flushing usage events


============================== 2023-01-02 19:29:46.357603 | d57e1a82-dfc2-4993-b65f-24574ec40326 ==============================
[0m19:29:46.357603 [info ] [MainThread]: Running with dbt=1.3.1
[0m19:29:46.358596 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'D:\\2023\\Cloudthought\\data-migration-dbt\\stgo_dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'exclude': ['my_first_dbt_model'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:29:46.358596 [debug] [MainThread]: Tracking: tracking
[0m19:29:46.416267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229AB0311C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229AB031A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229AB031130>]}
[0m19:29:46.570260 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:29:46.572262 [debug] [MainThread]: Partial parsing: updated file: stgo_dbt://models\split_full_name.sql
[0m19:29:46.601262 [debug] [MainThread]: 1603: static parser failed on split_full_name.sql
[0m19:29:46.638986 [debug] [MainThread]: 1602: parser fallback to jinja rendering on split_full_name.sql
[0m19:29:46.754985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd57e1a82-dfc2-4993-b65f-24574ec40326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229AAFFB9A0>]}
[0m19:29:46.768984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd57e1a82-dfc2-4993-b65f-24574ec40326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229AB14B910>]}
[0m19:29:46.769984 [info ] [MainThread]: Found 4 models, 1 test, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m19:29:46.775985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd57e1a82-dfc2-4993-b65f-24574ec40326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229AB14B8E0>]}
[0m19:29:46.780986 [info ] [MainThread]: 
[0m19:29:46.783986 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m19:29:46.789992 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m19:29:46.821989 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:29:46.821989 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:29:46.822983 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:29:48.894388 [debug] [ThreadPool]: SQL status: SELECT 11 in 2.07 seconds
[0m19:29:48.896881 [debug] [ThreadPool]: On list_postgres: Close
[0m19:29:48.900180 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m19:29:48.911306 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:29:48.912306 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m19:29:48.912306 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:29:50.981217 [debug] [ThreadPool]: SQL status: BEGIN in 2.07 seconds
[0m19:29:50.982070 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:29:50.982641 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m19:29:50.998336 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.01 seconds
[0m19:29:51.000868 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m19:29:51.004626 [debug] [ThreadPool]: On list_postgres_public: Close
[0m19:29:51.026416 [debug] [MainThread]: Using postgres connection "master"
[0m19:29:51.026416 [debug] [MainThread]: On master: BEGIN
[0m19:29:51.027600 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:29:53.105529 [debug] [MainThread]: SQL status: BEGIN in 2.08 seconds
[0m19:29:53.105529 [debug] [MainThread]: Using postgres connection "master"
[0m19:29:53.106529 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:29:53.143921 [debug] [MainThread]: SQL status: SELECT 0 in 0.04 seconds
[0m19:29:53.146693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd57e1a82-dfc2-4993-b65f-24574ec40326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229AB031850>]}
[0m19:29:53.147239 [debug] [MainThread]: On master: ROLLBACK
[0m19:29:53.149402 [debug] [MainThread]: Using postgres connection "master"
[0m19:29:53.149922 [debug] [MainThread]: On master: BEGIN
[0m19:29:53.153918 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:29:53.153918 [debug] [MainThread]: On master: COMMIT
[0m19:29:53.154917 [debug] [MainThread]: Using postgres connection "master"
[0m19:29:53.154917 [debug] [MainThread]: On master: COMMIT
[0m19:29:53.156922 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:29:53.156922 [debug] [MainThread]: On master: Close
[0m19:29:53.157918 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:29:53.159919 [info ] [MainThread]: 
[0m19:29:53.170919 [debug] [Thread-1  ]: Began running node model.stgo_dbt.split_full_name
[0m19:29:53.170919 [debug] [Thread-2  ]: Began running node model.stgo_dbt.utils
[0m19:29:53.171918 [info ] [Thread-1  ]: 1 of 2 START sql table model public.split_full_name ............................ [RUN]
[0m19:29:53.171918 [info ] [Thread-2  ]: 2 of 2 START sql view model public.utils ....................................... [RUN]
[0m19:29:53.173918 [debug] [Thread-1  ]: Acquiring new postgres connection "model.stgo_dbt.split_full_name"
[0m19:29:53.174920 [debug] [Thread-1  ]: Began compiling node model.stgo_dbt.split_full_name
[0m19:29:53.175918 [debug] [Thread-2  ]: Acquiring new postgres connection "model.stgo_dbt.utils"
[0m19:29:53.176924 [debug] [Thread-1  ]: Compiling model.stgo_dbt.split_full_name
[0m19:29:53.176924 [debug] [Thread-2  ]: Began compiling node model.stgo_dbt.utils
[0m19:29:53.181921 [debug] [Thread-1  ]: Writing injected SQL for node "model.stgo_dbt.split_full_name"
[0m19:29:53.181921 [debug] [Thread-2  ]: Compiling model.stgo_dbt.utils
[0m19:29:53.185919 [debug] [Thread-2  ]: Writing injected SQL for node "model.stgo_dbt.utils"
[0m19:29:53.186919 [debug] [Thread-1  ]: finished collecting timing info
[0m19:29:53.186919 [debug] [Thread-1  ]: Began executing node model.stgo_dbt.split_full_name
[0m19:29:53.200918 [debug] [Thread-2  ]: finished collecting timing info
[0m19:29:53.231919 [debug] [Thread-2  ]: Began executing node model.stgo_dbt.utils
[0m19:29:53.328552 [debug] [Thread-1  ]: Writing runtime sql for node "model.stgo_dbt.split_full_name"
[0m19:29:53.368552 [debug] [Thread-2  ]: Writing runtime sql for node "model.stgo_dbt.utils"
[0m19:29:53.369552 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.split_full_name"
[0m19:29:53.369552 [debug] [Thread-1  ]: On model.stgo_dbt.split_full_name: BEGIN
[0m19:29:53.370553 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m19:29:53.371551 [debug] [Thread-2  ]: Using postgres connection "model.stgo_dbt.utils"
[0m19:29:53.371551 [debug] [Thread-2  ]: On model.stgo_dbt.utils: BEGIN
[0m19:29:53.372553 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m19:29:55.451303 [debug] [Thread-2  ]: SQL status: BEGIN in 2.08 seconds
[0m19:29:55.451303 [debug] [Thread-2  ]: Using postgres connection "model.stgo_dbt.utils"
[0m19:29:55.452303 [debug] [Thread-2  ]: On model.stgo_dbt.utils: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.utils"} */

  create view "postgres"."public"."utils__dbt_tmp" as (
    create or replace function split_name(full_name varchar)
returns table (first_name varchar, last_name varchar) as $$
  select
    trim(split_part(full_name, ' ', 1)),
    trim(split_part(full_name, ' ', 2))
  from (
    select full_name
  ) t;
$$ language sql;
  );
[0m19:29:55.453306 [debug] [Thread-1  ]: SQL status: BEGIN in 2.08 seconds
[0m19:29:55.454303 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.split_full_name"
[0m19:29:55.454303 [debug] [Thread-1  ]: On model.stgo_dbt.split_full_name: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.split_full_name"} */

  
    

  create  table "postgres"."public"."split_full_name__dbt_tmp"
  as (
    



select
  name, 
  id as renamed_id
from cdc_tut
  );
  
[0m19:29:55.455303 [debug] [Thread-2  ]: Postgres adapter: Postgres error: syntax error at or near "create"
LINE 4:     create or replace function split_name(full_name varchar)
            ^

[0m19:29:55.456306 [debug] [Thread-2  ]: On model.stgo_dbt.utils: ROLLBACK
[0m19:29:55.458305 [debug] [Thread-2  ]: finished collecting timing info
[0m19:29:55.459308 [debug] [Thread-2  ]: On model.stgo_dbt.utils: Close
[0m19:29:55.460311 [debug] [Thread-2  ]: Database Error in model utils (models\utils.sql)
  syntax error at or near "create"
  LINE 4:     create or replace function split_name(full_name varchar)
              ^
  compiled Code at target\run\stgo_dbt\models\utils.sql
[0m19:29:55.461302 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd57e1a82-dfc2-4993-b65f-24574ec40326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229AAF420D0>]}
[0m19:29:55.461302 [error] [Thread-2  ]: 2 of 2 ERROR creating sql view model public.utils .............................. [[31mERROR[0m in 2.29s]
[0m19:29:55.464306 [debug] [Thread-2  ]: Finished running node model.stgo_dbt.utils
[0m19:29:55.544080 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.09 seconds
[0m19:29:55.558551 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.split_full_name"
[0m19:29:55.558551 [debug] [Thread-1  ]: On model.stgo_dbt.split_full_name: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.split_full_name"} */
alter table "postgres"."public"."split_full_name__dbt_tmp" rename to "split_full_name"
[0m19:29:55.563734 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:29:55.639108 [debug] [Thread-1  ]: On model.stgo_dbt.split_full_name: COMMIT
[0m19:29:55.640118 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.split_full_name"
[0m19:29:55.642114 [debug] [Thread-1  ]: On model.stgo_dbt.split_full_name: COMMIT
[0m19:29:55.677145 [debug] [Thread-1  ]: SQL status: COMMIT in 0.03 seconds
[0m19:29:55.689502 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.split_full_name"
[0m19:29:55.690481 [debug] [Thread-1  ]: On model.stgo_dbt.split_full_name: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.split_full_name"} */
drop table if exists "postgres"."public"."split_full_name__dbt_backup" cascade
[0m19:29:55.694560 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m19:29:55.698162 [debug] [Thread-1  ]: finished collecting timing info
[0m19:29:55.698639 [debug] [Thread-1  ]: On model.stgo_dbt.split_full_name: Close
[0m19:29:55.700326 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd57e1a82-dfc2-4993-b65f-24574ec40326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229AAF42D60>]}
[0m19:29:55.701325 [info ] [Thread-1  ]: 1 of 2 OK created sql table model public.split_full_name ....................... [[32mSELECT 3[0m in 2.53s]
[0m19:29:55.705326 [debug] [Thread-1  ]: Finished running node model.stgo_dbt.split_full_name
[0m19:29:55.711326 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m19:29:55.712325 [debug] [MainThread]: Using postgres connection "master"
[0m19:29:55.712325 [debug] [MainThread]: On master: BEGIN
[0m19:29:55.713327 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:29:57.797854 [debug] [MainThread]: SQL status: BEGIN in 2.08 seconds
[0m19:29:57.798408 [debug] [MainThread]: On master: COMMIT
[0m19:29:57.798961 [debug] [MainThread]: Using postgres connection "master"
[0m19:29:57.799549 [debug] [MainThread]: On master: COMMIT
[0m19:29:57.801705 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:29:57.802260 [debug] [MainThread]: On master: Close
[0m19:29:57.803354 [info ] [MainThread]: 
[0m19:29:57.804967 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 11.02 seconds (11.02s).
[0m19:29:57.806493 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:29:57.806493 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m19:29:57.807487 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m19:29:57.807487 [debug] [MainThread]: Connection 'model.stgo_dbt.split_full_name' was properly closed.
[0m19:29:57.808485 [debug] [MainThread]: Connection 'model.stgo_dbt.utils' was properly closed.
[0m19:29:57.821554 [info ] [MainThread]: 
[0m19:29:57.823552 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:29:57.824554 [info ] [MainThread]: 
[0m19:29:57.826552 [error] [MainThread]: [33mDatabase Error in model utils (models\utils.sql)[0m
[0m19:29:57.827555 [error] [MainThread]:   syntax error at or near "create"
[0m19:29:57.828553 [error] [MainThread]:   LINE 4:     create or replace function split_name(full_name varchar)
[0m19:29:57.829747 [error] [MainThread]:               ^
[0m19:29:57.831327 [error] [MainThread]:   compiled Code at target\run\stgo_dbt\models\utils.sql
[0m19:29:57.832283 [info ] [MainThread]: 
[0m19:29:57.834675 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m19:29:57.836474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229AAF49640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229AB0E9670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229AB00F6A0>]}
[0m19:29:57.837688 [debug] [MainThread]: Flushing usage events


============================== 2023-01-02 19:30:40.212216 | 69355cb2-7671-4600-b14e-b0f6d685717d ==============================
[0m19:30:40.212216 [info ] [MainThread]: Running with dbt=1.3.1
[0m19:30:40.213216 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'D:\\2023\\Cloudthought\\data-migration-dbt\\stgo_dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'exclude': ['my_first_dbt_model', 'utils'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:30:40.214216 [debug] [MainThread]: Tracking: tracking
[0m19:30:40.264068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD20AA11C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD20AA1AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD20AA1130>]}
[0m19:30:40.596358 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:30:40.597357 [debug] [MainThread]: Partial parsing: updated file: stgo_dbt://models\split_full_name.sql
[0m19:30:40.618357 [debug] [MainThread]: 1603: static parser failed on split_full_name.sql
[0m19:30:40.643354 [debug] [MainThread]: 1602: parser fallback to jinja rendering on split_full_name.sql
[0m19:30:40.744489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '69355cb2-7671-4600-b14e-b0f6d685717d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD209B8070>]}
[0m19:30:40.756490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '69355cb2-7671-4600-b14e-b0f6d685717d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD20BD0FA0>]}
[0m19:30:40.757492 [info ] [MainThread]: Found 4 models, 1 test, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m19:30:40.758491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69355cb2-7671-4600-b14e-b0f6d685717d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD20BBC910>]}
[0m19:30:40.760489 [info ] [MainThread]: 
[0m19:30:40.761488 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m19:30:40.764490 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m19:30:40.795494 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:30:40.795494 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:30:40.796494 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:30:42.882076 [debug] [ThreadPool]: SQL status: SELECT 11 in 2.09 seconds
[0m19:30:42.884078 [debug] [ThreadPool]: On list_postgres: Close
[0m19:30:42.888081 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m19:30:42.899079 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:30:42.899079 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m19:30:42.900077 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:30:44.946113 [debug] [ThreadPool]: SQL status: BEGIN in 2.05 seconds
[0m19:30:44.946661 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:30:44.947208 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m19:30:44.959459 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
[0m19:30:44.961626 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m19:30:44.963944 [debug] [ThreadPool]: On list_postgres_public: Close
[0m19:30:44.974400 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:44.975037 [debug] [MainThread]: On master: BEGIN
[0m19:30:44.975037 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:30:47.022745 [debug] [MainThread]: SQL status: BEGIN in 2.05 seconds
[0m19:30:47.023286 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:47.023882 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:30:47.048851 [debug] [MainThread]: SQL status: SELECT 0 in 0.02 seconds
[0m19:30:47.051584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69355cb2-7671-4600-b14e-b0f6d685717d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD209B8730>]}
[0m19:30:47.052124 [debug] [MainThread]: On master: ROLLBACK
[0m19:30:47.054318 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:47.054858 [debug] [MainThread]: On master: BEGIN
[0m19:30:47.058127 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:30:47.058697 [debug] [MainThread]: On master: COMMIT
[0m19:30:47.058697 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:47.059240 [debug] [MainThread]: On master: COMMIT
[0m19:30:47.060870 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:30:47.061415 [debug] [MainThread]: On master: Close
[0m19:30:47.062476 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:30:47.063893 [info ] [MainThread]: 
[0m19:30:47.074023 [debug] [Thread-1  ]: Began running node model.stgo_dbt.split_full_name
[0m19:30:47.074023 [info ] [Thread-1  ]: 1 of 1 START sql table model public.split_full_name ............................ [RUN]
[0m19:30:47.078026 [debug] [Thread-1  ]: Acquiring new postgres connection "model.stgo_dbt.split_full_name"
[0m19:30:47.079024 [debug] [Thread-1  ]: Began compiling node model.stgo_dbt.split_full_name
[0m19:30:47.079024 [debug] [Thread-1  ]: Compiling model.stgo_dbt.split_full_name
[0m19:30:47.086027 [debug] [Thread-1  ]: Writing injected SQL for node "model.stgo_dbt.split_full_name"
[0m19:30:47.087026 [debug] [Thread-1  ]: finished collecting timing info
[0m19:30:47.088026 [debug] [Thread-1  ]: Began executing node model.stgo_dbt.split_full_name
[0m19:30:47.174024 [debug] [Thread-1  ]: Writing runtime sql for node "model.stgo_dbt.split_full_name"
[0m19:30:47.177023 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.split_full_name"
[0m19:30:47.177023 [debug] [Thread-1  ]: On model.stgo_dbt.split_full_name: BEGIN
[0m19:30:47.178024 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m19:30:49.230936 [debug] [Thread-1  ]: SQL status: BEGIN in 2.05 seconds
[0m19:30:49.231481 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.split_full_name"
[0m19:30:49.231481 [debug] [Thread-1  ]: On model.stgo_dbt.split_full_name: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.split_full_name"} */

  
    

  create  table "postgres"."public"."split_full_name__dbt_tmp"
  as (
    



create or replace function split_name(full_name varchar)
returns table (first_name varchar, last_name varchar) as $$
  select
    trim(split_part(full_name, ' ', 1)),
    trim(split_part(full_name, ' ', 2))
  from (
    select full_name
  ) t;
$$ language sql;

select
  name, 
  id as renamed_id,
  split_name(name) as (first_name, last_name)
from cdc_tut
  );
  
[0m19:30:49.234351 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "create"
LINE 12: create or replace function split_name(full_name varchar)
         ^

[0m19:30:49.234893 [debug] [Thread-1  ]: On model.stgo_dbt.split_full_name: ROLLBACK
[0m19:30:49.237213 [debug] [Thread-1  ]: finished collecting timing info
[0m19:30:49.237742 [debug] [Thread-1  ]: On model.stgo_dbt.split_full_name: Close
[0m19:30:49.239085 [debug] [Thread-1  ]: Database Error in model split_full_name (models\split_full_name.sql)
  syntax error at or near "create"
  LINE 12: create or replace function split_name(full_name varchar)
           ^
  compiled Code at target\run\stgo_dbt\models\split_full_name.sql
[0m19:30:49.239646 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69355cb2-7671-4600-b14e-b0f6d685717d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD209B13A0>]}
[0m19:30:49.240734 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model public.split_full_name ................... [[31mERROR[0m in 2.16s]
[0m19:30:49.242414 [debug] [Thread-1  ]: Finished running node model.stgo_dbt.split_full_name
[0m19:30:49.245202 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m19:30:49.245758 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:49.245758 [debug] [MainThread]: On master: BEGIN
[0m19:30:49.246308 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:30:51.299321 [debug] [MainThread]: SQL status: BEGIN in 2.05 seconds
[0m19:30:51.299864 [debug] [MainThread]: On master: COMMIT
[0m19:30:51.300465 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:51.301017 [debug] [MainThread]: On master: COMMIT
[0m19:30:51.303297 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:30:51.303880 [debug] [MainThread]: On master: Close
[0m19:30:51.305736 [info ] [MainThread]: 
[0m19:30:51.306974 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.54 seconds (10.54s).
[0m19:30:51.308923 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:30:51.309585 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m19:30:51.310204 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m19:30:51.310728 [debug] [MainThread]: Connection 'model.stgo_dbt.split_full_name' was properly closed.
[0m19:30:51.328927 [info ] [MainThread]: 
[0m19:30:51.330931 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:30:51.334930 [info ] [MainThread]: 
[0m19:30:51.335927 [error] [MainThread]: [33mDatabase Error in model split_full_name (models\split_full_name.sql)[0m
[0m19:30:51.337937 [error] [MainThread]:   syntax error at or near "create"
[0m19:30:51.338936 [error] [MainThread]:   LINE 12: create or replace function split_name(full_name varchar)
[0m19:30:51.339930 [error] [MainThread]:            ^
[0m19:30:51.340929 [error] [MainThread]:   compiled Code at target\run\stgo_dbt\models\split_full_name.sql
[0m19:30:51.342926 [info ] [MainThread]: 
[0m19:30:51.345927 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:30:51.347937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD20BD0CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD20C0B2E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD20D28D60>]}
[0m19:30:51.349929 [debug] [MainThread]: Flushing usage events


============================== 2023-01-02 19:32:48.306906 | c58f4c2d-fa01-4413-9e71-7a651d29bef0 ==============================
[0m19:32:48.306906 [info ] [MainThread]: Running with dbt=1.3.1
[0m19:32:48.307906 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'D:\\2023\\Cloudthought\\data-migration-dbt\\stgo_dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'exclude': ['my_first_dbt_model', 'utils'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:32:48.308908 [debug] [MainThread]: Tracking: tracking
[0m19:32:48.372982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209171F06D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209171F0670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209171F05E0>]}
[0m19:32:48.627575 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:32:48.628574 [debug] [MainThread]: Partial parsing: updated file: stgo_dbt://models\split_full_name.sql
[0m19:32:48.651575 [debug] [MainThread]: 1603: static parser failed on split_full_name.sql
[0m19:32:48.674575 [debug] [MainThread]: 1602: parser fallback to jinja rendering on split_full_name.sql
[0m19:32:48.806653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c58f4c2d-fa01-4413-9e71-7a651d29bef0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020917369820>]}
[0m19:32:48.822650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c58f4c2d-fa01-4413-9e71-7a651d29bef0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002091732B8E0>]}
[0m19:32:48.823652 [info ] [MainThread]: Found 4 models, 1 test, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m19:32:48.824659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c58f4c2d-fa01-4413-9e71-7a651d29bef0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020913BDEAC0>]}
[0m19:32:48.826653 [info ] [MainThread]: 
[0m19:32:48.829653 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m19:32:48.832654 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m19:32:48.852653 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:32:48.852653 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:32:48.852653 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:32:50.944597 [debug] [ThreadPool]: SQL status: SELECT 11 in 2.09 seconds
[0m19:32:50.946204 [debug] [ThreadPool]: On list_postgres: Close
[0m19:32:50.950231 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m19:32:50.958743 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:32:50.958743 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m19:32:50.959803 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:32:53.045150 [debug] [ThreadPool]: SQL status: BEGIN in 2.09 seconds
[0m19:32:53.046139 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:32:53.046139 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m19:32:53.051137 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m19:32:53.053141 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m19:32:53.055138 [debug] [ThreadPool]: On list_postgres_public: Close
[0m19:32:53.064139 [debug] [MainThread]: Using postgres connection "master"
[0m19:32:53.064139 [debug] [MainThread]: On master: BEGIN
[0m19:32:53.064139 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:32:55.130593 [debug] [MainThread]: SQL status: BEGIN in 2.07 seconds
[0m19:32:55.131111 [debug] [MainThread]: Using postgres connection "master"
[0m19:32:55.131131 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:32:55.159640 [debug] [MainThread]: SQL status: SELECT 0 in 0.03 seconds
[0m19:32:55.161808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c58f4c2d-fa01-4413-9e71-7a651d29bef0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020914D6D5E0>]}
[0m19:32:55.162345 [debug] [MainThread]: On master: ROLLBACK
[0m19:32:55.165097 [debug] [MainThread]: Using postgres connection "master"
[0m19:32:55.165606 [debug] [MainThread]: On master: BEGIN
[0m19:32:55.170076 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:32:55.170643 [debug] [MainThread]: On master: COMMIT
[0m19:32:55.170643 [debug] [MainThread]: Using postgres connection "master"
[0m19:32:55.171164 [debug] [MainThread]: On master: COMMIT
[0m19:32:55.173499 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:32:55.174035 [debug] [MainThread]: On master: Close
[0m19:32:55.175718 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:32:55.177382 [info ] [MainThread]: 
[0m19:32:55.188374 [debug] [Thread-1  ]: Began running node model.stgo_dbt.split_full_name
[0m19:32:55.189377 [info ] [Thread-1  ]: 1 of 1 START sql table model public.split_full_name ............................ [RUN]
[0m19:32:55.192373 [debug] [Thread-1  ]: Acquiring new postgres connection "model.stgo_dbt.split_full_name"
[0m19:32:55.193384 [debug] [Thread-1  ]: Began compiling node model.stgo_dbt.split_full_name
[0m19:32:55.193384 [debug] [Thread-1  ]: Compiling model.stgo_dbt.split_full_name
[0m19:32:55.200396 [debug] [Thread-1  ]: Writing injected SQL for node "model.stgo_dbt.split_full_name"
[0m19:32:55.203377 [debug] [Thread-1  ]: finished collecting timing info
[0m19:32:55.204373 [debug] [Thread-1  ]: Began executing node model.stgo_dbt.split_full_name
[0m19:32:55.327427 [debug] [Thread-1  ]: Writing runtime sql for node "model.stgo_dbt.split_full_name"
[0m19:32:55.329425 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.split_full_name"
[0m19:32:55.330425 [debug] [Thread-1  ]: On model.stgo_dbt.split_full_name: BEGIN
[0m19:32:55.330425 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m19:32:57.409599 [debug] [Thread-1  ]: SQL status: BEGIN in 2.08 seconds
[0m19:32:57.409599 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.split_full_name"
[0m19:32:57.410598 [debug] [Thread-1  ]: On model.stgo_dbt.split_full_name: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.split_full_name"} */

  
    

  create  table "postgres"."public"."split_full_name__dbt_tmp"
  as (
    
create or replace function split_name(full_name varchar)
returns table (first_name varchar, last_name varchar) as $$
  select
    trim(split_part(full_name, ' ', 1)),
    trim(split_part(full_name, ' ', 2))
  from (
    select full_name
  ) t;
$$ language sql;




select
  name, 
  id as renamed_id,
  split_name(name) as (first_name, last_name)
from cdc_tut
  );
  
[0m19:32:57.412600 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "create"
LINE 9: create or replace function split_name(full_name varchar)
        ^

[0m19:32:57.413599 [debug] [Thread-1  ]: On model.stgo_dbt.split_full_name: ROLLBACK
[0m19:32:57.416117 [debug] [Thread-1  ]: finished collecting timing info
[0m19:32:57.416669 [debug] [Thread-1  ]: On model.stgo_dbt.split_full_name: Close
[0m19:32:57.418519 [debug] [Thread-1  ]: Database Error in model split_full_name (models\split_full_name.sql)
  syntax error at or near "create"
  LINE 9: create or replace function split_name(full_name varchar)
          ^
  compiled Code at target\run\stgo_dbt\models\split_full_name.sql
[0m19:32:57.419062 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c58f4c2d-fa01-4413-9e71-7a651d29bef0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020917211580>]}
[0m19:32:57.419613 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model public.split_full_name ................... [[31mERROR[0m in 2.23s]
[0m19:32:57.421674 [debug] [Thread-1  ]: Finished running node model.stgo_dbt.split_full_name
[0m19:32:57.424672 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m19:32:57.425670 [debug] [MainThread]: Using postgres connection "master"
[0m19:32:57.425670 [debug] [MainThread]: On master: BEGIN
[0m19:32:57.426672 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:32:59.489147 [debug] [MainThread]: SQL status: BEGIN in 2.06 seconds
[0m19:32:59.489670 [debug] [MainThread]: On master: COMMIT
[0m19:32:59.489724 [debug] [MainThread]: Using postgres connection "master"
[0m19:32:59.490274 [debug] [MainThread]: On master: COMMIT
[0m19:32:59.492461 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:32:59.493010 [debug] [MainThread]: On master: Close
[0m19:32:59.494160 [info ] [MainThread]: 
[0m19:32:59.495764 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.67 seconds (10.67s).
[0m19:32:59.497262 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:32:59.497802 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m19:32:59.498323 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m19:32:59.498597 [debug] [MainThread]: Connection 'model.stgo_dbt.split_full_name' was properly closed.
[0m19:32:59.513807 [info ] [MainThread]: 
[0m19:32:59.514810 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:32:59.516808 [info ] [MainThread]: 
[0m19:32:59.517808 [error] [MainThread]: [33mDatabase Error in model split_full_name (models\split_full_name.sql)[0m
[0m19:32:59.519809 [error] [MainThread]:   syntax error at or near "create"
[0m19:32:59.520810 [error] [MainThread]:   LINE 9: create or replace function split_name(full_name varchar)
[0m19:32:59.521810 [error] [MainThread]:           ^
[0m19:32:59.523810 [error] [MainThread]:   compiled Code at target\run\stgo_dbt\models\split_full_name.sql
[0m19:32:59.525819 [info ] [MainThread]: 
[0m19:32:59.527809 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:32:59.530814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209171E58B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002091733FD30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020917369BB0>]}
[0m19:32:59.530814 [debug] [MainThread]: Flushing usage events


============================== 2023-01-02 19:36:06.447683 | c5e57db4-cd10-4574-8765-3fb1b11427ea ==============================
[0m19:36:06.447683 [info ] [MainThread]: Running with dbt=1.3.1
[0m19:36:06.448684 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'D:\\2023\\Cloudthought\\data-migration-dbt\\stgo_dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'exclude': ['my_first_dbt_model', 'utils'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:36:06.449684 [debug] [MainThread]: Tracking: tracking
[0m19:36:06.498377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F403F2520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F403F22B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F403F2490>]}
[0m19:36:06.796506 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:36:06.797505 [debug] [MainThread]: Partial parsing: updated file: stgo_dbt://models\split_full_name.sql
[0m19:36:06.821503 [debug] [MainThread]: 1603: static parser failed on split_full_name.sql
[0m19:36:06.849503 [debug] [MainThread]: 1602: parser fallback to jinja rendering on split_full_name.sql
[0m19:36:06.941503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c5e57db4-cd10-4574-8765-3fb1b11427ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F403BB1F0>]}
[0m19:36:06.951505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c5e57db4-cd10-4574-8765-3fb1b11427ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F4050B910>]}
[0m19:36:06.952504 [info ] [MainThread]: Found 4 models, 1 test, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m19:36:06.953502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5e57db4-cd10-4574-8765-3fb1b11427ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F4050B8E0>]}
[0m19:36:06.955506 [info ] [MainThread]: 
[0m19:36:06.957505 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m19:36:06.959506 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m19:36:06.985510 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:36:06.985510 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:36:06.985510 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:36:09.050361 [debug] [ThreadPool]: SQL status: SELECT 11 in 2.06 seconds
[0m19:36:09.053734 [debug] [ThreadPool]: On list_postgres: Close
[0m19:36:09.057544 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m19:36:09.070490 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:36:09.070490 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m19:36:09.071490 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:36:11.131822 [debug] [ThreadPool]: SQL status: BEGIN in 2.06 seconds
[0m19:36:11.131822 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:36:11.132371 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m19:36:11.138738 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
[0m19:36:11.140506 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m19:36:11.143335 [debug] [ThreadPool]: On list_postgres_public: Close
[0m19:36:11.154543 [debug] [MainThread]: Using postgres connection "master"
[0m19:36:11.155125 [debug] [MainThread]: On master: BEGIN
[0m19:36:11.155125 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:36:13.237899 [debug] [MainThread]: SQL status: BEGIN in 2.08 seconds
[0m19:36:13.237899 [debug] [MainThread]: Using postgres connection "master"
[0m19:36:13.238896 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:36:13.265495 [debug] [MainThread]: SQL status: SELECT 0 in 0.03 seconds
[0m19:36:13.267659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5e57db4-cd10-4574-8765-3fb1b11427ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F4051FBE0>]}
[0m19:36:13.268206 [debug] [MainThread]: On master: ROLLBACK
[0m19:36:13.269867 [debug] [MainThread]: Using postgres connection "master"
[0m19:36:13.270470 [debug] [MainThread]: On master: BEGIN
[0m19:36:13.275104 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:36:13.275672 [debug] [MainThread]: On master: COMMIT
[0m19:36:13.276214 [debug] [MainThread]: Using postgres connection "master"
[0m19:36:13.276722 [debug] [MainThread]: On master: COMMIT
[0m19:36:13.278594 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:36:13.279131 [debug] [MainThread]: On master: Close
[0m19:36:13.280226 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:36:13.281811 [info ] [MainThread]: 
[0m19:36:13.294625 [debug] [Thread-1  ]: Began running node model.stgo_dbt.split_full_name
[0m19:36:13.295623 [info ] [Thread-1  ]: 1 of 1 START sql table model public.split_full_name ............................ [RUN]
[0m19:36:13.297627 [debug] [Thread-1  ]: Acquiring new postgres connection "model.stgo_dbt.split_full_name"
[0m19:36:13.298665 [debug] [Thread-1  ]: Began compiling node model.stgo_dbt.split_full_name
[0m19:36:13.298665 [debug] [Thread-1  ]: Compiling model.stgo_dbt.split_full_name
[0m19:36:13.306623 [debug] [Thread-1  ]: Writing injected SQL for node "model.stgo_dbt.split_full_name"
[0m19:36:13.309625 [debug] [Thread-1  ]: finished collecting timing info
[0m19:36:13.309625 [debug] [Thread-1  ]: Began executing node model.stgo_dbt.split_full_name
[0m19:36:13.403153 [debug] [Thread-1  ]: Writing runtime sql for node "model.stgo_dbt.split_full_name"
[0m19:36:13.404155 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.split_full_name"
[0m19:36:13.405152 [debug] [Thread-1  ]: On model.stgo_dbt.split_full_name: BEGIN
[0m19:36:13.405152 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m19:36:15.460755 [debug] [Thread-1  ]: SQL status: BEGIN in 2.06 seconds
[0m19:36:15.461279 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.split_full_name"
[0m19:36:15.461824 [debug] [Thread-1  ]: On model.stgo_dbt.split_full_name: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.split_full_name"} */

  
    

  create  table "postgres"."public"."split_full_name__dbt_tmp"
  as (
    




select
  name, 
  id as renamed_id,
  SUBSTRING(name, 1, CHARINDEX(' ', name) - 1) AS first_name,     
  SUBSTRING(name, CHARINDEX(' ', name) + 1, LEN(name) - CHARINDEX(' ', name)) AS last_name
from cdc_tut
  );
  
[0m19:36:15.465822 [debug] [Thread-1  ]: Postgres adapter: Postgres error: function charindex(unknown, text) does not exist
LINE 16:   SUBSTRING(name, 1, CHARINDEX(' ', name) - 1) AS first_name...
                              ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m19:36:15.466224 [debug] [Thread-1  ]: On model.stgo_dbt.split_full_name: ROLLBACK
[0m19:36:15.468942 [debug] [Thread-1  ]: finished collecting timing info
[0m19:36:15.469494 [debug] [Thread-1  ]: On model.stgo_dbt.split_full_name: Close
[0m19:36:15.470589 [debug] [Thread-1  ]: Database Error in model split_full_name (models\split_full_name.sql)
  function charindex(unknown, text) does not exist
  LINE 16:   SUBSTRING(name, 1, CHARINDEX(' ', name) - 1) AS first_name...
                                ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target\run\stgo_dbt\models\split_full_name.sql
[0m19:36:15.471112 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5e57db4-cd10-4574-8765-3fb1b11427ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F403CFFA0>]}
[0m19:36:15.472219 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model public.split_full_name ................... [[31mERROR[0m in 2.17s]
[0m19:36:15.475245 [debug] [Thread-1  ]: Finished running node model.stgo_dbt.split_full_name
[0m19:36:15.478455 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m19:36:15.479014 [debug] [MainThread]: Using postgres connection "master"
[0m19:36:15.479519 [debug] [MainThread]: On master: BEGIN
[0m19:36:15.479551 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:36:17.553149 [debug] [MainThread]: SQL status: BEGIN in 2.07 seconds
[0m19:36:17.553687 [debug] [MainThread]: On master: COMMIT
[0m19:36:17.553687 [debug] [MainThread]: Using postgres connection "master"
[0m19:36:17.554236 [debug] [MainThread]: On master: COMMIT
[0m19:36:17.556473 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:36:17.557009 [debug] [MainThread]: On master: Close
[0m19:36:17.558691 [info ] [MainThread]: 
[0m19:36:17.559829 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.60 seconds (10.60s).
[0m19:36:17.560926 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:36:17.560926 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m19:36:17.562441 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m19:36:17.562460 [debug] [MainThread]: Connection 'model.stgo_dbt.split_full_name' was properly closed.
[0m19:36:17.578937 [info ] [MainThread]: 
[0m19:36:17.580955 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:36:17.582724 [info ] [MainThread]: 
[0m19:36:17.583701 [error] [MainThread]: [33mDatabase Error in model split_full_name (models\split_full_name.sql)[0m
[0m19:36:17.585697 [error] [MainThread]:   function charindex(unknown, text) does not exist
[0m19:36:17.587775 [error] [MainThread]:   LINE 16:   SUBSTRING(name, 1, CHARINDEX(' ', name) - 1) AS first_name...
[0m19:36:17.588773 [error] [MainThread]:                                 ^
[0m19:36:17.589774 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[0m19:36:17.590778 [error] [MainThread]:   compiled Code at target\run\stgo_dbt\models\split_full_name.sql
[0m19:36:17.591773 [info ] [MainThread]: 
[0m19:36:17.592773 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:36:17.594788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F4051FDF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F403F2520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F4067B820>]}
[0m19:36:17.594788 [debug] [MainThread]: Flushing usage events


============================== 2023-01-02 19:40:57.054235 | 7f538deb-edc4-45a3-ac93-a551c5bd632c ==============================
[0m19:40:57.054235 [info ] [MainThread]: Running with dbt=1.3.1
[0m19:40:57.056234 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'D:\\2023\\Cloudthought\\data-migration-dbt\\stgo_dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'exclude': ['my_first_dbt_model', 'utils'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:40:57.057235 [debug] [MainThread]: Tracking: tracking
[0m19:40:57.104238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016ABC272580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016ABC2722E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016ABC272610>]}
[0m19:40:57.359805 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:40:57.360803 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:40:57.369805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7f538deb-edc4-45a3-ac93-a551c5bd632c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016ABC4FC0D0>]}
[0m19:40:57.381805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7f538deb-edc4-45a3-ac93-a551c5bd632c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016ABC449CA0>]}
[0m19:40:57.382807 [info ] [MainThread]: Found 4 models, 1 test, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m19:40:57.383803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f538deb-edc4-45a3-ac93-a551c5bd632c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016ABC449A60>]}
[0m19:40:57.385803 [info ] [MainThread]: 
[0m19:40:57.386804 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m19:40:57.389806 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m19:40:57.410806 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:40:57.411804 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:40:57.411804 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:40:59.496360 [debug] [ThreadPool]: SQL status: SELECT 11 in 2.08 seconds
[0m19:40:59.498023 [debug] [ThreadPool]: On list_postgres: Close
[0m19:40:59.501346 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m19:40:59.512559 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:40:59.512559 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m19:40:59.512559 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:41:01.580595 [debug] [ThreadPool]: SQL status: BEGIN in 2.07 seconds
[0m19:41:01.581143 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:41:01.581143 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m19:41:01.587151 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
[0m19:41:01.589864 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m19:41:01.591996 [debug] [ThreadPool]: On list_postgres_public: Close
[0m19:41:01.600289 [debug] [MainThread]: Using postgres connection "master"
[0m19:41:01.600289 [debug] [MainThread]: On master: BEGIN
[0m19:41:01.600831 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:41:03.688063 [debug] [MainThread]: SQL status: BEGIN in 2.09 seconds
[0m19:41:03.688612 [debug] [MainThread]: Using postgres connection "master"
[0m19:41:03.689164 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:41:03.715423 [debug] [MainThread]: SQL status: SELECT 0 in 0.03 seconds
[0m19:41:03.718316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f538deb-edc4-45a3-ac93-a551c5bd632c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016ABC449880>]}
[0m19:41:03.718878 [debug] [MainThread]: On master: ROLLBACK
[0m19:41:03.721075 [debug] [MainThread]: Using postgres connection "master"
[0m19:41:03.721075 [debug] [MainThread]: On master: BEGIN
[0m19:41:03.725173 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:41:03.725700 [debug] [MainThread]: On master: COMMIT
[0m19:41:03.726247 [debug] [MainThread]: Using postgres connection "master"
[0m19:41:03.726247 [debug] [MainThread]: On master: COMMIT
[0m19:41:03.728441 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:41:03.728990 [debug] [MainThread]: On master: Close
[0m19:41:03.730714 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:41:03.731796 [info ] [MainThread]: 
[0m19:41:03.745814 [debug] [Thread-1  ]: Began running node model.stgo_dbt.split_full_name
[0m19:41:03.746820 [info ] [Thread-1  ]: 1 of 1 START sql table model public.split_full_name ............................ [RUN]
[0m19:41:03.748813 [debug] [Thread-1  ]: Acquiring new postgres connection "model.stgo_dbt.split_full_name"
[0m19:41:03.749812 [debug] [Thread-1  ]: Began compiling node model.stgo_dbt.split_full_name
[0m19:41:03.749812 [debug] [Thread-1  ]: Compiling model.stgo_dbt.split_full_name
[0m19:41:03.808813 [debug] [Thread-1  ]: Writing injected SQL for node "model.stgo_dbt.split_full_name"
[0m19:41:03.810814 [debug] [Thread-1  ]: finished collecting timing info
[0m19:41:03.811811 [debug] [Thread-1  ]: Began executing node model.stgo_dbt.split_full_name
[0m19:41:03.881424 [debug] [Thread-1  ]: Writing runtime sql for node "model.stgo_dbt.split_full_name"
[0m19:41:03.882426 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.split_full_name"
[0m19:41:03.883426 [debug] [Thread-1  ]: On model.stgo_dbt.split_full_name: BEGIN
[0m19:41:03.883426 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m19:41:05.954115 [debug] [Thread-1  ]: SQL status: BEGIN in 2.07 seconds
[0m19:41:05.954115 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.split_full_name"
[0m19:41:05.954656 [debug] [Thread-1  ]: On model.stgo_dbt.split_full_name: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.split_full_name"} */

  
    

  create  table "postgres"."public"."split_full_name__dbt_tmp"
  as (
    




select
  name, 
  id as renamed_id,
  SUBSTRING(name, 1, CHARINDEX(' ', name) - 1) AS first_name,     
  SUBSTRING(name, CHARINDEX(' ', name) + 1, LEN(name) - CHARINDEX(' ', name)) AS last_name
from cdc_tut
  );
  
[0m19:41:05.957675 [debug] [Thread-1  ]: Postgres adapter: Postgres error: function charindex(unknown, text) does not exist
LINE 16:   SUBSTRING(name, 1, CHARINDEX(' ', name) - 1) AS first_name...
                              ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m19:41:05.958249 [debug] [Thread-1  ]: On model.stgo_dbt.split_full_name: ROLLBACK
[0m19:41:05.961074 [debug] [Thread-1  ]: finished collecting timing info
[0m19:41:05.961586 [debug] [Thread-1  ]: On model.stgo_dbt.split_full_name: Close
[0m19:41:05.962708 [debug] [Thread-1  ]: Database Error in model split_full_name (models\split_full_name.sql)
  function charindex(unknown, text) does not exist
  LINE 16:   SUBSTRING(name, 1, CHARINDEX(' ', name) - 1) AS first_name...
                                ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target\run\stgo_dbt\models\split_full_name.sql
[0m19:41:05.963258 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f538deb-edc4-45a3-ac93-a551c5bd632c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016ABC5858B0>]}
[0m19:41:05.963869 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model public.split_full_name ................... [[31mERROR[0m in 2.22s]
[0m19:41:05.966087 [debug] [Thread-1  ]: Finished running node model.stgo_dbt.split_full_name
[0m19:41:05.968330 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m19:41:05.968872 [debug] [MainThread]: Using postgres connection "master"
[0m19:41:05.969413 [debug] [MainThread]: On master: BEGIN
[0m19:41:05.969975 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:41:08.030623 [debug] [MainThread]: SQL status: BEGIN in 2.06 seconds
[0m19:41:08.031171 [debug] [MainThread]: On master: COMMIT
[0m19:41:08.031696 [debug] [MainThread]: Using postgres connection "master"
[0m19:41:08.031696 [debug] [MainThread]: On master: COMMIT
[0m19:41:08.033934 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:41:08.034484 [debug] [MainThread]: On master: Close
[0m19:41:08.035581 [info ] [MainThread]: 
[0m19:41:08.037252 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.65 seconds (10.65s).
[0m19:41:08.039115 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:41:08.039115 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m19:41:08.039774 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m19:41:08.040325 [debug] [MainThread]: Connection 'model.stgo_dbt.split_full_name' was properly closed.
[0m19:41:08.055661 [info ] [MainThread]: 
[0m19:41:08.057655 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:41:08.059653 [info ] [MainThread]: 
[0m19:41:08.061653 [error] [MainThread]: [33mDatabase Error in model split_full_name (models\split_full_name.sql)[0m
[0m19:41:08.062654 [error] [MainThread]:   function charindex(unknown, text) does not exist
[0m19:41:08.065201 [error] [MainThread]:   LINE 16:   SUBSTRING(name, 1, CHARINDEX(' ', name) - 1) AS first_name...
[0m19:41:08.066180 [error] [MainThread]:                                 ^
[0m19:41:08.068177 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[0m19:41:08.070179 [error] [MainThread]:   compiled Code at target\run\stgo_dbt\models\split_full_name.sql
[0m19:41:08.071184 [info ] [MainThread]: 
[0m19:41:08.073187 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:41:08.075181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016ABC449400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016ABC58EAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016ABC585100>]}
[0m19:41:08.075181 [debug] [MainThread]: Flushing usage events


============================== 2023-01-02 19:44:24.380291 | 4ab523b6-12cf-4c9f-8533-2c62262c6d03 ==============================
[0m19:44:24.380291 [info ] [MainThread]: Running with dbt=1.3.1
[0m19:44:24.381291 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'D:\\2023\\Cloudthought\\data-migration-dbt\\stgo_dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'exclude': ['my_first_dbt_model', 'utils'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:44:24.381291 [debug] [MainThread]: Tracking: tracking
[0m19:44:24.430296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161D3B711C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161D3B71AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161D3B71130>]}
[0m19:44:24.607589 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:44:24.607589 [debug] [MainThread]: Partial parsing: updated file: stgo_dbt://models\split_full_name.sql
[0m19:44:24.630589 [debug] [MainThread]: 1603: static parser failed on split_full_name.sql
[0m19:44:24.654589 [debug] [MainThread]: 1602: parser fallback to jinja rendering on split_full_name.sql
[0m19:44:24.744590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4ab523b6-12cf-4c9f-8533-2c62262c6d03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161D3A88070>]}
[0m19:44:24.756590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4ab523b6-12cf-4c9f-8533-2c62262c6d03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161D3C9FFA0>]}
[0m19:44:24.757590 [info ] [MainThread]: Found 4 models, 1 test, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m19:44:24.757590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ab523b6-12cf-4c9f-8533-2c62262c6d03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161D3C8A910>]}
[0m19:44:24.760591 [info ] [MainThread]: 
[0m19:44:24.762620 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m19:44:24.765590 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m19:44:24.787590 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:44:24.787590 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:44:24.787590 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:44:26.853748 [debug] [ThreadPool]: SQL status: SELECT 11 in 2.07 seconds
[0m19:44:26.855365 [debug] [ThreadPool]: On list_postgres: Close
[0m19:44:26.858403 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m19:44:26.868570 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:44:26.868570 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m19:44:26.868570 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:44:28.956432 [debug] [ThreadPool]: SQL status: BEGIN in 2.09 seconds
[0m19:44:28.956432 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:44:28.956432 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m19:44:28.966721 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
[0m19:44:28.969517 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m19:44:28.972210 [debug] [ThreadPool]: On list_postgres_public: Close
[0m19:44:28.983541 [debug] [MainThread]: Using postgres connection "master"
[0m19:44:28.984102 [debug] [MainThread]: On master: BEGIN
[0m19:44:28.984857 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:44:31.068462 [debug] [MainThread]: SQL status: BEGIN in 2.08 seconds
[0m19:44:31.069028 [debug] [MainThread]: Using postgres connection "master"
[0m19:44:31.069568 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:44:31.095621 [debug] [MainThread]: SQL status: SELECT 0 in 0.03 seconds
[0m19:44:31.097255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ab523b6-12cf-4c9f-8533-2c62262c6d03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161D3A88730>]}
[0m19:44:31.097856 [debug] [MainThread]: On master: ROLLBACK
[0m19:44:31.100640 [debug] [MainThread]: Using postgres connection "master"
[0m19:44:31.100640 [debug] [MainThread]: On master: BEGIN
[0m19:44:31.104416 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:44:31.104949 [debug] [MainThread]: On master: COMMIT
[0m19:44:31.105510 [debug] [MainThread]: Using postgres connection "master"
[0m19:44:31.106053 [debug] [MainThread]: On master: COMMIT
[0m19:44:31.107699 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:44:31.108243 [debug] [MainThread]: On master: Close
[0m19:44:31.109326 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:44:31.110409 [info ] [MainThread]: 
[0m19:44:31.121430 [debug] [Thread-1  ]: Began running node model.stgo_dbt.split_full_name
[0m19:44:31.121430 [info ] [Thread-1  ]: 1 of 1 START sql table model public.split_full_name ............................ [RUN]
[0m19:44:31.123430 [debug] [Thread-1  ]: Acquiring new postgres connection "model.stgo_dbt.split_full_name"
[0m19:44:31.123430 [debug] [Thread-1  ]: Began compiling node model.stgo_dbt.split_full_name
[0m19:44:31.124429 [debug] [Thread-1  ]: Compiling model.stgo_dbt.split_full_name
[0m19:44:31.131431 [debug] [Thread-1  ]: Writing injected SQL for node "model.stgo_dbt.split_full_name"
[0m19:44:31.133436 [debug] [Thread-1  ]: finished collecting timing info
[0m19:44:31.134431 [debug] [Thread-1  ]: Began executing node model.stgo_dbt.split_full_name
[0m19:44:31.220947 [debug] [Thread-1  ]: Writing runtime sql for node "model.stgo_dbt.split_full_name"
[0m19:44:31.221946 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.split_full_name"
[0m19:44:31.222945 [debug] [Thread-1  ]: On model.stgo_dbt.split_full_name: BEGIN
[0m19:44:31.222945 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m19:44:33.291814 [debug] [Thread-1  ]: SQL status: BEGIN in 2.07 seconds
[0m19:44:33.292383 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.split_full_name"
[0m19:44:33.293502 [debug] [Thread-1  ]: On model.stgo_dbt.split_full_name: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.split_full_name"} */

  
    

  create  table "postgres"."public"."split_full_name__dbt_tmp"
  as (
    
create or replace function split_name(full_name varchar)
returns table (first_name varchar, last_name varchar) as $$
  select
    trim(split_part(full_name, ' ', 1)),
    trim(split_part(full_name, ' ', 2))
  from (
    select full_name
  ) t;
$$ language sql;




select
  name, 
  id as renamed_id,
  split_name(cast(name as varchar(255))) as (first_name, last_name)
from cdc_tut
  );
  
[0m19:44:33.296403 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "create"
LINE 9: create or replace function split_name(full_name varchar)
        ^

[0m19:44:33.296928 [debug] [Thread-1  ]: On model.stgo_dbt.split_full_name: ROLLBACK
[0m19:44:33.299431 [debug] [Thread-1  ]: finished collecting timing info
[0m19:44:33.299975 [debug] [Thread-1  ]: On model.stgo_dbt.split_full_name: Close
[0m19:44:33.301160 [debug] [Thread-1  ]: Database Error in model split_full_name (models\split_full_name.sql)
  syntax error at or near "create"
  LINE 9: create or replace function split_name(full_name varchar)
          ^
  compiled Code at target\run\stgo_dbt\models\split_full_name.sql
[0m19:44:33.302250 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ab523b6-12cf-4c9f-8533-2c62262c6d03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161D3A814C0>]}
[0m19:44:33.302805 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model public.split_full_name ................... [[31mERROR[0m in 2.18s]
[0m19:44:33.306626 [debug] [Thread-1  ]: Finished running node model.stgo_dbt.split_full_name
[0m19:44:33.311102 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m19:44:33.311102 [debug] [MainThread]: Using postgres connection "master"
[0m19:44:33.312098 [debug] [MainThread]: On master: BEGIN
[0m19:44:33.313099 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:44:35.415362 [debug] [MainThread]: SQL status: BEGIN in 2.1 seconds
[0m19:44:35.416360 [debug] [MainThread]: On master: COMMIT
[0m19:44:35.416360 [debug] [MainThread]: Using postgres connection "master"
[0m19:44:35.417359 [debug] [MainThread]: On master: COMMIT
[0m19:44:35.419359 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:44:35.419359 [debug] [MainThread]: On master: Close
[0m19:44:35.420361 [info ] [MainThread]: 
[0m19:44:35.422359 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.66 seconds (10.66s).
[0m19:44:35.424362 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:44:35.425362 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m19:44:35.425362 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m19:44:35.425362 [debug] [MainThread]: Connection 'model.stgo_dbt.split_full_name' was properly closed.
[0m19:44:35.438360 [info ] [MainThread]: 
[0m19:44:35.439362 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:44:35.441360 [info ] [MainThread]: 
[0m19:44:35.442359 [error] [MainThread]: [33mDatabase Error in model split_full_name (models\split_full_name.sql)[0m
[0m19:44:35.444362 [error] [MainThread]:   syntax error at or near "create"
[0m19:44:35.445361 [error] [MainThread]:   LINE 9: create or replace function split_name(full_name varchar)
[0m19:44:35.446359 [error] [MainThread]:           ^
[0m19:44:35.447361 [error] [MainThread]:   compiled Code at target\run\stgo_dbt\models\split_full_name.sql
[0m19:44:35.448361 [info ] [MainThread]: 
[0m19:44:35.449360 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:44:35.451360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161D3CAE160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161D3C8A910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161D3DF8250>]}
[0m19:44:35.451360 [debug] [MainThread]: Flushing usage events


============================== 2023-01-02 19:48:12.927805 | 26a54cb7-e737-410d-ab61-a96b56bb23f8 ==============================
[0m19:48:12.927805 [info ] [MainThread]: Running with dbt=1.3.1
[0m19:48:12.929806 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'D:\\2023\\Cloudthought\\data-migration-dbt\\stgo_dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'exclude': ['my_first_dbt_model', 'utils'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:48:12.930805 [debug] [MainThread]: Tracking: tracking
[0m19:48:13.000008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C351CA11C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C351CA1A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C351CA1130>]}
[0m19:48:13.293539 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:48:13.295528 [debug] [MainThread]: Partial parsing: updated file: stgo_dbt://models\split_full_name.sql
[0m19:48:13.347529 [debug] [MainThread]: 1603: static parser failed on split_full_name.sql
[0m19:48:13.414124 [debug] [MainThread]: 1602: parser fallback to jinja rendering on split_full_name.sql
[0m19:48:13.551559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '26a54cb7-e737-410d-ab61-a96b56bb23f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C351C6BC40>]}
[0m19:48:13.565560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '26a54cb7-e737-410d-ab61-a96b56bb23f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C351C59940>]}
[0m19:48:13.566561 [info ] [MainThread]: Found 4 models, 1 test, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m19:48:13.567561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26a54cb7-e737-410d-ab61-a96b56bb23f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C351DBA8E0>]}
[0m19:48:13.570561 [info ] [MainThread]: 
[0m19:48:13.573561 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m19:48:13.577564 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m19:48:13.607580 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:48:13.608566 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:48:13.608566 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:48:15.690343 [debug] [ThreadPool]: SQL status: SELECT 11 in 2.08 seconds
[0m19:48:15.692391 [debug] [ThreadPool]: On list_postgres: Close
[0m19:48:15.695392 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m19:48:15.704392 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:48:15.704392 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m19:48:15.704392 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:48:17.752626 [debug] [ThreadPool]: SQL status: BEGIN in 2.05 seconds
[0m19:48:17.753201 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:48:17.753201 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m19:48:17.760079 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
[0m19:48:17.763079 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m19:48:17.765077 [debug] [ThreadPool]: On list_postgres_public: Close
[0m19:48:17.777078 [debug] [MainThread]: Using postgres connection "master"
[0m19:48:17.778078 [debug] [MainThread]: On master: BEGIN
[0m19:48:17.778078 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:48:19.857548 [debug] [MainThread]: SQL status: BEGIN in 2.08 seconds
[0m19:48:19.858095 [debug] [MainThread]: Using postgres connection "master"
[0m19:48:19.858095 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:48:19.884273 [debug] [MainThread]: SQL status: SELECT 0 in 0.03 seconds
[0m19:48:19.885797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26a54cb7-e737-410d-ab61-a96b56bb23f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C351DCFCA0>]}
[0m19:48:19.886795 [debug] [MainThread]: On master: ROLLBACK
[0m19:48:19.888887 [debug] [MainThread]: Using postgres connection "master"
[0m19:48:19.889434 [debug] [MainThread]: On master: BEGIN
[0m19:48:19.893274 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:48:19.893802 [debug] [MainThread]: On master: COMMIT
[0m19:48:19.893866 [debug] [MainThread]: Using postgres connection "master"
[0m19:48:19.894479 [debug] [MainThread]: On master: COMMIT
[0m19:48:19.896106 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:48:19.896660 [debug] [MainThread]: On master: Close
[0m19:48:19.897787 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:48:19.898890 [info ] [MainThread]: 
[0m19:48:19.909593 [debug] [Thread-1  ]: Began running node model.stgo_dbt.split_full_name
[0m19:48:19.910662 [info ] [Thread-1  ]: 1 of 1 START sql table model public.split_full_name ............................ [RUN]
[0m19:48:19.913250 [debug] [Thread-1  ]: Acquiring new postgres connection "model.stgo_dbt.split_full_name"
[0m19:48:19.913250 [debug] [Thread-1  ]: Began compiling node model.stgo_dbt.split_full_name
[0m19:48:19.914247 [debug] [Thread-1  ]: Compiling model.stgo_dbt.split_full_name
[0m19:48:19.921248 [debug] [Thread-1  ]: Writing injected SQL for node "model.stgo_dbt.split_full_name"
[0m19:48:19.923250 [debug] [Thread-1  ]: finished collecting timing info
[0m19:48:19.924246 [debug] [Thread-1  ]: Began executing node model.stgo_dbt.split_full_name
[0m19:48:20.007246 [debug] [Thread-1  ]: Writing runtime sql for node "model.stgo_dbt.split_full_name"
[0m19:48:20.009246 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.split_full_name"
[0m19:48:20.009246 [debug] [Thread-1  ]: On model.stgo_dbt.split_full_name: BEGIN
[0m19:48:20.010249 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m19:48:22.102398 [debug] [Thread-1  ]: SQL status: BEGIN in 2.09 seconds
[0m19:48:22.102968 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.split_full_name"
[0m19:48:22.103497 [debug] [Thread-1  ]: On model.stgo_dbt.split_full_name: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.split_full_name"} */

  
    

  create  table "postgres"."public"."split_full_name__dbt_tmp"
  as (
    
 



select
  name, 
  id as renamed_id,
  SUBSTRING(cast(name as varchar(255)), 1, CHARINDEX(' ', cast(name as varchar(255))) - 1) AS Firstname,     
  SUBSTRING(cast(name as varchar(255)),
            CHARINDEX(' ', cast(name as varchar(255))) + 1,
            LEN(cast(name as varchar(255))) - CHARINDEX(' ', cast(name as varchar(255)))) AS Lastname
from cdc_tut
  );
  
[0m19:48:22.106828 [debug] [Thread-1  ]: Postgres adapter: Postgres error: function charindex(unknown, character varying) does not exist
LINE 16:   SUBSTRING(cast(name as varchar(255)), 1, CHARINDEX(' ', ca...
                                                    ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m19:48:22.107397 [debug] [Thread-1  ]: On model.stgo_dbt.split_full_name: ROLLBACK
[0m19:48:22.109712 [debug] [Thread-1  ]: finished collecting timing info
[0m19:48:22.110282 [debug] [Thread-1  ]: On model.stgo_dbt.split_full_name: Close
[0m19:48:22.111347 [debug] [Thread-1  ]: Database Error in model split_full_name (models\split_full_name.sql)
  function charindex(unknown, character varying) does not exist
  LINE 16:   SUBSTRING(cast(name as varchar(255)), 1, CHARINDEX(' ', ca...
                                                      ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target\run\stgo_dbt\models\split_full_name.sql
[0m19:48:22.111366 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26a54cb7-e737-410d-ab61-a96b56bb23f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C351C7F880>]}
[0m19:48:22.112529 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model public.split_full_name ................... [[31mERROR[0m in 2.20s]
[0m19:48:22.114350 [debug] [Thread-1  ]: Finished running node model.stgo_dbt.split_full_name
[0m19:48:22.117152 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m19:48:22.117703 [debug] [MainThread]: Using postgres connection "master"
[0m19:48:22.117703 [debug] [MainThread]: On master: BEGIN
[0m19:48:22.118245 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:48:24.165384 [debug] [MainThread]: SQL status: BEGIN in 2.05 seconds
[0m19:48:24.166383 [debug] [MainThread]: On master: COMMIT
[0m19:48:24.166383 [debug] [MainThread]: Using postgres connection "master"
[0m19:48:24.166383 [debug] [MainThread]: On master: COMMIT
[0m19:48:24.168384 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:48:24.168384 [debug] [MainThread]: On master: Close
[0m19:48:24.170387 [info ] [MainThread]: 
[0m19:48:24.171385 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.60 seconds (10.60s).
[0m19:48:24.173385 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:48:24.173385 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m19:48:24.173385 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m19:48:24.174386 [debug] [MainThread]: Connection 'model.stgo_dbt.split_full_name' was properly closed.
[0m19:48:24.186386 [info ] [MainThread]: 
[0m19:48:24.187387 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:48:24.190387 [info ] [MainThread]: 
[0m19:48:24.191390 [error] [MainThread]: [33mDatabase Error in model split_full_name (models\split_full_name.sql)[0m
[0m19:48:24.193400 [error] [MainThread]:   function charindex(unknown, character varying) does not exist
[0m19:48:24.195391 [error] [MainThread]:   LINE 16:   SUBSTRING(cast(name as varchar(255)), 1, CHARINDEX(' ', ca...
[0m19:48:24.196385 [error] [MainThread]:                                                       ^
[0m19:48:24.197386 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[0m19:48:24.198387 [error] [MainThread]:   compiled Code at target\run\stgo_dbt\models\split_full_name.sql
[0m19:48:24.200386 [info ] [MainThread]: 
[0m19:48:24.201387 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:48:24.203386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C351C8DB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C351C887F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C351F28670>]}
[0m19:48:24.204395 [debug] [MainThread]: Flushing usage events


============================== 2023-01-02 19:49:15.806849 | 77aaafb1-2ee1-4a85-83aa-5738209d6bd0 ==============================
[0m19:49:15.806849 [info ] [MainThread]: Running with dbt=1.3.1
[0m19:49:15.809853 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'D:\\2023\\Cloudthought\\data-migration-dbt\\stgo_dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'exclude': ['my_first_dbt_model', 'utils'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:49:15.811856 [debug] [MainThread]: Tracking: tracking
[0m19:49:15.866846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002202E472580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002202E4722E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002202E472610>]}
[0m19:49:16.169964 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:49:16.170964 [debug] [MainThread]: Partial parsing: updated file: stgo_dbt://models\split_full_name.sql
[0m19:49:16.191967 [debug] [MainThread]: 1603: static parser failed on split_full_name.sql
[0m19:49:16.217966 [debug] [MainThread]: 1602: parser fallback to jinja rendering on split_full_name.sql
[0m19:49:16.347964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '77aaafb1-2ee1-4a85-83aa-5738209d6bd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002202E76BFD0>]}
[0m19:49:16.362967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '77aaafb1-2ee1-4a85-83aa-5738209d6bd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002202E6BFFA0>]}
[0m19:49:16.363969 [info ] [MainThread]: Found 4 models, 1 test, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m19:49:16.365968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77aaafb1-2ee1-4a85-83aa-5738209d6bd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002202E6AB8B0>]}
[0m19:49:16.367967 [info ] [MainThread]: 
[0m19:49:16.369967 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m19:49:16.372968 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m19:49:16.402498 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:49:16.403481 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:49:16.403481 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:49:18.497526 [debug] [ThreadPool]: SQL status: SELECT 11 in 2.09 seconds
[0m19:49:18.500230 [debug] [ThreadPool]: On list_postgres: Close
[0m19:49:18.503546 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m19:49:18.513140 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:49:18.514145 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m19:49:18.514145 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:49:20.580968 [debug] [ThreadPool]: SQL status: BEGIN in 2.07 seconds
[0m19:49:20.581506 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:49:20.581513 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m19:49:20.588653 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
[0m19:49:20.590336 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m19:49:20.593115 [debug] [ThreadPool]: On list_postgres_public: Close
[0m19:49:20.602320 [debug] [MainThread]: Using postgres connection "master"
[0m19:49:20.602320 [debug] [MainThread]: On master: BEGIN
[0m19:49:20.602866 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:49:22.674782 [debug] [MainThread]: SQL status: BEGIN in 2.07 seconds
[0m19:49:22.675364 [debug] [MainThread]: Using postgres connection "master"
[0m19:49:22.675914 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:49:22.709541 [debug] [MainThread]: SQL status: SELECT 0 in 0.03 seconds
[0m19:49:22.711847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77aaafb1-2ee1-4a85-83aa-5738209d6bd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002202E78C7F0>]}
[0m19:49:22.712767 [debug] [MainThread]: On master: ROLLBACK
[0m19:49:22.715014 [debug] [MainThread]: Using postgres connection "master"
[0m19:49:22.715550 [debug] [MainThread]: On master: BEGIN
[0m19:49:22.719532 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:49:22.720084 [debug] [MainThread]: On master: COMMIT
[0m19:49:22.720626 [debug] [MainThread]: Using postgres connection "master"
[0m19:49:22.720626 [debug] [MainThread]: On master: COMMIT
[0m19:49:22.722235 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:49:22.722781 [debug] [MainThread]: On master: Close
[0m19:49:22.724445 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:49:22.725754 [info ] [MainThread]: 
[0m19:49:22.735752 [debug] [Thread-1  ]: Began running node model.stgo_dbt.split_full_name
[0m19:49:22.736754 [info ] [Thread-1  ]: 1 of 1 START sql table model public.split_full_name ............................ [RUN]
[0m19:49:22.738751 [debug] [Thread-1  ]: Acquiring new postgres connection "model.stgo_dbt.split_full_name"
[0m19:49:22.738751 [debug] [Thread-1  ]: Began compiling node model.stgo_dbt.split_full_name
[0m19:49:22.738751 [debug] [Thread-1  ]: Compiling model.stgo_dbt.split_full_name
[0m19:49:22.745750 [debug] [Thread-1  ]: Writing injected SQL for node "model.stgo_dbt.split_full_name"
[0m19:49:22.747751 [debug] [Thread-1  ]: finished collecting timing info
[0m19:49:22.748753 [debug] [Thread-1  ]: Began executing node model.stgo_dbt.split_full_name
[0m19:49:22.865988 [debug] [Thread-1  ]: Writing runtime sql for node "model.stgo_dbt.split_full_name"
[0m19:49:22.866988 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.split_full_name"
[0m19:49:22.867990 [debug] [Thread-1  ]: On model.stgo_dbt.split_full_name: BEGIN
[0m19:49:22.867990 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m19:49:24.967431 [debug] [Thread-1  ]: SQL status: BEGIN in 2.1 seconds
[0m19:49:24.967971 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.split_full_name"
[0m19:49:24.968513 [debug] [Thread-1  ]: On model.stgo_dbt.split_full_name: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.split_full_name"} */

  
    

  create  table "postgres"."public"."split_full_name__dbt_tmp"
  as (
    
 



select
  name, 
  id as renamed_id,
  SUBSTRING(name, 1, CHARINDEX(' ', name) - 1) AS Firstname,     
  SUBSTRING(name,
            CHARINDEX(' ', name) + 1,
            LEN(name) - CHARINDEX(' ', name)) AS Lastname
from cdc_tut
  );
  
[0m19:49:24.971662 [debug] [Thread-1  ]: Postgres adapter: Postgres error: function charindex(unknown, character varying) does not exist
LINE 16:   SUBSTRING(name, 1, CHARINDEX(' ', name) - 1) AS Firstname,...
                              ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m19:49:24.972665 [debug] [Thread-1  ]: On model.stgo_dbt.split_full_name: ROLLBACK
[0m19:49:24.975685 [debug] [Thread-1  ]: finished collecting timing info
[0m19:49:24.975685 [debug] [Thread-1  ]: On model.stgo_dbt.split_full_name: Close
[0m19:49:24.976660 [debug] [Thread-1  ]: Database Error in model split_full_name (models\split_full_name.sql)
  function charindex(unknown, character varying) does not exist
  LINE 16:   SUBSTRING(name, 1, CHARINDEX(' ', name) - 1) AS Firstname,...
                                ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target\run\stgo_dbt\models\split_full_name.sql
[0m19:49:24.977659 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77aaafb1-2ee1-4a85-83aa-5738209d6bd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002202E4A8B20>]}
[0m19:49:24.977659 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model public.split_full_name ................... [[31mERROR[0m in 2.24s]
[0m19:49:24.979659 [debug] [Thread-1  ]: Finished running node model.stgo_dbt.split_full_name
[0m19:49:24.981661 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m19:49:24.982663 [debug] [MainThread]: Using postgres connection "master"
[0m19:49:24.983666 [debug] [MainThread]: On master: BEGIN
[0m19:49:24.983666 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:49:27.048297 [debug] [MainThread]: SQL status: BEGIN in 2.06 seconds
[0m19:49:27.048351 [debug] [MainThread]: On master: COMMIT
[0m19:49:27.048895 [debug] [MainThread]: Using postgres connection "master"
[0m19:49:27.049435 [debug] [MainThread]: On master: COMMIT
[0m19:49:27.051198 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:49:27.051724 [debug] [MainThread]: On master: Close
[0m19:49:27.053392 [info ] [MainThread]: 
[0m19:49:27.054521 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.68 seconds (10.68s).
[0m19:49:27.055675 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:49:27.056217 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m19:49:27.056771 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m19:49:27.057332 [debug] [MainThread]: Connection 'model.stgo_dbt.split_full_name' was properly closed.
[0m19:49:27.070245 [info ] [MainThread]: 
[0m19:49:27.072246 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:49:27.075247 [info ] [MainThread]: 
[0m19:49:27.077244 [error] [MainThread]: [33mDatabase Error in model split_full_name (models\split_full_name.sql)[0m
[0m19:49:27.079244 [error] [MainThread]:   function charindex(unknown, character varying) does not exist
[0m19:49:27.080589 [error] [MainThread]:   LINE 16:   SUBSTRING(name, 1, CHARINDEX(' ', name) - 1) AS Firstname,...
[0m19:49:27.082244 [error] [MainThread]:                                 ^
[0m19:49:27.083244 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[0m19:49:27.084244 [error] [MainThread]:   compiled Code at target\run\stgo_dbt\models\split_full_name.sql
[0m19:49:27.086243 [info ] [MainThread]: 
[0m19:49:27.087246 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:49:27.090244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002202E6AB880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002202E649DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002202E576670>]}
[0m19:49:27.091245 [debug] [MainThread]: Flushing usage events


============================== 2023-01-02 19:50:55.735560 | 02b44bee-0221-44df-8793-867a6129200a ==============================
[0m19:50:55.735560 [info ] [MainThread]: Running with dbt=1.3.1
[0m19:50:55.736559 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'D:\\2023\\Cloudthought\\data-migration-dbt\\stgo_dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'exclude': ['my_first_dbt_model', 'utils'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m19:50:55.736559 [debug] [MainThread]: Tracking: tracking
[0m19:50:55.793560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1E02586D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1E0258670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1E02585E0>]}
[0m19:50:56.007797 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:50:56.008796 [debug] [MainThread]: Partial parsing: updated file: stgo_dbt://models\split_full_name.sql
[0m19:50:56.027797 [debug] [MainThread]: 1603: static parser failed on split_full_name.sql
[0m19:50:56.049317 [debug] [MainThread]: 1602: parser fallback to jinja rendering on split_full_name.sql
[0m19:50:56.141472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '02b44bee-0221-44df-8793-867a6129200a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1E03C9820>]}
[0m19:50:56.152470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02b44bee-0221-44df-8793-867a6129200a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1E038C8E0>]}
[0m19:50:56.152470 [info ] [MainThread]: Found 4 models, 1 test, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m19:50:56.153468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02b44bee-0221-44df-8793-867a6129200a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1DCC3EAC0>]}
[0m19:50:56.155470 [info ] [MainThread]: 
[0m19:50:56.157470 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m19:50:56.159469 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m19:50:56.184469 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m19:50:56.185472 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m19:50:56.185472 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:50:58.246431 [debug] [ThreadPool]: SQL status: SELECT 11 in 2.06 seconds
[0m19:50:58.248428 [debug] [ThreadPool]: On list_postgres: Close
[0m19:50:58.252439 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m19:50:58.264431 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:50:58.265319 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m19:50:58.265427 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:51:00.334189 [debug] [ThreadPool]: SQL status: BEGIN in 2.07 seconds
[0m19:51:00.334730 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m19:51:00.335436 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m19:51:00.342465 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
[0m19:51:00.345362 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m19:51:00.347167 [debug] [ThreadPool]: On list_postgres_public: Close
[0m19:51:00.362651 [debug] [MainThread]: Using postgres connection "master"
[0m19:51:00.363174 [debug] [MainThread]: On master: BEGIN
[0m19:51:00.363174 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:51:02.431530 [debug] [MainThread]: SQL status: BEGIN in 2.07 seconds
[0m19:51:02.432047 [debug] [MainThread]: Using postgres connection "master"
[0m19:51:02.432604 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:51:02.458583 [debug] [MainThread]: SQL status: SELECT 0 in 0.03 seconds
[0m19:51:02.460759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02b44bee-0221-44df-8793-867a6129200a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1E0257820>]}
[0m19:51:02.461296 [debug] [MainThread]: On master: ROLLBACK
[0m19:51:02.463437 [debug] [MainThread]: Using postgres connection "master"
[0m19:51:02.463437 [debug] [MainThread]: On master: BEGIN
[0m19:51:02.468473 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:51:02.468510 [debug] [MainThread]: On master: COMMIT
[0m19:51:02.469091 [debug] [MainThread]: Using postgres connection "master"
[0m19:51:02.469687 [debug] [MainThread]: On master: COMMIT
[0m19:51:02.471900 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:51:02.472450 [debug] [MainThread]: On master: Close
[0m19:51:02.473178 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:51:02.474355 [info ] [MainThread]: 
[0m19:51:02.484262 [debug] [Thread-1  ]: Began running node model.stgo_dbt.split_full_name
[0m19:51:02.485263 [info ] [Thread-1  ]: 1 of 1 START sql table model public.split_full_name ............................ [RUN]
[0m19:51:02.488264 [debug] [Thread-1  ]: Acquiring new postgres connection "model.stgo_dbt.split_full_name"
[0m19:51:02.490263 [debug] [Thread-1  ]: Began compiling node model.stgo_dbt.split_full_name
[0m19:51:02.490263 [debug] [Thread-1  ]: Compiling model.stgo_dbt.split_full_name
[0m19:51:02.496264 [debug] [Thread-1  ]: Writing injected SQL for node "model.stgo_dbt.split_full_name"
[0m19:51:02.498265 [debug] [Thread-1  ]: finished collecting timing info
[0m19:51:02.499262 [debug] [Thread-1  ]: Began executing node model.stgo_dbt.split_full_name
[0m19:51:02.572909 [debug] [Thread-1  ]: Writing runtime sql for node "model.stgo_dbt.split_full_name"
[0m19:51:02.573916 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.split_full_name"
[0m19:51:02.574909 [debug] [Thread-1  ]: On model.stgo_dbt.split_full_name: BEGIN
[0m19:51:02.574909 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m19:51:04.636617 [debug] [Thread-1  ]: SQL status: BEGIN in 2.06 seconds
[0m19:51:04.636617 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.split_full_name"
[0m19:51:04.637619 [debug] [Thread-1  ]: On model.stgo_dbt.split_full_name: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.split_full_name"} */

  
    

  create  table "postgres"."public"."split_full_name__dbt_tmp"
  as (
    
 



select
  name, 
  id as renamed_id,
  SUBSTRING(name, 1, 3) AS Firstname,     
  SUBSTRING(name, 4, 6) AS Lastname
from cdc_tut
  );
  
[0m19:51:04.738739 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.1 seconds
[0m19:51:04.747917 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.split_full_name"
[0m19:51:04.748450 [debug] [Thread-1  ]: On model.stgo_dbt.split_full_name: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.split_full_name"} */
alter table "postgres"."public"."split_full_name" rename to "split_full_name__dbt_backup"
[0m19:51:04.751289 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:51:04.755592 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.split_full_name"
[0m19:51:04.755592 [debug] [Thread-1  ]: On model.stgo_dbt.split_full_name: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.split_full_name"} */
alter table "postgres"."public"."split_full_name__dbt_tmp" rename to "split_full_name"
[0m19:51:04.757750 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:51:04.792278 [debug] [Thread-1  ]: On model.stgo_dbt.split_full_name: COMMIT
[0m19:51:04.792278 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.split_full_name"
[0m19:51:04.792278 [debug] [Thread-1  ]: On model.stgo_dbt.split_full_name: COMMIT
[0m19:51:04.821123 [debug] [Thread-1  ]: SQL status: COMMIT in 0.03 seconds
[0m19:51:04.829122 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.split_full_name"
[0m19:51:04.829122 [debug] [Thread-1  ]: On model.stgo_dbt.split_full_name: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.split_full_name"} */
drop table if exists "postgres"."public"."split_full_name__dbt_backup" cascade
[0m19:51:04.855951 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.03 seconds
[0m19:51:04.858653 [debug] [Thread-1  ]: finished collecting timing info
[0m19:51:04.859276 [debug] [Thread-1  ]: On model.stgo_dbt.split_full_name: Close
[0m19:51:04.860949 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02b44bee-0221-44df-8793-867a6129200a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1E04F0D00>]}
[0m19:51:04.861494 [info ] [Thread-1  ]: 1 of 1 OK created sql table model public.split_full_name ....................... [[32mSELECT 3[0m in 2.37s]
[0m19:51:04.863846 [debug] [Thread-1  ]: Finished running node model.stgo_dbt.split_full_name
[0m19:51:04.866025 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m19:51:04.866610 [debug] [MainThread]: Using postgres connection "master"
[0m19:51:04.867160 [debug] [MainThread]: On master: BEGIN
[0m19:51:04.867160 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:51:06.919635 [debug] [MainThread]: SQL status: BEGIN in 2.05 seconds
[0m19:51:06.920158 [debug] [MainThread]: On master: COMMIT
[0m19:51:06.920900 [debug] [MainThread]: Using postgres connection "master"
[0m19:51:06.921448 [debug] [MainThread]: On master: COMMIT
[0m19:51:06.925300 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:51:06.926300 [debug] [MainThread]: On master: Close
[0m19:51:06.928300 [info ] [MainThread]: 
[0m19:51:06.930979 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.77 seconds (10.77s).
[0m19:51:06.934510 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:51:06.934510 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m19:51:06.935501 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m19:51:06.935501 [debug] [MainThread]: Connection 'model.stgo_dbt.split_full_name' was properly closed.
[0m19:51:06.962501 [info ] [MainThread]: 
[0m19:51:06.965500 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:51:06.971500 [info ] [MainThread]: 
[0m19:51:06.974498 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:51:06.975498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1E0244670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1E039FCA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1E0326520>]}
[0m19:51:06.976501 [debug] [MainThread]: Flushing usage events


============================== 2023-01-03 08:51:25.750890 | 6724d749-ae77-4c15-9070-c9b3074cc1e4 ==============================
[0m08:51:25.750890 [info ] [MainThread]: Running with dbt=1.3.1
[0m08:51:25.788894 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'D:\\2023\\Cloudthought\\data-migration-dbt\\stgo_dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:51:25.801891 [debug] [MainThread]: Tracking: tracking
[0m08:51:25.861882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD5DBC1520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD5DBC1670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD5DBCBD00>]}
[0m08:51:26.083191 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m08:51:26.084192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6724d749-ae77-4c15-9070-c9b3074cc1e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD5DCFC730>]}
[0m08:51:26.848622 [debug] [MainThread]: Parsing macros\adapters.sql
[0m08:51:26.889605 [debug] [MainThread]: Parsing macros\catalog.sql
[0m08:51:26.892643 [debug] [MainThread]: Parsing macros\relations.sql
[0m08:51:26.894600 [debug] [MainThread]: Parsing macros\timestamps.sql
[0m08:51:26.896634 [debug] [MainThread]: Parsing macros\materializations\incremental_strategies.sql
[0m08:51:26.898586 [debug] [MainThread]: Parsing macros\materializations\snapshot_merge.sql
[0m08:51:26.901601 [debug] [MainThread]: Parsing macros\utils\any_value.sql
[0m08:51:26.902602 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m08:51:26.903643 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m08:51:26.910638 [debug] [MainThread]: Parsing macros\utils\last_day.sql
[0m08:51:26.912598 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m08:51:26.915639 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m08:51:26.917644 [debug] [MainThread]: Parsing macros\adapters\apply_grants.sql
[0m08:51:26.935624 [debug] [MainThread]: Parsing macros\adapters\columns.sql
[0m08:51:26.948635 [debug] [MainThread]: Parsing macros\adapters\freshness.sql
[0m08:51:26.950635 [debug] [MainThread]: Parsing macros\adapters\indexes.sql
[0m08:51:26.957954 [debug] [MainThread]: Parsing macros\adapters\metadata.sql
[0m08:51:26.975608 [debug] [MainThread]: Parsing macros\adapters\persist_docs.sql
[0m08:51:26.984354 [debug] [MainThread]: Parsing macros\adapters\relation.sql
[0m08:51:27.012322 [debug] [MainThread]: Parsing macros\adapters\schema.sql
[0m08:51:27.016324 [debug] [MainThread]: Parsing macros\adapters\timestamps.sql
[0m08:51:27.023315 [debug] [MainThread]: Parsing macros\etc\datetime.sql
[0m08:51:27.043315 [debug] [MainThread]: Parsing macros\etc\statement.sql
[0m08:51:27.055312 [debug] [MainThread]: Parsing macros\generic_test_sql\accepted_values.sql
[0m08:51:27.059311 [debug] [MainThread]: Parsing macros\generic_test_sql\not_null.sql
[0m08:51:27.061320 [debug] [MainThread]: Parsing macros\generic_test_sql\relationships.sql
[0m08:51:27.063325 [debug] [MainThread]: Parsing macros\generic_test_sql\unique.sql
[0m08:51:27.065310 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_alias.sql
[0m08:51:27.068312 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_database.sql
[0m08:51:27.070315 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_schema.sql
[0m08:51:27.076330 [debug] [MainThread]: Parsing macros\materializations\configs.sql
[0m08:51:27.080331 [debug] [MainThread]: Parsing macros\materializations\hooks.sql
[0m08:51:27.090312 [debug] [MainThread]: Parsing macros\materializations\models\incremental\column_helpers.sql
[0m08:51:27.105324 [debug] [MainThread]: Parsing macros\materializations\models\incremental\incremental.sql
[0m08:51:27.122314 [debug] [MainThread]: Parsing macros\materializations\models\incremental\is_incremental.sql
[0m08:51:27.123315 [debug] [MainThread]: Parsing macros\materializations\models\incremental\merge.sql
[0m08:51:27.152393 [debug] [MainThread]: Parsing macros\materializations\models\incremental\on_schema_change.sql
[0m08:51:27.176391 [debug] [MainThread]: Parsing macros\materializations\models\incremental\strategies.sql
[0m08:51:27.184393 [debug] [MainThread]: Parsing macros\materializations\models\table\create_table_as.sql
[0m08:51:27.190389 [debug] [MainThread]: Parsing macros\materializations\models\table\table.sql
[0m08:51:27.197967 [debug] [MainThread]: Parsing macros\materializations\models\view\create_or_replace_view.sql
[0m08:51:27.202961 [debug] [MainThread]: Parsing macros\materializations\models\view\create_view_as.sql
[0m08:51:27.205956 [debug] [MainThread]: Parsing macros\materializations\models\view\helpers.sql
[0m08:51:27.210967 [debug] [MainThread]: Parsing macros\materializations\models\view\view.sql
[0m08:51:27.223771 [debug] [MainThread]: Parsing macros\materializations\seeds\helpers.sql
[0m08:51:27.282763 [debug] [MainThread]: Parsing macros\materializations\seeds\seed.sql
[0m08:51:27.292767 [debug] [MainThread]: Parsing macros\materializations\snapshots\helpers.sql
[0m08:51:27.308313 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot.sql
[0m08:51:27.322350 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot_merge.sql
[0m08:51:27.324306 [debug] [MainThread]: Parsing macros\materializations\snapshots\strategies.sql
[0m08:51:27.346317 [debug] [MainThread]: Parsing macros\materializations\tests\helpers.sql
[0m08:51:27.351337 [debug] [MainThread]: Parsing macros\materializations\tests\test.sql
[0m08:51:27.358308 [debug] [MainThread]: Parsing macros\materializations\tests\where_subquery.sql
[0m08:51:27.361344 [debug] [MainThread]: Parsing macros\python_model\python.sql
[0m08:51:27.373307 [debug] [MainThread]: Parsing macros\utils\any_value.sql
[0m08:51:27.375344 [debug] [MainThread]: Parsing macros\utils\array_append.sql
[0m08:51:27.376351 [debug] [MainThread]: Parsing macros\utils\array_concat.sql
[0m08:51:27.377344 [debug] [MainThread]: Parsing macros\utils\array_construct.sql
[0m08:51:27.381323 [debug] [MainThread]: Parsing macros\utils\bool_or.sql
[0m08:51:27.382325 [debug] [MainThread]: Parsing macros\utils\cast_bool_to_text.sql
[0m08:51:27.384308 [debug] [MainThread]: Parsing macros\utils\concat.sql
[0m08:51:27.388293 [debug] [MainThread]: Parsing macros\utils\data_types.sql
[0m08:51:27.399972 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m08:51:27.402962 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m08:51:27.405023 [debug] [MainThread]: Parsing macros\utils\date_trunc.sql
[0m08:51:27.406950 [debug] [MainThread]: Parsing macros\utils\escape_single_quotes.sql
[0m08:51:27.409965 [debug] [MainThread]: Parsing macros\utils\except.sql
[0m08:51:27.412000 [debug] [MainThread]: Parsing macros\utils\hash.sql
[0m08:51:27.413006 [debug] [MainThread]: Parsing macros\utils\intersect.sql
[0m08:51:27.414005 [debug] [MainThread]: Parsing macros\utils\last_day.sql
[0m08:51:27.416996 [debug] [MainThread]: Parsing macros\utils\length.sql
[0m08:51:27.417960 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m08:51:27.423963 [debug] [MainThread]: Parsing macros\utils\literal.sql
[0m08:51:27.426962 [debug] [MainThread]: Parsing macros\utils\position.sql
[0m08:51:27.429013 [debug] [MainThread]: Parsing macros\utils\replace.sql
[0m08:51:27.432963 [debug] [MainThread]: Parsing macros\utils\right.sql
[0m08:51:27.434954 [debug] [MainThread]: Parsing macros\utils\safe_cast.sql
[0m08:51:27.436997 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m08:51:27.439982 [debug] [MainThread]: Parsing tests\generic\builtin.sql
[0m08:51:27.911064 [debug] [MainThread]: 1603: static parser failed on users_7.sql
[0m08:51:27.938058 [debug] [MainThread]: 1602: parser fallback to jinja rendering on users_7.sql
[0m08:51:27.943061 [debug] [MainThread]: 1603: static parser failed on airbyte_ctes\dbo\users_7_ab1.sql
[0m08:51:27.980071 [debug] [MainThread]: 1602: parser fallback to jinja rendering on airbyte_ctes\dbo\users_7_ab1.sql
[0m08:51:27.983074 [debug] [MainThread]: 1603: static parser failed on airbyte_ctes\dbo\users_7_ab2.sql
[0m08:51:28.003916 [debug] [MainThread]: 1602: parser fallback to jinja rendering on airbyte_ctes\dbo\users_7_ab2.sql
[0m08:51:28.005915 [debug] [MainThread]: 1603: static parser failed on airbyte_ctes\dbo\users_7_ab3.sql
[0m08:51:28.019926 [debug] [MainThread]: 1602: parser fallback to jinja rendering on airbyte_ctes\dbo\users_7_ab3.sql
[0m08:51:28.089938 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'split_full_name' in the 'models' section of file 'models\schema.yml'
[0m08:51:28.116934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD5DECD1C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD5DD7FF70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD5DEBBAC0>]}
[0m08:51:28.117903 [debug] [MainThread]: Flushing usage events
[0m08:51:31.504391 [error] [MainThread]: Encountered an error:
Compilation Error in model users_7 (models\users_7.sql)
  Model 'model.stgo_dbt.users_7' (models\users_7.sql) depends on a source named 'dbo._airbyte_raw_users_7' which was not found


============================== 2023-01-03 08:52:16.765656 | ec62e455-a119-490f-9f48-eefd98b3fd20 ==============================
[0m08:52:16.765656 [info ] [MainThread]: Running with dbt=1.3.1
[0m08:52:16.766637 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'D:\\2023\\Cloudthought\\data-migration-dbt\\stgo_dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:52:16.767630 [debug] [MainThread]: Tracking: tracking
[0m08:52:16.819630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F29363BF40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F28DAFBE20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F28DAFBE50>]}
[0m08:52:16.864649 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m08:52:16.865646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ec62e455-a119-490f-9f48-eefd98b3fd20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F29376C490>]}
[0m08:52:16.985070 [debug] [MainThread]: Parsing macros\adapters.sql
[0m08:52:17.029090 [debug] [MainThread]: Parsing macros\catalog.sql
[0m08:52:17.032059 [debug] [MainThread]: Parsing macros\relations.sql
[0m08:52:17.035072 [debug] [MainThread]: Parsing macros\timestamps.sql
[0m08:52:17.042058 [debug] [MainThread]: Parsing macros\materializations\incremental_strategies.sql
[0m08:52:17.044056 [debug] [MainThread]: Parsing macros\materializations\snapshot_merge.sql
[0m08:52:17.049085 [debug] [MainThread]: Parsing macros\utils\any_value.sql
[0m08:52:17.050086 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m08:52:17.053074 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m08:52:17.065056 [debug] [MainThread]: Parsing macros\utils\last_day.sql
[0m08:52:17.067095 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m08:52:17.070074 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m08:52:17.071075 [debug] [MainThread]: Parsing macros\adapters\apply_grants.sql
[0m08:52:17.096062 [debug] [MainThread]: Parsing macros\adapters\columns.sql
[0m08:52:17.112073 [debug] [MainThread]: Parsing macros\adapters\freshness.sql
[0m08:52:17.116070 [debug] [MainThread]: Parsing macros\adapters\indexes.sql
[0m08:52:17.124108 [debug] [MainThread]: Parsing macros\adapters\metadata.sql
[0m08:52:17.140056 [debug] [MainThread]: Parsing macros\adapters\persist_docs.sql
[0m08:52:17.149090 [debug] [MainThread]: Parsing macros\adapters\relation.sql
[0m08:52:17.174283 [debug] [MainThread]: Parsing macros\adapters\schema.sql
[0m08:52:17.177254 [debug] [MainThread]: Parsing macros\adapters\timestamps.sql
[0m08:52:17.182250 [debug] [MainThread]: Parsing macros\etc\datetime.sql
[0m08:52:17.194251 [debug] [MainThread]: Parsing macros\etc\statement.sql
[0m08:52:17.203252 [debug] [MainThread]: Parsing macros\generic_test_sql\accepted_values.sql
[0m08:52:17.204253 [debug] [MainThread]: Parsing macros\generic_test_sql\not_null.sql
[0m08:52:17.206253 [debug] [MainThread]: Parsing macros\generic_test_sql\relationships.sql
[0m08:52:17.207278 [debug] [MainThread]: Parsing macros\generic_test_sql\unique.sql
[0m08:52:17.208247 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_alias.sql
[0m08:52:17.210250 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_database.sql
[0m08:52:17.216250 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_schema.sql
[0m08:52:17.220249 [debug] [MainThread]: Parsing macros\materializations\configs.sql
[0m08:52:17.223247 [debug] [MainThread]: Parsing macros\materializations\hooks.sql
[0m08:52:17.228258 [debug] [MainThread]: Parsing macros\materializations\models\incremental\column_helpers.sql
[0m08:52:17.239257 [debug] [MainThread]: Parsing macros\materializations\models\incremental\incremental.sql
[0m08:52:17.255261 [debug] [MainThread]: Parsing macros\materializations\models\incremental\is_incremental.sql
[0m08:52:17.257262 [debug] [MainThread]: Parsing macros\materializations\models\incremental\merge.sql
[0m08:52:17.278254 [debug] [MainThread]: Parsing macros\materializations\models\incremental\on_schema_change.sql
[0m08:52:17.301249 [debug] [MainThread]: Parsing macros\materializations\models\incremental\strategies.sql
[0m08:52:17.311252 [debug] [MainThread]: Parsing macros\materializations\models\table\create_table_as.sql
[0m08:52:17.315251 [debug] [MainThread]: Parsing macros\materializations\models\table\table.sql
[0m08:52:17.323251 [debug] [MainThread]: Parsing macros\materializations\models\view\create_or_replace_view.sql
[0m08:52:17.327251 [debug] [MainThread]: Parsing macros\materializations\models\view\create_view_as.sql
[0m08:52:17.330274 [debug] [MainThread]: Parsing macros\materializations\models\view\helpers.sql
[0m08:52:17.331252 [debug] [MainThread]: Parsing macros\materializations\models\view\view.sql
[0m08:52:17.338251 [debug] [MainThread]: Parsing macros\materializations\seeds\helpers.sql
[0m08:52:17.408179 [debug] [MainThread]: Parsing macros\materializations\seeds\seed.sql
[0m08:52:17.416851 [debug] [MainThread]: Parsing macros\materializations\snapshots\helpers.sql
[0m08:52:17.433851 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot.sql
[0m08:52:17.447816 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot_merge.sql
[0m08:52:17.450810 [debug] [MainThread]: Parsing macros\materializations\snapshots\strategies.sql
[0m08:52:17.474851 [debug] [MainThread]: Parsing macros\materializations\tests\helpers.sql
[0m08:52:17.477801 [debug] [MainThread]: Parsing macros\materializations\tests\test.sql
[0m08:52:17.483850 [debug] [MainThread]: Parsing macros\materializations\tests\where_subquery.sql
[0m08:52:17.486844 [debug] [MainThread]: Parsing macros\python_model\python.sql
[0m08:52:17.493850 [debug] [MainThread]: Parsing macros\utils\any_value.sql
[0m08:52:17.495854 [debug] [MainThread]: Parsing macros\utils\array_append.sql
[0m08:52:17.496850 [debug] [MainThread]: Parsing macros\utils\array_concat.sql
[0m08:52:17.498866 [debug] [MainThread]: Parsing macros\utils\array_construct.sql
[0m08:52:17.501849 [debug] [MainThread]: Parsing macros\utils\bool_or.sql
[0m08:52:17.502849 [debug] [MainThread]: Parsing macros\utils\cast_bool_to_text.sql
[0m08:52:17.504801 [debug] [MainThread]: Parsing macros\utils\concat.sql
[0m08:52:17.506868 [debug] [MainThread]: Parsing macros\utils\data_types.sql
[0m08:52:17.516812 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m08:52:17.518805 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m08:52:17.521852 [debug] [MainThread]: Parsing macros\utils\date_trunc.sql
[0m08:52:17.522853 [debug] [MainThread]: Parsing macros\utils\escape_single_quotes.sql
[0m08:52:17.523852 [debug] [MainThread]: Parsing macros\utils\except.sql
[0m08:52:17.524850 [debug] [MainThread]: Parsing macros\utils\hash.sql
[0m08:52:17.526847 [debug] [MainThread]: Parsing macros\utils\intersect.sql
[0m08:52:17.527817 [debug] [MainThread]: Parsing macros\utils\last_day.sql
[0m08:52:17.529850 [debug] [MainThread]: Parsing macros\utils\length.sql
[0m08:52:17.530816 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m08:52:17.535852 [debug] [MainThread]: Parsing macros\utils\literal.sql
[0m08:52:17.536882 [debug] [MainThread]: Parsing macros\utils\position.sql
[0m08:52:17.537851 [debug] [MainThread]: Parsing macros\utils\replace.sql
[0m08:52:17.539845 [debug] [MainThread]: Parsing macros\utils\right.sql
[0m08:52:17.541800 [debug] [MainThread]: Parsing macros\utils\safe_cast.sql
[0m08:52:17.543802 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m08:52:17.549856 [debug] [MainThread]: Parsing tests\generic\builtin.sql
[0m08:52:17.933316 [debug] [MainThread]: 1603: static parser failed on users_7.sql
[0m08:52:17.959542 [debug] [MainThread]: 1602: parser fallback to jinja rendering on users_7.sql
[0m08:52:17.962586 [debug] [MainThread]: 1603: static parser failed on airbyte_ctes\dbo\users_7_ab1.sql
[0m08:52:17.991576 [debug] [MainThread]: 1602: parser fallback to jinja rendering on airbyte_ctes\dbo\users_7_ab1.sql
[0m08:52:17.993591 [debug] [MainThread]: 1603: static parser failed on airbyte_ctes\dbo\users_7_ab2.sql
[0m08:52:18.013577 [debug] [MainThread]: 1602: parser fallback to jinja rendering on airbyte_ctes\dbo\users_7_ab2.sql
[0m08:52:18.015581 [debug] [MainThread]: 1603: static parser failed on airbyte_ctes\dbo\users_7_ab3.sql
[0m08:52:18.026544 [debug] [MainThread]: 1602: parser fallback to jinja rendering on airbyte_ctes\dbo\users_7_ab3.sql
[0m08:52:18.129554 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stgo_dbt.staging

[0m08:52:18.150536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec62e455-a119-490f-9f48-eefd98b3fd20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F2938FB0D0>]}
[0m08:52:18.176535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec62e455-a119-490f-9f48-eefd98b3fd20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F2937FD4F0>]}
[0m08:52:18.177529 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 2 seed files, 1 source, 0 exposures, 0 metrics
[0m08:52:18.178547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec62e455-a119-490f-9f48-eefd98b3fd20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F2938FE700>]}
[0m08:52:18.180526 [info ] [MainThread]: 
[0m08:52:18.182586 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m08:52:18.186530 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m08:52:18.205178 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m08:52:18.206191 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m08:52:18.206191 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m08:52:18.211183 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m08:52:18.211183 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:18.212185 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m08:52:18.214181 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:20.294067 [debug] [ThreadPool]: SQL status: SELECT 10 in 2.08 seconds
[0m08:52:20.298059 [debug] [ThreadPool]: On list_postgres: Close
[0m08:52:20.299169 [debug] [ThreadPool]: SQL status: SELECT 10 in 2.08 seconds
[0m08:52:20.300311 [debug] [ThreadPool]: On list_postgres: Close
[0m08:52:20.302646 [debug] [ThreadPool]: Acquiring new postgres connection "create_postgres_public_dbo"
[0m08:52:20.303190 [debug] [ThreadPool]: Acquiring new postgres connection "create_postgres_public__airbyte_dbo"
[0m08:52:20.303733 [debug] [ThreadPool]: Acquiring new postgres connection "create_postgres_public_dbo"
[0m08:52:20.305024 [debug] [ThreadPool]: Acquiring new postgres connection "create_postgres_public__airbyte_dbo"
[0m08:52:20.305546 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='postgres', schema='public_dbo', identifier=None)"
[0m08:52:20.306109 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='postgres', schema='public__airbyte_dbo', identifier=None)"
[0m08:52:20.314095 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_dbo"
[0m08:52:20.317090 [debug] [ThreadPool]: Using postgres connection "create_postgres_public__airbyte_dbo"
[0m08:52:20.317090 [debug] [ThreadPool]: On create_postgres_public_dbo: BEGIN
[0m08:52:20.317090 [debug] [ThreadPool]: On create_postgres_public__airbyte_dbo: BEGIN
[0m08:52:20.318081 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:52:20.318081 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:52:22.408954 [debug] [ThreadPool]: SQL status: BEGIN in 2.09 seconds
[0m08:52:22.409511 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_dbo"
[0m08:52:22.409511 [debug] [ThreadPool]: On create_postgres_public_dbo: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "create_postgres_public_dbo"} */
create schema if not exists "public_dbo"
[0m08:52:22.411854 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m08:52:22.413591 [debug] [ThreadPool]: On create_postgres_public_dbo: COMMIT
[0m08:52:22.414154 [debug] [ThreadPool]: Using postgres connection "create_postgres_public_dbo"
[0m08:52:22.414757 [debug] [ThreadPool]: On create_postgres_public_dbo: COMMIT
[0m08:52:22.418836 [debug] [ThreadPool]: SQL status: BEGIN in 2.1 seconds
[0m08:52:22.418836 [debug] [ThreadPool]: Using postgres connection "create_postgres_public__airbyte_dbo"
[0m08:52:22.419427 [debug] [ThreadPool]: On create_postgres_public__airbyte_dbo: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "create_postgres_public__airbyte_dbo"} */
create schema if not exists "public__airbyte_dbo"
[0m08:52:22.422451 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m08:52:22.423739 [debug] [ThreadPool]: On create_postgres_public__airbyte_dbo: COMMIT
[0m08:52:22.423739 [debug] [ThreadPool]: Using postgres connection "create_postgres_public__airbyte_dbo"
[0m08:52:22.423739 [debug] [ThreadPool]: On create_postgres_public__airbyte_dbo: COMMIT
[0m08:52:22.469707 [debug] [ThreadPool]: SQL status: COMMIT in 0.05 seconds
[0m08:52:22.470792 [debug] [ThreadPool]: On create_postgres_public_dbo: Close
[0m08:52:22.509893 [debug] [ThreadPool]: SQL status: COMMIT in 0.09 seconds
[0m08:52:22.510815 [debug] [ThreadPool]: On create_postgres_public__airbyte_dbo: Close
[0m08:52:22.514744 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m08:52:22.523821 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m08:52:22.524457 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m08:52:22.524457 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:22.525027 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public_dbo"
[0m08:52:22.528107 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_dbo"
[0m08:52:22.529100 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public__airbyte_dbo"
[0m08:52:22.529100 [debug] [ThreadPool]: On list_postgres_public_dbo: BEGIN
[0m08:52:22.531101 [debug] [ThreadPool]: Using postgres connection "list_postgres_public__airbyte_dbo"
[0m08:52:22.531101 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:22.532105 [debug] [ThreadPool]: On list_postgres_public__airbyte_dbo: BEGIN
[0m08:52:22.532105 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:24.601689 [debug] [ThreadPool]: SQL status: BEGIN in 2.08 seconds
[0m08:52:24.602278 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m08:52:24.602278 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m08:52:24.608288 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.01 seconds
[0m08:52:24.610577 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m08:52:24.613279 [debug] [ThreadPool]: On list_postgres_public: Close
[0m08:52:24.617895 [debug] [ThreadPool]: SQL status: BEGIN in 2.09 seconds
[0m08:52:24.618458 [debug] [ThreadPool]: Using postgres connection "list_postgres_public__airbyte_dbo"
[0m08:52:24.619019 [debug] [ThreadPool]: On list_postgres_public__airbyte_dbo: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres_public__airbyte_dbo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public__airbyte_dbo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public__airbyte_dbo'
  
[0m08:52:24.619668 [debug] [ThreadPool]: SQL status: BEGIN in 2.09 seconds
[0m08:52:24.620209 [debug] [ThreadPool]: Using postgres connection "list_postgres_public_dbo"
[0m08:52:24.620209 [debug] [ThreadPool]: On list_postgres_public_dbo: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres_public_dbo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dbo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dbo'
  
[0m08:52:24.624965 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.01 seconds
[0m08:52:24.627237 [debug] [ThreadPool]: On list_postgres_public__airbyte_dbo: ROLLBACK
[0m08:52:24.627237 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.01 seconds
[0m08:52:24.630701 [debug] [ThreadPool]: On list_postgres_public_dbo: ROLLBACK
[0m08:52:24.631283 [debug] [ThreadPool]: On list_postgres_public__airbyte_dbo: Close
[0m08:52:24.633723 [debug] [ThreadPool]: On list_postgres_public_dbo: Close
[0m08:52:24.647060 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:24.647654 [debug] [MainThread]: On master: BEGIN
[0m08:52:24.647654 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:52:26.747599 [debug] [MainThread]: SQL status: BEGIN in 2.1 seconds
[0m08:52:26.748160 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:26.748769 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:52:26.762031 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
[0m08:52:26.764561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec62e455-a119-490f-9f48-eefd98b3fd20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F293A07130>]}
[0m08:52:26.764561 [debug] [MainThread]: On master: ROLLBACK
[0m08:52:26.767612 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:26.767612 [debug] [MainThread]: On master: BEGIN
[0m08:52:26.772260 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:52:26.772260 [debug] [MainThread]: On master: COMMIT
[0m08:52:26.772780 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:26.772826 [debug] [MainThread]: On master: COMMIT
[0m08:52:26.775113 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:52:26.775113 [debug] [MainThread]: On master: Close
[0m08:52:26.777506 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:52:26.779176 [info ] [MainThread]: 
[0m08:52:26.794653 [debug] [Thread-1  ]: Began running node model.stgo_dbt.users_7_ab1
[0m08:52:26.795656 [info ] [Thread-1  ]: 1 of 4 START sql table model public__airbyte_dbo.users_7_ab1 ................... [RUN]
[0m08:52:26.796703 [debug] [Thread-1  ]: Acquiring new postgres connection "model.stgo_dbt.users_7_ab1"
[0m08:52:26.797984 [debug] [Thread-1  ]: Began compiling node model.stgo_dbt.users_7_ab1
[0m08:52:26.797984 [debug] [Thread-1  ]: Compiling model.stgo_dbt.users_7_ab1
[0m08:52:26.835979 [debug] [Thread-1  ]: finished collecting timing info
[0m08:52:26.836979 [debug] [Thread-1  ]: Compilation Error in model users_7_ab1 (models\airbyte_ctes\dbo\users_7_ab1.sql)
  'json_extract_scalar' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m08:52:26.836979 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec62e455-a119-490f-9f48-eefd98b3fd20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F293A3D1F0>]}
[0m08:52:26.836979 [error] [Thread-1  ]: 1 of 4 ERROR creating sql table model public__airbyte_dbo.users_7_ab1 .......... [[31mERROR[0m in 0.04s]
[0m08:52:26.839986 [debug] [Thread-1  ]: Finished running node model.stgo_dbt.users_7_ab1
[0m08:52:26.840987 [debug] [Thread-3  ]: Began running node model.stgo_dbt.users_7_ab2
[0m08:52:26.841981 [info ] [Thread-3  ]: 2 of 4 SKIP relation public__airbyte_dbo.users_7_ab2 ........................... [[33mSKIP[0m]
[0m08:52:26.844987 [debug] [Thread-3  ]: Finished running node model.stgo_dbt.users_7_ab2
[0m08:52:26.845988 [debug] [Thread-2  ]: Began running node model.stgo_dbt.users_7_ab3
[0m08:52:26.847021 [info ] [Thread-2  ]: 3 of 4 SKIP relation public__airbyte_dbo.users_7_ab3 ........................... [[33mSKIP[0m]
[0m08:52:26.847982 [debug] [Thread-2  ]: Finished running node model.stgo_dbt.users_7_ab3
[0m08:52:26.849985 [debug] [Thread-4  ]: Began running node model.stgo_dbt.users_7
[0m08:52:26.849985 [info ] [Thread-4  ]: 4 of 4 SKIP relation public_dbo.users_7 ........................................ [[33mSKIP[0m]
[0m08:52:26.851988 [debug] [Thread-4  ]: Finished running node model.stgo_dbt.users_7
[0m08:52:26.854983 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m08:52:26.855986 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:26.855986 [debug] [MainThread]: On master: BEGIN
[0m08:52:26.855986 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:52:28.943880 [debug] [MainThread]: SQL status: BEGIN in 2.09 seconds
[0m08:52:28.944419 [debug] [MainThread]: On master: COMMIT
[0m08:52:28.944419 [debug] [MainThread]: Using postgres connection "master"
[0m08:52:28.944996 [debug] [MainThread]: On master: COMMIT
[0m08:52:28.947200 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:52:28.947761 [debug] [MainThread]: On master: Close
[0m08:52:28.949398 [info ] [MainThread]: 
[0m08:52:28.950505 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 10.77 seconds (10.77s).
[0m08:52:28.951768 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:52:28.952310 [debug] [MainThread]: Connection 'create_postgres_public_dbo' was properly closed.
[0m08:52:28.952878 [debug] [MainThread]: Connection 'create_postgres_public__airbyte_dbo' was properly closed.
[0m08:52:28.953415 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m08:52:28.953415 [debug] [MainThread]: Connection 'list_postgres_public_dbo' was properly closed.
[0m08:52:28.954021 [debug] [MainThread]: Connection 'list_postgres_public__airbyte_dbo' was properly closed.
[0m08:52:28.954021 [debug] [MainThread]: Connection 'model.stgo_dbt.users_7_ab1' was properly closed.
[0m08:52:28.980324 [info ] [MainThread]: 
[0m08:52:28.982320 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:52:28.984306 [info ] [MainThread]: 
[0m08:52:28.986321 [error] [MainThread]: [33mCompilation Error in model users_7_ab1 (models\airbyte_ctes\dbo\users_7_ab1.sql)[0m
[0m08:52:28.988324 [error] [MainThread]:   'json_extract_scalar' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m08:52:28.991318 [info ] [MainThread]: 
[0m08:52:28.993309 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=3 TOTAL=4
[0m08:52:28.997320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F29398CFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F29398C5B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F29398C850>]}
[0m08:52:28.997320 [debug] [MainThread]: Flushing usage events


============================== 2023-01-03 08:53:08.937343 | 7da485f4-798b-4f8d-b932-055d5ce1c564 ==============================
[0m08:53:08.937343 [info ] [MainThread]: Running with dbt=1.3.1
[0m08:53:08.939372 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'D:\\2023\\Cloudthought\\data-migration-dbt\\stgo_dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:53:08.940356 [debug] [MainThread]: Tracking: tracking
[0m08:53:08.990344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F5FBD2580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F5FBD22E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F5FBD2610>]}
[0m08:53:09.326322 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 19 files added, 0 files changed.
[0m08:53:09.326322 [debug] [MainThread]: Partial parsing: added file: stgo_dbt://macros\star_intersect.sql
[0m08:53:09.327317 [debug] [MainThread]: Partial parsing: added file: stgo_dbt://macros\cross_db_utils\concat.sql
[0m08:53:09.327317 [debug] [MainThread]: Partial parsing: added file: stgo_dbt://macros\schema_tests\equality.sql
[0m08:53:09.327317 [debug] [MainThread]: Partial parsing: added file: stgo_dbt://macros\cross_db_utils\json_operations.sql
[0m08:53:09.328319 [debug] [MainThread]: Partial parsing: added file: stgo_dbt://macros\clean_tmp_tables.sql
[0m08:53:09.328319 [debug] [MainThread]: Partial parsing: added file: stgo_dbt://macros\configuration.sql
[0m08:53:09.328319 [debug] [MainThread]: Partial parsing: added file: stgo_dbt://macros\cross_db_utils\quote.sql
[0m08:53:09.328319 [debug] [MainThread]: Partial parsing: added file: stgo_dbt://macros\incremental.sql
[0m08:53:09.329322 [debug] [MainThread]: Partial parsing: added file: stgo_dbt://macros\schema_tests\equal_rowcount.sql
[0m08:53:09.329322 [debug] [MainThread]: Partial parsing: added file: stgo_dbt://macros\cross_db_utils\array.sql
[0m08:53:09.329322 [debug] [MainThread]: Partial parsing: added file: stgo_dbt://macros\get_custom_schema.sql
[0m08:53:09.329322 [debug] [MainThread]: Partial parsing: added file: stgo_dbt://macros\cross_db_utils\current_timestamp.sql
[0m08:53:09.329322 [debug] [MainThread]: Partial parsing: added file: stgo_dbt://macros\cross_db_utils\except.sql
[0m08:53:09.330320 [debug] [MainThread]: Partial parsing: added file: stgo_dbt://macros\cross_db_utils\type_conversions.sql
[0m08:53:09.330320 [debug] [MainThread]: Partial parsing: added file: stgo_dbt://macros\cross_db_utils\surrogate_key.sql
[0m08:53:09.330320 [debug] [MainThread]: Partial parsing: added file: stgo_dbt://macros\cross_db_utils\columns.sql
[0m08:53:09.330320 [debug] [MainThread]: Partial parsing: added file: stgo_dbt://macros\cross_db_utils\hash.sql
[0m08:53:09.330320 [debug] [MainThread]: Partial parsing: added file: stgo_dbt://macros\cross_db_utils\datatypes.sql
[0m08:53:09.331329 [debug] [MainThread]: Partial parsing: added file: stgo_dbt://macros\should_full_refresh.sql
[0m08:53:09.331329 [debug] [MainThread]: Parsing macros\star_intersect.sql
[0m08:53:09.342367 [debug] [MainThread]: Parsing macros\cross_db_utils\concat.sql
[0m08:53:09.346326 [debug] [MainThread]: Parsing macros\schema_tests\equality.sql
[0m08:53:09.355372 [debug] [MainThread]: Parsing macros\cross_db_utils\json_operations.sql
[0m08:53:09.412678 [debug] [MainThread]: Parsing macros\clean_tmp_tables.sql
[0m08:53:09.414675 [debug] [MainThread]: Parsing macros\configuration.sql
[0m08:53:09.418695 [debug] [MainThread]: Parsing macros\cross_db_utils\quote.sql
[0m08:53:09.421641 [debug] [MainThread]: Parsing macros\incremental.sql
[0m08:53:09.430646 [debug] [MainThread]: Parsing macros\schema_tests\equal_rowcount.sql
[0m08:53:09.432656 [debug] [MainThread]: Parsing macros\cross_db_utils\array.sql
[0m08:53:09.452686 [debug] [MainThread]: Parsing macros\get_custom_schema.sql
[0m08:53:09.453681 [debug] [MainThread]: Parsing macros\cross_db_utils\current_timestamp.sql
[0m08:53:09.454647 [debug] [MainThread]: Parsing macros\cross_db_utils\except.sql
[0m08:53:09.455681 [debug] [MainThread]: Parsing macros\cross_db_utils\type_conversions.sql
[0m08:53:09.467142 [debug] [MainThread]: Parsing macros\cross_db_utils\surrogate_key.sql
[0m08:53:09.469196 [debug] [MainThread]: Parsing macros\cross_db_utils\columns.sql
[0m08:53:09.475156 [debug] [MainThread]: Parsing macros\cross_db_utils\hash.sql
[0m08:53:09.476195 [debug] [MainThread]: Parsing macros\cross_db_utils\datatypes.sql
[0m08:53:09.532895 [debug] [MainThread]: Parsing macros\should_full_refresh.sql
[0m08:53:09.681204 [info ] [MainThread]: Change detected to override macro used during parsing. Starting full parse.
[0m08:53:09.682206 [debug] [MainThread]: Parsing macros\clean_tmp_tables.sql
[0m08:53:09.687194 [debug] [MainThread]: Parsing macros\configuration.sql
[0m08:53:09.691192 [debug] [MainThread]: Parsing macros\get_custom_schema.sql
[0m08:53:09.692192 [debug] [MainThread]: Parsing macros\incremental.sql
[0m08:53:09.705241 [debug] [MainThread]: Parsing macros\should_full_refresh.sql
[0m08:53:09.713197 [debug] [MainThread]: Parsing macros\star_intersect.sql
[0m08:53:09.721239 [debug] [MainThread]: Parsing macros\cross_db_utils\array.sql
[0m08:53:09.743992 [debug] [MainThread]: Parsing macros\cross_db_utils\columns.sql
[0m08:53:09.747941 [debug] [MainThread]: Parsing macros\cross_db_utils\concat.sql
[0m08:53:09.753941 [debug] [MainThread]: Parsing macros\cross_db_utils\current_timestamp.sql
[0m08:53:09.754995 [debug] [MainThread]: Parsing macros\cross_db_utils\datatypes.sql
[0m08:53:09.812948 [debug] [MainThread]: Parsing macros\cross_db_utils\except.sql
[0m08:53:09.814947 [debug] [MainThread]: Parsing macros\cross_db_utils\hash.sql
[0m08:53:09.815969 [debug] [MainThread]: Parsing macros\cross_db_utils\json_operations.sql
[0m08:53:09.906936 [debug] [MainThread]: Parsing macros\cross_db_utils\quote.sql
[0m08:53:09.909950 [debug] [MainThread]: Parsing macros\cross_db_utils\surrogate_key.sql
[0m08:53:09.912941 [debug] [MainThread]: Parsing macros\cross_db_utils\type_conversions.sql
[0m08:53:09.922936 [debug] [MainThread]: Parsing macros\schema_tests\equality.sql
[0m08:53:09.929935 [debug] [MainThread]: Parsing macros\schema_tests\equal_rowcount.sql
[0m08:53:09.931936 [debug] [MainThread]: Parsing macros\adapters.sql
[0m08:53:09.959935 [debug] [MainThread]: Parsing macros\catalog.sql
[0m08:53:09.962937 [debug] [MainThread]: Parsing macros\relations.sql
[0m08:53:09.964936 [debug] [MainThread]: Parsing macros\timestamps.sql
[0m08:53:09.967936 [debug] [MainThread]: Parsing macros\materializations\incremental_strategies.sql
[0m08:53:09.969937 [debug] [MainThread]: Parsing macros\materializations\snapshot_merge.sql
[0m08:53:09.971937 [debug] [MainThread]: Parsing macros\utils\any_value.sql
[0m08:53:09.972936 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m08:53:09.973935 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m08:53:09.996088 [debug] [MainThread]: Parsing macros\utils\last_day.sql
[0m08:53:09.999088 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m08:53:10.001087 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m08:53:10.003083 [debug] [MainThread]: Parsing macros\adapters\apply_grants.sql
[0m08:53:10.033090 [debug] [MainThread]: Parsing macros\adapters\columns.sql
[0m08:53:10.051097 [debug] [MainThread]: Parsing macros\adapters\freshness.sql
[0m08:53:10.054083 [debug] [MainThread]: Parsing macros\adapters\indexes.sql
[0m08:53:10.062085 [debug] [MainThread]: Parsing macros\adapters\metadata.sql
[0m08:53:10.075085 [debug] [MainThread]: Parsing macros\adapters\persist_docs.sql
[0m08:53:10.082082 [debug] [MainThread]: Parsing macros\adapters\relation.sql
[0m08:53:10.101098 [debug] [MainThread]: Parsing macros\adapters\schema.sql
[0m08:53:10.104085 [debug] [MainThread]: Parsing macros\adapters\timestamps.sql
[0m08:53:10.109084 [debug] [MainThread]: Parsing macros\etc\datetime.sql
[0m08:53:10.122083 [debug] [MainThread]: Parsing macros\etc\statement.sql
[0m08:53:10.131085 [debug] [MainThread]: Parsing macros\generic_test_sql\accepted_values.sql
[0m08:53:10.133084 [debug] [MainThread]: Parsing macros\generic_test_sql\not_null.sql
[0m08:53:10.134084 [debug] [MainThread]: Parsing macros\generic_test_sql\relationships.sql
[0m08:53:10.135084 [debug] [MainThread]: Parsing macros\generic_test_sql\unique.sql
[0m08:53:10.136084 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_alias.sql
[0m08:53:10.140089 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_database.sql
[0m08:53:10.143088 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_schema.sql
[0m08:53:10.147086 [debug] [MainThread]: Parsing macros\materializations\configs.sql
[0m08:53:10.151087 [debug] [MainThread]: Parsing macros\materializations\hooks.sql
[0m08:53:10.156086 [debug] [MainThread]: Parsing macros\materializations\models\incremental\column_helpers.sql
[0m08:53:10.168144 [debug] [MainThread]: Parsing macros\materializations\models\incremental\incremental.sql
[0m08:53:10.182095 [debug] [MainThread]: Parsing macros\materializations\models\incremental\is_incremental.sql
[0m08:53:10.184138 [debug] [MainThread]: Parsing macros\materializations\models\incremental\merge.sql
[0m08:53:10.207109 [debug] [MainThread]: Parsing macros\materializations\models\incremental\on_schema_change.sql
[0m08:53:10.233106 [debug] [MainThread]: Parsing macros\materializations\models\incremental\strategies.sql
[0m08:53:10.243097 [debug] [MainThread]: Parsing macros\materializations\models\table\create_table_as.sql
[0m08:53:10.250097 [debug] [MainThread]: Parsing macros\materializations\models\table\table.sql
[0m08:53:10.258101 [debug] [MainThread]: Parsing macros\materializations\models\view\create_or_replace_view.sql
[0m08:53:10.262822 [debug] [MainThread]: Parsing macros\materializations\models\view\create_view_as.sql
[0m08:53:10.266816 [debug] [MainThread]: Parsing macros\materializations\models\view\helpers.sql
[0m08:53:10.267873 [debug] [MainThread]: Parsing macros\materializations\models\view\view.sql
[0m08:53:10.275842 [debug] [MainThread]: Parsing macros\materializations\seeds\helpers.sql
[0m08:53:10.299851 [debug] [MainThread]: Parsing macros\materializations\seeds\seed.sql
[0m08:53:10.307838 [debug] [MainThread]: Parsing macros\materializations\snapshots\helpers.sql
[0m08:53:10.332845 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot.sql
[0m08:53:10.350830 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot_merge.sql
[0m08:53:10.353897 [debug] [MainThread]: Parsing macros\materializations\snapshots\strategies.sql
[0m08:53:10.374837 [debug] [MainThread]: Parsing macros\materializations\tests\helpers.sql
[0m08:53:10.377792 [debug] [MainThread]: Parsing macros\materializations\tests\test.sql
[0m08:53:10.386795 [debug] [MainThread]: Parsing macros\materializations\tests\where_subquery.sql
[0m08:53:10.392803 [debug] [MainThread]: Parsing macros\python_model\python.sql
[0m08:53:10.413798 [debug] [MainThread]: Parsing macros\utils\any_value.sql
[0m08:53:10.418790 [debug] [MainThread]: Parsing macros\utils\array_append.sql
[0m08:53:10.422817 [debug] [MainThread]: Parsing macros\utils\array_concat.sql
[0m08:53:10.426796 [debug] [MainThread]: Parsing macros\utils\array_construct.sql
[0m08:53:10.434804 [debug] [MainThread]: Parsing macros\utils\bool_or.sql
[0m08:53:10.437792 [debug] [MainThread]: Parsing macros\utils\cast_bool_to_text.sql
[0m08:53:10.441797 [debug] [MainThread]: Parsing macros\utils\concat.sql
[0m08:53:10.446793 [debug] [MainThread]: Parsing macros\utils\data_types.sql
[0m08:53:10.466788 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m08:53:10.470797 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m08:53:10.476790 [debug] [MainThread]: Parsing macros\utils\date_trunc.sql
[0m08:53:10.480798 [debug] [MainThread]: Parsing macros\utils\escape_single_quotes.sql
[0m08:53:10.482799 [debug] [MainThread]: Parsing macros\utils\except.sql
[0m08:53:10.487819 [debug] [MainThread]: Parsing macros\utils\hash.sql
[0m08:53:10.490789 [debug] [MainThread]: Parsing macros\utils\intersect.sql
[0m08:53:10.492802 [debug] [MainThread]: Parsing macros\utils\last_day.sql
[0m08:53:10.497803 [debug] [MainThread]: Parsing macros\utils\length.sql
[0m08:53:10.500797 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m08:53:10.504799 [debug] [MainThread]: Parsing macros\utils\literal.sql
[0m08:53:10.506790 [debug] [MainThread]: Parsing macros\utils\position.sql
[0m08:53:10.508798 [debug] [MainThread]: Parsing macros\utils\replace.sql
[0m08:53:10.513738 [debug] [MainThread]: Parsing macros\utils\right.sql
[0m08:53:10.516738 [debug] [MainThread]: Parsing macros\utils\safe_cast.sql
[0m08:53:10.520744 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m08:53:10.527740 [debug] [MainThread]: Parsing tests\generic\builtin.sql
[0m08:53:11.147231 [debug] [MainThread]: 1603: static parser failed on users_7.sql
[0m08:53:11.184242 [debug] [MainThread]: 1602: parser fallback to jinja rendering on users_7.sql
[0m08:53:11.186236 [debug] [MainThread]: 1603: static parser failed on airbyte_ctes\dbo\users_7_ab1.sql
[0m08:53:11.255268 [debug] [MainThread]: 1602: parser fallback to jinja rendering on airbyte_ctes\dbo\users_7_ab1.sql
[0m08:53:11.259240 [debug] [MainThread]: 1603: static parser failed on airbyte_ctes\dbo\users_7_ab2.sql
[0m08:53:11.282250 [debug] [MainThread]: 1602: parser fallback to jinja rendering on airbyte_ctes\dbo\users_7_ab2.sql
[0m08:53:11.285253 [debug] [MainThread]: 1603: static parser failed on airbyte_ctes\dbo\users_7_ab3.sql
[0m08:53:11.296981 [debug] [MainThread]: 1602: parser fallback to jinja rendering on airbyte_ctes\dbo\users_7_ab3.sql
[0m08:53:11.417663 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stgo_dbt.staging

[0m08:53:11.481692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7da485f4-798b-4f8d-b932-055d5ce1c564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F6001CA00>]}
[0m08:53:11.507715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7da485f4-798b-4f8d-b932-055d5ce1c564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F5FE2D0D0>]}
[0m08:53:11.507715 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 501 macros, 0 operations, 2 seed files, 1 source, 0 exposures, 0 metrics
[0m08:53:11.508696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7da485f4-798b-4f8d-b932-055d5ce1c564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F5FE2D1F0>]}
[0m08:53:11.511653 [info ] [MainThread]: 
[0m08:53:11.513651 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m08:53:11.517666 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m08:53:11.541652 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m08:53:11.541652 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m08:53:11.541652 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:53:13.644460 [debug] [ThreadPool]: SQL status: SELECT 12 in 2.1 seconds
[0m08:53:13.648766 [debug] [ThreadPool]: On list_postgres: Close
[0m08:53:13.652897 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m08:53:13.663272 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m08:53:13.664270 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m08:53:13.664270 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:53:15.853805 [debug] [ThreadPool]: SQL status: BEGIN in 2.19 seconds
[0m08:53:15.854369 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m08:53:15.854369 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m08:53:15.868859 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.01 seconds
[0m08:53:15.870758 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m08:53:15.875143 [debug] [ThreadPool]: On list_postgres_public: Close
[0m08:53:15.893595 [debug] [MainThread]: Using postgres connection "master"
[0m08:53:15.894588 [debug] [MainThread]: On master: BEGIN
[0m08:53:15.894588 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:53:17.970022 [debug] [MainThread]: SQL status: BEGIN in 2.08 seconds
[0m08:53:17.971028 [debug] [MainThread]: Using postgres connection "master"
[0m08:53:17.971028 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:53:17.980021 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
[0m08:53:17.982019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7da485f4-798b-4f8d-b932-055d5ce1c564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F6000B160>]}
[0m08:53:17.983025 [debug] [MainThread]: On master: ROLLBACK
[0m08:53:17.987021 [debug] [MainThread]: Using postgres connection "master"
[0m08:53:17.987021 [debug] [MainThread]: On master: BEGIN
[0m08:53:17.991019 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:53:17.991019 [debug] [MainThread]: On master: COMMIT
[0m08:53:17.991019 [debug] [MainThread]: Using postgres connection "master"
[0m08:53:17.991019 [debug] [MainThread]: On master: COMMIT
[0m08:53:17.994034 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:53:17.995023 [debug] [MainThread]: On master: Close
[0m08:53:17.997023 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:53:17.998029 [info ] [MainThread]: 
[0m08:53:18.011021 [debug] [Thread-1  ]: Began running node model.stgo_dbt.users_7_ab1
[0m08:53:18.013025 [info ] [Thread-1  ]: 1 of 4 START sql table model public.users_7_ab1 ................................ [RUN]
[0m08:53:18.015023 [debug] [Thread-1  ]: Acquiring new postgres connection "model.stgo_dbt.users_7_ab1"
[0m08:53:18.016029 [debug] [Thread-1  ]: Began compiling node model.stgo_dbt.users_7_ab1
[0m08:53:18.017034 [debug] [Thread-1  ]: Compiling model.stgo_dbt.users_7_ab1
[0m08:53:18.087040 [debug] [Thread-1  ]: Writing injected SQL for node "model.stgo_dbt.users_7_ab1"
[0m08:53:18.115650 [debug] [Thread-1  ]: finished collecting timing info
[0m08:53:18.115650 [debug] [Thread-1  ]: Began executing node model.stgo_dbt.users_7_ab1
[0m08:53:18.186665 [debug] [Thread-1  ]: Writing runtime sql for node "model.stgo_dbt.users_7_ab1"
[0m08:53:18.189661 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.users_7_ab1"
[0m08:53:18.189661 [debug] [Thread-1  ]: On model.stgo_dbt.users_7_ab1: BEGIN
[0m08:53:18.189661 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m08:53:20.246388 [debug] [Thread-1  ]: SQL status: BEGIN in 2.06 seconds
[0m08:53:20.246932 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.users_7_ab1"
[0m08:53:20.246932 [debug] [Thread-1  ]: On model.stgo_dbt.users_7_ab1: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.users_7_ab1"} */

  
    

  create  table "postgres"."public"."users_7_ab1__dbt_tmp"
  as (
    
-- SQL model to parse JSON blob stored in a single column and extract into separated field columns as described by the JSON Schema
-- depends_on: "postgres".dbo._airbyte_raw_users_7
select
    jsonb_extract_path_text(_airbyte_data, 'id') as "id",
    jsonb_extract_path_text(_airbyte_data, 'ip') as ip,
    jsonb_extract_path_text(_airbyte_data, 'bod') as bod,
    jsonb_extract_path_text(_airbyte_data, 'sid') as sid,
    jsonb_extract_path_text(_airbyte_data, 'city') as city,
    jsonb_extract_path_text(_airbyte_data, 'meta') as meta,
    jsonb_extract_path_text(_airbyte_data, 'name') as "name",
    jsonb_extract_path_text(_airbyte_data, 'uuid') as uuid,
    jsonb_extract_path_text(_airbyte_data, 'email') as email,
    jsonb_extract_path_text(_airbyte_data, 'gender') as gender,
    jsonb_extract_path_text(_airbyte_data, 'mobile') as mobile,
    jsonb_extract_path_text(_airbyte_data, 'status') as status,
    jsonb_extract_path_text(_airbyte_data, 'OS_name') as os_name,
    jsonb_extract_path_text(_airbyte_data, 'country') as country,
    jsonb_extract_path_text(_airbyte_data, 'fav_dic') as fav_dic,
    jsonb_extract_path_text(_airbyte_data, 'is_kids') as is_kids,
    jsonb_extract_path_text(_airbyte_data, 'hawaui_id') as hawaui_id,
    jsonb_extract_path_text(_airbyte_data, 'join_date') as join_date,
    jsonb_extract_path_text(_airbyte_data, 'deleted_at') as deleted_at,
    jsonb_extract_path_text(_airbyte_data, 'is_deleted') as is_deleted,
    jsonb_extract_path_text(_airbyte_data, 'last_login') as last_login,
    jsonb_extract_path_text(_airbyte_data, 'parent_code') as parent_code,
    jsonb_extract_path_text(_airbyte_data, 'parent_date') as parent_date,
    jsonb_extract_path_text(_airbyte_data, 'session_key') as session_key,
    jsonb_extract_path_text(_airbyte_data, 'character_id') as character_id,
    jsonb_extract_path_text(_airbyte_data, 'readable_sid') as readable_sid,
    jsonb_extract_path_text(_airbyte_data, 'forbidden_dic') as forbidden_dic,
    jsonb_extract_path_text(_airbyte_data, 'last_login_ip') as last_login_ip,
    jsonb_extract_path_text(_airbyte_data, 'music_fav_dic') as music_fav_dic,
    jsonb_extract_path_text(_airbyte_data, 'profile_email') as profile_email,
    jsonb_extract_path_text(_airbyte_data, 'approve_policy') as approve_policy,
    jsonb_extract_path_text(_airbyte_data, 'parent_channel') as parent_channel,
    jsonb_extract_path_text(_airbyte_data, 'last_login_city') as last_login_city,
    jsonb_extract_path_text(_airbyte_data, 'extra_last_update') as extra_last_update,
    jsonb_extract_path_text(_airbyte_data, 'follow_topics_dic') as follow_topics_dic,
    jsonb_extract_path_text(_airbyte_data, 'planets_order_dic') as planets_order_dic,
    jsonb_extract_path_text(_airbyte_data, 'recent_series_dic') as recent_series_dic,
    jsonb_extract_path_text(_airbyte_data, 'last_login_country') as last_login_country,
    jsonb_extract_path_text(_airbyte_data, 'music_playlist_dic') as music_playlist_dic,
    jsonb_extract_path_text(_airbyte_data, 'recent_episode_dic') as recent_episode_dic,
    jsonb_extract_path_text(_airbyte_data, 'session_last_update') as session_last_update,
    _airbyte_ab_id,
    _airbyte_emitted_at,
    now() as _airbyte_normalized_at
from "postgres".dbo._airbyte_raw_users_7 as table_alias
-- users_7
where 1 = 1

  );
  
[0m08:53:21.268723 [debug] [Thread-1  ]: SQL status: SELECT 54800 in 1.02 seconds
[0m08:53:21.278242 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.users_7_ab1"
[0m08:53:21.278242 [debug] [Thread-1  ]: On model.stgo_dbt.users_7_ab1: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.users_7_ab1"} */
alter table "postgres"."public"."users_7_ab1__dbt_tmp" rename to "users_7_ab1"
[0m08:53:21.282117 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:53:21.300746 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.users_7_ab1"
[0m08:53:21.301744 [debug] [Thread-1  ]: On model.stgo_dbt.users_7_ab1: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.users_7_ab1"} */

    create  index if not exists
  "e5cd7281a23f7d84cf4b7459e3739ab5"
  on "postgres"."public"."users_7_ab1" using btree
  (_airbyte_emitted_at);
  
[0m08:53:21.492919 [debug] [Thread-1  ]: SQL status: CREATE INDEX in 0.19 seconds
[0m08:53:21.513849 [debug] [Thread-1  ]: On model.stgo_dbt.users_7_ab1: COMMIT
[0m08:53:21.514849 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.users_7_ab1"
[0m08:53:21.514849 [debug] [Thread-1  ]: On model.stgo_dbt.users_7_ab1: COMMIT
[0m08:53:21.600082 [debug] [Thread-1  ]: SQL status: COMMIT in 0.09 seconds
[0m08:53:21.606938 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.users_7_ab1"
[0m08:53:21.607469 [debug] [Thread-1  ]: On model.stgo_dbt.users_7_ab1: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.users_7_ab1"} */
drop table if exists "postgres"."public"."users_7_ab1__dbt_backup" cascade
[0m08:53:21.610907 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m08:53:21.613097 [debug] [Thread-1  ]: finished collecting timing info
[0m08:53:21.613680 [debug] [Thread-1  ]: On model.stgo_dbt.users_7_ab1: Close
[0m08:53:21.614790 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7da485f4-798b-4f8d-b932-055d5ce1c564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F600D6370>]}
[0m08:53:21.615910 [info ] [Thread-1  ]: 1 of 4 OK created sql table model public.users_7_ab1 ........................... [[32mSELECT 54800[0m in 3.60s]
[0m08:53:21.618265 [debug] [Thread-1  ]: Finished running node model.stgo_dbt.users_7_ab1
[0m08:53:21.619479 [debug] [Thread-3  ]: Began running node model.stgo_dbt.users_7_ab2
[0m08:53:21.620036 [info ] [Thread-3  ]: 2 of 4 START sql table model public.users_7_ab2 ................................ [RUN]
[0m08:53:21.622834 [debug] [Thread-3  ]: Acquiring new postgres connection "model.stgo_dbt.users_7_ab2"
[0m08:53:21.623437 [debug] [Thread-3  ]: Began compiling node model.stgo_dbt.users_7_ab2
[0m08:53:21.624080 [debug] [Thread-3  ]: Compiling model.stgo_dbt.users_7_ab2
[0m08:53:21.650282 [debug] [Thread-3  ]: finished collecting timing info
[0m08:53:21.652286 [debug] [Thread-3  ]: Compilation Error in model users_7_ab2 (models\airbyte_ctes\dbo\users_7_ab2.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m08:53:21.653299 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7da485f4-798b-4f8d-b932-055d5ce1c564', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F600A6A60>]}
[0m08:53:21.654300 [error] [Thread-3  ]: 2 of 4 ERROR creating sql table model public.users_7_ab2 ....................... [[31mERROR[0m in 0.03s]
[0m08:53:21.656305 [debug] [Thread-3  ]: Finished running node model.stgo_dbt.users_7_ab2
[0m08:53:21.657280 [debug] [Thread-2  ]: Began running node model.stgo_dbt.users_7_ab3
[0m08:53:21.657280 [info ] [Thread-2  ]: 3 of 4 SKIP relation public.users_7_ab3 ........................................ [[33mSKIP[0m]
[0m08:53:21.659285 [debug] [Thread-2  ]: Finished running node model.stgo_dbt.users_7_ab3
[0m08:53:21.661282 [debug] [Thread-4  ]: Began running node model.stgo_dbt.users_7
[0m08:53:21.661282 [info ] [Thread-4  ]: 4 of 4 SKIP relation public.users_7 ............................................ [[33mSKIP[0m]
[0m08:53:21.664286 [debug] [Thread-4  ]: Finished running node model.stgo_dbt.users_7
[0m08:53:21.666281 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m08:53:21.667278 [debug] [MainThread]: Using postgres connection "master"
[0m08:53:21.667278 [debug] [MainThread]: On master: BEGIN
[0m08:53:21.667278 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:53:23.756236 [debug] [MainThread]: SQL status: BEGIN in 2.09 seconds
[0m08:53:23.756236 [debug] [MainThread]: On master: COMMIT
[0m08:53:23.756996 [debug] [MainThread]: Using postgres connection "master"
[0m08:53:23.757075 [debug] [MainThread]: On master: COMMIT
[0m08:53:23.759251 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:53:23.760343 [debug] [MainThread]: On master: Close
[0m08:53:23.762110 [info ] [MainThread]: 
[0m08:53:23.764377 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 12.25 seconds (12.25s).
[0m08:53:23.766170 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:53:23.766264 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m08:53:23.766815 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m08:53:23.766815 [debug] [MainThread]: Connection 'model.stgo_dbt.users_7_ab1' was properly closed.
[0m08:53:23.767378 [debug] [MainThread]: Connection 'model.stgo_dbt.users_7_ab2' was properly closed.
[0m08:53:23.788433 [info ] [MainThread]: 
[0m08:53:23.789768 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:53:23.792291 [info ] [MainThread]: 
[0m08:53:23.793294 [error] [MainThread]: [33mCompilation Error in model users_7_ab2 (models\airbyte_ctes\dbo\users_7_ab2.sql)[0m
[0m08:53:23.795290 [error] [MainThread]:   'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m08:53:23.797293 [info ] [MainThread]: 
[0m08:53:23.798288 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=2 TOTAL=4
[0m08:53:23.800288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F5FE3E7C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F5FF502B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F5FF50850>]}
[0m08:53:23.800288 [debug] [MainThread]: Flushing usage events


============================== 2023-01-03 08:55:02.955948 | 352f3f6a-3658-4df5-a997-85dc031c278d ==============================
[0m08:55:02.955948 [info ] [MainThread]: Running with dbt=1.3.1
[0m08:55:02.956952 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'D:\\2023\\Cloudthought\\data-migration-dbt\\stgo_dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:55:02.957907 [debug] [MainThread]: Tracking: tracking
[0m08:55:03.013475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F12C06B3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F12C0159A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F12C061490>]}
[0m08:55:03.014473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F12C061490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F12C0158E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F12C082CD0>]}
[0m08:55:03.014473 [debug] [MainThread]: Flushing usage events
[0m08:55:05.823981 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.


============================== 2023-01-03 08:55:22.486427 | 4617b7f1-fe87-4a0a-bf45-e378d01bb3f5 ==============================
[0m08:55:22.486427 [info ] [MainThread]: Running with dbt=1.3.1
[0m08:55:22.488426 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'D:\\2023\\Cloudthought\\data-migration-dbt\\stgo_dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m08:55:22.489435 [debug] [MainThread]: Tracking: tracking
[0m08:55:22.538426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F24F57880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F24F57B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F24F57910>]}
[0m08:55:22.541427 [debug] [MainThread]: Set downloads directory='C:\Users\Dani\AppData\Local\Temp\dbt-downloads-w6zp5goz'
[0m08:55:22.542429 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/fishtown-analytics/dbt-utils.git 859fd0fa21176efee375a447937f7a46"
[0m08:55:27.409900 [debug] [MainThread]: STDOUT: "b''"
[0m08:55:27.409900 [debug] [MainThread]: STDERR: "b"Cloning into '859fd0fa21176efee375a447937f7a46'...\n""
[0m08:55:27.409900 [debug] [MainThread]: Pulling new dependency 859fd0fa21176efee375a447937f7a46.
[0m08:55:27.410884 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m08:55:27.464887 [debug] [MainThread]: STDOUT: "b'233cc05659097b30d44f54f78ebcf6a2f633366a\n'"
[0m08:55:27.465883 [debug] [MainThread]: STDERR: "b''"
[0m08:55:27.465883 [debug] [MainThread]:   Checking out revision 0.8.2.
[0m08:55:27.465883 [debug] [MainThread]: Executing "git remote set-branches origin 0.8.2"
[0m08:55:27.523890 [debug] [MainThread]: STDOUT: "b''"
[0m08:55:27.524893 [debug] [MainThread]: STDERR: "b''"
[0m08:55:27.524893 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags 0.8.2"
[0m08:55:32.684249 [debug] [MainThread]: STDOUT: "b''"
[0m08:55:32.685262 [debug] [MainThread]: STDERR: "b'From https://github.com/fishtown-analytics/dbt-utils\n * tag               0.8.2      -> FETCH_HEAD\n * [new tag]         0.0.1      -> 0.0.1\n * [new tag]         0.1.0      -> 0.1.0\n * [new tag]         0.1.1      -> 0.1.1\n * [new tag]         0.1.10     -> 0.1.10\n * [new tag]         0.1.11     -> 0.1.11\n * [new tag]         0.1.12     -> 0.1.12\n * [new tag]         0.1.13     -> 0.1.13\n * [new tag]         0.1.14     -> 0.1.14\n * [new tag]         0.1.15     -> 0.1.15\n * [new tag]         0.1.16     -> 0.1.16\n * [new tag]         0.1.17     -> 0.1.17\n * [new tag]         0.1.18     -> 0.1.18\n * [new tag]         0.1.19     -> 0.1.19\n * [new tag]         0.1.2      -> 0.1.2\n * [new tag]         0.1.20     -> 0.1.20\n * [new tag]         0.1.21     -> 0.1.21\n * [new tag]         0.1.22     -> 0.1.22\n * [new tag]         0.1.23     -> 0.1.23\n * [new tag]         0.1.24     -> 0.1.24\n * [new tag]         0.1.25     -> 0.1.25\n * [new tag]         0.1.3      -> 0.1.3\n * [new tag]         0.1.4      -> 0.1.4\n * [new tag]         0.1.5      -> 0.1.5\n * [new tag]         0.1.6      -> 0.1.6\n * [new tag]         0.1.7      -> 0.1.7\n * [new tag]         0.1.8      -> 0.1.8\n * [new tag]         0.1.9      -> 0.1.9\n * [new tag]         0.2.0      -> 0.2.0\n * [new tag]         0.2.1      -> 0.2.1\n * [new tag]         0.2.2      -> 0.2.2\n * [new tag]         0.2.3      -> 0.2.3\n * [new tag]         0.2.4      -> 0.2.4\n * [new tag]         0.2.5      -> 0.2.5\n * [new tag]         0.3.0      -> 0.3.0\n * [new tag]         0.4.0      -> 0.4.0\n * [new tag]         0.4.1      -> 0.4.1\n * [new tag]         0.5.0      -> 0.5.0\n * [new tag]         0.5.1      -> 0.5.1\n * [new tag]         0.6.0      -> 0.6.0\n * [new tag]         0.6.1      -> 0.6.1\n * [new tag]         0.6.2      -> 0.6.2\n * [new tag]         0.6.3      -> 0.6.3\n * [new tag]         0.6.4      -> 0.6.4\n * [new tag]         0.6.5      -> 0.6.5\n * [new tag]         0.6.6      -> 0.6.6\n * [new tag]         0.7.0      -> 0.7.0\n * [new tag]         0.7.1      -> 0.7.1\n * [new tag]         0.7.2      -> 0.7.2\n * [new tag]         0.7.3      -> 0.7.3\n * [new tag]         0.7.4      -> 0.7.4\n * [new tag]         0.7.4-b1   -> 0.7.4-b1\n * [new tag]         0.7.4b1    -> 0.7.4b1\n * [new tag]         0.7.5      -> 0.7.5\n * [new tag]         0.7.6      -> 0.7.6\n * [new tag]         0.8.0      -> 0.8.0\n * [new tag]         0.8.1      -> 0.8.1\n * [new tag]         0.8.2      -> 0.8.2\n * [new tag]         0.8.3      -> 0.8.3\n * [new tag]         0.8.4      -> 0.8.4\n * [new tag]         0.8.5      -> 0.8.5\n * [new tag]         0.8.6      -> 0.8.6\n * [new tag]         0.9.0      -> 0.9.0\n * [new tag]         0.9.1      -> 0.9.1\n * [new tag]         0.9.2      -> 0.9.2\n * [new tag]         0.9.5      -> 0.9.5\n * [new tag]         0.9.6      -> 0.9.6\n * [new tag]         1.0.0      -> 1.0.0\n * [new tag]         1.0.0-b1   -> 1.0.0-b1\n * [new tag]         1.0.0-b2   -> 1.0.0-b2\n * [new tag]         1.0.0-rc1  -> 1.0.0-rc1\n'"
[0m08:55:32.685262 [debug] [MainThread]: Executing "git tag --list"
[0m08:55:32.759240 [debug] [MainThread]: STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n0.7.1\n0.7.2\n0.7.3\n0.7.4\n0.7.4-b1\n0.7.4b1\n0.7.5\n0.7.6\n0.8.0\n0.8.1\n0.8.2\n0.8.3\n0.8.4\n0.8.5\n0.8.6\n0.9.0\n0.9.1\n0.9.2\n0.9.5\n0.9.6\n1.0.0\n1.0.0-b1\n1.0.0-b2\n1.0.0-rc1\n'"
[0m08:55:32.760279 [debug] [MainThread]: STDERR: "b''"
[0m08:55:32.760279 [debug] [MainThread]: Executing "git reset --hard tags/0.8.2"
[0m08:55:33.087314 [debug] [MainThread]: STDOUT: "b'HEAD is now at 5717b10 Fix union_relations error when no include/exclude provided\n'"
[0m08:55:33.087314 [debug] [MainThread]: STDERR: "b''"
[0m08:55:33.087314 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m08:55:33.143326 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m08:55:33.144372 [debug] [MainThread]: STDERR: "b''"
[0m08:55:33.144372 [debug] [MainThread]:   Checked out at 5717b10.
[0m08:55:33.160357 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/fishtown-analytics/dbt-utils.git 859fd0fa21176efee375a447937f7a46"
[0m08:55:33.217426 [debug] [MainThread]: STDOUT: "b''"
[0m08:55:33.217426 [debug] [MainThread]: STDERR: "b"fatal: destination path '859fd0fa21176efee375a447937f7a46' already exists and is not an empty directory.\n""
[0m08:55:33.217426 [debug] [MainThread]: command return code=128
[0m08:55:33.219439 [debug] [MainThread]: Updating existing dependency 859fd0fa21176efee375a447937f7a46.
[0m08:55:33.219439 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m08:55:33.269454 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m08:55:33.269454 [debug] [MainThread]: STDERR: "b''"
[0m08:55:33.270012 [debug] [MainThread]:   Checking out revision 0.8.2.
[0m08:55:33.271014 [debug] [MainThread]: Executing "git remote set-branches origin 0.8.2"
[0m08:55:33.331905 [debug] [MainThread]: STDOUT: "b''"
[0m08:55:33.331905 [debug] [MainThread]: STDERR: "b''"
[0m08:55:33.331905 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags 0.8.2"
[0m08:55:36.497535 [debug] [MainThread]: STDOUT: "b''"
[0m08:55:36.497535 [debug] [MainThread]: STDERR: "b'From https://github.com/fishtown-analytics/dbt-utils\n * tag               0.8.2      -> FETCH_HEAD\n'"
[0m08:55:36.498523 [debug] [MainThread]: Executing "git tag --list"
[0m08:55:36.572093 [debug] [MainThread]: STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n0.7.1\n0.7.2\n0.7.3\n0.7.4\n0.7.4-b1\n0.7.4b1\n0.7.5\n0.7.6\n0.8.0\n0.8.1\n0.8.2\n0.8.3\n0.8.4\n0.8.5\n0.8.6\n0.9.0\n0.9.1\n0.9.2\n0.9.5\n0.9.6\n1.0.0\n1.0.0-b1\n1.0.0-b2\n1.0.0-rc1\n'"
[0m08:55:36.572093 [debug] [MainThread]: STDERR: "b''"
[0m08:55:36.572093 [debug] [MainThread]: Executing "git reset --hard tags/0.8.2"
[0m08:55:36.673747 [debug] [MainThread]: STDOUT: "b'HEAD is now at 5717b10 Fix union_relations error when no include/exclude provided\n'"
[0m08:55:36.673747 [debug] [MainThread]: STDERR: "b''"
[0m08:55:36.674747 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m08:55:36.727768 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m08:55:36.727768 [debug] [MainThread]: STDERR: "b''"
[0m08:55:36.727768 [debug] [MainThread]: Already at 5717b10, nothing to do.
[0m08:55:36.734772 [info ] [MainThread]: Installing https://github.com/fishtown-analytics/dbt-utils.git
[0m08:55:36.736746 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/fishtown-analytics/dbt-utils.git 859fd0fa21176efee375a447937f7a46"
[0m08:55:36.795764 [debug] [MainThread]: STDOUT: "b''"
[0m08:55:36.795764 [debug] [MainThread]: STDERR: "b"fatal: destination path '859fd0fa21176efee375a447937f7a46' already exists and is not an empty directory.\n""
[0m08:55:36.796772 [debug] [MainThread]: command return code=128
[0m08:55:36.797746 [debug] [MainThread]: Updating existing dependency 859fd0fa21176efee375a447937f7a46.
[0m08:55:36.798747 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m08:55:36.854745 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m08:55:36.854745 [debug] [MainThread]: STDERR: "b''"
[0m08:55:36.854745 [debug] [MainThread]:   Checking out revision 0.8.2.
[0m08:55:36.855745 [debug] [MainThread]: Executing "git remote set-branches origin 0.8.2"
[0m08:55:36.923953 [debug] [MainThread]: STDOUT: "b''"
[0m08:55:36.924951 [debug] [MainThread]: STDERR: "b''"
[0m08:55:36.924951 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags 0.8.2"
[0m08:55:40.136818 [debug] [MainThread]: STDOUT: "b''"
[0m08:55:40.136818 [debug] [MainThread]: STDERR: "b'From https://github.com/fishtown-analytics/dbt-utils\n * tag               0.8.2      -> FETCH_HEAD\n'"
[0m08:55:40.137848 [debug] [MainThread]: Executing "git tag --list"
[0m08:55:40.212826 [debug] [MainThread]: STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n0.7.1\n0.7.2\n0.7.3\n0.7.4\n0.7.4-b1\n0.7.4b1\n0.7.5\n0.7.6\n0.8.0\n0.8.1\n0.8.2\n0.8.3\n0.8.4\n0.8.5\n0.8.6\n0.9.0\n0.9.1\n0.9.2\n0.9.5\n0.9.6\n1.0.0\n1.0.0-b1\n1.0.0-b2\n1.0.0-rc1\n'"
[0m08:55:40.212826 [debug] [MainThread]: STDERR: "b''"
[0m08:55:40.212826 [debug] [MainThread]: Executing "git reset --hard tags/0.8.2"
[0m08:55:40.301443 [debug] [MainThread]: STDOUT: "b'HEAD is now at 5717b10 Fix union_relations error when no include/exclude provided\n'"
[0m08:55:40.301443 [debug] [MainThread]: STDERR: "b''"
[0m08:55:40.301443 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m08:55:40.367056 [debug] [MainThread]: STDOUT: "b'5717b109d358844e0f085565b93e74cbe469ecb0\n'"
[0m08:55:40.367056 [debug] [MainThread]: STDERR: "b''"
[0m08:55:40.368064 [debug] [MainThread]: Already at 5717b10, nothing to do.
[0m08:55:43.829726 [info ] [MainThread]:   Installed from revision 0.8.2
[0m08:55:43.831725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4617b7f1-fe87-4a0a-bf45-e378d01bb3f5', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F24F6EC70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F24F6EC10>]}
[0m08:55:43.834723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F24F57C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F24F6E9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F24F7B1C0>]}
[0m08:55:43.834723 [debug] [MainThread]: Flushing usage events


============================== 2023-01-03 08:55:56.455535 | 1c812bad-8f37-49a9-9087-2ba54be35554 ==============================
[0m08:55:56.455535 [info ] [MainThread]: Running with dbt=1.3.1
[0m08:55:56.457511 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'D:\\2023\\Cloudthought\\data-migration-dbt\\stgo_dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:55:56.458510 [debug] [MainThread]: Tracking: tracking
[0m08:55:56.519505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C95E76B3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C95E7158E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C95E7617F0>]}
[0m08:55:56.695181 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m08:55:56.696147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1c812bad-8f37-49a9-9087-2ba54be35554', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C95E782430>]}
[0m08:55:57.073086 [debug] [MainThread]: Parsing macros\clean_tmp_tables.sql
[0m08:55:57.078074 [debug] [MainThread]: Parsing macros\configuration.sql
[0m08:55:57.083078 [debug] [MainThread]: Parsing macros\get_custom_schema.sql
[0m08:55:57.084079 [debug] [MainThread]: Parsing macros\incremental.sql
[0m08:55:57.095073 [debug] [MainThread]: Parsing macros\should_full_refresh.sql
[0m08:55:57.103084 [debug] [MainThread]: Parsing macros\star_intersect.sql
[0m08:55:57.116069 [debug] [MainThread]: Parsing macros\cross_db_utils\array.sql
[0m08:55:57.176972 [debug] [MainThread]: Parsing macros\cross_db_utils\columns.sql
[0m08:55:57.183638 [debug] [MainThread]: Parsing macros\cross_db_utils\concat.sql
[0m08:55:57.192640 [debug] [MainThread]: Parsing macros\cross_db_utils\current_timestamp.sql
[0m08:55:57.193639 [debug] [MainThread]: Parsing macros\cross_db_utils\datatypes.sql
[0m08:55:57.219637 [debug] [MainThread]: Parsing macros\cross_db_utils\except.sql
[0m08:55:57.220636 [debug] [MainThread]: Parsing macros\cross_db_utils\hash.sql
[0m08:55:57.221636 [debug] [MainThread]: Parsing macros\cross_db_utils\json_operations.sql
[0m08:55:57.281653 [debug] [MainThread]: Parsing macros\cross_db_utils\quote.sql
[0m08:55:57.283659 [debug] [MainThread]: Parsing macros\cross_db_utils\surrogate_key.sql
[0m08:55:57.285654 [debug] [MainThread]: Parsing macros\cross_db_utils\type_conversions.sql
[0m08:55:57.297654 [debug] [MainThread]: Parsing macros\schema_tests\equality.sql
[0m08:55:57.307665 [debug] [MainThread]: Parsing macros\schema_tests\equal_rowcount.sql
[0m08:55:57.309659 [debug] [MainThread]: Parsing macros\adapters.sql
[0m08:55:57.348639 [debug] [MainThread]: Parsing macros\catalog.sql
[0m08:55:57.352655 [debug] [MainThread]: Parsing macros\relations.sql
[0m08:55:57.356638 [debug] [MainThread]: Parsing macros\timestamps.sql
[0m08:55:57.360640 [debug] [MainThread]: Parsing macros\materializations\incremental_strategies.sql
[0m08:55:57.363654 [debug] [MainThread]: Parsing macros\materializations\snapshot_merge.sql
[0m08:55:57.367641 [debug] [MainThread]: Parsing macros\utils\any_value.sql
[0m08:55:57.369642 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m08:55:57.372639 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m08:55:57.381650 [debug] [MainThread]: Parsing macros\utils\last_day.sql
[0m08:55:57.383688 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m08:55:57.385638 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m08:55:57.388640 [debug] [MainThread]: Parsing macros\adapters\apply_grants.sql
[0m08:55:57.405686 [debug] [MainThread]: Parsing macros\adapters\columns.sql
[0m08:55:57.419687 [debug] [MainThread]: Parsing macros\adapters\freshness.sql
[0m08:55:57.421686 [debug] [MainThread]: Parsing macros\adapters\indexes.sql
[0m08:55:57.425641 [debug] [MainThread]: Parsing macros\adapters\metadata.sql
[0m08:55:57.437541 [debug] [MainThread]: Parsing macros\adapters\persist_docs.sql
[0m08:55:57.445523 [debug] [MainThread]: Parsing macros\adapters\relation.sql
[0m08:55:57.469527 [debug] [MainThread]: Parsing macros\adapters\schema.sql
[0m08:55:57.471525 [debug] [MainThread]: Parsing macros\adapters\timestamps.sql
[0m08:55:57.476521 [debug] [MainThread]: Parsing macros\etc\datetime.sql
[0m08:55:57.488521 [debug] [MainThread]: Parsing macros\etc\statement.sql
[0m08:55:57.497530 [debug] [MainThread]: Parsing macros\generic_test_sql\accepted_values.sql
[0m08:55:57.499524 [debug] [MainThread]: Parsing macros\generic_test_sql\not_null.sql
[0m08:55:57.500524 [debug] [MainThread]: Parsing macros\generic_test_sql\relationships.sql
[0m08:55:57.501526 [debug] [MainThread]: Parsing macros\generic_test_sql\unique.sql
[0m08:55:57.502523 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_alias.sql
[0m08:55:57.504524 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_database.sql
[0m08:55:57.508513 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_schema.sql
[0m08:55:57.512510 [debug] [MainThread]: Parsing macros\materializations\configs.sql
[0m08:55:57.515508 [debug] [MainThread]: Parsing macros\materializations\hooks.sql
[0m08:55:57.523510 [debug] [MainThread]: Parsing macros\materializations\models\incremental\column_helpers.sql
[0m08:55:57.536511 [debug] [MainThread]: Parsing macros\materializations\models\incremental\incremental.sql
[0m08:55:57.552511 [debug] [MainThread]: Parsing macros\materializations\models\incremental\is_incremental.sql
[0m08:55:57.554508 [debug] [MainThread]: Parsing macros\materializations\models\incremental\merge.sql
[0m08:55:57.576525 [debug] [MainThread]: Parsing macros\materializations\models\incremental\on_schema_change.sql
[0m08:55:57.597555 [debug] [MainThread]: Parsing macros\materializations\models\incremental\strategies.sql
[0m08:55:57.619522 [debug] [MainThread]: Parsing macros\materializations\models\table\create_table_as.sql
[0m08:55:57.627546 [debug] [MainThread]: Parsing macros\materializations\models\table\table.sql
[0m08:55:57.634566 [debug] [MainThread]: Parsing macros\materializations\models\view\create_or_replace_view.sql
[0m08:55:57.639510 [debug] [MainThread]: Parsing macros\materializations\models\view\create_view_as.sql
[0m08:55:57.643562 [debug] [MainThread]: Parsing macros\materializations\models\view\helpers.sql
[0m08:55:57.645560 [debug] [MainThread]: Parsing macros\materializations\models\view\view.sql
[0m08:55:57.654513 [debug] [MainThread]: Parsing macros\materializations\seeds\helpers.sql
[0m08:55:57.682510 [debug] [MainThread]: Parsing macros\materializations\seeds\seed.sql
[0m08:55:57.693519 [debug] [MainThread]: Parsing macros\materializations\snapshots\helpers.sql
[0m08:55:57.709205 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot.sql
[0m08:55:57.725224 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot_merge.sql
[0m08:55:57.727201 [debug] [MainThread]: Parsing macros\materializations\snapshots\strategies.sql
[0m08:55:57.748180 [debug] [MainThread]: Parsing macros\materializations\tests\helpers.sql
[0m08:55:57.751170 [debug] [MainThread]: Parsing macros\materializations\tests\test.sql
[0m08:55:57.755170 [debug] [MainThread]: Parsing macros\materializations\tests\where_subquery.sql
[0m08:55:57.758171 [debug] [MainThread]: Parsing macros\python_model\python.sql
[0m08:55:57.769231 [debug] [MainThread]: Parsing macros\utils\any_value.sql
[0m08:55:57.770180 [debug] [MainThread]: Parsing macros\utils\array_append.sql
[0m08:55:57.772211 [debug] [MainThread]: Parsing macros\utils\array_concat.sql
[0m08:55:57.775199 [debug] [MainThread]: Parsing macros\utils\array_construct.sql
[0m08:55:57.778225 [debug] [MainThread]: Parsing macros\utils\bool_or.sql
[0m08:55:57.779221 [debug] [MainThread]: Parsing macros\utils\cast_bool_to_text.sql
[0m08:55:57.781221 [debug] [MainThread]: Parsing macros\utils\concat.sql
[0m08:55:57.782208 [debug] [MainThread]: Parsing macros\utils\data_types.sql
[0m08:55:57.794189 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m08:55:57.795170 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m08:55:57.797170 [debug] [MainThread]: Parsing macros\utils\date_trunc.sql
[0m08:55:57.800177 [debug] [MainThread]: Parsing macros\utils\escape_single_quotes.sql
[0m08:55:57.803186 [debug] [MainThread]: Parsing macros\utils\except.sql
[0m08:55:57.805220 [debug] [MainThread]: Parsing macros\utils\hash.sql
[0m08:55:57.806180 [debug] [MainThread]: Parsing macros\utils\intersect.sql
[0m08:55:57.808179 [debug] [MainThread]: Parsing macros\utils\last_day.sql
[0m08:55:57.811171 [debug] [MainThread]: Parsing macros\utils\length.sql
[0m08:55:57.812192 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m08:55:57.817217 [debug] [MainThread]: Parsing macros\utils\literal.sql
[0m08:55:57.818219 [debug] [MainThread]: Parsing macros\utils\position.sql
[0m08:55:57.819217 [debug] [MainThread]: Parsing macros\utils\replace.sql
[0m08:55:57.821215 [debug] [MainThread]: Parsing macros\utils\right.sql
[0m08:55:57.822170 [debug] [MainThread]: Parsing macros\utils\safe_cast.sql
[0m08:55:57.824218 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m08:55:57.827179 [debug] [MainThread]: Parsing tests\generic\builtin.sql
[0m08:55:57.831228 [debug] [MainThread]: Parsing macros\cross_db_utils\any_value.sql
[0m08:55:57.833220 [debug] [MainThread]: Parsing macros\cross_db_utils\bool_or.sql
[0m08:55:57.835223 [debug] [MainThread]: Parsing macros\cross_db_utils\cast_bool_to_text.sql
[0m08:55:57.837219 [debug] [MainThread]: Parsing macros\cross_db_utils\concat.sql
[0m08:55:57.840196 [debug] [MainThread]: Parsing macros\cross_db_utils\current_timestamp.sql
[0m08:55:57.846226 [debug] [MainThread]: Parsing macros\cross_db_utils\datatypes.sql
[0m08:55:57.856183 [debug] [MainThread]: Parsing macros\cross_db_utils\dateadd.sql
[0m08:55:57.861183 [debug] [MainThread]: Parsing macros\cross_db_utils\datediff.sql
[0m08:55:57.874220 [debug] [MainThread]: Parsing macros\cross_db_utils\date_trunc.sql
[0m08:55:57.876219 [debug] [MainThread]: Parsing macros\cross_db_utils\escape_single_quotes.sql
[0m08:55:57.878171 [debug] [MainThread]: Parsing macros\cross_db_utils\except.sql
[0m08:55:57.881229 [debug] [MainThread]: Parsing macros\cross_db_utils\hash.sql
[0m08:55:57.884212 [debug] [MainThread]: Parsing macros\cross_db_utils\identifier.sql
[0m08:55:57.886222 [debug] [MainThread]: Parsing macros\cross_db_utils\intersect.sql
[0m08:55:57.888219 [debug] [MainThread]: Parsing macros\cross_db_utils\last_day.sql
[0m08:55:57.892200 [debug] [MainThread]: Parsing macros\cross_db_utils\length.sql
[0m08:55:57.894172 [debug] [MainThread]: Parsing macros\cross_db_utils\literal.sql
[0m08:55:57.896181 [debug] [MainThread]: Parsing macros\cross_db_utils\position.sql
[0m08:55:57.899222 [debug] [MainThread]: Parsing macros\cross_db_utils\replace.sql
[0m08:55:57.900174 [debug] [MainThread]: Parsing macros\cross_db_utils\right.sql
[0m08:55:57.903219 [debug] [MainThread]: Parsing macros\cross_db_utils\safe_cast.sql
[0m08:55:57.906176 [debug] [MainThread]: Parsing macros\cross_db_utils\split_part.sql
[0m08:55:57.909182 [debug] [MainThread]: Parsing macros\cross_db_utils\width_bucket.sql
[0m08:55:57.915213 [debug] [MainThread]: Parsing macros\cross_db_utils\_is_ephemeral.sql
[0m08:55:57.918172 [debug] [MainThread]: Parsing macros\cross_db_utils\_is_relation.sql
[0m08:55:57.921197 [debug] [MainThread]: Parsing macros\jinja_helpers\log_info.sql
[0m08:55:57.923203 [debug] [MainThread]: Parsing macros\jinja_helpers\pretty_log_format.sql
[0m08:55:57.925186 [debug] [MainThread]: Parsing macros\jinja_helpers\pretty_time.sql
[0m08:55:57.926187 [debug] [MainThread]: Parsing macros\jinja_helpers\slugify.sql
[0m08:55:57.928187 [debug] [MainThread]: Parsing macros\materializations\insert_by_period_materialization.sql
[0m08:55:57.961884 [debug] [MainThread]: Parsing macros\schema_tests\accepted_range.sql
[0m08:55:57.965904 [debug] [MainThread]: Parsing macros\schema_tests\at_least_one.sql
[0m08:55:57.968849 [debug] [MainThread]: Parsing macros\schema_tests\cardinality_equality.sql
[0m08:55:57.970884 [debug] [MainThread]: Parsing macros\schema_tests\equality.sql
[0m08:55:57.976061 [debug] [MainThread]: Parsing macros\schema_tests\equal_rowcount.sql
[0m08:55:57.979078 [debug] [MainThread]: Parsing macros\schema_tests\expression_is_true.sql
[0m08:55:57.981036 [debug] [MainThread]: Parsing macros\schema_tests\fewer_rows_than.sql
[0m08:55:57.983060 [debug] [MainThread]: Parsing macros\schema_tests\mutually_exclusive_ranges.sql
[0m08:55:57.994034 [debug] [MainThread]: Parsing macros\schema_tests\not_accepted_values.sql
[0m08:55:57.997065 [debug] [MainThread]: Parsing macros\schema_tests\not_constant.sql
[0m08:55:57.999027 [debug] [MainThread]: Parsing macros\schema_tests\not_null_proportion.sql
[0m08:55:58.003022 [debug] [MainThread]: Parsing macros\schema_tests\recency.sql
[0m08:55:58.005068 [debug] [MainThread]: Parsing macros\schema_tests\relationships_where.sql
[0m08:55:58.008061 [debug] [MainThread]: Parsing macros\schema_tests\sequential_values.sql
[0m08:55:58.012016 [debug] [MainThread]: Parsing macros\schema_tests\test_not_null_where.sql
[0m08:55:58.017017 [debug] [MainThread]: Parsing macros\schema_tests\test_unique_where.sql
[0m08:55:58.019017 [debug] [MainThread]: Parsing macros\schema_tests\unique_combination_of_columns.sql
[0m08:55:58.025019 [debug] [MainThread]: Parsing macros\sql\date_spine.sql
[0m08:55:58.032069 [debug] [MainThread]: Parsing macros\sql\generate_series.sql
[0m08:55:58.037094 [debug] [MainThread]: Parsing macros\sql\get_column_values.sql
[0m08:55:58.045070 [debug] [MainThread]: Parsing macros\sql\get_query_results_as_dict.sql
[0m08:55:58.048017 [debug] [MainThread]: Parsing macros\sql\get_relations_by_pattern.sql
[0m08:55:58.052017 [debug] [MainThread]: Parsing macros\sql\get_relations_by_prefix.sql
[0m08:55:58.057065 [debug] [MainThread]: Parsing macros\sql\get_tables_by_pattern_sql.sql
[0m08:55:58.064062 [debug] [MainThread]: Parsing macros\sql\get_tables_by_prefix_sql.sql
[0m08:55:58.067031 [debug] [MainThread]: Parsing macros\sql\get_table_types_sql.sql
[0m08:55:58.070069 [debug] [MainThread]: Parsing macros\sql\groupby.sql
[0m08:55:58.071065 [debug] [MainThread]: Parsing macros\sql\haversine_distance.sql
[0m08:55:58.081021 [debug] [MainThread]: Parsing macros\sql\nullcheck.sql
[0m08:55:58.084071 [debug] [MainThread]: Parsing macros\sql\nullcheck_table.sql
[0m08:55:58.085066 [debug] [MainThread]: Parsing macros\sql\pivot.sql
[0m08:55:58.090062 [debug] [MainThread]: Parsing macros\sql\safe_add.sql
[0m08:55:58.093016 [debug] [MainThread]: Parsing macros\sql\star.sql
[0m08:55:58.099064 [debug] [MainThread]: Parsing macros\sql\surrogate_key.sql
[0m08:55:58.103063 [debug] [MainThread]: Parsing macros\sql\union.sql
[0m08:55:58.121016 [debug] [MainThread]: Parsing macros\sql\unpivot.sql
[0m08:55:58.130015 [debug] [MainThread]: Parsing macros\web\get_url_host.sql
[0m08:55:58.133016 [debug] [MainThread]: Parsing macros\web\get_url_parameter.sql
[0m08:55:58.137033 [debug] [MainThread]: Parsing macros\web\get_url_path.sql
[0m08:55:58.843930 [debug] [MainThread]: 1603: static parser failed on users_7.sql
[0m08:55:58.880899 [debug] [MainThread]: 1602: parser fallback to jinja rendering on users_7.sql
[0m08:55:58.883929 [debug] [MainThread]: 1603: static parser failed on airbyte_ctes\dbo\users_7_ab1.sql
[0m08:55:58.950896 [debug] [MainThread]: 1602: parser fallback to jinja rendering on airbyte_ctes\dbo\users_7_ab1.sql
[0m08:55:58.953891 [debug] [MainThread]: 1603: static parser failed on airbyte_ctes\dbo\users_7_ab2.sql
[0m08:55:58.996876 [debug] [MainThread]: 1602: parser fallback to jinja rendering on airbyte_ctes\dbo\users_7_ab2.sql
[0m08:55:58.998878 [debug] [MainThread]: 1603: static parser failed on airbyte_ctes\dbo\users_7_ab3.sql
[0m08:55:59.049887 [debug] [MainThread]: 1602: parser fallback to jinja rendering on airbyte_ctes\dbo\users_7_ab3.sql
[0m08:55:59.248877 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stgo_dbt.staging

[0m08:55:59.260907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c812bad-8f37-49a9-9087-2ba54be35554', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C95EA7D910>]}
[0m08:55:59.298906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c812bad-8f37-49a9-9087-2ba54be35554', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C958C2BE80>]}
[0m08:55:59.299906 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 703 macros, 0 operations, 2 seed files, 1 source, 0 exposures, 0 metrics
[0m08:55:59.301936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c812bad-8f37-49a9-9087-2ba54be35554', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C95E7159A0>]}
[0m08:55:59.304908 [info ] [MainThread]: 
[0m08:55:59.307908 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m08:55:59.311955 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m08:55:59.329919 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m08:55:59.329919 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m08:55:59.329919 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:56:01.412938 [debug] [ThreadPool]: SQL status: SELECT 12 in 2.08 seconds
[0m08:56:01.415772 [debug] [ThreadPool]: On list_postgres: Close
[0m08:56:01.420158 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m08:56:01.431249 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m08:56:01.432233 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m08:56:01.432233 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:56:03.528835 [debug] [ThreadPool]: SQL status: BEGIN in 2.1 seconds
[0m08:56:03.529509 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m08:56:03.529509 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m08:56:03.535329 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.01 seconds
[0m08:56:03.537842 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m08:56:03.540351 [debug] [ThreadPool]: On list_postgres_public: Close
[0m08:56:03.551706 [debug] [MainThread]: Using postgres connection "master"
[0m08:56:03.551706 [debug] [MainThread]: On master: BEGIN
[0m08:56:03.551706 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:56:05.652207 [debug] [MainThread]: SQL status: BEGIN in 2.1 seconds
[0m08:56:05.652771 [debug] [MainThread]: Using postgres connection "master"
[0m08:56:05.652771 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:56:05.670351 [debug] [MainThread]: SQL status: SELECT 0 in 0.02 seconds
[0m08:56:05.673369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c812bad-8f37-49a9-9087-2ba54be35554', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C95EA7D0D0>]}
[0m08:56:05.674191 [debug] [MainThread]: On master: ROLLBACK
[0m08:56:05.676730 [debug] [MainThread]: Using postgres connection "master"
[0m08:56:05.677298 [debug] [MainThread]: On master: BEGIN
[0m08:56:05.681936 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:56:05.682474 [debug] [MainThread]: On master: COMMIT
[0m08:56:05.683073 [debug] [MainThread]: Using postgres connection "master"
[0m08:56:05.683583 [debug] [MainThread]: On master: COMMIT
[0m08:56:05.687049 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:56:05.687049 [debug] [MainThread]: On master: Close
[0m08:56:05.688801 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:56:05.689960 [info ] [MainThread]: 
[0m08:56:05.704843 [debug] [Thread-1  ]: Began running node model.stgo_dbt.users_7_ab1
[0m08:56:05.704843 [info ] [Thread-1  ]: 1 of 4 START sql table model public.users_7_ab1 ................................ [RUN]
[0m08:56:05.707828 [debug] [Thread-1  ]: Acquiring new postgres connection "model.stgo_dbt.users_7_ab1"
[0m08:56:05.708827 [debug] [Thread-1  ]: Began compiling node model.stgo_dbt.users_7_ab1
[0m08:56:05.709829 [debug] [Thread-1  ]: Compiling model.stgo_dbt.users_7_ab1
[0m08:56:05.810780 [debug] [Thread-1  ]: Writing injected SQL for node "model.stgo_dbt.users_7_ab1"
[0m08:56:05.811785 [debug] [Thread-1  ]: finished collecting timing info
[0m08:56:05.812778 [debug] [Thread-1  ]: Began executing node model.stgo_dbt.users_7_ab1
[0m08:56:05.891777 [debug] [Thread-1  ]: Writing runtime sql for node "model.stgo_dbt.users_7_ab1"
[0m08:56:05.892778 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.users_7_ab1"
[0m08:56:05.892778 [debug] [Thread-1  ]: On model.stgo_dbt.users_7_ab1: BEGIN
[0m08:56:05.892778 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m08:56:07.991219 [debug] [Thread-1  ]: SQL status: BEGIN in 2.1 seconds
[0m08:56:07.991816 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.users_7_ab1"
[0m08:56:07.992772 [debug] [Thread-1  ]: On model.stgo_dbt.users_7_ab1: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.users_7_ab1"} */

  
    

  create  table "postgres"."public"."users_7_ab1__dbt_tmp"
  as (
    
-- SQL model to parse JSON blob stored in a single column and extract into separated field columns as described by the JSON Schema
-- depends_on: "postgres".dbo._airbyte_raw_users_7
select
    jsonb_extract_path_text(_airbyte_data, 'id') as "id",
    jsonb_extract_path_text(_airbyte_data, 'ip') as ip,
    jsonb_extract_path_text(_airbyte_data, 'bod') as bod,
    jsonb_extract_path_text(_airbyte_data, 'sid') as sid,
    jsonb_extract_path_text(_airbyte_data, 'city') as city,
    jsonb_extract_path_text(_airbyte_data, 'meta') as meta,
    jsonb_extract_path_text(_airbyte_data, 'name') as "name",
    jsonb_extract_path_text(_airbyte_data, 'uuid') as uuid,
    jsonb_extract_path_text(_airbyte_data, 'email') as email,
    jsonb_extract_path_text(_airbyte_data, 'gender') as gender,
    jsonb_extract_path_text(_airbyte_data, 'mobile') as mobile,
    jsonb_extract_path_text(_airbyte_data, 'status') as status,
    jsonb_extract_path_text(_airbyte_data, 'OS_name') as os_name,
    jsonb_extract_path_text(_airbyte_data, 'country') as country,
    jsonb_extract_path_text(_airbyte_data, 'fav_dic') as fav_dic,
    jsonb_extract_path_text(_airbyte_data, 'is_kids') as is_kids,
    jsonb_extract_path_text(_airbyte_data, 'hawaui_id') as hawaui_id,
    jsonb_extract_path_text(_airbyte_data, 'join_date') as join_date,
    jsonb_extract_path_text(_airbyte_data, 'deleted_at') as deleted_at,
    jsonb_extract_path_text(_airbyte_data, 'is_deleted') as is_deleted,
    jsonb_extract_path_text(_airbyte_data, 'last_login') as last_login,
    jsonb_extract_path_text(_airbyte_data, 'parent_code') as parent_code,
    jsonb_extract_path_text(_airbyte_data, 'parent_date') as parent_date,
    jsonb_extract_path_text(_airbyte_data, 'session_key') as session_key,
    jsonb_extract_path_text(_airbyte_data, 'character_id') as character_id,
    jsonb_extract_path_text(_airbyte_data, 'readable_sid') as readable_sid,
    jsonb_extract_path_text(_airbyte_data, 'forbidden_dic') as forbidden_dic,
    jsonb_extract_path_text(_airbyte_data, 'last_login_ip') as last_login_ip,
    jsonb_extract_path_text(_airbyte_data, 'music_fav_dic') as music_fav_dic,
    jsonb_extract_path_text(_airbyte_data, 'profile_email') as profile_email,
    jsonb_extract_path_text(_airbyte_data, 'approve_policy') as approve_policy,
    jsonb_extract_path_text(_airbyte_data, 'parent_channel') as parent_channel,
    jsonb_extract_path_text(_airbyte_data, 'last_login_city') as last_login_city,
    jsonb_extract_path_text(_airbyte_data, 'extra_last_update') as extra_last_update,
    jsonb_extract_path_text(_airbyte_data, 'follow_topics_dic') as follow_topics_dic,
    jsonb_extract_path_text(_airbyte_data, 'planets_order_dic') as planets_order_dic,
    jsonb_extract_path_text(_airbyte_data, 'recent_series_dic') as recent_series_dic,
    jsonb_extract_path_text(_airbyte_data, 'last_login_country') as last_login_country,
    jsonb_extract_path_text(_airbyte_data, 'music_playlist_dic') as music_playlist_dic,
    jsonb_extract_path_text(_airbyte_data, 'recent_episode_dic') as recent_episode_dic,
    jsonb_extract_path_text(_airbyte_data, 'session_last_update') as session_last_update,
    _airbyte_ab_id,
    _airbyte_emitted_at,
    now() as _airbyte_normalized_at
from "postgres".dbo._airbyte_raw_users_7 as table_alias
-- users_7
where 1 = 1

  );
  
[0m08:56:09.249899 [debug] [Thread-1  ]: SQL status: SELECT 54800 in 1.26 seconds
[0m08:56:09.261511 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.users_7_ab1"
[0m08:56:09.261511 [debug] [Thread-1  ]: On model.stgo_dbt.users_7_ab1: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.users_7_ab1"} */
alter table "postgres"."public"."users_7_ab1" rename to "users_7_ab1__dbt_backup"
[0m08:56:09.266270 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:56:09.271436 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.users_7_ab1"
[0m08:56:09.271436 [debug] [Thread-1  ]: On model.stgo_dbt.users_7_ab1: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.users_7_ab1"} */
alter table "postgres"."public"."users_7_ab1__dbt_tmp" rename to "users_7_ab1"
[0m08:56:09.273711 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:56:09.295237 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.users_7_ab1"
[0m08:56:09.295237 [debug] [Thread-1  ]: On model.stgo_dbt.users_7_ab1: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.users_7_ab1"} */

    create  index if not exists
  "ff7196b8cda6fca93fd38f3612efc192"
  on "postgres"."public"."users_7_ab1" using btree
  (_airbyte_emitted_at);
  
[0m08:56:09.399009 [debug] [Thread-1  ]: SQL status: CREATE INDEX in 0.1 seconds
[0m08:56:09.427046 [debug] [Thread-1  ]: On model.stgo_dbt.users_7_ab1: COMMIT
[0m08:56:09.427046 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.users_7_ab1"
[0m08:56:09.427046 [debug] [Thread-1  ]: On model.stgo_dbt.users_7_ab1: COMMIT
[0m08:56:09.539579 [debug] [Thread-1  ]: SQL status: COMMIT in 0.11 seconds
[0m08:56:09.547688 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.users_7_ab1"
[0m08:56:09.547688 [debug] [Thread-1  ]: On model.stgo_dbt.users_7_ab1: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.users_7_ab1"} */
drop table if exists "postgres"."public"."users_7_ab1__dbt_backup" cascade
[0m08:56:09.584419 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.04 seconds
[0m08:56:09.586024 [debug] [Thread-1  ]: finished collecting timing info
[0m08:56:09.586024 [debug] [Thread-1  ]: On model.stgo_dbt.users_7_ab1: Close
[0m08:56:09.587451 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c812bad-8f37-49a9-9087-2ba54be35554', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C95EBEDA00>]}
[0m08:56:09.587451 [info ] [Thread-1  ]: 1 of 4 OK created sql table model public.users_7_ab1 ........................... [[32mSELECT 54800[0m in 3.88s]
[0m08:56:09.589447 [debug] [Thread-1  ]: Finished running node model.stgo_dbt.users_7_ab1
[0m08:56:09.590448 [debug] [Thread-3  ]: Began running node model.stgo_dbt.users_7_ab2
[0m08:56:09.591453 [info ] [Thread-3  ]: 2 of 4 START sql table model public.users_7_ab2 ................................ [RUN]
[0m08:56:09.595309 [debug] [Thread-3  ]: Acquiring new postgres connection "model.stgo_dbt.users_7_ab2"
[0m08:56:09.595903 [debug] [Thread-3  ]: Began compiling node model.stgo_dbt.users_7_ab2
[0m08:56:09.595903 [debug] [Thread-3  ]: Compiling model.stgo_dbt.users_7_ab2
[0m08:56:09.638830 [debug] [Thread-3  ]: Writing injected SQL for node "model.stgo_dbt.users_7_ab2"
[0m08:56:09.640793 [debug] [Thread-3  ]: finished collecting timing info
[0m08:56:09.640793 [debug] [Thread-3  ]: Began executing node model.stgo_dbt.users_7_ab2
[0m08:56:09.652790 [debug] [Thread-3  ]: Writing runtime sql for node "model.stgo_dbt.users_7_ab2"
[0m08:56:09.653816 [debug] [Thread-3  ]: Using postgres connection "model.stgo_dbt.users_7_ab2"
[0m08:56:09.653816 [debug] [Thread-3  ]: On model.stgo_dbt.users_7_ab2: BEGIN
[0m08:56:09.654823 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m08:56:11.744275 [debug] [Thread-3  ]: SQL status: BEGIN in 2.09 seconds
[0m08:56:11.744275 [debug] [Thread-3  ]: Using postgres connection "model.stgo_dbt.users_7_ab2"
[0m08:56:11.744804 [debug] [Thread-3  ]: On model.stgo_dbt.users_7_ab2: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.users_7_ab2"} */

  
    

  create  table "postgres"."public"."users_7_ab2__dbt_tmp"
  as (
    
-- SQL model to cast each column to its adequate SQL type converted from the JSON schema type
-- depends_on: "postgres"."public"."users_7_ab1"
select
    cast("id" as 
    bigint
) as "id",
    cast(ip as text) as ip,
    cast(bod as text) as bod,
    cast(sid as 
    float
) as sid,
    cast(city as text) as city,
    cast(meta as text) as meta,
    cast("name" as text) as "name",
    cast(uuid as 
    bigint
) as uuid,
    cast(email as text) as email,
    cast(gender as text) as gender,
    cast(mobile as text) as mobile,
    cast(status as 
    bigint
) as status,
    cast(os_name as text) as os_name,
    cast(country as text) as country,
    cast(fav_dic as text) as fav_dic,
    cast(is_kids as 
    bigint
) as is_kids,
    cast(hawaui_id as text) as hawaui_id,
    cast(join_date as text) as join_date,
    cast(deleted_at as text) as deleted_at,
    cast(is_deleted as 
    bigint
) as is_deleted,
    cast(last_login as 
    bigint
) as last_login,
    cast(parent_code as text) as parent_code,
    cast(parent_date as text) as parent_date,
    cast(session_key as 
    bigint
) as session_key,
    cast(character_id as 
    bigint
) as character_id,
    cast(readable_sid as text) as readable_sid,
    cast(forbidden_dic as text) as forbidden_dic,
    cast(last_login_ip as text) as last_login_ip,
    cast(music_fav_dic as text) as music_fav_dic,
    cast(profile_email as text) as profile_email,
    cast(approve_policy as 
    bigint
) as approve_policy,
    cast(parent_channel as text) as parent_channel,
    cast(last_login_city as 
    bigint
) as last_login_city,
    cast(extra_last_update as 
    bigint
) as extra_last_update,
    cast(follow_topics_dic as text) as follow_topics_dic,
    cast(planets_order_dic as text) as planets_order_dic,
    cast(recent_series_dic as text) as recent_series_dic,
    cast(last_login_country as 
    bigint
) as last_login_country,
    cast(music_playlist_dic as text) as music_playlist_dic,
    cast(recent_episode_dic as text) as recent_episode_dic,
    cast(session_last_update as 
    bigint
) as session_last_update,
    _airbyte_ab_id,
    _airbyte_emitted_at,
    now() as _airbyte_normalized_at
from "postgres"."public"."users_7_ab1"
-- users_7
where 1 = 1

  );
  
[0m08:56:12.710212 [debug] [Thread-3  ]: SQL status: SELECT 54800 in 0.97 seconds
[0m08:56:12.715478 [debug] [Thread-3  ]: Using postgres connection "model.stgo_dbt.users_7_ab2"
[0m08:56:12.715478 [debug] [Thread-3  ]: On model.stgo_dbt.users_7_ab2: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.users_7_ab2"} */
alter table "postgres"."public"."users_7_ab2__dbt_tmp" rename to "users_7_ab2"
[0m08:56:12.718325 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:56:12.721303 [debug] [Thread-3  ]: Using postgres connection "model.stgo_dbt.users_7_ab2"
[0m08:56:12.721303 [debug] [Thread-3  ]: On model.stgo_dbt.users_7_ab2: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.users_7_ab2"} */

    create  index if not exists
  "b98122dec2f8741c35d0aebe64ae410a"
  on "postgres"."public"."users_7_ab2" using btree
  (_airbyte_emitted_at);
  
[0m08:56:12.865806 [debug] [Thread-3  ]: SQL status: CREATE INDEX in 0.14 seconds
[0m08:56:12.868620 [debug] [Thread-3  ]: On model.stgo_dbt.users_7_ab2: COMMIT
[0m08:56:12.869190 [debug] [Thread-3  ]: Using postgres connection "model.stgo_dbt.users_7_ab2"
[0m08:56:12.869190 [debug] [Thread-3  ]: On model.stgo_dbt.users_7_ab2: COMMIT
[0m08:56:13.149236 [debug] [Thread-3  ]: SQL status: COMMIT in 0.28 seconds
[0m08:56:13.153222 [debug] [Thread-3  ]: Using postgres connection "model.stgo_dbt.users_7_ab2"
[0m08:56:13.153579 [debug] [Thread-3  ]: On model.stgo_dbt.users_7_ab2: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.users_7_ab2"} */
drop table if exists "postgres"."public"."users_7_ab2__dbt_backup" cascade
[0m08:56:13.155726 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m08:56:13.157506 [debug] [Thread-3  ]: finished collecting timing info
[0m08:56:13.158067 [debug] [Thread-3  ]: On model.stgo_dbt.users_7_ab2: Close
[0m08:56:13.159879 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c812bad-8f37-49a9-9087-2ba54be35554', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C95EDC3AC0>]}
[0m08:56:13.160433 [info ] [Thread-3  ]: 2 of 4 OK created sql table model public.users_7_ab2 ........................... [[32mSELECT 54800[0m in 3.57s]
[0m08:56:13.162102 [debug] [Thread-3  ]: Finished running node model.stgo_dbt.users_7_ab2
[0m08:56:13.163285 [debug] [Thread-2  ]: Began running node model.stgo_dbt.users_7_ab3
[0m08:56:13.163836 [info ] [Thread-2  ]: 3 of 4 START sql table model public.users_7_ab3 ................................ [RUN]
[0m08:56:13.167864 [debug] [Thread-2  ]: Acquiring new postgres connection "model.stgo_dbt.users_7_ab3"
[0m08:56:13.168418 [debug] [Thread-2  ]: Began compiling node model.stgo_dbt.users_7_ab3
[0m08:56:13.168956 [debug] [Thread-2  ]: Compiling model.stgo_dbt.users_7_ab3
[0m08:56:13.207676 [debug] [Thread-2  ]: Writing injected SQL for node "model.stgo_dbt.users_7_ab3"
[0m08:56:13.210679 [debug] [Thread-2  ]: finished collecting timing info
[0m08:56:13.210679 [debug] [Thread-2  ]: Began executing node model.stgo_dbt.users_7_ab3
[0m08:56:13.219695 [debug] [Thread-2  ]: Writing runtime sql for node "model.stgo_dbt.users_7_ab3"
[0m08:56:13.222678 [debug] [Thread-2  ]: Using postgres connection "model.stgo_dbt.users_7_ab3"
[0m08:56:13.223694 [debug] [Thread-2  ]: On model.stgo_dbt.users_7_ab3: BEGIN
[0m08:56:13.223694 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m08:56:15.315390 [debug] [Thread-2  ]: SQL status: BEGIN in 2.09 seconds
[0m08:56:15.315955 [debug] [Thread-2  ]: Using postgres connection "model.stgo_dbt.users_7_ab3"
[0m08:56:15.315955 [debug] [Thread-2  ]: On model.stgo_dbt.users_7_ab3: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.users_7_ab3"} */

  
    

  create  table "postgres"."public"."users_7_ab3__dbt_tmp"
  as (
    
-- SQL model to build a hash column based on the values of this record
-- depends_on: "postgres"."public"."users_7_ab2"
select
    md5(cast(coalesce(cast("id" as text), '') || '-' || coalesce(cast(ip as text), '') || '-' || coalesce(cast(bod as text), '') || '-' || coalesce(cast(sid as text), '') || '-' || coalesce(cast(city as text), '') || '-' || coalesce(cast(meta as text), '') || '-' || coalesce(cast("name" as text), '') || '-' || coalesce(cast(uuid as text), '') || '-' || coalesce(cast(email as text), '') || '-' || coalesce(cast(gender as text), '') || '-' || coalesce(cast(mobile as text), '') || '-' || coalesce(cast(status as text), '') || '-' || coalesce(cast(os_name as text), '') || '-' || coalesce(cast(country as text), '') || '-' || coalesce(cast(fav_dic as text), '') || '-' || coalesce(cast(is_kids as text), '') || '-' || coalesce(cast(hawaui_id as text), '') || '-' || coalesce(cast(join_date as text), '') || '-' || coalesce(cast(deleted_at as text), '') || '-' || coalesce(cast(is_deleted as text), '') || '-' || coalesce(cast(last_login as text), '') || '-' || coalesce(cast(parent_code as text), '') || '-' || coalesce(cast(parent_date as text), '') || '-' || coalesce(cast(session_key as text), '') || '-' || coalesce(cast(character_id as text), '') || '-' || coalesce(cast(readable_sid as text), '') || '-' || coalesce(cast(forbidden_dic as text), '') || '-' || coalesce(cast(last_login_ip as text), '') || '-' || coalesce(cast(music_fav_dic as text), '') || '-' || coalesce(cast(profile_email as text), '') || '-' || coalesce(cast(approve_policy as text), '') || '-' || coalesce(cast(parent_channel as text), '') || '-' || coalesce(cast(last_login_city as text), '') || '-' || coalesce(cast(extra_last_update as text), '') || '-' || coalesce(cast(follow_topics_dic as text), '') || '-' || coalesce(cast(planets_order_dic as text), '') || '-' || coalesce(cast(recent_series_dic as text), '') || '-' || coalesce(cast(last_login_country as text), '') || '-' || coalesce(cast(music_playlist_dic as text), '') || '-' || coalesce(cast(recent_episode_dic as text), '') || '-' || coalesce(cast(session_last_update as text), '') as text)) as _airbyte_users_7_hashid,
    tmp.*
from "postgres"."public"."users_7_ab2" tmp
-- users_7
where 1 = 1

  );
  
[0m08:56:17.562575 [debug] [Thread-2  ]: SQL status: SELECT 54800 in 2.25 seconds
[0m08:56:17.570517 [debug] [Thread-2  ]: Using postgres connection "model.stgo_dbt.users_7_ab3"
[0m08:56:17.571037 [debug] [Thread-2  ]: On model.stgo_dbt.users_7_ab3: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.users_7_ab3"} */
alter table "postgres"."public"."users_7_ab3__dbt_tmp" rename to "users_7_ab3"
[0m08:56:17.574528 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:56:17.577349 [debug] [Thread-2  ]: Using postgres connection "model.stgo_dbt.users_7_ab3"
[0m08:56:17.577349 [debug] [Thread-2  ]: On model.stgo_dbt.users_7_ab3: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.users_7_ab3"} */

    create  index if not exists
  "5f27b802435afbc22acb913160e0cbb2"
  on "postgres"."public"."users_7_ab3" using btree
  (_airbyte_emitted_at);
  
[0m08:56:17.758171 [debug] [Thread-2  ]: SQL status: CREATE INDEX in 0.18 seconds
[0m08:56:17.760544 [debug] [Thread-2  ]: On model.stgo_dbt.users_7_ab3: COMMIT
[0m08:56:17.761137 [debug] [Thread-2  ]: Using postgres connection "model.stgo_dbt.users_7_ab3"
[0m08:56:17.761137 [debug] [Thread-2  ]: On model.stgo_dbt.users_7_ab3: COMMIT
[0m08:56:17.923919 [debug] [Thread-2  ]: SQL status: COMMIT in 0.16 seconds
[0m08:56:17.930031 [debug] [Thread-2  ]: Using postgres connection "model.stgo_dbt.users_7_ab3"
[0m08:56:17.930557 [debug] [Thread-2  ]: On model.stgo_dbt.users_7_ab3: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.users_7_ab3"} */
drop table if exists "postgres"."public"."users_7_ab3__dbt_backup" cascade
[0m08:56:17.933016 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m08:56:17.934884 [debug] [Thread-2  ]: finished collecting timing info
[0m08:56:17.934884 [debug] [Thread-2  ]: On model.stgo_dbt.users_7_ab3: Close
[0m08:56:17.936644 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c812bad-8f37-49a9-9087-2ba54be35554', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C95EBBC130>]}
[0m08:56:17.937199 [info ] [Thread-2  ]: 3 of 4 OK created sql table model public.users_7_ab3 ........................... [[32mSELECT 54800[0m in 4.77s]
[0m08:56:17.938331 [debug] [Thread-2  ]: Finished running node model.stgo_dbt.users_7_ab3
[0m08:56:17.940066 [debug] [Thread-4  ]: Began running node model.stgo_dbt.users_7
[0m08:56:17.941205 [info ] [Thread-4  ]: 4 of 4 START sql table model public.users_7 .................................... [RUN]
[0m08:56:17.944846 [debug] [Thread-4  ]: Acquiring new postgres connection "model.stgo_dbt.users_7"
[0m08:56:17.945419 [debug] [Thread-4  ]: Began compiling node model.stgo_dbt.users_7
[0m08:56:17.945419 [debug] [Thread-4  ]: Compiling model.stgo_dbt.users_7
[0m08:56:17.959046 [debug] [Thread-4  ]: Writing injected SQL for node "model.stgo_dbt.users_7"
[0m08:56:17.978045 [debug] [Thread-4  ]: finished collecting timing info
[0m08:56:17.979052 [debug] [Thread-4  ]: Began executing node model.stgo_dbt.users_7
[0m08:56:17.990049 [debug] [Thread-4  ]: Writing runtime sql for node "model.stgo_dbt.users_7"
[0m08:56:17.992058 [debug] [Thread-4  ]: Using postgres connection "model.stgo_dbt.users_7"
[0m08:56:17.993047 [debug] [Thread-4  ]: On model.stgo_dbt.users_7: BEGIN
[0m08:56:17.993047 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m08:56:20.104922 [debug] [Thread-4  ]: SQL status: BEGIN in 2.11 seconds
[0m08:56:20.105481 [debug] [Thread-4  ]: Using postgres connection "model.stgo_dbt.users_7"
[0m08:56:20.105481 [debug] [Thread-4  ]: On model.stgo_dbt.users_7: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.users_7"} */

  
    

  create  table "postgres"."public"."users_7__dbt_tmp"
  as (
    
-- Final base SQL model
-- depends_on: "postgres"."public"."users_7_ab3"
select
    "id",
    sid as account_id,
    uuid,
    "name",
    gender,
    bod as date_of_birth,
    country,
    mobile as phone_number,
    is_kids as age_category,
    join_date as created_at,
    deleted_at,
    _airbyte_ab_id,
    _airbyte_emitted_at,
    now() as _airbyte_normalized_at,
    _airbyte_users_7_hashid
from "postgres"."public"."users_7_ab3"
-- users_7 from "postgres".dbo._airbyte_raw_users_7
where 1 = 1

  );
  
[0m08:56:20.403052 [debug] [Thread-4  ]: SQL status: SELECT 54800 in 0.3 seconds
[0m08:56:20.408626 [debug] [Thread-4  ]: Using postgres connection "model.stgo_dbt.users_7"
[0m08:56:20.409628 [debug] [Thread-4  ]: On model.stgo_dbt.users_7: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.users_7"} */
alter table "postgres"."public"."users_7__dbt_tmp" rename to "users_7"
[0m08:56:20.413955 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:56:20.416797 [debug] [Thread-4  ]: Using postgres connection "model.stgo_dbt.users_7"
[0m08:56:20.416797 [debug] [Thread-4  ]: On model.stgo_dbt.users_7: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.users_7"} */

    create  index if not exists
  "9ac26d226396a030a2e5f3202d849742"
  on "postgres"."public"."users_7" using btree
  (_airbyte_emitted_at);
  
[0m08:56:20.697488 [debug] [Thread-4  ]: SQL status: CREATE INDEX in 0.28 seconds
[0m08:56:20.702053 [debug] [Thread-4  ]: On model.stgo_dbt.users_7: COMMIT
[0m08:56:20.702053 [debug] [Thread-4  ]: Using postgres connection "model.stgo_dbt.users_7"
[0m08:56:20.702053 [debug] [Thread-4  ]: On model.stgo_dbt.users_7: COMMIT
[0m08:56:21.488294 [debug] [Thread-4  ]: SQL status: COMMIT in 0.79 seconds
[0m08:56:21.500579 [debug] [Thread-4  ]: Using postgres connection "model.stgo_dbt.users_7"
[0m08:56:21.500579 [debug] [Thread-4  ]: On model.stgo_dbt.users_7: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.users_7"} */
drop table if exists "postgres"."public"."users_7__dbt_backup" cascade
[0m08:56:21.506030 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.0 seconds
[0m08:56:21.509803 [debug] [Thread-4  ]: finished collecting timing info
[0m08:56:21.510899 [debug] [Thread-4  ]: On model.stgo_dbt.users_7: Close
[0m08:56:21.514664 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c812bad-8f37-49a9-9087-2ba54be35554', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C95EDA5AF0>]}
[0m08:56:21.517266 [info ] [Thread-4  ]: 4 of 4 OK created sql table model public.users_7 ............................... [[32mSELECT 54800[0m in 3.57s]
[0m08:56:21.524437 [debug] [Thread-4  ]: Finished running node model.stgo_dbt.users_7
[0m08:56:21.532433 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m08:56:21.533411 [debug] [MainThread]: Using postgres connection "master"
[0m08:56:21.533411 [debug] [MainThread]: On master: BEGIN
[0m08:56:21.534426 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:56:23.631157 [debug] [MainThread]: SQL status: BEGIN in 2.1 seconds
[0m08:56:23.631747 [debug] [MainThread]: On master: COMMIT
[0m08:56:23.631747 [debug] [MainThread]: Using postgres connection "master"
[0m08:56:23.632332 [debug] [MainThread]: On master: COMMIT
[0m08:56:23.634629 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:56:23.635231 [debug] [MainThread]: On master: Close
[0m08:56:23.637022 [info ] [MainThread]: 
[0m08:56:23.639457 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 24.33 seconds (24.33s).
[0m08:56:23.641383 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:56:23.642474 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m08:56:23.642534 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m08:56:23.643080 [debug] [MainThread]: Connection 'model.stgo_dbt.users_7_ab1' was properly closed.
[0m08:56:23.643211 [debug] [MainThread]: Connection 'model.stgo_dbt.users_7_ab2' was properly closed.
[0m08:56:23.643831 [debug] [MainThread]: Connection 'model.stgo_dbt.users_7_ab3' was properly closed.
[0m08:56:23.643831 [debug] [MainThread]: Connection 'model.stgo_dbt.users_7' was properly closed.
[0m08:56:23.678096 [info ] [MainThread]: 
[0m08:56:23.680099 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:56:23.682123 [info ] [MainThread]: 
[0m08:56:23.684112 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m08:56:23.685124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C95EA7DC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C95ECCD9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C95ED34A30>]}
[0m08:56:23.686115 [debug] [MainThread]: Flushing usage events


============================== 2023-01-03 10:16:32.253277 | 2354d8eb-4e8a-484b-a6e0-ffe30b91c9f2 ==============================
[0m10:16:32.253277 [info ] [MainThread]: Running with dbt=1.3.1
[0m10:16:32.268792 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'D:\\2023\\Cloudthought\\data-migration-dbt\\stgo_dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:16:32.269792 [debug] [MainThread]: Tracking: tracking
[0m10:16:32.328996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020554F4B280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020554EF5DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020554F415E0>]}
[0m10:16:33.016269 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 0 files added, 1 files changed.
[0m10:16:33.016269 [debug] [MainThread]: Partial parsing: deleted file: stgo_dbt://models\airbyte_ctes\dbo\users_7_ab1.sql
[0m10:16:33.016269 [debug] [MainThread]: Partial parsing: deleted file: stgo_dbt://models\airbyte_ctes\dbo\users_7_ab2.sql
[0m10:16:33.017271 [debug] [MainThread]: Partial parsing: deleted file: stgo_dbt://models\airbyte_ctes\dbo\users_7_ab3.sql
[0m10:16:33.017271 [debug] [MainThread]: Partial parsing: updated file: stgo_dbt://models\users_7.sql
[0m10:16:33.055282 [debug] [MainThread]: 1603: static parser failed on users_7.sql
[0m10:16:33.165269 [debug] [MainThread]: 1602: parser fallback to jinja rendering on users_7.sql
[0m10:16:33.166272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020555300E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205550D5970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205550D5910>]}
[0m10:16:33.167271 [debug] [MainThread]: Flushing usage events
[0m10:16:34.352436 [error] [MainThread]: Encountered an error:
Compilation Error in model users_7 (models\users_7.sql)
  Model 'model.stgo_dbt.users_7' (models\users_7.sql) depends on a node named 'users_7_ab3' which was not found


============================== 2023-01-03 10:17:35.128957 | c7ef6959-f8a5-43fa-9c05-9035ac7693f8 ==============================
[0m10:17:35.128957 [info ] [MainThread]: Running with dbt=1.3.1
[0m10:17:35.129930 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'D:\\2023\\Cloudthought\\data-migration-dbt\\stgo_dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:17:35.130933 [debug] [MainThread]: Tracking: tracking
[0m10:17:35.169936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A50ECB280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A50E75DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A50EC1400>]}
[0m10:17:35.415654 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 0 files added, 1 files changed.
[0m10:17:35.415654 [debug] [MainThread]: Partial parsing: deleted file: stgo_dbt://models\airbyte_ctes\dbo\users_7_ab1.sql
[0m10:17:35.415654 [debug] [MainThread]: Partial parsing: deleted file: stgo_dbt://models\airbyte_ctes\dbo\users_7_ab2.sql
[0m10:17:35.416654 [debug] [MainThread]: Partial parsing: deleted file: stgo_dbt://models\airbyte_ctes\dbo\users_7_ab3.sql
[0m10:17:35.416654 [debug] [MainThread]: Partial parsing: updated file: stgo_dbt://models\users_7.sql
[0m10:17:35.435614 [debug] [MainThread]: 1603: static parser failed on users_7.sql
[0m10:17:35.464646 [debug] [MainThread]: 1602: parser fallback to jinja rendering on users_7.sql
[0m10:17:35.503311 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stgo_dbt.staging

[0m10:17:35.511985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7ef6959-f8a5-43fa-9c05-9035ac7693f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A512B1F10>]}
[0m10:17:35.527999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7ef6959-f8a5-43fa-9c05-9035ac7693f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A51253A90>]}
[0m10:17:35.528984 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 703 macros, 0 operations, 2 seed files, 1 source, 0 exposures, 0 metrics
[0m10:17:35.529982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7ef6959-f8a5-43fa-9c05-9035ac7693f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A50E75A00>]}
[0m10:17:35.531988 [info ] [MainThread]: 
[0m10:17:35.533987 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m10:17:35.537404 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m10:17:35.554416 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m10:17:35.555417 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m10:17:35.555417 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:17:37.650895 [debug] [ThreadPool]: SQL status: SELECT 10 in 2.1 seconds
[0m10:17:37.652093 [debug] [ThreadPool]: On list_postgres: Close
[0m10:17:37.655208 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m10:17:37.663669 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m10:17:37.663669 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m10:17:37.663669 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:17:39.752746 [debug] [ThreadPool]: SQL status: BEGIN in 2.09 seconds
[0m10:17:39.753286 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m10:17:39.753286 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m10:17:39.759953 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
[0m10:17:39.761849 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m10:17:39.764217 [debug] [ThreadPool]: On list_postgres_public: Close
[0m10:17:39.772263 [debug] [MainThread]: Using postgres connection "master"
[0m10:17:39.772796 [debug] [MainThread]: On master: BEGIN
[0m10:17:39.772842 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:17:41.844408 [debug] [MainThread]: SQL status: BEGIN in 2.07 seconds
[0m10:17:41.844955 [debug] [MainThread]: Using postgres connection "master"
[0m10:17:41.844955 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:17:41.859766 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
[0m10:17:41.861403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7ef6959-f8a5-43fa-9c05-9035ac7693f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A50EE2A60>]}
[0m10:17:41.862013 [debug] [MainThread]: On master: ROLLBACK
[0m10:17:41.864912 [debug] [MainThread]: Using postgres connection "master"
[0m10:17:41.865454 [debug] [MainThread]: On master: BEGIN
[0m10:17:41.869301 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:17:41.869889 [debug] [MainThread]: On master: COMMIT
[0m10:17:41.870352 [debug] [MainThread]: Using postgres connection "master"
[0m10:17:41.871059 [debug] [MainThread]: On master: COMMIT
[0m10:17:41.873330 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:17:41.874052 [debug] [MainThread]: On master: Close
[0m10:17:41.875252 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:17:41.876386 [info ] [MainThread]: 
[0m10:17:41.887959 [debug] [Thread-1  ]: Began running node model.stgo_dbt.users_7
[0m10:17:41.887959 [info ] [Thread-1  ]: 1 of 1 START sql table model public.users_7 .................................... [RUN]
[0m10:17:41.890953 [debug] [Thread-1  ]: Acquiring new postgres connection "model.stgo_dbt.users_7"
[0m10:17:41.890953 [debug] [Thread-1  ]: Began compiling node model.stgo_dbt.users_7
[0m10:17:41.890953 [debug] [Thread-1  ]: Compiling model.stgo_dbt.users_7
[0m10:17:41.903957 [debug] [Thread-1  ]: Writing injected SQL for node "model.stgo_dbt.users_7"
[0m10:17:41.904942 [debug] [Thread-1  ]: finished collecting timing info
[0m10:17:41.905944 [debug] [Thread-1  ]: Began executing node model.stgo_dbt.users_7
[0m10:17:41.976972 [debug] [Thread-1  ]: Writing runtime sql for node "model.stgo_dbt.users_7"
[0m10:17:41.998566 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.users_7"
[0m10:17:41.999566 [debug] [Thread-1  ]: On model.stgo_dbt.users_7: BEGIN
[0m10:17:41.999566 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m10:17:44.085609 [debug] [Thread-1  ]: SQL status: BEGIN in 2.09 seconds
[0m10:17:44.086269 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.users_7"
[0m10:17:44.086858 [debug] [Thread-1  ]: On model.stgo_dbt.users_7: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.users_7"} */

  
    

  create  table "postgres"."public"."users_7__dbt_tmp"
  as (
    
-- Final base SQL model
-- depends_on: dbo.users_7
select
    "id",
    sid as account_id,
    uuid,
    "name",
    gender,
    bod as date_of_birth,
    country,
    mobile as phone_number,
    is_kids as age_category,
    join_date as created_at,
    deleted_at,
    _airbyte_ab_id,
    _airbyte_emitted_at,
    now() as _airbyte_normalized_at,
    _airbyte_users_7_hashid
from dbo.users_7
-- users_7 from "postgres".dbo._airbyte_raw_users_7
where 1 = 1

  );
  
[0m10:17:44.526027 [debug] [Thread-1  ]: SQL status: SELECT 54800 in 0.44 seconds
[0m10:17:44.534519 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.users_7"
[0m10:17:44.534519 [debug] [Thread-1  ]: On model.stgo_dbt.users_7: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.users_7"} */
alter table "postgres"."public"."users_7" rename to "users_7__dbt_backup"
[0m10:17:44.538096 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:17:44.542810 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.users_7"
[0m10:17:44.542810 [debug] [Thread-1  ]: On model.stgo_dbt.users_7: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.users_7"} */
alter table "postgres"."public"."users_7__dbt_tmp" rename to "users_7"
[0m10:17:44.545804 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:17:44.559986 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.users_7"
[0m10:17:44.561018 [debug] [Thread-1  ]: On model.stgo_dbt.users_7: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.users_7"} */

    create  index if not exists
  "e6d55f2e53603e2f8ccbf62949d47e72"
  on "postgres"."public"."users_7" using btree
  (_airbyte_emitted_at);
  
[0m10:17:44.846946 [debug] [Thread-1  ]: SQL status: CREATE INDEX in 0.29 seconds
[0m10:17:44.887655 [debug] [Thread-1  ]: On model.stgo_dbt.users_7: COMMIT
[0m10:17:44.887655 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.users_7"
[0m10:17:44.887655 [debug] [Thread-1  ]: On model.stgo_dbt.users_7: COMMIT
[0m10:17:44.994335 [debug] [Thread-1  ]: SQL status: COMMIT in 0.11 seconds
[0m10:17:45.002357 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.users_7"
[0m10:17:45.002357 [debug] [Thread-1  ]: On model.stgo_dbt.users_7: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.users_7"} */
drop table if exists "postgres"."public"."users_7__dbt_backup" cascade
[0m10:17:45.054483 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.05 seconds
[0m10:17:45.055480 [debug] [Thread-1  ]: finished collecting timing info
[0m10:17:45.056480 [debug] [Thread-1  ]: On model.stgo_dbt.users_7: Close
[0m10:17:45.057426 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7ef6959-f8a5-43fa-9c05-9035ac7693f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A51381CD0>]}
[0m10:17:45.057426 [info ] [Thread-1  ]: 1 of 1 OK created sql table model public.users_7 ............................... [[32mSELECT 54800[0m in 3.17s]
[0m10:17:45.059421 [debug] [Thread-1  ]: Finished running node model.stgo_dbt.users_7
[0m10:17:45.062806 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m10:17:45.063438 [debug] [MainThread]: Using postgres connection "master"
[0m10:17:45.063438 [debug] [MainThread]: On master: BEGIN
[0m10:17:45.063996 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:17:47.114713 [debug] [MainThread]: SQL status: BEGIN in 2.05 seconds
[0m10:17:47.115246 [debug] [MainThread]: On master: COMMIT
[0m10:17:47.115783 [debug] [MainThread]: Using postgres connection "master"
[0m10:17:47.115783 [debug] [MainThread]: On master: COMMIT
[0m10:17:47.117544 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:17:47.118082 [debug] [MainThread]: On master: Close
[0m10:17:47.119231 [info ] [MainThread]: 
[0m10:17:47.120940 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.59 seconds (11.59s).
[0m10:17:47.122335 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:17:47.122890 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m10:17:47.122890 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m10:17:47.123432 [debug] [MainThread]: Connection 'model.stgo_dbt.users_7' was properly closed.
[0m10:17:47.150406 [info ] [MainThread]: 
[0m10:17:47.152406 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:17:47.154406 [info ] [MainThread]: 
[0m10:17:47.155405 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:17:47.156405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A513A7670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A513A70D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A513A7F70>]}
[0m10:17:47.157405 [debug] [MainThread]: Flushing usage events


============================== 2023-01-03 10:18:24.899796 | e947214c-4ea1-4ac4-a1d6-9c84beea0f99 ==============================
[0m10:18:24.899796 [info ] [MainThread]: Running with dbt=1.3.1
[0m10:18:24.901809 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'D:\\2023\\Cloudthought\\data-migration-dbt\\stgo_dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:18:24.902799 [debug] [MainThread]: Tracking: tracking
[0m10:18:24.944804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226228A0310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226227A26D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226227A2730>]}
[0m10:18:25.457438 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:18:25.458458 [debug] [MainThread]: Partial parsing: updated file: stgo_dbt://models\users_7.sql
[0m10:18:25.481439 [debug] [MainThread]: 1603: static parser failed on users_7.sql
[0m10:18:25.517436 [debug] [MainThread]: 1602: parser fallback to jinja rendering on users_7.sql
[0m10:18:25.544448 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stgo_dbt.staging

[0m10:18:25.558085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e947214c-4ea1-4ac4-a1d6-9c84beea0f99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022622BCEDC0>]}
[0m10:18:25.589464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e947214c-4ea1-4ac4-a1d6-9c84beea0f99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226227C2910>]}
[0m10:18:25.590469 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 703 macros, 0 operations, 2 seed files, 1 source, 0 exposures, 0 metrics
[0m10:18:25.592461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e947214c-4ea1-4ac4-a1d6-9c84beea0f99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022622B291F0>]}
[0m10:18:25.595461 [info ] [MainThread]: 
[0m10:18:25.598472 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m10:18:25.602463 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m10:18:25.624462 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m10:18:25.625459 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m10:18:25.625459 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:18:27.714122 [debug] [ThreadPool]: SQL status: SELECT 10 in 2.09 seconds
[0m10:18:27.716071 [debug] [ThreadPool]: On list_postgres: Close
[0m10:18:27.718490 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_public"
[0m10:18:27.726771 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m10:18:27.727331 [debug] [ThreadPool]: On list_postgres_public: BEGIN
[0m10:18:27.727331 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:18:29.811548 [debug] [ThreadPool]: SQL status: BEGIN in 2.08 seconds
[0m10:18:29.811548 [debug] [ThreadPool]: Using postgres connection "list_postgres_public"
[0m10:18:29.812138 [debug] [ThreadPool]: On list_postgres_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m10:18:29.819648 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
[0m10:18:29.822074 [debug] [ThreadPool]: On list_postgres_public: ROLLBACK
[0m10:18:29.824301 [debug] [ThreadPool]: On list_postgres_public: Close
[0m10:18:29.834379 [debug] [MainThread]: Using postgres connection "master"
[0m10:18:29.834456 [debug] [MainThread]: On master: BEGIN
[0m10:18:29.834456 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:18:31.941118 [debug] [MainThread]: SQL status: BEGIN in 2.11 seconds
[0m10:18:31.941680 [debug] [MainThread]: Using postgres connection "master"
[0m10:18:31.942233 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:18:31.956588 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
[0m10:18:31.958854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e947214c-4ea1-4ac4-a1d6-9c84beea0f99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226227C2BE0>]}
[0m10:18:31.959948 [debug] [MainThread]: On master: ROLLBACK
[0m10:18:31.962683 [debug] [MainThread]: Using postgres connection "master"
[0m10:18:31.963201 [debug] [MainThread]: On master: BEGIN
[0m10:18:31.967068 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:18:31.967068 [debug] [MainThread]: On master: COMMIT
[0m10:18:31.967612 [debug] [MainThread]: Using postgres connection "master"
[0m10:18:31.967612 [debug] [MainThread]: On master: COMMIT
[0m10:18:31.970300 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:18:31.970847 [debug] [MainThread]: On master: Close
[0m10:18:31.972514 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:18:31.973622 [info ] [MainThread]: 
[0m10:18:31.986127 [debug] [Thread-1  ]: Began running node model.stgo_dbt.users_7
[0m10:18:31.987108 [info ] [Thread-1  ]: 1 of 1 START sql table model public.users_7 .................................... [RUN]
[0m10:18:31.990108 [debug] [Thread-1  ]: Acquiring new postgres connection "model.stgo_dbt.users_7"
[0m10:18:31.990108 [debug] [Thread-1  ]: Began compiling node model.stgo_dbt.users_7
[0m10:18:31.991111 [debug] [Thread-1  ]: Compiling model.stgo_dbt.users_7
[0m10:18:32.005109 [debug] [Thread-1  ]: Writing injected SQL for node "model.stgo_dbt.users_7"
[0m10:18:32.008109 [debug] [Thread-1  ]: finished collecting timing info
[0m10:18:32.009108 [debug] [Thread-1  ]: Began executing node model.stgo_dbt.users_7
[0m10:18:32.085328 [debug] [Thread-1  ]: Writing runtime sql for node "model.stgo_dbt.users_7"
[0m10:18:32.087313 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.users_7"
[0m10:18:32.087313 [debug] [Thread-1  ]: On model.stgo_dbt.users_7: BEGIN
[0m10:18:32.087313 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m10:18:34.197400 [debug] [Thread-1  ]: SQL status: BEGIN in 2.11 seconds
[0m10:18:34.197933 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.users_7"
[0m10:18:34.198478 [debug] [Thread-1  ]: On model.stgo_dbt.users_7: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.users_7"} */

  
    

  create  table "postgres"."public"."users_7__dbt_tmp"
  as (
    
-- Final base SQL model
-- depends_on: dbo.users_7
select
    "id",
    sid as account_idasddas,
    uuid,
    "name",
    gender,
    bod as date_of_birth,
    country,
    mobile as phone_number,
    is_kids as age_category,
    join_date as created_at,
    deleted_at,
    _airbyte_ab_id,
    _airbyte_emitted_at,
    now() as _airbyte_normalized_at,
    _airbyte_users_7_hashid
from dbo.users_7
-- users_7 from "postgres".dbo._airbyte_raw_users_7
where 1 = 1

  );
  
[0m10:18:34.467341 [debug] [Thread-1  ]: SQL status: SELECT 54800 in 0.27 seconds
[0m10:18:34.473389 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.users_7"
[0m10:18:34.474385 [debug] [Thread-1  ]: On model.stgo_dbt.users_7: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.users_7"} */
alter table "postgres"."public"."users_7" rename to "users_7__dbt_backup"
[0m10:18:34.476571 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:18:34.481070 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.users_7"
[0m10:18:34.481622 [debug] [Thread-1  ]: On model.stgo_dbt.users_7: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.users_7"} */
alter table "postgres"."public"."users_7__dbt_tmp" rename to "users_7"
[0m10:18:34.483838 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:18:34.498476 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.users_7"
[0m10:18:34.499479 [debug] [Thread-1  ]: On model.stgo_dbt.users_7: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.users_7"} */

    create  index if not exists
  "cea5fdebe4e6f0d647e5632958d4335b"
  on "postgres"."public"."users_7" using btree
  (_airbyte_emitted_at);
  
[0m10:18:34.821335 [debug] [Thread-1  ]: SQL status: CREATE INDEX in 0.32 seconds
[0m10:18:34.861368 [debug] [Thread-1  ]: On model.stgo_dbt.users_7: COMMIT
[0m10:18:34.861368 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.users_7"
[0m10:18:34.861368 [debug] [Thread-1  ]: On model.stgo_dbt.users_7: COMMIT
[0m10:18:34.926980 [debug] [Thread-1  ]: SQL status: COMMIT in 0.06 seconds
[0m10:18:34.934510 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.users_7"
[0m10:18:34.934510 [debug] [Thread-1  ]: On model.stgo_dbt.users_7: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.users_7"} */
drop table if exists "postgres"."public"."users_7__dbt_backup" cascade
[0m10:18:34.970891 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.04 seconds
[0m10:18:34.971925 [debug] [Thread-1  ]: finished collecting timing info
[0m10:18:34.971925 [debug] [Thread-1  ]: On model.stgo_dbt.users_7: Close
[0m10:18:34.973695 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e947214c-4ea1-4ac4-a1d6-9c84beea0f99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022622DDEF70>]}
[0m10:18:34.973695 [info ] [Thread-1  ]: 1 of 1 OK created sql table model public.users_7 ............................... [[32mSELECT 54800[0m in 2.99s]
[0m10:18:34.975690 [debug] [Thread-1  ]: Finished running node model.stgo_dbt.users_7
[0m10:18:34.978501 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m10:18:34.979072 [debug] [MainThread]: Using postgres connection "master"
[0m10:18:34.979072 [debug] [MainThread]: On master: BEGIN
[0m10:18:34.979685 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:18:37.077509 [debug] [MainThread]: SQL status: BEGIN in 2.1 seconds
[0m10:18:37.078052 [debug] [MainThread]: On master: COMMIT
[0m10:18:37.079062 [debug] [MainThread]: Using postgres connection "master"
[0m10:18:37.080055 [debug] [MainThread]: On master: COMMIT
[0m10:18:37.092098 [debug] [MainThread]: SQL status: COMMIT in 0.01 seconds
[0m10:18:37.093263 [debug] [MainThread]: On master: Close
[0m10:18:37.095784 [info ] [MainThread]: 
[0m10:18:37.097781 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.50 seconds (11.50s).
[0m10:18:37.099794 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:18:37.099794 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m10:18:37.100783 [debug] [MainThread]: Connection 'list_postgres_public' was properly closed.
[0m10:18:37.101781 [debug] [MainThread]: Connection 'model.stgo_dbt.users_7' was properly closed.
[0m10:18:37.142909 [info ] [MainThread]: 
[0m10:18:37.145911 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:18:37.149923 [info ] [MainThread]: 
[0m10:18:37.152909 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:18:37.155914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022622C87FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022622C87520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022622C874C0>]}
[0m10:18:37.157909 [debug] [MainThread]: Flushing usage events


============================== 2023-01-03 10:26:54.588533 | e9ea8e7d-e4df-4605-9935-6ed1fa940a3d ==============================
[0m10:26:54.588533 [info ] [MainThread]: Running with dbt=1.3.1
[0m10:26:54.590052 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'D:\\2023\\Cloudthought\\data-migration-dbt\\stgo_dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:26:54.590052 [debug] [MainThread]: Tracking: tracking
[0m10:26:54.646059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025AB781B280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025AB77C4A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025AB7811670>]}
[0m10:26:54.850791 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m10:26:54.851828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e9ea8e7d-e4df-4605-9935-6ed1fa940a3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025AB1CDC9D0>]}
[0m10:26:55.011794 [debug] [MainThread]: Parsing macros\clean_tmp_tables.sql
[0m10:26:55.015783 [debug] [MainThread]: Parsing macros\configuration.sql
[0m10:26:55.019801 [debug] [MainThread]: Parsing macros\get_custom_schema.sql
[0m10:26:55.020783 [debug] [MainThread]: Parsing macros\incremental.sql
[0m10:26:55.030821 [debug] [MainThread]: Parsing macros\should_full_refresh.sql
[0m10:26:55.035798 [debug] [MainThread]: Parsing macros\star_intersect.sql
[0m10:26:55.042796 [debug] [MainThread]: Parsing macros\cross_db_utils\array.sql
[0m10:26:55.059809 [debug] [MainThread]: Parsing macros\cross_db_utils\columns.sql
[0m10:26:55.062799 [debug] [MainThread]: Parsing macros\cross_db_utils\concat.sql
[0m10:26:55.065831 [debug] [MainThread]: Parsing macros\cross_db_utils\current_timestamp.sql
[0m10:26:55.066837 [debug] [MainThread]: Parsing macros\cross_db_utils\datatypes.sql
[0m10:26:55.088829 [debug] [MainThread]: Parsing macros\cross_db_utils\except.sql
[0m10:26:55.089791 [debug] [MainThread]: Parsing macros\cross_db_utils\hash.sql
[0m10:26:55.090791 [debug] [MainThread]: Parsing macros\cross_db_utils\json_operations.sql
[0m10:26:55.135491 [debug] [MainThread]: Parsing macros\cross_db_utils\quote.sql
[0m10:26:55.137525 [debug] [MainThread]: Parsing macros\cross_db_utils\surrogate_key.sql
[0m10:26:55.139525 [debug] [MainThread]: Parsing macros\cross_db_utils\type_conversions.sql
[0m10:26:55.148480 [debug] [MainThread]: Parsing macros\schema_tests\equality.sql
[0m10:26:55.154482 [debug] [MainThread]: Parsing macros\schema_tests\equal_rowcount.sql
[0m10:26:55.155529 [debug] [MainThread]: Parsing macros\adapters.sql
[0m10:26:55.181516 [debug] [MainThread]: Parsing macros\catalog.sql
[0m10:26:55.183516 [debug] [MainThread]: Parsing macros\relations.sql
[0m10:26:55.184515 [debug] [MainThread]: Parsing macros\timestamps.sql
[0m10:26:55.186516 [debug] [MainThread]: Parsing macros\materializations\incremental_strategies.sql
[0m10:26:55.187515 [debug] [MainThread]: Parsing macros\materializations\snapshot_merge.sql
[0m10:26:55.189515 [debug] [MainThread]: Parsing macros\utils\any_value.sql
[0m10:26:55.189515 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m10:26:55.190495 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m10:26:55.196515 [debug] [MainThread]: Parsing macros\utils\last_day.sql
[0m10:26:55.197515 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m10:26:55.199515 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m10:26:55.200516 [debug] [MainThread]: Parsing macros\adapters\apply_grants.sql
[0m10:26:55.215479 [debug] [MainThread]: Parsing macros\adapters\columns.sql
[0m10:26:55.224531 [debug] [MainThread]: Parsing macros\adapters\freshness.sql
[0m10:26:55.226529 [debug] [MainThread]: Parsing macros\adapters\indexes.sql
[0m10:26:55.229488 [debug] [MainThread]: Parsing macros\adapters\metadata.sql
[0m10:26:55.237528 [debug] [MainThread]: Parsing macros\adapters\persist_docs.sql
[0m10:26:55.242528 [debug] [MainThread]: Parsing macros\adapters\relation.sql
[0m10:26:55.257526 [debug] [MainThread]: Parsing macros\adapters\schema.sql
[0m10:26:55.260488 [debug] [MainThread]: Parsing macros\adapters\timestamps.sql
[0m10:26:55.264515 [debug] [MainThread]: Parsing macros\etc\datetime.sql
[0m10:26:55.272515 [debug] [MainThread]: Parsing macros\etc\statement.sql
[0m10:26:55.278515 [debug] [MainThread]: Parsing macros\generic_test_sql\accepted_values.sql
[0m10:26:55.279516 [debug] [MainThread]: Parsing macros\generic_test_sql\not_null.sql
[0m10:26:55.280516 [debug] [MainThread]: Parsing macros\generic_test_sql\relationships.sql
[0m10:26:55.281491 [debug] [MainThread]: Parsing macros\generic_test_sql\unique.sql
[0m10:26:55.283488 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_alias.sql
[0m10:26:55.284488 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_database.sql
[0m10:26:55.286515 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_schema.sql
[0m10:26:55.288515 [debug] [MainThread]: Parsing macros\materializations\configs.sql
[0m10:26:55.291532 [debug] [MainThread]: Parsing macros\materializations\hooks.sql
[0m10:26:55.295506 [debug] [MainThread]: Parsing macros\materializations\models\incremental\column_helpers.sql
[0m10:26:55.303529 [debug] [MainThread]: Parsing macros\materializations\models\incremental\incremental.sql
[0m10:26:55.314541 [debug] [MainThread]: Parsing macros\materializations\models\incremental\is_incremental.sql
[0m10:26:55.315530 [debug] [MainThread]: Parsing macros\materializations\models\incremental\merge.sql
[0m10:26:55.332503 [debug] [MainThread]: Parsing macros\materializations\models\incremental\on_schema_change.sql
[0m10:26:55.348481 [debug] [MainThread]: Parsing macros\materializations\models\incremental\strategies.sql
[0m10:26:55.356084 [debug] [MainThread]: Parsing macros\materializations\models\table\create_table_as.sql
[0m10:26:55.360071 [debug] [MainThread]: Parsing macros\materializations\models\table\table.sql
[0m10:26:55.366084 [debug] [MainThread]: Parsing macros\materializations\models\view\create_or_replace_view.sql
[0m10:26:55.370090 [debug] [MainThread]: Parsing macros\materializations\models\view\create_view_as.sql
[0m10:26:55.372083 [debug] [MainThread]: Parsing macros\materializations\models\view\helpers.sql
[0m10:26:55.373085 [debug] [MainThread]: Parsing macros\materializations\models\view\view.sql
[0m10:26:55.379084 [debug] [MainThread]: Parsing macros\materializations\seeds\helpers.sql
[0m10:26:55.396069 [debug] [MainThread]: Parsing macros\materializations\seeds\seed.sql
[0m10:26:55.404045 [debug] [MainThread]: Parsing macros\materializations\snapshots\helpers.sql
[0m10:26:55.417045 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot.sql
[0m10:26:55.430044 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot_merge.sql
[0m10:26:55.432063 [debug] [MainThread]: Parsing macros\materializations\snapshots\strategies.sql
[0m10:26:55.448070 [debug] [MainThread]: Parsing macros\materializations\tests\helpers.sql
[0m10:26:55.450042 [debug] [MainThread]: Parsing macros\materializations\tests\test.sql
[0m10:26:55.454079 [debug] [MainThread]: Parsing macros\materializations\tests\where_subquery.sql
[0m10:26:55.456081 [debug] [MainThread]: Parsing macros\python_model\python.sql
[0m10:26:55.462069 [debug] [MainThread]: Parsing macros\utils\any_value.sql
[0m10:26:55.464070 [debug] [MainThread]: Parsing macros\utils\array_append.sql
[0m10:26:55.465069 [debug] [MainThread]: Parsing macros\utils\array_concat.sql
[0m10:26:55.466070 [debug] [MainThread]: Parsing macros\utils\array_construct.sql
[0m10:26:55.468044 [debug] [MainThread]: Parsing macros\utils\bool_or.sql
[0m10:26:55.469070 [debug] [MainThread]: Parsing macros\utils\cast_bool_to_text.sql
[0m10:26:55.470070 [debug] [MainThread]: Parsing macros\utils\concat.sql
[0m10:26:55.471070 [debug] [MainThread]: Parsing macros\utils\data_types.sql
[0m10:26:55.477070 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m10:26:55.479071 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m10:26:55.480072 [debug] [MainThread]: Parsing macros\utils\date_trunc.sql
[0m10:26:55.482071 [debug] [MainThread]: Parsing macros\utils\escape_single_quotes.sql
[0m10:26:55.483070 [debug] [MainThread]: Parsing macros\utils\except.sql
[0m10:26:55.483070 [debug] [MainThread]: Parsing macros\utils\hash.sql
[0m10:26:55.485069 [debug] [MainThread]: Parsing macros\utils\intersect.sql
[0m10:26:55.485069 [debug] [MainThread]: Parsing macros\utils\last_day.sql
[0m10:26:55.487069 [debug] [MainThread]: Parsing macros\utils\length.sql
[0m10:26:55.488073 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m10:26:55.490048 [debug] [MainThread]: Parsing macros\utils\literal.sql
[0m10:26:55.492070 [debug] [MainThread]: Parsing macros\utils\position.sql
[0m10:26:55.493069 [debug] [MainThread]: Parsing macros\utils\replace.sql
[0m10:26:55.494069 [debug] [MainThread]: Parsing macros\utils\right.sql
[0m10:26:55.495071 [debug] [MainThread]: Parsing macros\utils\safe_cast.sql
[0m10:26:55.496070 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m10:26:55.498069 [debug] [MainThread]: Parsing tests\generic\builtin.sql
[0m10:26:55.502085 [debug] [MainThread]: Parsing macros\cross_db_utils\any_value.sql
[0m10:26:55.503086 [debug] [MainThread]: Parsing macros\cross_db_utils\bool_or.sql
[0m10:26:55.505085 [debug] [MainThread]: Parsing macros\cross_db_utils\cast_bool_to_text.sql
[0m10:26:55.506085 [debug] [MainThread]: Parsing macros\cross_db_utils\concat.sql
[0m10:26:55.507087 [debug] [MainThread]: Parsing macros\cross_db_utils\current_timestamp.sql
[0m10:26:55.510877 [debug] [MainThread]: Parsing macros\cross_db_utils\datatypes.sql
[0m10:26:55.516860 [debug] [MainThread]: Parsing macros\cross_db_utils\dateadd.sql
[0m10:26:55.519860 [debug] [MainThread]: Parsing macros\cross_db_utils\datediff.sql
[0m10:26:55.532824 [debug] [MainThread]: Parsing macros\cross_db_utils\date_trunc.sql
[0m10:26:55.533823 [debug] [MainThread]: Parsing macros\cross_db_utils\escape_single_quotes.sql
[0m10:26:55.535824 [debug] [MainThread]: Parsing macros\cross_db_utils\except.sql
[0m10:26:55.536824 [debug] [MainThread]: Parsing macros\cross_db_utils\hash.sql
[0m10:26:55.538824 [debug] [MainThread]: Parsing macros\cross_db_utils\identifier.sql
[0m10:26:55.540861 [debug] [MainThread]: Parsing macros\cross_db_utils\intersect.sql
[0m10:26:55.541859 [debug] [MainThread]: Parsing macros\cross_db_utils\last_day.sql
[0m10:26:55.545860 [debug] [MainThread]: Parsing macros\cross_db_utils\length.sql
[0m10:26:55.546861 [debug] [MainThread]: Parsing macros\cross_db_utils\literal.sql
[0m10:26:55.547825 [debug] [MainThread]: Parsing macros\cross_db_utils\position.sql
[0m10:26:55.549860 [debug] [MainThread]: Parsing macros\cross_db_utils\replace.sql
[0m10:26:55.550860 [debug] [MainThread]: Parsing macros\cross_db_utils\right.sql
[0m10:26:55.552860 [debug] [MainThread]: Parsing macros\cross_db_utils\safe_cast.sql
[0m10:26:55.554861 [debug] [MainThread]: Parsing macros\cross_db_utils\split_part.sql
[0m10:26:55.557082 [debug] [MainThread]: Parsing macros\cross_db_utils\width_bucket.sql
[0m10:26:55.564095 [debug] [MainThread]: Parsing macros\cross_db_utils\_is_ephemeral.sql
[0m10:26:55.567100 [debug] [MainThread]: Parsing macros\cross_db_utils\_is_relation.sql
[0m10:26:55.570081 [debug] [MainThread]: Parsing macros\jinja_helpers\log_info.sql
[0m10:26:55.572116 [debug] [MainThread]: Parsing macros\jinja_helpers\pretty_log_format.sql
[0m10:26:55.574088 [debug] [MainThread]: Parsing macros\jinja_helpers\pretty_time.sql
[0m10:26:55.576117 [debug] [MainThread]: Parsing macros\jinja_helpers\slugify.sql
[0m10:26:55.577081 [debug] [MainThread]: Parsing macros\materializations\insert_by_period_materialization.sql
[0m10:26:55.608080 [debug] [MainThread]: Parsing macros\schema_tests\accepted_range.sql
[0m10:26:55.614078 [debug] [MainThread]: Parsing macros\schema_tests\at_least_one.sql
[0m10:26:55.618079 [debug] [MainThread]: Parsing macros\schema_tests\cardinality_equality.sql
[0m10:26:55.622066 [debug] [MainThread]: Parsing macros\schema_tests\equality.sql
[0m10:26:55.629037 [debug] [MainThread]: Parsing macros\schema_tests\equal_rowcount.sql
[0m10:26:55.632036 [debug] [MainThread]: Parsing macros\schema_tests\expression_is_true.sql
[0m10:26:55.636047 [debug] [MainThread]: Parsing macros\schema_tests\fewer_rows_than.sql
[0m10:26:55.639036 [debug] [MainThread]: Parsing macros\schema_tests\mutually_exclusive_ranges.sql
[0m10:26:55.652047 [debug] [MainThread]: Parsing macros\schema_tests\not_accepted_values.sql
[0m10:26:55.657065 [debug] [MainThread]: Parsing macros\schema_tests\not_constant.sql
[0m10:26:55.659054 [debug] [MainThread]: Parsing macros\schema_tests\not_null_proportion.sql
[0m10:26:55.663049 [debug] [MainThread]: Parsing macros\schema_tests\recency.sql
[0m10:26:55.665064 [debug] [MainThread]: Parsing macros\schema_tests\relationships_where.sql
[0m10:26:55.669036 [debug] [MainThread]: Parsing macros\schema_tests\sequential_values.sql
[0m10:26:55.674047 [debug] [MainThread]: Parsing macros\schema_tests\test_not_null_where.sql
[0m10:26:55.676073 [debug] [MainThread]: Parsing macros\schema_tests\test_unique_where.sql
[0m10:26:55.678074 [debug] [MainThread]: Parsing macros\schema_tests\unique_combination_of_columns.sql
[0m10:26:55.682051 [debug] [MainThread]: Parsing macros\sql\date_spine.sql
[0m10:26:55.688051 [debug] [MainThread]: Parsing macros\sql\generate_series.sql
[0m10:26:55.694049 [debug] [MainThread]: Parsing macros\sql\get_column_values.sql
[0m10:26:55.701045 [debug] [MainThread]: Parsing macros\sql\get_query_results_as_dict.sql
[0m10:26:55.705084 [debug] [MainThread]: Parsing macros\sql\get_relations_by_pattern.sql
[0m10:26:55.710024 [debug] [MainThread]: Parsing macros\sql\get_relations_by_prefix.sql
[0m10:26:55.716834 [debug] [MainThread]: Parsing macros\sql\get_tables_by_pattern_sql.sql
[0m10:26:55.729988 [debug] [MainThread]: Parsing macros\sql\get_tables_by_prefix_sql.sql
[0m10:26:55.732002 [debug] [MainThread]: Parsing macros\sql\get_table_types_sql.sql
[0m10:26:55.733020 [debug] [MainThread]: Parsing macros\sql\groupby.sql
[0m10:26:55.736035 [debug] [MainThread]: Parsing macros\sql\haversine_distance.sql
[0m10:26:55.744994 [debug] [MainThread]: Parsing macros\sql\nullcheck.sql
[0m10:26:55.747013 [debug] [MainThread]: Parsing macros\sql\nullcheck_table.sql
[0m10:26:55.749005 [debug] [MainThread]: Parsing macros\sql\pivot.sql
[0m10:26:55.754040 [debug] [MainThread]: Parsing macros\sql\safe_add.sql
[0m10:26:55.756994 [debug] [MainThread]: Parsing macros\sql\star.sql
[0m10:26:55.763024 [debug] [MainThread]: Parsing macros\sql\surrogate_key.sql
[0m10:26:55.767989 [debug] [MainThread]: Parsing macros\sql\union.sql
[0m10:26:55.785986 [debug] [MainThread]: Parsing macros\sql\unpivot.sql
[0m10:26:55.796999 [debug] [MainThread]: Parsing macros\web\get_url_host.sql
[0m10:26:55.798998 [debug] [MainThread]: Parsing macros\web\get_url_parameter.sql
[0m10:26:55.801000 [debug] [MainThread]: Parsing macros\web\get_url_path.sql
[0m10:26:56.435782 [debug] [MainThread]: 1699: static parser successfully parsed generateEnums.sql
[0m10:26:56.448438 [debug] [MainThread]: 1603: static parser failed on profile.sql
[0m10:26:56.465429 [debug] [MainThread]: 1602: parser fallback to jinja rendering on profile.sql
[0m10:26:56.608462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025AB4595190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025AB7C68640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025AB7C68490>]}
[0m10:26:56.608462 [debug] [MainThread]: Flushing usage events
[0m10:26:57.799528 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two resources with the name "profile".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for ref("profile").
  
  To fix this, change the name of one of these resources:
  - model.stgo_dbt.profile (models\profile.sql)
  - seed.stgo_dbt.profile (seeds\profile.csv)


============================== 2023-01-03 10:27:33.892065 | e788e96a-b384-47c2-ab8a-ae3a8d961550 ==============================
[0m10:27:33.892065 [info ] [MainThread]: Running with dbt=1.3.1
[0m10:27:33.893102 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'D:\\2023\\Cloudthought\\data-migration-dbt\\stgo_dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:27:33.893102 [debug] [MainThread]: Tracking: tracking
[0m10:27:33.936077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021593E1B1C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002158E2ECE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002158E2ECE80>]}
[0m10:27:34.348524 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 0 files added, 0 files changed.
[0m10:27:34.349526 [debug] [MainThread]: Partial parsing: deleted file: stgo_dbt://seeds\avatar.csv
[0m10:27:34.349526 [debug] [MainThread]: Partial parsing: deleted file: stgo_dbt://seeds\profile.csv
[0m10:27:34.373523 [debug] [MainThread]: 1699: static parser successfully parsed generateEnums.sql
[0m10:27:34.412523 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stgo_dbt.staging

[0m10:27:34.423564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e788e96a-b384-47c2-ab8a-ae3a8d961550', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021594215E20>]}
[0m10:27:34.443525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e788e96a-b384-47c2-ab8a-ae3a8d961550', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215940F6580>]}
[0m10:27:34.443525 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 703 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m10:27:34.444545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e788e96a-b384-47c2-ab8a-ae3a8d961550', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021591AC1070>]}
[0m10:27:34.448564 [info ] [MainThread]: 
[0m10:27:34.450523 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m10:27:34.454534 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m10:27:34.476522 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m10:27:34.476522 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m10:27:34.476522 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:27:36.579251 [debug] [ThreadPool]: SQL status: SELECT 10 in 2.1 seconds
[0m10:27:36.580890 [debug] [ThreadPool]: On list_postgres: Close
[0m10:27:36.583653 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbo"
[0m10:27:36.592729 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m10:27:36.592729 [debug] [ThreadPool]: On list_postgres_dbo: BEGIN
[0m10:27:36.592729 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:27:38.661785 [debug] [ThreadPool]: SQL status: BEGIN in 2.07 seconds
[0m10:27:38.661785 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m10:27:38.662367 [debug] [ThreadPool]: On list_postgres_dbo: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres_dbo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo'
  
[0m10:27:38.667020 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m10:27:38.668709 [debug] [ThreadPool]: On list_postgres_dbo: ROLLBACK
[0m10:27:38.671153 [debug] [ThreadPool]: On list_postgres_dbo: Close
[0m10:27:38.679870 [debug] [MainThread]: Using postgres connection "master"
[0m10:27:38.680389 [debug] [MainThread]: On master: BEGIN
[0m10:27:38.680389 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:27:40.752879 [debug] [MainThread]: SQL status: BEGIN in 2.07 seconds
[0m10:27:40.753985 [debug] [MainThread]: Using postgres connection "master"
[0m10:27:40.753985 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:27:40.767739 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
[0m10:27:40.769253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e788e96a-b384-47c2-ab8a-ae3a8d961550', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021593E328B0>]}
[0m10:27:40.769253 [debug] [MainThread]: On master: ROLLBACK
[0m10:27:40.772700 [debug] [MainThread]: Using postgres connection "master"
[0m10:27:40.772700 [debug] [MainThread]: On master: BEGIN
[0m10:27:40.776690 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:27:40.776690 [debug] [MainThread]: On master: COMMIT
[0m10:27:40.777688 [debug] [MainThread]: Using postgres connection "master"
[0m10:27:40.777688 [debug] [MainThread]: On master: COMMIT
[0m10:27:40.780700 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:27:40.780700 [debug] [MainThread]: On master: Close
[0m10:27:40.781687 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:27:40.782687 [info ] [MainThread]: 
[0m10:27:40.791690 [debug] [Thread-1  ]: Began running node model.stgo_dbt.profile
[0m10:27:40.792688 [info ] [Thread-1  ]: 1 of 2 START sql table model dbo.profile ....................................... [RUN]
[0m10:27:40.794688 [debug] [Thread-1  ]: Acquiring new postgres connection "model.stgo_dbt.profile"
[0m10:27:40.795691 [debug] [Thread-1  ]: Began compiling node model.stgo_dbt.profile
[0m10:27:40.795691 [debug] [Thread-1  ]: Compiling model.stgo_dbt.profile
[0m10:27:40.825489 [debug] [Thread-1  ]: Writing injected SQL for node "model.stgo_dbt.profile"
[0m10:27:40.826489 [debug] [Thread-1  ]: finished collecting timing info
[0m10:27:40.826489 [debug] [Thread-1  ]: Began executing node model.stgo_dbt.profile
[0m10:27:40.888491 [debug] [Thread-1  ]: Writing runtime sql for node "model.stgo_dbt.profile"
[0m10:27:40.890491 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m10:27:40.890491 [debug] [Thread-1  ]: On model.stgo_dbt.profile: BEGIN
[0m10:27:40.890491 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m10:27:42.995397 [debug] [Thread-1  ]: SQL status: BEGIN in 2.1 seconds
[0m10:27:42.995966 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m10:27:42.995966 [debug] [Thread-1  ]: On model.stgo_dbt.profile: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.profile"} */

  
    

  create  table "postgres"."dbo"."profile__dbt_tmp"
  as (
    
-- Final base SQL model
-- depends_on: dbo.users_7
select
    "id",
    sid as account_idasddas,
    uuid,
    "name",
    gender,
    bod as date_of_birth,
    country,
    mobile as phone_number,
    is_kids as age_category,
    join_date as created_at,
    deleted_at,
    _airbyte_ab_id,
    _airbyte_emitted_at,
    now() as _airbyte_normalized_at,
    _airbyte_users_7_hashid
from dbo.users_7
-- users_7 from "postgres".dbo._airbyte_raw_users_7
where 1 = 1

  );
  
[0m10:27:43.438026 [debug] [Thread-1  ]: SQL status: SELECT 54800 in 0.44 seconds
[0m10:27:43.446414 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m10:27:43.446414 [debug] [Thread-1  ]: On model.stgo_dbt.profile: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.profile"} */
alter table "postgres"."dbo"."profile" rename to "profile__dbt_backup"
[0m10:27:43.450187 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:27:43.455118 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m10:27:43.455735 [debug] [Thread-1  ]: On model.stgo_dbt.profile: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.profile"} */
alter table "postgres"."dbo"."profile__dbt_tmp" rename to "profile"
[0m10:27:43.458288 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:27:43.474133 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m10:27:43.474133 [debug] [Thread-1  ]: On model.stgo_dbt.profile: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.profile"} */

    create  index if not exists
  "5498a9beb71ea3f49db1160b7936d650"
  on "postgres"."dbo"."profile" using btree
  (_airbyte_emitted_at);
  
[0m10:27:43.578495 [debug] [Thread-1  ]: SQL status: CREATE INDEX in 0.1 seconds
[0m10:27:43.600525 [debug] [Thread-1  ]: On model.stgo_dbt.profile: COMMIT
[0m10:27:43.600525 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m10:27:43.600525 [debug] [Thread-1  ]: On model.stgo_dbt.profile: COMMIT
[0m10:27:43.738439 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m10:27:43.751582 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m10:27:43.752581 [debug] [Thread-1  ]: On model.stgo_dbt.profile: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.profile"} */
drop table if exists "postgres"."dbo"."profile__dbt_backup" cascade
[0m10:27:43.790263 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.04 seconds
[0m10:27:43.793567 [debug] [Thread-1  ]: finished collecting timing info
[0m10:27:43.794421 [debug] [Thread-1  ]: On model.stgo_dbt.profile: Close
[0m10:27:43.796885 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e788e96a-b384-47c2-ab8a-ae3a8d961550', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021594431EB0>]}
[0m10:27:43.798617 [info ] [Thread-1  ]: 1 of 2 OK created sql table model dbo.profile .................................. [[32mSELECT 54800[0m in 3.00s]
[0m10:27:43.803056 [debug] [Thread-1  ]: Finished running node model.stgo_dbt.profile
[0m10:27:43.806022 [debug] [Thread-3  ]: Began running node model.stgo_dbt.generateEnums
[0m10:27:43.807246 [info ] [Thread-3  ]: 2 of 2 START sql table model dbo.generateEnums ................................. [RUN]
[0m10:27:43.813025 [debug] [Thread-3  ]: Acquiring new postgres connection "model.stgo_dbt.generateEnums"
[0m10:27:43.813855 [debug] [Thread-3  ]: Began compiling node model.stgo_dbt.generateEnums
[0m10:27:43.814464 [debug] [Thread-3  ]: Compiling model.stgo_dbt.generateEnums
[0m10:27:43.824482 [debug] [Thread-3  ]: Writing injected SQL for node "model.stgo_dbt.generateEnums"
[0m10:27:43.842480 [debug] [Thread-3  ]: finished collecting timing info
[0m10:27:43.843484 [debug] [Thread-3  ]: Began executing node model.stgo_dbt.generateEnums
[0m10:27:43.853531 [debug] [Thread-3  ]: Writing runtime sql for node "model.stgo_dbt.generateEnums"
[0m10:27:43.854512 [debug] [Thread-3  ]: Using postgres connection "model.stgo_dbt.generateEnums"
[0m10:27:43.854512 [debug] [Thread-3  ]: On model.stgo_dbt.generateEnums: BEGIN
[0m10:27:43.854512 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m10:27:45.948806 [debug] [Thread-3  ]: SQL status: BEGIN in 2.09 seconds
[0m10:27:45.948819 [debug] [Thread-3  ]: Using postgres connection "model.stgo_dbt.generateEnums"
[0m10:27:45.948819 [debug] [Thread-3  ]: On model.stgo_dbt.generateEnums: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.generateEnums"} */

  
    

  create  table "postgres"."dbo"."generateEnums__dbt_tmp"
  as (
    

DO $$ 
BEGIN 
    CREATE TYPE dbo.age_category AS ENUM ('ADULT','KID');
EXCEPTION
    WHEN duplicate_object THEN null;
END $$;
-- Final base SQL model
-- depends_on: dbo.users_7
select
*
from "postgres"."dbo"."profile"
  );
  
[0m10:27:45.951658 [debug] [Thread-3  ]: Postgres adapter: Postgres error: syntax error at or near "DO"
LINE 10: DO $$ 
         ^

[0m10:27:45.951658 [debug] [Thread-3  ]: On model.stgo_dbt.generateEnums: ROLLBACK
[0m10:27:45.953838 [debug] [Thread-3  ]: finished collecting timing info
[0m10:27:45.954395 [debug] [Thread-3  ]: On model.stgo_dbt.generateEnums: Close
[0m10:27:45.955524 [debug] [Thread-3  ]: Database Error in model generateEnums (models\generateEnums.sql)
  syntax error at or near "DO"
  LINE 10: DO $$ 
           ^
  compiled Code at target\run\stgo_dbt\models\generateEnums.sql
[0m10:27:45.955524 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e788e96a-b384-47c2-ab8a-ae3a8d961550', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215942A25B0>]}
[0m10:27:45.956083 [error] [Thread-3  ]: 2 of 2 ERROR creating sql table model dbo.generateEnums ........................ [[31mERROR[0m in 2.14s]
[0m10:27:45.957894 [debug] [Thread-3  ]: Finished running node model.stgo_dbt.generateEnums
[0m10:27:45.960075 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m10:27:45.960617 [debug] [MainThread]: Using postgres connection "master"
[0m10:27:45.960617 [debug] [MainThread]: On master: BEGIN
[0m10:27:45.960617 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:27:48.081802 [debug] [MainThread]: SQL status: BEGIN in 2.12 seconds
[0m10:27:48.082365 [debug] [MainThread]: On master: COMMIT
[0m10:27:48.082892 [debug] [MainThread]: Using postgres connection "master"
[0m10:27:48.082925 [debug] [MainThread]: On master: COMMIT
[0m10:27:48.085326 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:27:48.085921 [debug] [MainThread]: On master: Close
[0m10:27:48.087041 [info ] [MainThread]: 
[0m10:27:48.088250 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 13.64 seconds (13.64s).
[0m10:27:48.089372 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:27:48.089944 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m10:27:48.090514 [debug] [MainThread]: Connection 'list_postgres_dbo' was properly closed.
[0m10:27:48.091075 [debug] [MainThread]: Connection 'model.stgo_dbt.profile' was properly closed.
[0m10:27:48.091075 [debug] [MainThread]: Connection 'model.stgo_dbt.generateEnums' was properly closed.
[0m10:27:48.111597 [info ] [MainThread]: 
[0m10:27:48.112605 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:27:48.114602 [info ] [MainThread]: 
[0m10:27:48.115604 [error] [MainThread]: [33mDatabase Error in model generateEnums (models\generateEnums.sql)[0m
[0m10:27:48.117607 [error] [MainThread]:   syntax error at or near "DO"
[0m10:27:48.118608 [error] [MainThread]:   LINE 10: DO $$ 
[0m10:27:48.119610 [error] [MainThread]:            ^
[0m10:27:48.120607 [error] [MainThread]:   compiled Code at target\run\stgo_dbt\models\generateEnums.sql
[0m10:27:48.121614 [info ] [MainThread]: 
[0m10:27:48.122609 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m10:27:48.123611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021594431EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215941AADF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021594444BB0>]}
[0m10:27:48.124701 [debug] [MainThread]: Flushing usage events


============================== 2023-01-03 10:28:02.639048 | dcb2cb14-b2aa-4c90-ac61-6656663e4b25 ==============================
[0m10:28:02.639048 [info ] [MainThread]: Running with dbt=1.3.1
[0m10:28:02.640048 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'D:\\2023\\Cloudthought\\data-migration-dbt\\stgo_dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:28:02.641048 [debug] [MainThread]: Tracking: tracking
[0m10:28:02.679046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F0B69BE20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F0B645910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F0B6915B0>]}
[0m10:28:02.983731 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:28:02.983731 [debug] [MainThread]: Partial parsing: updated file: stgo_dbt://models\generateEnums.sql
[0m10:28:03.002748 [debug] [MainThread]: 1699: static parser successfully parsed generateEnums.sql
[0m10:28:03.032739 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stgo_dbt.staging

[0m10:28:03.042718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dcb2cb14-b2aa-4c90-ac61-6656663e4b25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F0BAEA0D0>]}
[0m10:28:03.062737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dcb2cb14-b2aa-4c90-ac61-6656663e4b25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F0B6B20D0>]}
[0m10:28:03.062737 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 703 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m10:28:03.063741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dcb2cb14-b2aa-4c90-ac61-6656663e4b25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F0B6459D0>]}
[0m10:28:03.065748 [info ] [MainThread]: 
[0m10:28:03.068722 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m10:28:03.072207 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m10:28:03.097744 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m10:28:03.098752 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m10:28:03.098752 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:28:05.214987 [debug] [ThreadPool]: SQL status: SELECT 10 in 2.12 seconds
[0m10:28:05.216109 [debug] [ThreadPool]: On list_postgres: Close
[0m10:28:05.218896 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbo"
[0m10:28:05.228011 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m10:28:05.228011 [debug] [ThreadPool]: On list_postgres_dbo: BEGIN
[0m10:28:05.228011 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:28:07.305597 [debug] [ThreadPool]: SQL status: BEGIN in 2.08 seconds
[0m10:28:07.305597 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m10:28:07.306121 [debug] [ThreadPool]: On list_postgres_dbo: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres_dbo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo'
  
[0m10:28:07.311248 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
[0m10:28:07.312945 [debug] [ThreadPool]: On list_postgres_dbo: ROLLBACK
[0m10:28:07.315327 [debug] [ThreadPool]: On list_postgres_dbo: Close
[0m10:28:07.322850 [debug] [MainThread]: Using postgres connection "master"
[0m10:28:07.323063 [debug] [MainThread]: On master: BEGIN
[0m10:28:07.323261 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:28:09.411862 [debug] [MainThread]: SQL status: BEGIN in 2.09 seconds
[0m10:28:09.411862 [debug] [MainThread]: Using postgres connection "master"
[0m10:28:09.412421 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:28:09.428180 [debug] [MainThread]: SQL status: SELECT 0 in 0.02 seconds
[0m10:28:09.429361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dcb2cb14-b2aa-4c90-ac61-6656663e4b25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F0B797CD0>]}
[0m10:28:09.430261 [debug] [MainThread]: On master: ROLLBACK
[0m10:28:09.433188 [debug] [MainThread]: Using postgres connection "master"
[0m10:28:09.433188 [debug] [MainThread]: On master: BEGIN
[0m10:28:09.437793 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:28:09.437793 [debug] [MainThread]: On master: COMMIT
[0m10:28:09.438499 [debug] [MainThread]: Using postgres connection "master"
[0m10:28:09.438499 [debug] [MainThread]: On master: COMMIT
[0m10:28:09.440969 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:28:09.440969 [debug] [MainThread]: On master: Close
[0m10:28:09.442596 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:28:09.443178 [info ] [MainThread]: 
[0m10:28:09.453489 [debug] [Thread-1  ]: Began running node model.stgo_dbt.profile
[0m10:28:09.453489 [info ] [Thread-1  ]: 1 of 2 START sql table model dbo.profile ....................................... [RUN]
[0m10:28:09.455490 [debug] [Thread-1  ]: Acquiring new postgres connection "model.stgo_dbt.profile"
[0m10:28:09.456491 [debug] [Thread-1  ]: Began compiling node model.stgo_dbt.profile
[0m10:28:09.457491 [debug] [Thread-1  ]: Compiling model.stgo_dbt.profile
[0m10:28:09.476283 [debug] [Thread-1  ]: Writing injected SQL for node "model.stgo_dbt.profile"
[0m10:28:09.478301 [debug] [Thread-1  ]: finished collecting timing info
[0m10:28:09.478301 [debug] [Thread-1  ]: Began executing node model.stgo_dbt.profile
[0m10:28:09.541328 [debug] [Thread-1  ]: Writing runtime sql for node "model.stgo_dbt.profile"
[0m10:28:09.543341 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m10:28:09.544285 [debug] [Thread-1  ]: On model.stgo_dbt.profile: BEGIN
[0m10:28:09.544285 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m10:28:11.654256 [debug] [Thread-1  ]: SQL status: BEGIN in 2.11 seconds
[0m10:28:11.654256 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m10:28:11.654256 [debug] [Thread-1  ]: On model.stgo_dbt.profile: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.profile"} */

  
    

  create  table "postgres"."dbo"."profile__dbt_tmp"
  as (
    
-- Final base SQL model
-- depends_on: dbo.users_7
select
    "id",
    sid as account_idasddas,
    uuid,
    "name",
    gender,
    bod as date_of_birth,
    country,
    mobile as phone_number,
    is_kids as age_category,
    join_date as created_at,
    deleted_at,
    _airbyte_ab_id,
    _airbyte_emitted_at,
    now() as _airbyte_normalized_at,
    _airbyte_users_7_hashid
from dbo.users_7
-- users_7 from "postgres".dbo._airbyte_raw_users_7
where 1 = 1

  );
  
[0m10:28:12.139586 [debug] [Thread-1  ]: SQL status: SELECT 54800 in 0.48 seconds
[0m10:28:12.149559 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m10:28:12.149559 [debug] [Thread-1  ]: On model.stgo_dbt.profile: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.profile"} */
alter table "postgres"."dbo"."profile" rename to "profile__dbt_backup"
[0m10:28:12.153124 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:28:12.157047 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m10:28:12.157047 [debug] [Thread-1  ]: On model.stgo_dbt.profile: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.profile"} */
alter table "postgres"."dbo"."profile__dbt_tmp" rename to "profile"
[0m10:28:12.160000 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:28:12.173693 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m10:28:12.173693 [debug] [Thread-1  ]: On model.stgo_dbt.profile: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.profile"} */

    create  index if not exists
  "07ada1a8a8e0f3ef2d78d2d9d1f478a1"
  on "postgres"."dbo"."profile" using btree
  (_airbyte_emitted_at);
  
[0m10:28:12.263913 [debug] [Thread-1  ]: SQL status: CREATE INDEX in 0.09 seconds
[0m10:28:12.298527 [debug] [Thread-1  ]: On model.stgo_dbt.profile: COMMIT
[0m10:28:12.298527 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m10:28:12.298527 [debug] [Thread-1  ]: On model.stgo_dbt.profile: COMMIT
[0m10:28:12.378583 [debug] [Thread-1  ]: SQL status: COMMIT in 0.08 seconds
[0m10:28:12.386591 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m10:28:12.386591 [debug] [Thread-1  ]: On model.stgo_dbt.profile: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.profile"} */
drop table if exists "postgres"."dbo"."profile__dbt_backup" cascade
[0m10:28:12.423337 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.04 seconds
[0m10:28:12.425393 [debug] [Thread-1  ]: finished collecting timing info
[0m10:28:12.425393 [debug] [Thread-1  ]: On model.stgo_dbt.profile: Close
[0m10:28:12.426484 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcb2cb14-b2aa-4c90-ac61-6656663e4b25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F0BB2EFA0>]}
[0m10:28:12.427055 [info ] [Thread-1  ]: 1 of 2 OK created sql table model dbo.profile .................................. [[32mSELECT 54800[0m in 2.97s]
[0m10:28:12.428647 [debug] [Thread-1  ]: Finished running node model.stgo_dbt.profile
[0m10:28:12.429822 [debug] [Thread-3  ]: Began running node model.stgo_dbt.generateEnums
[0m10:28:12.430948 [info ] [Thread-3  ]: 2 of 2 START sql table model dbo.generateEnums ................................. [RUN]
[0m10:28:12.433149 [debug] [Thread-3  ]: Acquiring new postgres connection "model.stgo_dbt.generateEnums"
[0m10:28:12.433687 [debug] [Thread-3  ]: Began compiling node model.stgo_dbt.generateEnums
[0m10:28:12.433687 [debug] [Thread-3  ]: Compiling model.stgo_dbt.generateEnums
[0m10:28:12.439379 [debug] [Thread-3  ]: Writing injected SQL for node "model.stgo_dbt.generateEnums"
[0m10:28:12.440708 [debug] [Thread-3  ]: finished collecting timing info
[0m10:28:12.441323 [debug] [Thread-3  ]: Began executing node model.stgo_dbt.generateEnums
[0m10:28:12.448457 [debug] [Thread-3  ]: Writing runtime sql for node "model.stgo_dbt.generateEnums"
[0m10:28:12.450455 [debug] [Thread-3  ]: Using postgres connection "model.stgo_dbt.generateEnums"
[0m10:28:12.450455 [debug] [Thread-3  ]: On model.stgo_dbt.generateEnums: BEGIN
[0m10:28:12.450455 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m10:28:14.515909 [debug] [Thread-3  ]: SQL status: BEGIN in 2.07 seconds
[0m10:28:14.515909 [debug] [Thread-3  ]: Using postgres connection "model.stgo_dbt.generateEnums"
[0m10:28:14.516442 [debug] [Thread-3  ]: On model.stgo_dbt.generateEnums: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.generateEnums"} */

  
    

  create  table "postgres"."dbo"."generateEnums__dbt_tmp"
  as (
    


BEGIN 
    CREATE TYPE dbo.age_category AS ENUM ('ADULT','KID');
EXCEPTION
    WHEN duplicate_object THEN null;
END
-- Final base SQL model
-- depends_on: dbo.users_7
select
*
from "postgres"."dbo"."profile"
  );
  
[0m10:28:14.518201 [debug] [Thread-3  ]: Postgres adapter: Postgres error: syntax error at or near "BEGIN"
LINE 11: BEGIN 
         ^

[0m10:28:14.518201 [debug] [Thread-3  ]: On model.stgo_dbt.generateEnums: ROLLBACK
[0m10:28:14.520354 [debug] [Thread-3  ]: finished collecting timing info
[0m10:28:14.520354 [debug] [Thread-3  ]: On model.stgo_dbt.generateEnums: Close
[0m10:28:14.521427 [debug] [Thread-3  ]: Database Error in model generateEnums (models\generateEnums.sql)
  syntax error at or near "BEGIN"
  LINE 11: BEGIN 
           ^
  compiled Code at target\run\stgo_dbt\models\generateEnums.sql
[0m10:28:14.521977 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcb2cb14-b2aa-4c90-ac61-6656663e4b25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F0BC9B670>]}
[0m10:28:14.522541 [error] [Thread-3  ]: 2 of 2 ERROR creating sql table model dbo.generateEnums ........................ [[31mERROR[0m in 2.09s]
[0m10:28:14.524225 [debug] [Thread-3  ]: Finished running node model.stgo_dbt.generateEnums
[0m10:28:14.526543 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m10:28:14.527098 [debug] [MainThread]: Using postgres connection "master"
[0m10:28:14.527619 [debug] [MainThread]: On master: BEGIN
[0m10:28:14.527651 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:28:16.620486 [debug] [MainThread]: SQL status: BEGIN in 2.09 seconds
[0m10:28:16.621038 [debug] [MainThread]: On master: COMMIT
[0m10:28:16.621038 [debug] [MainThread]: Using postgres connection "master"
[0m10:28:16.621571 [debug] [MainThread]: On master: COMMIT
[0m10:28:16.623816 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:28:16.623860 [debug] [MainThread]: On master: Close
[0m10:28:16.624932 [info ] [MainThread]: 
[0m10:28:16.626051 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 13.56 seconds (13.56s).
[0m10:28:16.627233 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:28:16.627759 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m10:28:16.628046 [debug] [MainThread]: Connection 'list_postgres_dbo' was properly closed.
[0m10:28:16.628566 [debug] [MainThread]: Connection 'model.stgo_dbt.profile' was properly closed.
[0m10:28:16.629112 [debug] [MainThread]: Connection 'model.stgo_dbt.generateEnums' was properly closed.
[0m10:28:16.651498 [info ] [MainThread]: 
[0m10:28:16.652506 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:28:16.653484 [info ] [MainThread]: 
[0m10:28:16.655500 [error] [MainThread]: [33mDatabase Error in model generateEnums (models\generateEnums.sql)[0m
[0m10:28:16.656493 [error] [MainThread]:   syntax error at or near "BEGIN"
[0m10:28:16.657506 [error] [MainThread]:   LINE 11: BEGIN 
[0m10:28:16.659504 [error] [MainThread]:            ^
[0m10:28:16.661293 [error] [MainThread]:   compiled Code at target\run\stgo_dbt\models\generateEnums.sql
[0m10:28:16.662300 [info ] [MainThread]: 
[0m10:28:16.664291 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m10:28:16.665300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F0B6B2970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F0B78D190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F0BC91430>]}
[0m10:28:16.665300 [debug] [MainThread]: Flushing usage events


============================== 2023-01-03 10:30:55.144083 | a128ad35-57d1-4e08-b7b4-f983a076d7c6 ==============================
[0m10:30:55.144083 [info ] [MainThread]: Running with dbt=1.3.1
[0m10:30:55.145083 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'D:\\2023\\Cloudthought\\data-migration-dbt\\stgo_dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:30:55.146085 [debug] [MainThread]: Tracking: tracking
[0m10:30:55.199085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E229DAB1C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E22428BCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E22428BE80>]}
[0m10:30:55.550845 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:30:55.550845 [debug] [MainThread]: Partial parsing: updated file: stgo_dbt://models\generateEnums.sql
[0m10:30:55.570621 [debug] [MainThread]: 1699: static parser successfully parsed generateEnums.sql
[0m10:30:55.611503 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stgo_dbt.staging

[0m10:30:55.623534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a128ad35-57d1-4e08-b7b4-f983a076d7c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E22A1F70D0>]}
[0m10:30:55.652517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a128ad35-57d1-4e08-b7b4-f983a076d7c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E229DC27F0>]}
[0m10:30:55.652517 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 703 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m10:30:55.653531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a128ad35-57d1-4e08-b7b4-f983a076d7c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E22A124AF0>]}
[0m10:30:55.656551 [info ] [MainThread]: 
[0m10:30:55.658506 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m10:30:55.660503 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m10:30:55.688502 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m10:30:55.688502 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m10:30:55.688502 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:30:57.786187 [debug] [ThreadPool]: SQL status: SELECT 10 in 2.1 seconds
[0m10:30:57.788615 [debug] [ThreadPool]: On list_postgres: Close
[0m10:30:57.792468 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbo"
[0m10:30:57.804788 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m10:30:57.804788 [debug] [ThreadPool]: On list_postgres_dbo: BEGIN
[0m10:30:57.804788 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:30:59.917535 [debug] [ThreadPool]: SQL status: BEGIN in 2.11 seconds
[0m10:30:59.918234 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m10:30:59.918234 [debug] [ThreadPool]: On list_postgres_dbo: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres_dbo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo'
  
[0m10:30:59.926347 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
[0m10:30:59.928403 [debug] [ThreadPool]: On list_postgres_dbo: ROLLBACK
[0m10:30:59.931307 [debug] [ThreadPool]: On list_postgres_dbo: Close
[0m10:30:59.942394 [debug] [MainThread]: Using postgres connection "master"
[0m10:30:59.942394 [debug] [MainThread]: On master: BEGIN
[0m10:30:59.942953 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:31:02.029803 [debug] [MainThread]: SQL status: BEGIN in 2.09 seconds
[0m10:31:02.030339 [debug] [MainThread]: Using postgres connection "master"
[0m10:31:02.030339 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:31:02.043912 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
[0m10:31:02.045097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a128ad35-57d1-4e08-b7b4-f983a076d7c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E229E9E5E0>]}
[0m10:31:02.046105 [debug] [MainThread]: On master: ROLLBACK
[0m10:31:02.048932 [debug] [MainThread]: Using postgres connection "master"
[0m10:31:02.048932 [debug] [MainThread]: On master: BEGIN
[0m10:31:02.053458 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:31:02.054029 [debug] [MainThread]: On master: COMMIT
[0m10:31:02.054573 [debug] [MainThread]: Using postgres connection "master"
[0m10:31:02.054573 [debug] [MainThread]: On master: COMMIT
[0m10:31:02.057115 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:31:02.057697 [debug] [MainThread]: On master: Close
[0m10:31:02.059867 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:31:02.060431 [info ] [MainThread]: 
[0m10:31:02.072840 [debug] [Thread-1  ]: Began running node model.stgo_dbt.profile
[0m10:31:02.073368 [info ] [Thread-1  ]: 1 of 2 START sql table model dbo.profile ....................................... [RUN]
[0m10:31:02.075367 [debug] [Thread-1  ]: Acquiring new postgres connection "model.stgo_dbt.profile"
[0m10:31:02.075367 [debug] [Thread-1  ]: Began compiling node model.stgo_dbt.profile
[0m10:31:02.075367 [debug] [Thread-1  ]: Compiling model.stgo_dbt.profile
[0m10:31:02.102369 [debug] [Thread-1  ]: Writing injected SQL for node "model.stgo_dbt.profile"
[0m10:31:02.104372 [debug] [Thread-1  ]: finished collecting timing info
[0m10:31:02.104372 [debug] [Thread-1  ]: Began executing node model.stgo_dbt.profile
[0m10:31:02.183367 [debug] [Thread-1  ]: Writing runtime sql for node "model.stgo_dbt.profile"
[0m10:31:02.184367 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m10:31:02.184367 [debug] [Thread-1  ]: On model.stgo_dbt.profile: BEGIN
[0m10:31:02.185368 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m10:31:04.262965 [debug] [Thread-1  ]: SQL status: BEGIN in 2.08 seconds
[0m10:31:04.263617 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m10:31:04.263617 [debug] [Thread-1  ]: On model.stgo_dbt.profile: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.profile"} */

  
    

  create  table "postgres"."dbo"."profile__dbt_tmp"
  as (
    
-- Final base SQL model
-- depends_on: dbo.users_7
select
    "id",
    sid as account_idasddas,
    uuid,
    "name",
    gender,
    bod as date_of_birth,
    country,
    mobile as phone_number,
    is_kids as age_category,
    join_date as created_at,
    deleted_at,
    _airbyte_ab_id,
    _airbyte_emitted_at,
    now() as _airbyte_normalized_at,
    _airbyte_users_7_hashid
from dbo.users_7
-- users_7 from "postgres".dbo._airbyte_raw_users_7
where 1 = 1

  );
  
[0m10:31:04.724946 [debug] [Thread-1  ]: SQL status: SELECT 54800 in 0.46 seconds
[0m10:31:04.750649 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m10:31:04.751664 [debug] [Thread-1  ]: On model.stgo_dbt.profile: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.profile"} */
alter table "postgres"."dbo"."profile" rename to "profile__dbt_backup"
[0m10:31:04.756923 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
[0m10:31:04.764689 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m10:31:04.765263 [debug] [Thread-1  ]: On model.stgo_dbt.profile: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.profile"} */
alter table "postgres"."dbo"."profile__dbt_tmp" rename to "profile"
[0m10:31:04.768442 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:31:04.789032 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m10:31:04.789032 [debug] [Thread-1  ]: On model.stgo_dbt.profile: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.profile"} */

    create  index if not exists
  "1b2db2bf196fb4056013b78d628e8639"
  on "postgres"."dbo"."profile" using btree
  (_airbyte_emitted_at);
  
[0m10:31:04.894400 [debug] [Thread-1  ]: SQL status: CREATE INDEX in 0.1 seconds
[0m10:31:04.921412 [debug] [Thread-1  ]: On model.stgo_dbt.profile: COMMIT
[0m10:31:04.922421 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m10:31:04.922421 [debug] [Thread-1  ]: On model.stgo_dbt.profile: COMMIT
[0m10:31:04.986016 [debug] [Thread-1  ]: SQL status: COMMIT in 0.06 seconds
[0m10:31:04.994856 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m10:31:04.994856 [debug] [Thread-1  ]: On model.stgo_dbt.profile: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.profile"} */
drop table if exists "postgres"."dbo"."profile__dbt_backup" cascade
[0m10:31:05.037951 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.04 seconds
[0m10:31:05.039000 [debug] [Thread-1  ]: finished collecting timing info
[0m10:31:05.039951 [debug] [Thread-1  ]: On model.stgo_dbt.profile: Close
[0m10:31:05.041309 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a128ad35-57d1-4e08-b7b4-f983a076d7c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E22A23EF10>]}
[0m10:31:05.042284 [info ] [Thread-1  ]: 1 of 2 OK created sql table model dbo.profile .................................. [[32mSELECT 54800[0m in 2.97s]
[0m10:31:05.044306 [debug] [Thread-1  ]: Finished running node model.stgo_dbt.profile
[0m10:31:05.045329 [debug] [Thread-3  ]: Began running node model.stgo_dbt.generateEnums
[0m10:31:05.046057 [info ] [Thread-3  ]: 2 of 2 START sql table model dbo.generateEnums ................................. [RUN]
[0m10:31:05.048865 [debug] [Thread-3  ]: Acquiring new postgres connection "model.stgo_dbt.generateEnums"
[0m10:31:05.049456 [debug] [Thread-3  ]: Began compiling node model.stgo_dbt.generateEnums
[0m10:31:05.049456 [debug] [Thread-3  ]: Compiling model.stgo_dbt.generateEnums
[0m10:31:05.057371 [debug] [Thread-3  ]: Writing injected SQL for node "model.stgo_dbt.generateEnums"
[0m10:31:05.058367 [debug] [Thread-3  ]: finished collecting timing info
[0m10:31:05.059368 [debug] [Thread-3  ]: Began executing node model.stgo_dbt.generateEnums
[0m10:31:05.072421 [debug] [Thread-3  ]: Writing runtime sql for node "model.stgo_dbt.generateEnums"
[0m10:31:05.074415 [debug] [Thread-3  ]: Using postgres connection "model.stgo_dbt.generateEnums"
[0m10:31:05.075399 [debug] [Thread-3  ]: On model.stgo_dbt.generateEnums: BEGIN
[0m10:31:05.075399 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m10:31:07.160030 [debug] [Thread-3  ]: SQL status: BEGIN in 2.08 seconds
[0m10:31:07.160576 [debug] [Thread-3  ]: Using postgres connection "model.stgo_dbt.generateEnums"
[0m10:31:07.160607 [debug] [Thread-3  ]: On model.stgo_dbt.generateEnums: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.generateEnums"} */

  
    

  create  table "postgres"."dbo"."generateEnums__dbt_tmp"
  as (
    


CREATE TYPE dbo.age_category AS ENUM ('ADULT','KID');


-- Final base SQL model
-- depends_on: dbo.users_7
select
*
from "postgres"."dbo"."profile"
  );
  
[0m10:31:07.162848 [debug] [Thread-3  ]: Postgres adapter: Postgres error: syntax error at or near "CREATE"
LINE 11: CREATE TYPE dbo.age_category AS ENUM ('ADULT','KID');
         ^

[0m10:31:07.163405 [debug] [Thread-3  ]: On model.stgo_dbt.generateEnums: ROLLBACK
[0m10:31:07.165632 [debug] [Thread-3  ]: finished collecting timing info
[0m10:31:07.166219 [debug] [Thread-3  ]: On model.stgo_dbt.generateEnums: Close
[0m10:31:07.167987 [debug] [Thread-3  ]: Database Error in model generateEnums (models\generateEnums.sql)
  syntax error at or near "CREATE"
  LINE 11: CREATE TYPE dbo.age_category AS ENUM ('ADULT','KID');
           ^
  compiled Code at target\run\stgo_dbt\models\generateEnums.sql
[0m10:31:07.167987 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a128ad35-57d1-4e08-b7b4-f983a076d7c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E22A29FD00>]}
[0m10:31:07.168556 [error] [Thread-3  ]: 2 of 2 ERROR creating sql table model dbo.generateEnums ........................ [[31mERROR[0m in 2.12s]
[0m10:31:07.170790 [debug] [Thread-3  ]: Finished running node model.stgo_dbt.generateEnums
[0m10:31:07.173186 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m10:31:07.173730 [debug] [MainThread]: Using postgres connection "master"
[0m10:31:07.173730 [debug] [MainThread]: On master: BEGIN
[0m10:31:07.173730 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:31:09.251208 [debug] [MainThread]: SQL status: BEGIN in 2.08 seconds
[0m10:31:09.251783 [debug] [MainThread]: On master: COMMIT
[0m10:31:09.251783 [debug] [MainThread]: Using postgres connection "master"
[0m10:31:09.251783 [debug] [MainThread]: On master: COMMIT
[0m10:31:09.253595 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:31:09.254110 [debug] [MainThread]: On master: Close
[0m10:31:09.254667 [info ] [MainThread]: 
[0m10:31:09.255749 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 13.60 seconds (13.60s).
[0m10:31:09.256847 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:31:09.257425 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m10:31:09.257486 [debug] [MainThread]: Connection 'list_postgres_dbo' was properly closed.
[0m10:31:09.258098 [debug] [MainThread]: Connection 'model.stgo_dbt.profile' was properly closed.
[0m10:31:09.258345 [debug] [MainThread]: Connection 'model.stgo_dbt.generateEnums' was properly closed.
[0m10:31:09.277292 [info ] [MainThread]: 
[0m10:31:09.278255 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:31:09.280243 [info ] [MainThread]: 
[0m10:31:09.281269 [error] [MainThread]: [33mDatabase Error in model generateEnums (models\generateEnums.sql)[0m
[0m10:31:09.283244 [error] [MainThread]:   syntax error at or near "CREATE"
[0m10:31:09.284248 [error] [MainThread]:   LINE 11: CREATE TYPE dbo.age_category AS ENUM ('ADULT','KID');
[0m10:31:09.285246 [error] [MainThread]:            ^
[0m10:31:09.286245 [error] [MainThread]:   compiled Code at target\run\stgo_dbt\models\generateEnums.sql
[0m10:31:09.288246 [info ] [MainThread]: 
[0m10:31:09.289245 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m10:31:09.290242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E22A1BA1F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E229EA30D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E22A3A5A00>]}
[0m10:31:09.291241 [debug] [MainThread]: Flushing usage events


============================== 2023-01-03 10:32:57.575270 | d5c5bde9-2013-4b3c-87a8-c0c00f919f88 ==============================
[0m10:32:57.575270 [info ] [MainThread]: Running with dbt=1.3.1
[0m10:32:57.576107 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'D:\\2023\\Cloudthought\\data-migration-dbt\\stgo_dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:32:57.576107 [debug] [MainThread]: Tracking: tracking
[0m10:32:57.618902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA8B45B3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA8B4058E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA8B4513A0>]}
[0m10:32:57.918163 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:32:57.918163 [debug] [MainThread]: Partial parsing: updated file: stgo_dbt://models\generateEnums.sql
[0m10:32:57.935129 [debug] [MainThread]: 1699: static parser successfully parsed generateEnums.sql
[0m10:32:57.968164 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stgo_dbt.staging

[0m10:32:57.977139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd5c5bde9-2013-4b3c-87a8-c0c00f919f88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA8B8A90D0>]}
[0m10:32:57.995148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd5c5bde9-2013-4b3c-87a8-c0c00f919f88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA8B4720A0>]}
[0m10:32:57.995148 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 703 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m10:32:57.996127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5c5bde9-2013-4b3c-87a8-c0c00f919f88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA8B4059A0>]}
[0m10:32:57.998142 [info ] [MainThread]: 
[0m10:32:57.999128 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m10:32:58.003145 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m10:32:58.019132 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m10:32:58.020126 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m10:32:58.020126 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:33:00.132811 [debug] [ThreadPool]: SQL status: SELECT 10 in 2.11 seconds
[0m10:33:00.135323 [debug] [ThreadPool]: On list_postgres: Close
[0m10:33:00.139371 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbo"
[0m10:33:00.153026 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m10:33:00.154052 [debug] [ThreadPool]: On list_postgres_dbo: BEGIN
[0m10:33:00.154052 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:33:02.240287 [debug] [ThreadPool]: SQL status: BEGIN in 2.09 seconds
[0m10:33:02.240287 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m10:33:02.240852 [debug] [ThreadPool]: On list_postgres_dbo: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres_dbo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo'
  
[0m10:33:02.246018 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
[0m10:33:02.247776 [debug] [ThreadPool]: On list_postgres_dbo: ROLLBACK
[0m10:33:02.250055 [debug] [ThreadPool]: On list_postgres_dbo: Close
[0m10:33:02.257293 [debug] [MainThread]: Using postgres connection "master"
[0m10:33:02.257293 [debug] [MainThread]: On master: BEGIN
[0m10:33:02.257845 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:33:04.367515 [debug] [MainThread]: SQL status: BEGIN in 2.11 seconds
[0m10:33:04.368115 [debug] [MainThread]: Using postgres connection "master"
[0m10:33:04.368140 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:33:04.385416 [debug] [MainThread]: SQL status: SELECT 0 in 0.02 seconds
[0m10:33:04.386935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5c5bde9-2013-4b3c-87a8-c0c00f919f88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA8B472730>]}
[0m10:33:04.386935 [debug] [MainThread]: On master: ROLLBACK
[0m10:33:04.389952 [debug] [MainThread]: Using postgres connection "master"
[0m10:33:04.390490 [debug] [MainThread]: On master: BEGIN
[0m10:33:04.394858 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:33:04.394858 [debug] [MainThread]: On master: COMMIT
[0m10:33:04.395442 [debug] [MainThread]: Using postgres connection "master"
[0m10:33:04.395442 [debug] [MainThread]: On master: COMMIT
[0m10:33:04.397688 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:33:04.398248 [debug] [MainThread]: On master: Close
[0m10:33:04.398801 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:33:04.400033 [info ] [MainThread]: 
[0m10:33:04.409970 [debug] [Thread-1  ]: Began running node model.stgo_dbt.profile
[0m10:33:04.410558 [info ] [Thread-1  ]: 1 of 2 START sql table model dbo.profile ....................................... [RUN]
[0m10:33:04.412769 [debug] [Thread-1  ]: Acquiring new postgres connection "model.stgo_dbt.profile"
[0m10:33:04.412769 [debug] [Thread-1  ]: Began compiling node model.stgo_dbt.profile
[0m10:33:04.413314 [debug] [Thread-1  ]: Compiling model.stgo_dbt.profile
[0m10:33:04.429467 [debug] [Thread-1  ]: Writing injected SQL for node "model.stgo_dbt.profile"
[0m10:33:04.430459 [debug] [Thread-1  ]: finished collecting timing info
[0m10:33:04.430459 [debug] [Thread-1  ]: Began executing node model.stgo_dbt.profile
[0m10:33:04.480429 [debug] [Thread-1  ]: Writing runtime sql for node "model.stgo_dbt.profile"
[0m10:33:04.482448 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m10:33:04.482448 [debug] [Thread-1  ]: On model.stgo_dbt.profile: BEGIN
[0m10:33:04.482448 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m10:33:06.598782 [debug] [Thread-1  ]: SQL status: BEGIN in 2.12 seconds
[0m10:33:06.599324 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m10:33:06.599907 [debug] [Thread-1  ]: On model.stgo_dbt.profile: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.profile"} */

  
    

  create  table "postgres"."dbo"."profile__dbt_tmp"
  as (
    
-- Final base SQL model
-- depends_on: dbo.users_7
select
    "id",
    sid as account_idasddas,
    uuid,
    "name",
    gender,
    bod as date_of_birth,
    country,
    mobile as phone_number,
    is_kids as age_category,
    join_date as created_at,
    deleted_at,
    _airbyte_ab_id,
    _airbyte_emitted_at,
    now() as _airbyte_normalized_at,
    _airbyte_users_7_hashid
from dbo.users_7
-- users_7 from "postgres".dbo._airbyte_raw_users_7
where 1 = 1

  );
  
[0m10:33:06.927373 [debug] [Thread-1  ]: SQL status: SELECT 54800 in 0.33 seconds
[0m10:33:06.943256 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m10:33:06.944254 [debug] [Thread-1  ]: On model.stgo_dbt.profile: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.profile"} */
alter table "postgres"."dbo"."profile" rename to "profile__dbt_backup"
[0m10:33:07.116969 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.17 seconds
[0m10:33:07.122397 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m10:33:07.122681 [debug] [Thread-1  ]: On model.stgo_dbt.profile: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.profile"} */
alter table "postgres"."dbo"."profile__dbt_tmp" rename to "profile"
[0m10:33:07.124886 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:33:07.137790 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m10:33:07.137790 [debug] [Thread-1  ]: On model.stgo_dbt.profile: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.profile"} */

    create  index if not exists
  "dca08e1ffb81b0fe883ba3a833dc9b1b"
  on "postgres"."dbo"."profile" using btree
  (_airbyte_emitted_at);
  
[0m10:33:07.292388 [debug] [Thread-1  ]: SQL status: CREATE INDEX in 0.15 seconds
[0m10:33:07.315459 [debug] [Thread-1  ]: On model.stgo_dbt.profile: COMMIT
[0m10:33:07.315459 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m10:33:07.315459 [debug] [Thread-1  ]: On model.stgo_dbt.profile: COMMIT
[0m10:33:07.391717 [debug] [Thread-1  ]: SQL status: COMMIT in 0.08 seconds
[0m10:33:07.399117 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m10:33:07.399692 [debug] [Thread-1  ]: On model.stgo_dbt.profile: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.profile"} */
drop table if exists "postgres"."dbo"."profile__dbt_backup" cascade
[0m10:33:07.436053 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.04 seconds
[0m10:33:07.437661 [debug] [Thread-1  ]: finished collecting timing info
[0m10:33:07.437661 [debug] [Thread-1  ]: On model.stgo_dbt.profile: Close
[0m10:33:07.438762 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5c5bde9-2013-4b3c-87a8-c0c00f919f88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA8B8EDF70>]}
[0m10:33:07.439320 [info ] [Thread-1  ]: 1 of 2 OK created sql table model dbo.profile .................................. [[32mSELECT 54800[0m in 3.03s]
[0m10:33:07.441115 [debug] [Thread-1  ]: Finished running node model.stgo_dbt.profile
[0m10:33:07.441710 [debug] [Thread-3  ]: Began running node model.stgo_dbt.generateEnums
[0m10:33:07.442780 [info ] [Thread-3  ]: 2 of 2 START sql table model dbo.generateEnums ................................. [RUN]
[0m10:33:07.444555 [debug] [Thread-3  ]: Acquiring new postgres connection "model.stgo_dbt.generateEnums"
[0m10:33:07.445245 [debug] [Thread-3  ]: Began compiling node model.stgo_dbt.generateEnums
[0m10:33:07.445787 [debug] [Thread-3  ]: Compiling model.stgo_dbt.generateEnums
[0m10:33:07.451111 [debug] [Thread-3  ]: Writing injected SQL for node "model.stgo_dbt.generateEnums"
[0m10:33:07.452222 [debug] [Thread-3  ]: finished collecting timing info
[0m10:33:07.452325 [debug] [Thread-3  ]: Began executing node model.stgo_dbt.generateEnums
[0m10:33:07.459644 [debug] [Thread-3  ]: Writing runtime sql for node "model.stgo_dbt.generateEnums"
[0m10:33:07.461365 [debug] [Thread-3  ]: Using postgres connection "model.stgo_dbt.generateEnums"
[0m10:33:07.461365 [debug] [Thread-3  ]: On model.stgo_dbt.generateEnums: BEGIN
[0m10:33:07.461365 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m10:33:09.509829 [debug] [Thread-3  ]: SQL status: BEGIN in 2.05 seconds
[0m10:33:09.509843 [debug] [Thread-3  ]: Using postgres connection "model.stgo_dbt.generateEnums"
[0m10:33:09.510431 [debug] [Thread-3  ]: On model.stgo_dbt.generateEnums: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.generateEnums"} */

  
    

  create  table "postgres"."dbo"."generateEnums__dbt_tmp"
  as (
    


CREATE TYPE public.age_category AS ENUM ('ADULT','KID')$


-- Final base SQL model
-- depends_on: dbo.users_7
select
*
from "postgres"."dbo"."profile"
  );
  
[0m10:33:09.512123 [debug] [Thread-3  ]: Postgres adapter: Postgres error: syntax error at or near "CREATE"
LINE 11: CREATE TYPE public.age_category AS ENUM ('ADULT','KID')$
         ^

[0m10:33:09.512709 [debug] [Thread-3  ]: On model.stgo_dbt.generateEnums: ROLLBACK
[0m10:33:09.514959 [debug] [Thread-3  ]: finished collecting timing info
[0m10:33:09.514959 [debug] [Thread-3  ]: On model.stgo_dbt.generateEnums: Close
[0m10:33:09.516059 [debug] [Thread-3  ]: Database Error in model generateEnums (models\generateEnums.sql)
  syntax error at or near "CREATE"
  LINE 11: CREATE TYPE public.age_category AS ENUM ('ADULT','KID')$
           ^
  compiled Code at target\run\stgo_dbt\models\generateEnums.sql
[0m10:33:09.516603 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5c5bde9-2013-4b3c-87a8-c0c00f919f88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA8BA5C610>]}
[0m10:33:09.516603 [error] [Thread-3  ]: 2 of 2 ERROR creating sql table model dbo.generateEnums ........................ [[31mERROR[0m in 2.07s]
[0m10:33:09.518243 [debug] [Thread-3  ]: Finished running node model.stgo_dbt.generateEnums
[0m10:33:09.520479 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m10:33:09.521034 [debug] [MainThread]: Using postgres connection "master"
[0m10:33:09.521034 [debug] [MainThread]: On master: BEGIN
[0m10:33:09.521594 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:33:11.601641 [debug] [MainThread]: SQL status: BEGIN in 2.08 seconds
[0m10:33:11.602161 [debug] [MainThread]: On master: COMMIT
[0m10:33:11.602446 [debug] [MainThread]: Using postgres connection "master"
[0m10:33:11.602983 [debug] [MainThread]: On master: COMMIT
[0m10:33:11.605186 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:33:11.605186 [debug] [MainThread]: On master: Close
[0m10:33:11.606827 [info ] [MainThread]: 
[0m10:33:11.607955 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 13.61 seconds (13.61s).
[0m10:33:11.608522 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:33:11.609474 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m10:33:11.609474 [debug] [MainThread]: Connection 'list_postgres_dbo' was properly closed.
[0m10:33:11.610472 [debug] [MainThread]: Connection 'model.stgo_dbt.profile' was properly closed.
[0m10:33:11.610472 [debug] [MainThread]: Connection 'model.stgo_dbt.generateEnums' was properly closed.
[0m10:33:11.635472 [info ] [MainThread]: 
[0m10:33:11.636480 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:33:11.638474 [info ] [MainThread]: 
[0m10:33:11.639476 [error] [MainThread]: [33mDatabase Error in model generateEnums (models\generateEnums.sql)[0m
[0m10:33:11.640473 [error] [MainThread]:   syntax error at or near "CREATE"
[0m10:33:11.641473 [error] [MainThread]:   LINE 11: CREATE TYPE public.age_category AS ENUM ('ADULT','KID')$
[0m10:33:11.642473 [error] [MainThread]:            ^
[0m10:33:11.644494 [error] [MainThread]:   compiled Code at target\run\stgo_dbt\models\generateEnums.sql
[0m10:33:11.645474 [info ] [MainThread]: 
[0m10:33:11.646474 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m10:33:11.647483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA8B8AAD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA8B472E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA8BA55A90>]}
[0m10:33:11.648484 [debug] [MainThread]: Flushing usage events


============================== 2023-01-03 10:34:10.490398 | 27c5dd8b-bac4-4518-a497-95a74cee63c0 ==============================
[0m10:34:10.490398 [info ] [MainThread]: Running with dbt=1.3.1
[0m10:34:10.491397 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'D:\\2023\\Cloudthought\\data-migration-dbt\\stgo_dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:34:10.492366 [debug] [MainThread]: Tracking: tracking
[0m10:34:10.534013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A30029BE20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3002449D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A300291550>]}
[0m10:34:10.930888 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:34:10.931898 [debug] [MainThread]: Partial parsing: updated file: stgo_dbt://models\generateEnums.sql
[0m10:34:10.950865 [debug] [MainThread]: 1699: static parser successfully parsed generateEnums.sql
[0m10:34:10.983974 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stgo_dbt.staging

[0m10:34:10.992944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '27c5dd8b-bac4-4518-a497-95a74cee63c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3006DB0D0>]}
[0m10:34:11.011952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '27c5dd8b-bac4-4518-a497-95a74cee63c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3002B20D0>]}
[0m10:34:11.011952 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 703 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m10:34:11.012953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27c5dd8b-bac4-4518-a497-95a74cee63c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A300244910>]}
[0m10:34:11.014914 [info ] [MainThread]: 
[0m10:34:11.016917 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m10:34:11.019931 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m10:34:11.037929 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m10:34:11.037929 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m10:34:11.037929 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:34:13.169318 [debug] [ThreadPool]: SQL status: SELECT 10 in 2.13 seconds
[0m10:34:13.171316 [debug] [ThreadPool]: On list_postgres: Close
[0m10:34:13.174340 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbo"
[0m10:34:13.185347 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m10:34:13.185347 [debug] [ThreadPool]: On list_postgres_dbo: BEGIN
[0m10:34:13.185877 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:34:15.253596 [debug] [ThreadPool]: SQL status: BEGIN in 2.07 seconds
[0m10:34:15.254198 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m10:34:15.254198 [debug] [ThreadPool]: On list_postgres_dbo: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres_dbo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo'
  
[0m10:34:15.258223 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m10:34:15.261139 [debug] [ThreadPool]: On list_postgres_dbo: ROLLBACK
[0m10:34:15.263621 [debug] [ThreadPool]: On list_postgres_dbo: Close
[0m10:34:15.270662 [debug] [MainThread]: Using postgres connection "master"
[0m10:34:15.271211 [debug] [MainThread]: On master: BEGIN
[0m10:34:15.271268 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:34:17.367691 [debug] [MainThread]: SQL status: BEGIN in 2.1 seconds
[0m10:34:17.368239 [debug] [MainThread]: Using postgres connection "master"
[0m10:34:17.368239 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:34:17.382027 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
[0m10:34:17.383606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27c5dd8b-bac4-4518-a497-95a74cee63c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A30037B940>]}
[0m10:34:17.383606 [debug] [MainThread]: On master: ROLLBACK
[0m10:34:17.386528 [debug] [MainThread]: Using postgres connection "master"
[0m10:34:17.387079 [debug] [MainThread]: On master: BEGIN
[0m10:34:17.391095 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:34:17.391630 [debug] [MainThread]: On master: COMMIT
[0m10:34:17.391705 [debug] [MainThread]: Using postgres connection "master"
[0m10:34:17.391705 [debug] [MainThread]: On master: COMMIT
[0m10:34:17.393979 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:34:17.393979 [debug] [MainThread]: On master: Close
[0m10:34:17.395090 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:34:17.395624 [info ] [MainThread]: 
[0m10:34:17.406523 [debug] [Thread-1  ]: Began running node model.stgo_dbt.profile
[0m10:34:17.407195 [info ] [Thread-1  ]: 1 of 2 START sql table model dbo.profile ....................................... [RUN]
[0m10:34:17.409448 [debug] [Thread-1  ]: Acquiring new postgres connection "model.stgo_dbt.profile"
[0m10:34:17.409448 [debug] [Thread-1  ]: Began compiling node model.stgo_dbt.profile
[0m10:34:17.409448 [debug] [Thread-1  ]: Compiling model.stgo_dbt.profile
[0m10:34:17.428439 [debug] [Thread-1  ]: Writing injected SQL for node "model.stgo_dbt.profile"
[0m10:34:17.430405 [debug] [Thread-1  ]: finished collecting timing info
[0m10:34:17.430405 [debug] [Thread-1  ]: Began executing node model.stgo_dbt.profile
[0m10:34:17.481438 [debug] [Thread-1  ]: Writing runtime sql for node "model.stgo_dbt.profile"
[0m10:34:17.483400 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m10:34:17.483400 [debug] [Thread-1  ]: On model.stgo_dbt.profile: BEGIN
[0m10:34:17.484406 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m10:34:19.598702 [debug] [Thread-1  ]: SQL status: BEGIN in 2.11 seconds
[0m10:34:19.598702 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m10:34:19.599844 [debug] [Thread-1  ]: On model.stgo_dbt.profile: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.profile"} */

  
    

  create  table "postgres"."dbo"."profile__dbt_tmp"
  as (
    
-- Final base SQL model
-- depends_on: dbo.users_7
select
    "id",
    sid as account_idasddas,
    uuid,
    "name",
    gender,
    bod as date_of_birth,
    country,
    mobile as phone_number,
    is_kids as age_category,
    join_date as created_at,
    deleted_at,
    _airbyte_ab_id,
    _airbyte_emitted_at,
    now() as _airbyte_normalized_at,
    _airbyte_users_7_hashid
from dbo.users_7
-- users_7 from "postgres".dbo._airbyte_raw_users_7
where 1 = 1

  );
  
[0m10:34:19.876078 [debug] [Thread-1  ]: SQL status: SELECT 54800 in 0.28 seconds
[0m10:34:19.883689 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m10:34:19.883689 [debug] [Thread-1  ]: On model.stgo_dbt.profile: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.profile"} */
alter table "postgres"."dbo"."profile" rename to "profile__dbt_backup"
[0m10:34:19.887314 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:34:19.891294 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m10:34:19.891861 [debug] [Thread-1  ]: On model.stgo_dbt.profile: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.profile"} */
alter table "postgres"."dbo"."profile__dbt_tmp" rename to "profile"
[0m10:34:19.894108 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:34:19.908688 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m10:34:19.908688 [debug] [Thread-1  ]: On model.stgo_dbt.profile: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.profile"} */

    create  index if not exists
  "77869bd8262579e374d05a77d5975d77"
  on "postgres"."dbo"."profile" using btree
  (_airbyte_emitted_at);
  
[0m10:34:20.099680 [debug] [Thread-1  ]: SQL status: CREATE INDEX in 0.19 seconds
[0m10:34:20.133045 [debug] [Thread-1  ]: On model.stgo_dbt.profile: COMMIT
[0m10:34:20.134042 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m10:34:20.134042 [debug] [Thread-1  ]: On model.stgo_dbt.profile: COMMIT
[0m10:34:20.215733 [debug] [Thread-1  ]: SQL status: COMMIT in 0.08 seconds
[0m10:34:20.225565 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m10:34:20.226120 [debug] [Thread-1  ]: On model.stgo_dbt.profile: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.profile"} */
drop table if exists "postgres"."dbo"."profile__dbt_backup" cascade
[0m10:34:20.268147 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.04 seconds
[0m10:34:20.269236 [debug] [Thread-1  ]: finished collecting timing info
[0m10:34:20.270196 [debug] [Thread-1  ]: On model.stgo_dbt.profile: Close
[0m10:34:20.271320 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27c5dd8b-bac4-4518-a497-95a74cee63c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A30089FFA0>]}
[0m10:34:20.272436 [info ] [Thread-1  ]: 1 of 2 OK created sql table model dbo.profile .................................. [[32mSELECT 54800[0m in 2.86s]
[0m10:34:20.274478 [debug] [Thread-1  ]: Finished running node model.stgo_dbt.profile
[0m10:34:20.275613 [debug] [Thread-3  ]: Began running node model.stgo_dbt.generateEnums
[0m10:34:20.276687 [info ] [Thread-3  ]: 2 of 2 START sql table model dbo.generateEnums ................................. [RUN]
[0m10:34:20.278864 [debug] [Thread-3  ]: Acquiring new postgres connection "model.stgo_dbt.generateEnums"
[0m10:34:20.279427 [debug] [Thread-3  ]: Began compiling node model.stgo_dbt.generateEnums
[0m10:34:20.279982 [debug] [Thread-3  ]: Compiling model.stgo_dbt.generateEnums
[0m10:34:20.286805 [debug] [Thread-3  ]: Writing injected SQL for node "model.stgo_dbt.generateEnums"
[0m10:34:20.287339 [debug] [Thread-3  ]: finished collecting timing info
[0m10:34:20.288318 [debug] [Thread-3  ]: Began executing node model.stgo_dbt.generateEnums
[0m10:34:20.297319 [debug] [Thread-3  ]: Writing runtime sql for node "model.stgo_dbt.generateEnums"
[0m10:34:20.299323 [debug] [Thread-3  ]: Using postgres connection "model.stgo_dbt.generateEnums"
[0m10:34:20.299323 [debug] [Thread-3  ]: On model.stgo_dbt.generateEnums: BEGIN
[0m10:34:20.299323 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m10:34:22.371943 [debug] [Thread-3  ]: SQL status: BEGIN in 2.07 seconds
[0m10:34:22.372491 [debug] [Thread-3  ]: Using postgres connection "model.stgo_dbt.generateEnums"
[0m10:34:22.372491 [debug] [Thread-3  ]: On model.stgo_dbt.generateEnums: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.generateEnums"} */

  
    

  create  table "postgres"."dbo"."generateEnums__dbt_tmp"
  as (
    


CREATE TYPE age_category AS ENUM ('ADULT','KID');


-- Final base SQL model
-- depends_on: dbo.users_7
select
*
from "postgres"."dbo"."profile"
  );
  
[0m10:34:22.374716 [debug] [Thread-3  ]: Postgres adapter: Postgres error: syntax error at or near "CREATE"
LINE 11: CREATE TYPE age_category AS ENUM ('ADULT','KID');
         ^

[0m10:34:22.374716 [debug] [Thread-3  ]: On model.stgo_dbt.generateEnums: ROLLBACK
[0m10:34:22.376970 [debug] [Thread-3  ]: finished collecting timing info
[0m10:34:22.377543 [debug] [Thread-3  ]: On model.stgo_dbt.generateEnums: Close
[0m10:34:22.378661 [debug] [Thread-3  ]: Database Error in model generateEnums (models\generateEnums.sql)
  syntax error at or near "CREATE"
  LINE 11: CREATE TYPE age_category AS ENUM ('ADULT','KID');
           ^
  compiled Code at target\run\stgo_dbt\models\generateEnums.sql
[0m10:34:22.378661 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27c5dd8b-bac4-4518-a497-95a74cee63c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A30077ED00>]}
[0m10:34:22.379228 [error] [Thread-3  ]: 2 of 2 ERROR creating sql table model dbo.generateEnums ........................ [[31mERROR[0m in 2.10s]
[0m10:34:22.380878 [debug] [Thread-3  ]: Finished running node model.stgo_dbt.generateEnums
[0m10:34:22.383123 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m10:34:22.383722 [debug] [MainThread]: Using postgres connection "master"
[0m10:34:22.383722 [debug] [MainThread]: On master: BEGIN
[0m10:34:22.384276 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:34:24.502102 [debug] [MainThread]: SQL status: BEGIN in 2.12 seconds
[0m10:34:24.502102 [debug] [MainThread]: On master: COMMIT
[0m10:34:24.502683 [debug] [MainThread]: Using postgres connection "master"
[0m10:34:24.502683 [debug] [MainThread]: On master: COMMIT
[0m10:34:24.504935 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:34:24.504935 [debug] [MainThread]: On master: Close
[0m10:34:24.506059 [info ] [MainThread]: 
[0m10:34:24.506616 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 13.49 seconds (13.49s).
[0m10:34:24.507732 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:34:24.508278 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m10:34:24.508278 [debug] [MainThread]: Connection 'list_postgres_dbo' was properly closed.
[0m10:34:24.508278 [debug] [MainThread]: Connection 'model.stgo_dbt.profile' was properly closed.
[0m10:34:24.508803 [debug] [MainThread]: Connection 'model.stgo_dbt.generateEnums' was properly closed.
[0m10:34:24.525373 [info ] [MainThread]: 
[0m10:34:24.527324 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:34:24.529343 [info ] [MainThread]: 
[0m10:34:24.530339 [error] [MainThread]: [33mDatabase Error in model generateEnums (models\generateEnums.sql)[0m
[0m10:34:24.532380 [error] [MainThread]:   syntax error at or near "CREATE"
[0m10:34:24.533344 [error] [MainThread]:   LINE 11: CREATE TYPE age_category AS ENUM ('ADULT','KID');
[0m10:34:24.534343 [error] [MainThread]:            ^
[0m10:34:24.535347 [error] [MainThread]:   compiled Code at target\run\stgo_dbt\models\generateEnums.sql
[0m10:34:24.536341 [info ] [MainThread]: 
[0m10:34:24.537335 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m10:34:24.538337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A30077ED00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A30037B8B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A300702430>]}
[0m10:34:24.538337 [debug] [MainThread]: Flushing usage events


============================== 2023-01-03 10:41:17.092902 | ed0fddcd-9279-428c-9f0c-4de0d687ebc2 ==============================
[0m10:41:17.092902 [info ] [MainThread]: Running with dbt=1.3.1
[0m10:41:17.093901 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'D:\\2023\\Cloudthought\\data-migration-dbt\\stgo_dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:41:17.093901 [debug] [MainThread]: Tracking: tracking
[0m10:41:17.139903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232A4C7B3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232A4C248E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232A4C71070>]}
[0m10:41:17.446711 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 1 files changed.
[0m10:41:17.447705 [debug] [MainThread]: Partial parsing: deleted file: stgo_dbt://models\generateEnums.sql
[0m10:41:17.447705 [debug] [MainThread]: Partial parsing: updated file: stgo_dbt://models\profile.sql
[0m10:41:17.464704 [debug] [MainThread]: 1603: static parser failed on profile.sql
[0m10:41:17.494721 [debug] [MainThread]: 1602: parser fallback to jinja rendering on profile.sql
[0m10:41:17.514349 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stgo_dbt.staging

[0m10:41:17.524354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ed0fddcd-9279-428c-9f0c-4de0d687ebc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232A50A30D0>]}
[0m10:41:17.547313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ed0fddcd-9279-428c-9f0c-4de0d687ebc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232A4FF3B50>]}
[0m10:41:17.547313 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 703 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m10:41:17.549320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed0fddcd-9279-428c-9f0c-4de0d687ebc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232A4C249A0>]}
[0m10:41:17.551314 [info ] [MainThread]: 
[0m10:41:17.553314 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m10:41:17.555319 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m10:41:17.578316 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m10:41:17.579313 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m10:41:17.579313 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:41:19.690519 [debug] [ThreadPool]: SQL status: SELECT 10 in 2.11 seconds
[0m10:41:19.692950 [debug] [ThreadPool]: On list_postgres: Close
[0m10:41:19.697123 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbo"
[0m10:41:19.708290 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m10:41:19.708290 [debug] [ThreadPool]: On list_postgres_dbo: BEGIN
[0m10:41:19.708290 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:41:21.806582 [debug] [ThreadPool]: SQL status: BEGIN in 2.1 seconds
[0m10:41:21.806902 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m10:41:21.807154 [debug] [ThreadPool]: On list_postgres_dbo: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres_dbo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo'
  
[0m10:41:21.812633 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
[0m10:41:21.814552 [debug] [ThreadPool]: On list_postgres_dbo: ROLLBACK
[0m10:41:21.816964 [debug] [ThreadPool]: On list_postgres_dbo: Close
[0m10:41:21.826742 [debug] [MainThread]: Using postgres connection "master"
[0m10:41:21.826810 [debug] [MainThread]: On master: BEGIN
[0m10:41:21.826810 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:41:23.906478 [debug] [MainThread]: SQL status: BEGIN in 2.08 seconds
[0m10:41:23.906478 [debug] [MainThread]: Using postgres connection "master"
[0m10:41:23.906478 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:41:23.917875 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
[0m10:41:23.918424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed0fddcd-9279-428c-9f0c-4de0d687ebc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232A4C924C0>]}
[0m10:41:23.919462 [debug] [MainThread]: On master: ROLLBACK
[0m10:41:23.921567 [debug] [MainThread]: Using postgres connection "master"
[0m10:41:23.922130 [debug] [MainThread]: On master: BEGIN
[0m10:41:23.925712 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:41:23.925712 [debug] [MainThread]: On master: COMMIT
[0m10:41:23.926312 [debug] [MainThread]: Using postgres connection "master"
[0m10:41:23.926312 [debug] [MainThread]: On master: COMMIT
[0m10:41:23.928067 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:41:23.928679 [debug] [MainThread]: On master: Close
[0m10:41:23.929754 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:41:23.930941 [info ] [MainThread]: 
[0m10:41:23.941506 [debug] [Thread-1  ]: Began running node model.stgo_dbt.profile
[0m10:41:23.942221 [info ] [Thread-1  ]: 1 of 1 START sql table model dbo.profile ....................................... [RUN]
[0m10:41:23.944320 [debug] [Thread-1  ]: Acquiring new postgres connection "model.stgo_dbt.profile"
[0m10:41:23.944320 [debug] [Thread-1  ]: Began compiling node model.stgo_dbt.profile
[0m10:41:23.945313 [debug] [Thread-1  ]: Compiling model.stgo_dbt.profile
[0m10:41:23.952342 [debug] [Thread-1  ]: Writing injected SQL for node "model.stgo_dbt.profile"
[0m10:41:23.954295 [debug] [Thread-1  ]: finished collecting timing info
[0m10:41:23.954295 [debug] [Thread-1  ]: Began executing node model.stgo_dbt.profile
[0m10:41:24.008338 [debug] [Thread-1  ]: Writing runtime sql for node "model.stgo_dbt.profile"
[0m10:41:24.010299 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m10:41:24.010299 [debug] [Thread-1  ]: On model.stgo_dbt.profile: BEGIN
[0m10:41:24.010299 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m10:41:26.101299 [debug] [Thread-1  ]: SQL status: BEGIN in 2.09 seconds
[0m10:41:26.101299 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m10:41:26.101854 [debug] [Thread-1  ]: On model.stgo_dbt.profile: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.profile"} */

  
    

  create  table "postgres"."dbo"."profile__dbt_tmp"
  as (
    
-- Final base SQL model
-- depends_on: dbo.users_7
select
    "id",
    sid as account_id,
    uuid,
    "name",
    gender,
    bod as date_of_birth,
    country,
    mobile as phone_number,
    is_kids as age_category,
    join_date as created_at,
    date::timestamp_ntz AS updated_at,
    deleted_at,
    _airbyte_ab_id,
    _airbyte_emitted_at,
    now() as _airbyte_normalized_at,
    _airbyte_users_7_hashid
from dbo.users_7
-- users_7 from "postgres".dbo._airbyte_raw_users_7
where 1 = 1


create type age_category as ENUM ('ADULT','KID')
  );
  
[0m10:41:26.103626 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "create"
LINE 33: create type age_category as ENUM ('ADULT','KID')
         ^

[0m10:41:26.104158 [debug] [Thread-1  ]: On model.stgo_dbt.profile: ROLLBACK
[0m10:41:26.106468 [debug] [Thread-1  ]: finished collecting timing info
[0m10:41:26.106468 [debug] [Thread-1  ]: On model.stgo_dbt.profile: Close
[0m10:41:26.107621 [debug] [Thread-1  ]: Database Error in model profile (models\profile.sql)
  syntax error at or near "create"
  LINE 33: create type age_category as ENUM ('ADULT','KID')
           ^
  compiled Code at target\run\stgo_dbt\models\profile.sql
[0m10:41:26.108160 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed0fddcd-9279-428c-9f0c-4de0d687ebc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232A5293FD0>]}
[0m10:41:26.108724 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dbo.profile .............................. [[31mERROR[0m in 2.16s]
[0m10:41:26.111018 [debug] [Thread-1  ]: Finished running node model.stgo_dbt.profile
[0m10:41:26.113411 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m10:41:26.113967 [debug] [MainThread]: Using postgres connection "master"
[0m10:41:26.114506 [debug] [MainThread]: On master: BEGIN
[0m10:41:26.114682 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:41:28.212911 [debug] [MainThread]: SQL status: BEGIN in 2.1 seconds
[0m10:41:28.213450 [debug] [MainThread]: On master: COMMIT
[0m10:41:28.213556 [debug] [MainThread]: Using postgres connection "master"
[0m10:41:28.214460 [debug] [MainThread]: On master: COMMIT
[0m10:41:28.216806 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:41:28.217377 [debug] [MainThread]: On master: Close
[0m10:41:28.219085 [info ] [MainThread]: 
[0m10:41:28.221391 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.67 seconds (10.67s).
[0m10:41:28.224331 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:41:28.224890 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m10:41:28.225413 [debug] [MainThread]: Connection 'list_postgres_dbo' was properly closed.
[0m10:41:28.225413 [debug] [MainThread]: Connection 'model.stgo_dbt.profile' was properly closed.
[0m10:41:28.249725 [info ] [MainThread]: 
[0m10:41:28.251727 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:41:28.252739 [info ] [MainThread]: 
[0m10:41:28.253723 [error] [MainThread]: [33mDatabase Error in model profile (models\profile.sql)[0m
[0m10:41:28.256736 [error] [MainThread]:   syntax error at or near "create"
[0m10:41:28.257726 [error] [MainThread]:   LINE 33: create type age_category as ENUM ('ADULT','KID')
[0m10:41:28.259726 [error] [MainThread]:            ^
[0m10:41:28.260721 [error] [MainThread]:   compiled Code at target\run\stgo_dbt\models\profile.sql
[0m10:41:28.262725 [info ] [MainThread]: 
[0m10:41:28.263724 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:41:28.265724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232A4C92940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232A4C92F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232A50EB6A0>]}
[0m10:41:28.265724 [debug] [MainThread]: Flushing usage events


============================== 2023-01-03 10:41:56.784347 | 203a2237-3758-439d-be24-cbee72c6df1b ==============================
[0m10:41:56.784347 [info ] [MainThread]: Running with dbt=1.3.1
[0m10:41:56.785344 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'D:\\2023\\Cloudthought\\data-migration-dbt\\stgo_dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:41:56.786300 [debug] [MainThread]: Tracking: tracking
[0m10:41:56.824349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1C6E0B220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1C6DB4970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1C6E02310>]}
[0m10:41:57.190172 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:41:57.190172 [debug] [MainThread]: Partial parsing: updated file: stgo_dbt://models\profile.sql
[0m10:41:57.206170 [debug] [MainThread]: 1603: static parser failed on profile.sql
[0m10:41:57.233172 [debug] [MainThread]: 1602: parser fallback to jinja rendering on profile.sql
[0m10:41:57.250172 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stgo_dbt.staging

[0m10:41:57.259173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '203a2237-3758-439d-be24-cbee72c6df1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1C72340D0>]}
[0m10:41:57.276172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '203a2237-3758-439d-be24-cbee72c6df1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1C7192F10>]}
[0m10:41:57.276172 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 703 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m10:41:57.277172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '203a2237-3758-439d-be24-cbee72c6df1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1C6DB48B0>]}
[0m10:41:57.279175 [info ] [MainThread]: 
[0m10:41:57.281173 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m10:41:57.284176 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m10:41:57.302175 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m10:41:57.302175 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m10:41:57.302175 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:41:59.414376 [debug] [ThreadPool]: SQL status: SELECT 10 in 2.11 seconds
[0m10:41:59.416083 [debug] [ThreadPool]: On list_postgres: Close
[0m10:41:59.419048 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbo"
[0m10:41:59.427116 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m10:41:59.427684 [debug] [ThreadPool]: On list_postgres_dbo: BEGIN
[0m10:41:59.427684 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:42:01.495210 [debug] [ThreadPool]: SQL status: BEGIN in 2.07 seconds
[0m10:42:01.495784 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m10:42:01.495784 [debug] [ThreadPool]: On list_postgres_dbo: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres_dbo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo'
  
[0m10:42:01.500257 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m10:42:01.501894 [debug] [ThreadPool]: On list_postgres_dbo: ROLLBACK
[0m10:42:01.504325 [debug] [ThreadPool]: On list_postgres_dbo: Close
[0m10:42:01.511817 [debug] [MainThread]: Using postgres connection "master"
[0m10:42:01.511817 [debug] [MainThread]: On master: BEGIN
[0m10:42:01.512403 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:42:03.603303 [debug] [MainThread]: SQL status: BEGIN in 2.09 seconds
[0m10:42:03.603343 [debug] [MainThread]: Using postgres connection "master"
[0m10:42:03.603910 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:42:03.622885 [debug] [MainThread]: SQL status: SELECT 0 in 0.02 seconds
[0m10:42:03.623408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '203a2237-3758-439d-be24-cbee72c6df1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1C7192D00>]}
[0m10:42:03.624457 [debug] [MainThread]: On master: ROLLBACK
[0m10:42:03.626798 [debug] [MainThread]: Using postgres connection "master"
[0m10:42:03.626798 [debug] [MainThread]: On master: BEGIN
[0m10:42:03.630895 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:42:03.631444 [debug] [MainThread]: On master: COMMIT
[0m10:42:03.631444 [debug] [MainThread]: Using postgres connection "master"
[0m10:42:03.631991 [debug] [MainThread]: On master: COMMIT
[0m10:42:03.633767 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:42:03.634308 [debug] [MainThread]: On master: Close
[0m10:42:03.635639 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:42:03.636821 [info ] [MainThread]: 
[0m10:42:03.647345 [debug] [Thread-1  ]: Began running node model.stgo_dbt.profile
[0m10:42:03.648341 [info ] [Thread-1  ]: 1 of 1 START sql table model dbo.profile ....................................... [RUN]
[0m10:42:03.650336 [debug] [Thread-1  ]: Acquiring new postgres connection "model.stgo_dbt.profile"
[0m10:42:03.650336 [debug] [Thread-1  ]: Began compiling node model.stgo_dbt.profile
[0m10:42:03.651329 [debug] [Thread-1  ]: Compiling model.stgo_dbt.profile
[0m10:42:03.659373 [debug] [Thread-1  ]: Writing injected SQL for node "model.stgo_dbt.profile"
[0m10:42:03.661327 [debug] [Thread-1  ]: finished collecting timing info
[0m10:42:03.661327 [debug] [Thread-1  ]: Began executing node model.stgo_dbt.profile
[0m10:42:03.714119 [debug] [Thread-1  ]: Writing runtime sql for node "model.stgo_dbt.profile"
[0m10:42:03.716089 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m10:42:03.716089 [debug] [Thread-1  ]: On model.stgo_dbt.profile: BEGIN
[0m10:42:03.716089 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m10:42:05.783219 [debug] [Thread-1  ]: SQL status: BEGIN in 2.07 seconds
[0m10:42:05.783755 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m10:42:05.784262 [debug] [Thread-1  ]: On model.stgo_dbt.profile: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.profile"} */

  
    

  create  table "postgres"."dbo"."profile__dbt_tmp"
  as (
    
-- Final base SQL model
-- depends_on: dbo.users_7
select
    "id",
    sid as account_id,
    uuid,
    "name",
    gender,
    bod as date_of_birth,
    country,
    mobile as phone_number,
    is_kids as age_category,
    join_date as created_at,
    date::timestamp_ntz AS updated_at,
    deleted_at,
    _airbyte_ab_id,
    _airbyte_emitted_at,
    now() as _airbyte_normalized_at,
    _airbyte_users_7_hashid
from dbo.users_7
-- users_7 from "postgres".dbo._airbyte_raw_users_7
where 1 = 1


DO $$ 
BEGIN 
    create type age_category as ENUM ('ADULT','KID')
EXCEPTION
    WHEN duplicate_object THEN null;
END $$;
  );
  
[0m10:42:05.786435 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "DO"
LINE 33: DO $$ 
         ^

[0m10:42:05.786435 [debug] [Thread-1  ]: On model.stgo_dbt.profile: ROLLBACK
[0m10:42:05.788658 [debug] [Thread-1  ]: finished collecting timing info
[0m10:42:05.789179 [debug] [Thread-1  ]: On model.stgo_dbt.profile: Close
[0m10:42:05.790816 [debug] [Thread-1  ]: Database Error in model profile (models\profile.sql)
  syntax error at or near "DO"
  LINE 33: DO $$ 
           ^
  compiled Code at target\run\stgo_dbt\models\profile.sql
[0m10:42:05.791352 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '203a2237-3758-439d-be24-cbee72c6df1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1C725BAF0>]}
[0m10:42:05.792004 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dbo.profile .............................. [[31mERROR[0m in 2.14s]
[0m10:42:05.793698 [debug] [Thread-1  ]: Finished running node model.stgo_dbt.profile
[0m10:42:05.796462 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m10:42:05.796462 [debug] [MainThread]: Using postgres connection "master"
[0m10:42:05.797019 [debug] [MainThread]: On master: BEGIN
[0m10:42:05.797560 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:42:07.902166 [debug] [MainThread]: SQL status: BEGIN in 2.1 seconds
[0m10:42:07.902996 [debug] [MainThread]: On master: COMMIT
[0m10:42:07.902996 [debug] [MainThread]: Using postgres connection "master"
[0m10:42:07.903583 [debug] [MainThread]: On master: COMMIT
[0m10:42:07.906459 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:42:07.906672 [debug] [MainThread]: On master: Close
[0m10:42:07.908538 [info ] [MainThread]: 
[0m10:42:07.909992 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.63 seconds (10.63s).
[0m10:42:07.911267 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:42:07.911828 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m10:42:07.911828 [debug] [MainThread]: Connection 'list_postgres_dbo' was properly closed.
[0m10:42:07.912378 [debug] [MainThread]: Connection 'model.stgo_dbt.profile' was properly closed.
[0m10:42:07.929652 [info ] [MainThread]: 
[0m10:42:07.930630 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:42:07.932608 [info ] [MainThread]: 
[0m10:42:07.933609 [error] [MainThread]: [33mDatabase Error in model profile (models\profile.sql)[0m
[0m10:42:07.934618 [error] [MainThread]:   syntax error at or near "DO"
[0m10:42:07.935695 [error] [MainThread]:   LINE 33: DO $$ 
[0m10:42:07.936616 [error] [MainThread]:            ^
[0m10:42:07.937608 [error] [MainThread]:   compiled Code at target\run\stgo_dbt\models\profile.sql
[0m10:42:07.938617 [info ] [MainThread]: 
[0m10:42:07.940608 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:42:07.941617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1C7439F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1C7192D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1C7267C40>]}
[0m10:42:07.942611 [debug] [MainThread]: Flushing usage events


============================== 2023-01-03 10:44:06.543550 | 0be196b9-1426-41d0-b39b-45531db93480 ==============================
[0m10:44:06.543550 [info ] [MainThread]: Running with dbt=1.3.1
[0m10:44:06.544547 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'D:\\2023\\Cloudthought\\data-migration-dbt\\stgo_dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:44:06.544547 [debug] [MainThread]: Tracking: tracking
[0m10:44:06.584255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F8F76B3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F8F7159A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F8F7613D0>]}
[0m10:44:06.903367 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:44:06.904374 [debug] [MainThread]: Partial parsing: updated file: stgo_dbt://models\profile.sql
[0m10:44:06.923908 [debug] [MainThread]: 1603: static parser failed on profile.sql
[0m10:44:06.960611 [debug] [MainThread]: 1602: parser fallback to jinja rendering on profile.sql
[0m10:44:06.983616 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stgo_dbt.staging

[0m10:44:06.996596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0be196b9-1426-41d0-b39b-45531db93480', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F8FB930D0>]}
[0m10:44:07.017575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0be196b9-1426-41d0-b39b-45531db93480', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F8FAF2FA0>]}
[0m10:44:07.018589 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 703 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m10:44:07.020577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0be196b9-1426-41d0-b39b-45531db93480', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F8F7158E0>]}
[0m10:44:07.023603 [info ] [MainThread]: 
[0m10:44:07.025576 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m10:44:07.028623 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m10:44:07.054206 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m10:44:07.054206 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m10:44:07.055208 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:44:09.154337 [debug] [ThreadPool]: SQL status: SELECT 10 in 2.1 seconds
[0m10:44:09.156558 [debug] [ThreadPool]: On list_postgres: Close
[0m10:44:09.159324 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbo"
[0m10:44:09.168571 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m10:44:09.169123 [debug] [ThreadPool]: On list_postgres_dbo: BEGIN
[0m10:44:09.169123 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:44:11.256373 [debug] [ThreadPool]: SQL status: BEGIN in 2.09 seconds
[0m10:44:11.256373 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m10:44:11.256951 [debug] [ThreadPool]: On list_postgres_dbo: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres_dbo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo'
  
[0m10:44:11.261533 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m10:44:11.263355 [debug] [ThreadPool]: On list_postgres_dbo: ROLLBACK
[0m10:44:11.265726 [debug] [ThreadPool]: On list_postgres_dbo: Close
[0m10:44:11.274049 [debug] [MainThread]: Using postgres connection "master"
[0m10:44:11.274608 [debug] [MainThread]: On master: BEGIN
[0m10:44:11.275153 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:44:13.349053 [debug] [MainThread]: SQL status: BEGIN in 2.07 seconds
[0m10:44:13.349574 [debug] [MainThread]: Using postgres connection "master"
[0m10:44:13.349574 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:44:13.362536 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
[0m10:44:13.363617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0be196b9-1426-41d0-b39b-45531db93480', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F8FAF2C70>]}
[0m10:44:13.364183 [debug] [MainThread]: On master: ROLLBACK
[0m10:44:13.366384 [debug] [MainThread]: Using postgres connection "master"
[0m10:44:13.366906 [debug] [MainThread]: On master: BEGIN
[0m10:44:13.371122 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:44:13.371657 [debug] [MainThread]: On master: COMMIT
[0m10:44:13.372190 [debug] [MainThread]: Using postgres connection "master"
[0m10:44:13.372190 [debug] [MainThread]: On master: COMMIT
[0m10:44:13.374377 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:44:13.374931 [debug] [MainThread]: On master: Close
[0m10:44:13.376043 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:44:13.377175 [info ] [MainThread]: 
[0m10:44:13.387544 [debug] [Thread-1  ]: Began running node model.stgo_dbt.profile
[0m10:44:13.388544 [info ] [Thread-1  ]: 1 of 1 START sql table model dbo.profile ....................................... [RUN]
[0m10:44:13.390562 [debug] [Thread-1  ]: Acquiring new postgres connection "model.stgo_dbt.profile"
[0m10:44:13.390562 [debug] [Thread-1  ]: Began compiling node model.stgo_dbt.profile
[0m10:44:13.390562 [debug] [Thread-1  ]: Compiling model.stgo_dbt.profile
[0m10:44:13.402546 [debug] [Thread-1  ]: Writing injected SQL for node "model.stgo_dbt.profile"
[0m10:44:13.403543 [debug] [Thread-1  ]: finished collecting timing info
[0m10:44:13.404544 [debug] [Thread-1  ]: Began executing node model.stgo_dbt.profile
[0m10:44:13.480708 [debug] [Thread-1  ]: Writing runtime sql for node "model.stgo_dbt.profile"
[0m10:44:13.482711 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m10:44:13.482711 [debug] [Thread-1  ]: On model.stgo_dbt.profile: BEGIN
[0m10:44:13.482711 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m10:44:15.584965 [debug] [Thread-1  ]: SQL status: BEGIN in 2.1 seconds
[0m10:44:15.585539 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m10:44:15.585539 [debug] [Thread-1  ]: On model.stgo_dbt.profile: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.profile"} */

  
    

  create  table "postgres"."dbo"."profile__dbt_tmp"
  as (
    
-- Final base SQL model
-- depends_on: dbo.users_7
select
    "id",
    sid as account_id,
    uuid,
    "name",
    gender,
    bod as date_of_birth,
    country,
    mobile as phone_number,
    is_kids as age_category,
    join_date as created_at,
    date::timestamp_ntz AS updated_at,
    deleted_at,
    _airbyte_ab_id,
    _airbyte_emitted_at,
    now() as _airbyte_normalized_at,
    _airbyte_users_7_hashid
from dbo.users_7
-- users_7 from "postgres".dbo._airbyte_raw_users_7
where 1 = 1


-- DO 
-- $$ 
-- BEGIN 
--     create type age_category as ENUM ('ADULT','KID')
-- EXCEPTION
--     WHEN duplicate_object THEN null;
-- END 
-- $$;
  );
  
[0m10:44:15.589686 [debug] [Thread-1  ]: Postgres adapter: Postgres error: type "timestamp_ntz" does not exist
LINE 22:     date::timestamp_ntz AS updated_at,
                   ^

[0m10:44:15.590277 [debug] [Thread-1  ]: On model.stgo_dbt.profile: ROLLBACK
[0m10:44:15.593037 [debug] [Thread-1  ]: finished collecting timing info
[0m10:44:15.593594 [debug] [Thread-1  ]: On model.stgo_dbt.profile: Close
[0m10:44:15.595294 [debug] [Thread-1  ]: Database Error in model profile (models\profile.sql)
  type "timestamp_ntz" does not exist
  LINE 22:     date::timestamp_ntz AS updated_at,
                     ^
  compiled Code at target\run\stgo_dbt\models\profile.sql
[0m10:44:15.595852 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0be196b9-1426-41d0-b39b-45531db93480', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F8FD86E50>]}
[0m10:44:15.596413 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dbo.profile .............................. [[31mERROR[0m in 2.21s]
[0m10:44:15.598630 [debug] [Thread-1  ]: Finished running node model.stgo_dbt.profile
[0m10:44:15.600924 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m10:44:15.601471 [debug] [MainThread]: Using postgres connection "master"
[0m10:44:15.602013 [debug] [MainThread]: On master: BEGIN
[0m10:44:15.602013 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:44:17.721209 [debug] [MainThread]: SQL status: BEGIN in 2.12 seconds
[0m10:44:17.721787 [debug] [MainThread]: On master: COMMIT
[0m10:44:17.721787 [debug] [MainThread]: Using postgres connection "master"
[0m10:44:17.722360 [debug] [MainThread]: On master: COMMIT
[0m10:44:17.724343 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:44:17.724890 [debug] [MainThread]: On master: Close
[0m10:44:17.725451 [info ] [MainThread]: 
[0m10:44:17.727112 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.70 seconds (10.70s).
[0m10:44:17.727684 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:44:17.728234 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m10:44:17.728234 [debug] [MainThread]: Connection 'list_postgres_dbo' was properly closed.
[0m10:44:17.728776 [debug] [MainThread]: Connection 'model.stgo_dbt.profile' was properly closed.
[0m10:44:17.744811 [info ] [MainThread]: 
[0m10:44:17.745816 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:44:17.746854 [info ] [MainThread]: 
[0m10:44:17.747830 [error] [MainThread]: [33mDatabase Error in model profile (models\profile.sql)[0m
[0m10:44:17.749818 [error] [MainThread]:   type "timestamp_ntz" does not exist
[0m10:44:17.750815 [error] [MainThread]:   LINE 22:     date::timestamp_ntz AS updated_at,
[0m10:44:17.751816 [error] [MainThread]:                      ^
[0m10:44:17.753816 [error] [MainThread]:   compiled Code at target\run\stgo_dbt\models\profile.sql
[0m10:44:17.754888 [info ] [MainThread]: 
[0m10:44:17.755818 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:44:17.756832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F8FAF2D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F8F862340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F8FC1A0A0>]}
[0m10:44:17.757817 [debug] [MainThread]: Flushing usage events


============================== 2023-01-03 10:50:54.226933 | 6ee0cbf8-c89f-4953-b694-24590e23ad21 ==============================
[0m10:50:54.226933 [info ] [MainThread]: Running with dbt=1.3.1
[0m10:50:54.227948 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'D:\\2023\\Cloudthought\\data-migration-dbt\\stgo_dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:50:54.228931 [debug] [MainThread]: Tracking: tracking
[0m10:50:54.278933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249A3C9DFA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249A3C9DE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249A3C9D160>]}
[0m10:50:54.626894 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:50:54.627897 [debug] [MainThread]: Partial parsing: updated file: stgo_dbt://models\profile.sql
[0m10:50:54.644919 [debug] [MainThread]: 1603: static parser failed on profile.sql
[0m10:50:54.678777 [debug] [MainThread]: 1602: parser fallback to jinja rendering on profile.sql
[0m10:50:54.710785 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stgo_dbt.staging

[0m10:50:54.721769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ee0cbf8-c89f-4953-b694-24590e23ad21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249A3FB60D0>]}
[0m10:50:54.748774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6ee0cbf8-c89f-4953-b694-24590e23ad21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249A3C85D30>]}
[0m10:50:54.749771 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 703 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m10:50:54.750771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ee0cbf8-c89f-4953-b694-24590e23ad21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249A3F10910>]}
[0m10:50:54.751770 [info ] [MainThread]: 
[0m10:50:54.753771 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m10:50:54.757772 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m10:50:54.780771 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m10:50:54.780771 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m10:50:54.780771 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:50:56.868350 [debug] [ThreadPool]: SQL status: SELECT 10 in 2.09 seconds
[0m10:50:56.870632 [debug] [ThreadPool]: On list_postgres: Close
[0m10:50:56.874738 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbo"
[0m10:50:56.887858 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m10:50:56.887858 [debug] [ThreadPool]: On list_postgres_dbo: BEGIN
[0m10:50:56.887858 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:50:58.973508 [debug] [ThreadPool]: SQL status: BEGIN in 2.09 seconds
[0m10:50:58.974136 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m10:50:58.974754 [debug] [ThreadPool]: On list_postgres_dbo: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres_dbo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo'
  
[0m10:50:58.980727 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m10:50:58.982379 [debug] [ThreadPool]: On list_postgres_dbo: ROLLBACK
[0m10:50:58.984051 [debug] [ThreadPool]: On list_postgres_dbo: Close
[0m10:50:58.993342 [debug] [MainThread]: Using postgres connection "master"
[0m10:50:58.993342 [debug] [MainThread]: On master: BEGIN
[0m10:50:58.993959 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:51:01.078645 [debug] [MainThread]: SQL status: BEGIN in 2.08 seconds
[0m10:51:01.078645 [debug] [MainThread]: Using postgres connection "master"
[0m10:51:01.079193 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:51:01.090135 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
[0m10:51:01.091811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ee0cbf8-c89f-4953-b694-24590e23ad21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249A3F1FE20>]}
[0m10:51:01.092356 [debug] [MainThread]: On master: ROLLBACK
[0m10:51:01.095232 [debug] [MainThread]: Using postgres connection "master"
[0m10:51:01.095821 [debug] [MainThread]: On master: BEGIN
[0m10:51:01.099940 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:51:01.100497 [debug] [MainThread]: On master: COMMIT
[0m10:51:01.100497 [debug] [MainThread]: Using postgres connection "master"
[0m10:51:01.100497 [debug] [MainThread]: On master: COMMIT
[0m10:51:01.102777 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:51:01.103338 [debug] [MainThread]: On master: Close
[0m10:51:01.103905 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:51:01.104972 [info ] [MainThread]: 
[0m10:51:01.116929 [debug] [Thread-1  ]: Began running node model.stgo_dbt.profile
[0m10:51:01.116929 [info ] [Thread-1  ]: 1 of 1 START sql table model dbo.profile ....................................... [RUN]
[0m10:51:01.119936 [debug] [Thread-1  ]: Acquiring new postgres connection "model.stgo_dbt.profile"
[0m10:51:01.120917 [debug] [Thread-1  ]: Began compiling node model.stgo_dbt.profile
[0m10:51:01.120917 [debug] [Thread-1  ]: Compiling model.stgo_dbt.profile
[0m10:51:01.128964 [debug] [Thread-1  ]: Writing injected SQL for node "model.stgo_dbt.profile"
[0m10:51:01.130927 [debug] [Thread-1  ]: finished collecting timing info
[0m10:51:01.130927 [debug] [Thread-1  ]: Began executing node model.stgo_dbt.profile
[0m10:51:01.199473 [debug] [Thread-1  ]: Writing runtime sql for node "model.stgo_dbt.profile"
[0m10:51:01.201469 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m10:51:01.202479 [debug] [Thread-1  ]: On model.stgo_dbt.profile: BEGIN
[0m10:51:01.202479 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m10:51:03.291407 [debug] [Thread-1  ]: SQL status: BEGIN in 2.09 seconds
[0m10:51:03.291989 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m10:51:03.291989 [debug] [Thread-1  ]: On model.stgo_dbt.profile: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.profile"} */

  
    

  create  table "postgres"."dbo"."profile__dbt_tmp"
  as (
    
-- Final base SQL model
-- depends_on: dbo.users_7
select
    "id",
    sid as account_id,
    uuid,
    "name",
    gender,
    bod as date_of_birth,
    country,
    mobile as phone_number,
    is_kids as age_category,
    join_date as created_at,
    deleted_at,
    _airbyte_ab_id,
    _airbyte_emitted_at,
    now() as _airbyte_normalized_at,
    _airbyte_users_7_hashid
from dbo.users_7
-- users_7 from "postgres".dbo._airbyte_raw_users_7
where 1 = 1


ALTER TABLE public.profile ADD COLUMN updated_at TIMESTAMP WITH TIME ZONE;
-- DO 
-- $$ 
-- BEGIN 
--     create type age_category as ENUM ('ADULT','KID')
-- EXCEPTION
--     WHEN duplicate_object THEN null;
-- END 
-- $$;
  );
  
[0m10:51:03.294314 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "ALTER"
LINE 32: ALTER TABLE public.profile ADD COLUMN updated_at TIMESTAMP W...
         ^

[0m10:51:03.294314 [debug] [Thread-1  ]: On model.stgo_dbt.profile: ROLLBACK
[0m10:51:03.297199 [debug] [Thread-1  ]: finished collecting timing info
[0m10:51:03.297199 [debug] [Thread-1  ]: On model.stgo_dbt.profile: Close
[0m10:51:03.298358 [debug] [Thread-1  ]: Database Error in model profile (models\profile.sql)
  syntax error at or near "ALTER"
  LINE 32: ALTER TABLE public.profile ADD COLUMN updated_at TIMESTAMP W...
           ^
  compiled Code at target\run\stgo_dbt\models\profile.sql
[0m10:51:03.298911 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ee0cbf8-c89f-4953-b694-24590e23ad21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249A41B3FD0>]}
[0m10:51:03.299490 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dbo.profile .............................. [[31mERROR[0m in 2.18s]
[0m10:51:03.301365 [debug] [Thread-1  ]: Finished running node model.stgo_dbt.profile
[0m10:51:03.303666 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m10:51:03.303666 [debug] [MainThread]: Using postgres connection "master"
[0m10:51:03.304199 [debug] [MainThread]: On master: BEGIN
[0m10:51:03.304263 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:51:05.377847 [debug] [MainThread]: SQL status: BEGIN in 2.07 seconds
[0m10:51:05.377847 [debug] [MainThread]: On master: COMMIT
[0m10:51:05.377847 [debug] [MainThread]: Using postgres connection "master"
[0m10:51:05.378388 [debug] [MainThread]: On master: COMMIT
[0m10:51:05.380685 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:51:05.381222 [debug] [MainThread]: On master: Close
[0m10:51:05.382451 [info ] [MainThread]: 
[0m10:51:05.383582 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.63 seconds (10.63s).
[0m10:51:05.384717 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:51:05.384717 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m10:51:05.385249 [debug] [MainThread]: Connection 'list_postgres_dbo' was properly closed.
[0m10:51:05.385830 [debug] [MainThread]: Connection 'model.stgo_dbt.profile' was properly closed.
[0m10:51:05.406803 [info ] [MainThread]: 
[0m10:51:05.407800 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:51:05.409805 [info ] [MainThread]: 
[0m10:51:05.410799 [error] [MainThread]: [33mDatabase Error in model profile (models\profile.sql)[0m
[0m10:51:05.412832 [error] [MainThread]:   syntax error at or near "ALTER"
[0m10:51:05.414798 [error] [MainThread]:   LINE 32: ALTER TABLE public.profile ADD COLUMN updated_at TIMESTAMP W...
[0m10:51:05.415822 [error] [MainThread]:            ^
[0m10:51:05.417800 [error] [MainThread]:   compiled Code at target\run\stgo_dbt\models\profile.sql
[0m10:51:05.418805 [info ] [MainThread]: 
[0m10:51:05.419799 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:51:05.421783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249A41B3A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249A402F520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249A3BB2850>]}
[0m10:51:05.421783 [debug] [MainThread]: Flushing usage events


============================== 2023-01-03 10:53:31.963577 | 0af6ff88-93bd-4365-9cdf-3adff5431b8c ==============================
[0m10:53:31.963577 [info ] [MainThread]: Running with dbt=1.3.1
[0m10:53:31.978576 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'D:\\2023\\Cloudthought\\data-migration-dbt\\stgo_dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:53:31.979575 [debug] [MainThread]: Tracking: tracking
[0m10:53:32.053636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B10D253FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B10D253E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B10D253160>]}
[0m10:53:32.472895 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:53:32.472895 [debug] [MainThread]: Partial parsing: updated file: stgo_dbt://models\profile.sql
[0m10:53:32.489894 [debug] [MainThread]: 1603: static parser failed on profile.sql
[0m10:53:32.518906 [debug] [MainThread]: 1602: parser fallback to jinja rendering on profile.sql
[0m10:53:32.541862 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stgo_dbt.staging

[0m10:53:32.551873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0af6ff88-93bd-4365-9cdf-3adff5431b8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B10D5760D0>]}
[0m10:53:32.571859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0af6ff88-93bd-4365-9cdf-3adff5431b8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B10D245730>]}
[0m10:53:32.572862 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 703 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m10:53:32.573854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0af6ff88-93bd-4365-9cdf-3adff5431b8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B10D4D0910>]}
[0m10:53:32.575860 [info ] [MainThread]: 
[0m10:53:32.578856 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m10:53:32.580856 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m10:53:32.597859 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m10:53:32.598897 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m10:53:32.598897 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:53:34.723958 [debug] [ThreadPool]: SQL status: SELECT 10 in 2.13 seconds
[0m10:53:34.725109 [debug] [ThreadPool]: On list_postgres: Close
[0m10:53:34.728183 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbo"
[0m10:53:34.738573 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m10:53:34.739151 [debug] [ThreadPool]: On list_postgres_dbo: BEGIN
[0m10:53:34.739168 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:53:36.812299 [debug] [ThreadPool]: SQL status: BEGIN in 2.07 seconds
[0m10:53:36.812867 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m10:53:36.812867 [debug] [ThreadPool]: On list_postgres_dbo: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres_dbo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo'
  
[0m10:53:36.818417 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m10:53:36.820045 [debug] [ThreadPool]: On list_postgres_dbo: ROLLBACK
[0m10:53:36.822374 [debug] [ThreadPool]: On list_postgres_dbo: Close
[0m10:53:36.829843 [debug] [MainThread]: Using postgres connection "master"
[0m10:53:36.830438 [debug] [MainThread]: On master: BEGIN
[0m10:53:36.830438 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:53:38.929564 [debug] [MainThread]: SQL status: BEGIN in 2.1 seconds
[0m10:53:38.930073 [debug] [MainThread]: Using postgres connection "master"
[0m10:53:38.930175 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:53:38.943282 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
[0m10:53:38.944796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0af6ff88-93bd-4365-9cdf-3adff5431b8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B10D4DFE20>]}
[0m10:53:38.944796 [debug] [MainThread]: On master: ROLLBACK
[0m10:53:38.947838 [debug] [MainThread]: Using postgres connection "master"
[0m10:53:38.947838 [debug] [MainThread]: On master: BEGIN
[0m10:53:38.953120 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:53:38.953817 [debug] [MainThread]: On master: COMMIT
[0m10:53:38.953817 [debug] [MainThread]: Using postgres connection "master"
[0m10:53:38.954373 [debug] [MainThread]: On master: COMMIT
[0m10:53:38.956552 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:53:38.957115 [debug] [MainThread]: On master: Close
[0m10:53:38.958244 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:53:38.959596 [info ] [MainThread]: 
[0m10:53:38.973025 [debug] [Thread-1  ]: Began running node model.stgo_dbt.profile
[0m10:53:38.974051 [info ] [Thread-1  ]: 1 of 1 START sql table model dbo.profile ....................................... [RUN]
[0m10:53:38.975042 [debug] [Thread-1  ]: Acquiring new postgres connection "model.stgo_dbt.profile"
[0m10:53:38.976011 [debug] [Thread-1  ]: Began compiling node model.stgo_dbt.profile
[0m10:53:38.976011 [debug] [Thread-1  ]: Compiling model.stgo_dbt.profile
[0m10:53:38.988011 [debug] [Thread-1  ]: Writing injected SQL for node "model.stgo_dbt.profile"
[0m10:53:38.990012 [debug] [Thread-1  ]: finished collecting timing info
[0m10:53:38.990012 [debug] [Thread-1  ]: Began executing node model.stgo_dbt.profile
[0m10:53:39.061071 [debug] [Thread-1  ]: Writing runtime sql for node "model.stgo_dbt.profile"
[0m10:53:39.064012 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m10:53:39.064012 [debug] [Thread-1  ]: On model.stgo_dbt.profile: BEGIN
[0m10:53:39.064012 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m10:53:41.145435 [debug] [Thread-1  ]: SQL status: BEGIN in 2.08 seconds
[0m10:53:41.146058 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m10:53:41.146058 [debug] [Thread-1  ]: On model.stgo_dbt.profile: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.profile"} */

  
    

  create  table "postgres"."dbo"."profile__dbt_tmp"
  as (
    
-- Final base SQL model

with profile as (
    select
    "id",
    sid as account_id,
    uuid,
    "name",
    gender,
    bod as date_of_birth,
    country,
    mobile as phone_number,
    is_kids as age_category,
    join_date as created_at,
    deleted_at,
    _airbyte_ab_id,
    _airbyte_emitted_at,
    now() as _airbyte_normalized_at,
    _airbyte_users_7_hashid
from dbo.users_7
),

ALTER TABLE profile ADD COLUMN updated_at TIMESTAMP WITH TIME ZONE;

select * from profile;

-- depends_on: dbo.users_7

-- users_7 from "postgres".dbo._airbyte_raw_users_7
where 1 = 1

  );
  
[0m10:53:41.149003 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "TABLE"
LINE 31: ALTER TABLE profile ADD COLUMN updated_at TIMESTAMP WITH TIM...
               ^

[0m10:53:41.149003 [debug] [Thread-1  ]: On model.stgo_dbt.profile: ROLLBACK
[0m10:53:41.151770 [debug] [Thread-1  ]: finished collecting timing info
[0m10:53:41.152346 [debug] [Thread-1  ]: On model.stgo_dbt.profile: Close
[0m10:53:41.155245 [debug] [Thread-1  ]: Database Error in model profile (models\profile.sql)
  syntax error at or near "TABLE"
  LINE 31: ALTER TABLE profile ADD COLUMN updated_at TIMESTAMP WITH TIM...
                 ^
  compiled Code at target\run\stgo_dbt\models\profile.sql
[0m10:53:41.155793 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0af6ff88-93bd-4365-9cdf-3adff5431b8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B10D5B1B80>]}
[0m10:53:41.156387 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dbo.profile .............................. [[31mERROR[0m in 2.18s]
[0m10:53:41.159332 [debug] [Thread-1  ]: Finished running node model.stgo_dbt.profile
[0m10:53:41.162278 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m10:53:41.162278 [debug] [MainThread]: Using postgres connection "master"
[0m10:53:41.162809 [debug] [MainThread]: On master: BEGIN
[0m10:53:41.162985 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:53:43.290901 [debug] [MainThread]: SQL status: BEGIN in 2.13 seconds
[0m10:53:43.291520 [debug] [MainThread]: On master: COMMIT
[0m10:53:43.291520 [debug] [MainThread]: Using postgres connection "master"
[0m10:53:43.292097 [debug] [MainThread]: On master: COMMIT
[0m10:53:43.296150 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:53:43.296150 [debug] [MainThread]: On master: Close
[0m10:53:43.297825 [info ] [MainThread]: 
[0m10:53:43.299493 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.72 seconds (10.72s).
[0m10:53:43.301182 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:53:43.301870 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m10:53:43.302446 [debug] [MainThread]: Connection 'list_postgres_dbo' was properly closed.
[0m10:53:43.303079 [debug] [MainThread]: Connection 'model.stgo_dbt.profile' was properly closed.
[0m10:53:43.324198 [info ] [MainThread]: 
[0m10:53:43.325197 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:53:43.328210 [info ] [MainThread]: 
[0m10:53:43.329198 [error] [MainThread]: [33mDatabase Error in model profile (models\profile.sql)[0m
[0m10:53:43.330199 [error] [MainThread]:   syntax error at or near "TABLE"
[0m10:53:43.331200 [error] [MainThread]:   LINE 31: ALTER TABLE profile ADD COLUMN updated_at TIMESTAMP WITH TIM...
[0m10:53:43.332199 [error] [MainThread]:                  ^
[0m10:53:43.333197 [error] [MainThread]:   compiled Code at target\run\stgo_dbt\models\profile.sql
[0m10:53:43.333197 [info ] [MainThread]: 
[0m10:53:43.334198 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:53:43.335199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B10D245550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B10D5C36A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B10D5BED30>]}
[0m10:53:43.335199 [debug] [MainThread]: Flushing usage events


============================== 2023-01-03 10:53:58.900546 | c23d3b0b-0d21-44e3-9004-3d33dcd11cd3 ==============================
[0m10:53:58.900546 [info ] [MainThread]: Running with dbt=1.3.1
[0m10:53:58.902507 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'D:\\2023\\Cloudthought\\data-migration-dbt\\stgo_dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:53:58.902507 [debug] [MainThread]: Tracking: tracking
[0m10:53:58.953513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E417064040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E417045100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4170453D0>]}
[0m10:53:59.360625 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:53:59.361608 [debug] [MainThread]: Partial parsing: updated file: stgo_dbt://models\profile.sql
[0m10:53:59.381646 [debug] [MainThread]: 1603: static parser failed on profile.sql
[0m10:53:59.419608 [debug] [MainThread]: 1602: parser fallback to jinja rendering on profile.sql
[0m10:53:59.452608 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stgo_dbt.staging

[0m10:53:59.462610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c23d3b0b-0d21-44e3-9004-3d33dcd11cd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E41735E0D0>]}
[0m10:53:59.494618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c23d3b0b-0d21-44e3-9004-3d33dcd11cd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E417035B20>]}
[0m10:53:59.496609 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 703 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m10:53:59.498617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c23d3b0b-0d21-44e3-9004-3d33dcd11cd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E414BD33D0>]}
[0m10:53:59.499607 [info ] [MainThread]: 
[0m10:53:59.501611 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m10:53:59.506609 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m10:53:59.531610 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m10:53:59.532610 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m10:53:59.532610 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:54:01.634803 [debug] [ThreadPool]: SQL status: SELECT 10 in 2.1 seconds
[0m10:54:01.635970 [debug] [ThreadPool]: On list_postgres: Close
[0m10:54:01.639603 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbo"
[0m10:54:01.652843 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m10:54:01.652843 [debug] [ThreadPool]: On list_postgres_dbo: BEGIN
[0m10:54:01.652843 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:54:03.776726 [debug] [ThreadPool]: SQL status: BEGIN in 2.12 seconds
[0m10:54:03.777293 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m10:54:03.777293 [debug] [ThreadPool]: On list_postgres_dbo: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres_dbo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo'
  
[0m10:54:03.784015 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
[0m10:54:03.786341 [debug] [ThreadPool]: On list_postgres_dbo: ROLLBACK
[0m10:54:03.789469 [debug] [ThreadPool]: On list_postgres_dbo: Close
[0m10:54:03.799477 [debug] [MainThread]: Using postgres connection "master"
[0m10:54:03.800233 [debug] [MainThread]: On master: BEGIN
[0m10:54:03.800822 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:54:05.902990 [debug] [MainThread]: SQL status: BEGIN in 2.1 seconds
[0m10:54:05.903561 [debug] [MainThread]: Using postgres connection "master"
[0m10:54:05.903561 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:54:05.918062 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
[0m10:54:05.919584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c23d3b0b-0d21-44e3-9004-3d33dcd11cd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4172CFE20>]}
[0m10:54:05.919584 [debug] [MainThread]: On master: ROLLBACK
[0m10:54:05.922989 [debug] [MainThread]: Using postgres connection "master"
[0m10:54:05.923524 [debug] [MainThread]: On master: BEGIN
[0m10:54:05.928248 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:54:05.928248 [debug] [MainThread]: On master: COMMIT
[0m10:54:05.928248 [debug] [MainThread]: Using postgres connection "master"
[0m10:54:05.928840 [debug] [MainThread]: On master: COMMIT
[0m10:54:05.931107 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:54:05.931709 [debug] [MainThread]: On master: Close
[0m10:54:05.932800 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:54:05.935201 [info ] [MainThread]: 
[0m10:54:05.947618 [debug] [Thread-1  ]: Began running node model.stgo_dbt.profile
[0m10:54:05.947618 [info ] [Thread-1  ]: 1 of 1 START sql table model dbo.profile ....................................... [RUN]
[0m10:54:05.950613 [debug] [Thread-1  ]: Acquiring new postgres connection "model.stgo_dbt.profile"
[0m10:54:05.950613 [debug] [Thread-1  ]: Began compiling node model.stgo_dbt.profile
[0m10:54:05.950613 [debug] [Thread-1  ]: Compiling model.stgo_dbt.profile
[0m10:54:05.959610 [debug] [Thread-1  ]: Writing injected SQL for node "model.stgo_dbt.profile"
[0m10:54:05.962641 [debug] [Thread-1  ]: finished collecting timing info
[0m10:54:05.962641 [debug] [Thread-1  ]: Began executing node model.stgo_dbt.profile
[0m10:54:06.024620 [debug] [Thread-1  ]: Writing runtime sql for node "model.stgo_dbt.profile"
[0m10:54:06.026612 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m10:54:06.026612 [debug] [Thread-1  ]: On model.stgo_dbt.profile: BEGIN
[0m10:54:06.027621 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m10:54:08.112569 [debug] [Thread-1  ]: SQL status: BEGIN in 2.08 seconds
[0m10:54:08.113121 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m10:54:08.113121 [debug] [Thread-1  ]: On model.stgo_dbt.profile: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.profile"} */

  
    

  create  table "postgres"."dbo"."profile__dbt_tmp"
  as (
    
-- Final base SQL model

with profile as (
    select
    "id",
    sid as account_id,
    uuid,
    "name",
    gender,
    bod as date_of_birth,
    country,
    mobile as phone_number,
    is_kids as age_category,
    join_date as created_at,
    deleted_at,
    _airbyte_ab_id,
    _airbyte_emitted_at,
    now() as _airbyte_normalized_at,
    _airbyte_users_7_hashid
from dbo.users_7
),

ALTER profile ADD COLUMN updated_at TIMESTAMP WITH TIME ZONE;

select * from profile;

-- depends_on: dbo.users_7

-- users_7 from "postgres".dbo._airbyte_raw_users_7
where 1 = 1

  );
  
[0m10:54:08.116163 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "profile"
LINE 31: ALTER profile ADD COLUMN updated_at TIMESTAMP WITH TIME ZONE...
               ^

[0m10:54:08.116710 [debug] [Thread-1  ]: On model.stgo_dbt.profile: ROLLBACK
[0m10:54:08.119397 [debug] [Thread-1  ]: finished collecting timing info
[0m10:54:08.119981 [debug] [Thread-1  ]: On model.stgo_dbt.profile: Close
[0m10:54:08.121636 [debug] [Thread-1  ]: Database Error in model profile (models\profile.sql)
  syntax error at or near "profile"
  LINE 31: ALTER profile ADD COLUMN updated_at TIMESTAMP WITH TIME ZONE...
                 ^
  compiled Code at target\run\stgo_dbt\models\profile.sql
[0m10:54:08.122726 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c23d3b0b-0d21-44e3-9004-3d33dcd11cd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E417564F40>]}
[0m10:54:08.124288 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dbo.profile .............................. [[31mERROR[0m in 2.17s]
[0m10:54:08.126498 [debug] [Thread-1  ]: Finished running node model.stgo_dbt.profile
[0m10:54:08.128479 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m10:54:08.129134 [debug] [MainThread]: Using postgres connection "master"
[0m10:54:08.129134 [debug] [MainThread]: On master: BEGIN
[0m10:54:08.129681 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:54:10.225816 [debug] [MainThread]: SQL status: BEGIN in 2.1 seconds
[0m10:54:10.226347 [debug] [MainThread]: On master: COMMIT
[0m10:54:10.226524 [debug] [MainThread]: Using postgres connection "master"
[0m10:54:10.226524 [debug] [MainThread]: On master: COMMIT
[0m10:54:10.228785 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:54:10.229330 [debug] [MainThread]: On master: Close
[0m10:54:10.231876 [info ] [MainThread]: 
[0m10:54:10.233003 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.73 seconds (10.73s).
[0m10:54:10.234716 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:54:10.235270 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m10:54:10.235846 [debug] [MainThread]: Connection 'list_postgres_dbo' was properly closed.
[0m10:54:10.235846 [debug] [MainThread]: Connection 'model.stgo_dbt.profile' was properly closed.
[0m10:54:10.253603 [info ] [MainThread]: 
[0m10:54:10.255594 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:54:10.258612 [info ] [MainThread]: 
[0m10:54:10.259591 [error] [MainThread]: [33mDatabase Error in model profile (models\profile.sql)[0m
[0m10:54:10.261585 [error] [MainThread]:   syntax error at or near "profile"
[0m10:54:10.263588 [error] [MainThread]:   LINE 31: ALTER profile ADD COLUMN updated_at TIMESTAMP WITH TIME ZONE...
[0m10:54:10.264585 [error] [MainThread]:                  ^
[0m10:54:10.265589 [error] [MainThread]:   compiled Code at target\run\stgo_dbt\models\profile.sql
[0m10:54:10.266584 [info ] [MainThread]: 
[0m10:54:10.267589 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:54:10.269599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4173F6EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4173F6190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4173E3CA0>]}
[0m10:54:10.270599 [debug] [MainThread]: Flushing usage events


============================== 2023-01-03 11:11:55.112745 | d1275b30-eeab-472b-a987-76e3c0d6bcc1 ==============================
[0m11:11:55.112745 [info ] [MainThread]: Running with dbt=1.3.1
[0m11:11:55.114763 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'D:\\2023\\Cloudthought\\data-migration-dbt\\stgo_dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:11:55.114763 [debug] [MainThread]: Tracking: tracking
[0m11:11:55.165745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA54C810A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA54C81250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA54C81160>]}
[0m11:11:55.474365 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:11:55.475365 [debug] [MainThread]: Partial parsing: updated file: stgo_dbt://models\profile.sql
[0m11:11:55.490363 [debug] [MainThread]: 1603: static parser failed on profile.sql
[0m11:11:55.516505 [debug] [MainThread]: 1602: parser fallback to jinja rendering on profile.sql
[0m11:11:55.535365 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stgo_dbt.staging

[0m11:11:55.544364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1275b30-eeab-472b-a987-76e3c0d6bcc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA54F9D0D0>]}
[0m11:11:55.562367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd1275b30-eeab-472b-a987-76e3c0d6bcc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA54C75850>]}
[0m11:11:55.563565 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 703 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m11:11:55.564708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1275b30-eeab-472b-a987-76e3c0d6bcc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA54F028B0>]}
[0m11:11:55.567229 [info ] [MainThread]: 
[0m11:11:55.569228 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m11:11:55.572232 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m11:11:55.590904 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m11:11:55.591906 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m11:11:55.591906 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:11:57.664084 [debug] [ThreadPool]: SQL status: SELECT 10 in 2.07 seconds
[0m11:11:57.665260 [debug] [ThreadPool]: On list_postgres: Close
[0m11:11:57.668043 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbo"
[0m11:11:57.677223 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m11:11:57.677223 [debug] [ThreadPool]: On list_postgres_dbo: BEGIN
[0m11:11:57.677778 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:11:59.745864 [debug] [ThreadPool]: SQL status: BEGIN in 2.07 seconds
[0m11:11:59.746395 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m11:11:59.746395 [debug] [ThreadPool]: On list_postgres_dbo: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres_dbo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo'
  
[0m11:11:59.750890 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m11:11:59.752605 [debug] [ThreadPool]: On list_postgres_dbo: ROLLBACK
[0m11:11:59.754751 [debug] [ThreadPool]: On list_postgres_dbo: Close
[0m11:11:59.761963 [debug] [MainThread]: Using postgres connection "master"
[0m11:11:59.762469 [debug] [MainThread]: On master: BEGIN
[0m11:11:59.762521 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:12:01.838474 [debug] [MainThread]: SQL status: BEGIN in 2.08 seconds
[0m11:12:01.839025 [debug] [MainThread]: Using postgres connection "master"
[0m11:12:01.839025 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:12:01.850286 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
[0m11:12:01.850847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1275b30-eeab-472b-a987-76e3c0d6bcc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA54BA22E0>]}
[0m11:12:01.850847 [debug] [MainThread]: On master: ROLLBACK
[0m11:12:01.853809 [debug] [MainThread]: Using postgres connection "master"
[0m11:12:01.854492 [debug] [MainThread]: On master: BEGIN
[0m11:12:01.858550 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:12:01.859091 [debug] [MainThread]: On master: COMMIT
[0m11:12:01.859230 [debug] [MainThread]: Using postgres connection "master"
[0m11:12:01.859230 [debug] [MainThread]: On master: COMMIT
[0m11:12:01.861585 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:12:01.862169 [debug] [MainThread]: On master: Close
[0m11:12:01.862705 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:12:01.864008 [info ] [MainThread]: 
[0m11:12:01.874809 [debug] [Thread-1  ]: Began running node model.stgo_dbt.profile
[0m11:12:01.875371 [info ] [Thread-1  ]: 1 of 1 START sql table model dbo.profile ....................................... [RUN]
[0m11:12:01.877743 [debug] [Thread-1  ]: Acquiring new postgres connection "model.stgo_dbt.profile"
[0m11:12:01.878260 [debug] [Thread-1  ]: Began compiling node model.stgo_dbt.profile
[0m11:12:01.878260 [debug] [Thread-1  ]: Compiling model.stgo_dbt.profile
[0m11:12:01.887281 [debug] [Thread-1  ]: Writing injected SQL for node "model.stgo_dbt.profile"
[0m11:12:01.889277 [debug] [Thread-1  ]: finished collecting timing info
[0m11:12:01.889277 [debug] [Thread-1  ]: Began executing node model.stgo_dbt.profile
[0m11:12:01.957680 [debug] [Thread-1  ]: Writing runtime sql for node "model.stgo_dbt.profile"
[0m11:12:01.959707 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m11:12:01.959707 [debug] [Thread-1  ]: On model.stgo_dbt.profile: BEGIN
[0m11:12:01.959707 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m11:12:04.058858 [debug] [Thread-1  ]: SQL status: BEGIN in 2.1 seconds
[0m11:12:04.058891 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m11:12:04.059570 [debug] [Thread-1  ]: On model.stgo_dbt.profile: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.profile"} */

  
    

  create  table "postgres"."dbo"."profile__dbt_tmp"
  as (
    
-- Final base SQL model



with profile as (
    select
    "id",
    sid as account_id,
    uuid,
    "name",
    gender,
    bod as date_of_birth,
    country,
    mobile as phone_number,
    age_category[is_kids] as age_category,
    join_date as created_at,
    join_date as updated_at,
    deleted_at,
    _airbyte_ab_id,
    _airbyte_emitted_at,
    now() as _airbyte_normalized_at,
    _airbyte_users_7_hashid
from dbo.users_7
),


-- depends_on: dbo.users_7

-- users_7 from "postgres".dbo._airbyte_raw_users_7
where 1 = 1

  );
  
[0m11:12:04.061997 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "where"
LINE 38: where 1 = 1
         ^

[0m11:12:04.062541 [debug] [Thread-1  ]: On model.stgo_dbt.profile: ROLLBACK
[0m11:12:04.066095 [debug] [Thread-1  ]: finished collecting timing info
[0m11:12:04.066095 [debug] [Thread-1  ]: On model.stgo_dbt.profile: Close
[0m11:12:04.067807 [debug] [Thread-1  ]: Database Error in model profile (models\profile.sql)
  syntax error at or near "where"
  LINE 38: where 1 = 1
           ^
  compiled Code at target\run\stgo_dbt\models\profile.sql
[0m11:12:04.068401 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1275b30-eeab-472b-a987-76e3c0d6bcc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA551A3E50>]}
[0m11:12:04.069218 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dbo.profile .............................. [[31mERROR[0m in 2.19s]
[0m11:12:04.071089 [debug] [Thread-1  ]: Finished running node model.stgo_dbt.profile
[0m11:12:04.073406 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m11:12:04.073982 [debug] [MainThread]: Using postgres connection "master"
[0m11:12:04.073982 [debug] [MainThread]: On master: BEGIN
[0m11:12:04.073982 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:12:06.154356 [debug] [MainThread]: SQL status: BEGIN in 2.08 seconds
[0m11:12:06.154892 [debug] [MainThread]: On master: COMMIT
[0m11:12:06.154892 [debug] [MainThread]: Using postgres connection "master"
[0m11:12:06.155423 [debug] [MainThread]: On master: COMMIT
[0m11:12:06.157243 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:12:06.157243 [debug] [MainThread]: On master: Close
[0m11:12:06.158412 [info ] [MainThread]: 
[0m11:12:06.159582 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.59 seconds (10.59s).
[0m11:12:06.161221 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:12:06.161258 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m11:12:06.161809 [debug] [MainThread]: Connection 'list_postgres_dbo' was properly closed.
[0m11:12:06.161809 [debug] [MainThread]: Connection 'model.stgo_dbt.profile' was properly closed.
[0m11:12:06.177355 [info ] [MainThread]: 
[0m11:12:06.178356 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:12:06.180356 [info ] [MainThread]: 
[0m11:12:06.182377 [error] [MainThread]: [33mDatabase Error in model profile (models\profile.sql)[0m
[0m11:12:06.183373 [error] [MainThread]:   syntax error at or near "where"
[0m11:12:06.185354 [error] [MainThread]:   LINE 38: where 1 = 1
[0m11:12:06.186355 [error] [MainThread]:            ^
[0m11:12:06.187399 [error] [MainThread]:   compiled Code at target\run\stgo_dbt\models\profile.sql
[0m11:12:06.188356 [info ] [MainThread]: 
[0m11:12:06.190355 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:12:06.191374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA5503B3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA5503BFA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA55025F10>]}
[0m11:12:06.191374 [debug] [MainThread]: Flushing usage events


============================== 2023-01-03 11:12:30.267488 | c29ba6d5-a62e-4a60-b856-08e8c1121ac0 ==============================
[0m11:12:30.267488 [info ] [MainThread]: Running with dbt=1.3.1
[0m11:12:30.268489 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'D:\\2023\\Cloudthought\\data-migration-dbt\\stgo_dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:12:30.269495 [debug] [MainThread]: Tracking: tracking
[0m11:12:30.307130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002825BAA30A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002825BAA3250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002825BAA3160>]}
[0m11:12:30.623279 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:12:30.623279 [debug] [MainThread]: Partial parsing: updated file: stgo_dbt://models\profile.sql
[0m11:12:30.650263 [debug] [MainThread]: 1603: static parser failed on profile.sql
[0m11:12:30.686264 [debug] [MainThread]: 1602: parser fallback to jinja rendering on profile.sql
[0m11:12:30.713591 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stgo_dbt.staging

[0m11:12:30.726492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c29ba6d5-a62e-4a60-b856-08e8c1121ac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002825BDC50D0>]}
[0m11:12:30.746486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c29ba6d5-a62e-4a60-b856-08e8c1121ac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002825BA95AC0>]}
[0m11:12:30.746486 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 703 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m11:12:30.747478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c29ba6d5-a62e-4a60-b856-08e8c1121ac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002825BD218B0>]}
[0m11:12:30.748479 [info ] [MainThread]: 
[0m11:12:30.750480 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m11:12:30.754480 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m11:12:30.774479 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m11:12:30.775479 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m11:12:30.775479 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:12:32.905003 [debug] [ThreadPool]: SQL status: SELECT 10 in 2.13 seconds
[0m11:12:32.906753 [debug] [ThreadPool]: On list_postgres: Close
[0m11:12:32.909858 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbo"
[0m11:12:32.919802 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m11:12:32.919802 [debug] [ThreadPool]: On list_postgres_dbo: BEGIN
[0m11:12:32.920467 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:12:35.017292 [debug] [ThreadPool]: SQL status: BEGIN in 2.1 seconds
[0m11:12:35.017846 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m11:12:35.017846 [debug] [ThreadPool]: On list_postgres_dbo: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres_dbo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo'
  
[0m11:12:35.022711 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m11:12:35.024485 [debug] [ThreadPool]: On list_postgres_dbo: ROLLBACK
[0m11:12:35.026191 [debug] [ThreadPool]: On list_postgres_dbo: Close
[0m11:12:35.033132 [debug] [MainThread]: Using postgres connection "master"
[0m11:12:35.033657 [debug] [MainThread]: On master: BEGIN
[0m11:12:35.033788 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:12:37.134500 [debug] [MainThread]: SQL status: BEGIN in 2.1 seconds
[0m11:12:37.135048 [debug] [MainThread]: Using postgres connection "master"
[0m11:12:37.135649 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:12:37.152102 [debug] [MainThread]: SQL status: SELECT 0 in 0.02 seconds
[0m11:12:37.153633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c29ba6d5-a62e-4a60-b856-08e8c1121ac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002825BD2FDC0>]}
[0m11:12:37.154645 [debug] [MainThread]: On master: ROLLBACK
[0m11:12:37.157353 [debug] [MainThread]: Using postgres connection "master"
[0m11:12:37.157893 [debug] [MainThread]: On master: BEGIN
[0m11:12:37.161121 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:12:37.161659 [debug] [MainThread]: On master: COMMIT
[0m11:12:37.161659 [debug] [MainThread]: Using postgres connection "master"
[0m11:12:37.162193 [debug] [MainThread]: On master: COMMIT
[0m11:12:37.164492 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:12:37.164492 [debug] [MainThread]: On master: Close
[0m11:12:37.166112 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:12:37.166642 [info ] [MainThread]: 
[0m11:12:37.178129 [debug] [Thread-1  ]: Began running node model.stgo_dbt.profile
[0m11:12:37.178662 [info ] [Thread-1  ]: 1 of 1 START sql table model dbo.profile ....................................... [RUN]
[0m11:12:37.179732 [debug] [Thread-1  ]: Acquiring new postgres connection "model.stgo_dbt.profile"
[0m11:12:37.179732 [debug] [Thread-1  ]: Began compiling node model.stgo_dbt.profile
[0m11:12:37.180742 [debug] [Thread-1  ]: Compiling model.stgo_dbt.profile
[0m11:12:37.191741 [debug] [Thread-1  ]: Writing injected SQL for node "model.stgo_dbt.profile"
[0m11:12:37.193753 [debug] [Thread-1  ]: finished collecting timing info
[0m11:12:37.193753 [debug] [Thread-1  ]: Began executing node model.stgo_dbt.profile
[0m11:12:37.249750 [debug] [Thread-1  ]: Writing runtime sql for node "model.stgo_dbt.profile"
[0m11:12:37.251748 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m11:12:37.251748 [debug] [Thread-1  ]: On model.stgo_dbt.profile: BEGIN
[0m11:12:37.251748 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m11:12:39.352248 [debug] [Thread-1  ]: SQL status: BEGIN in 2.1 seconds
[0m11:12:39.352785 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m11:12:39.352785 [debug] [Thread-1  ]: On model.stgo_dbt.profile: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.profile"} */

  
    

  create  table "postgres"."dbo"."profile__dbt_tmp"
  as (
    
-- Final base SQL model



select
"id",
sid as account_id,
uuid,
"name",
gender,
bod as date_of_birth,
country,
mobile as phone_number,
age_category[is_kids] as age_category,
join_date as created_at,
join_date as updated_at,
deleted_at,
_airbyte_ab_id,
_airbyte_emitted_at,
now() as _airbyte_normalized_at,
_airbyte_users_7_hashid
from dbo.users_7



-- depends_on: dbo.users_7

-- users_7 from "postgres".dbo._airbyte_raw_users_7
where 1 = 1

  );
  
[0m11:12:39.356860 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "age_category" does not exist
LINE 22: age_category[is_kids] as age_category,
         ^

[0m11:12:39.356860 [debug] [Thread-1  ]: On model.stgo_dbt.profile: ROLLBACK
[0m11:12:39.359015 [debug] [Thread-1  ]: finished collecting timing info
[0m11:12:39.359015 [debug] [Thread-1  ]: On model.stgo_dbt.profile: Close
[0m11:12:39.360135 [debug] [Thread-1  ]: Database Error in model profile (models\profile.sql)
  column "age_category" does not exist
  LINE 22: age_category[is_kids] as age_category,
           ^
  compiled Code at target\run\stgo_dbt\models\profile.sql
[0m11:12:39.360679 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c29ba6d5-a62e-4a60-b856-08e8c1121ac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002825BFC4E80>]}
[0m11:12:39.360679 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dbo.profile .............................. [[31mERROR[0m in 2.18s]
[0m11:12:39.362925 [debug] [Thread-1  ]: Finished running node model.stgo_dbt.profile
[0m11:12:39.364576 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m11:12:39.365118 [debug] [MainThread]: Using postgres connection "master"
[0m11:12:39.365624 [debug] [MainThread]: On master: BEGIN
[0m11:12:39.365667 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:12:41.452815 [debug] [MainThread]: SQL status: BEGIN in 2.09 seconds
[0m11:12:41.453390 [debug] [MainThread]: On master: COMMIT
[0m11:12:41.453390 [debug] [MainThread]: Using postgres connection "master"
[0m11:12:41.453390 [debug] [MainThread]: On master: COMMIT
[0m11:12:41.455730 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:12:41.455730 [debug] [MainThread]: On master: Close
[0m11:12:41.456854 [info ] [MainThread]: 
[0m11:12:41.458019 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.71 seconds (10.71s).
[0m11:12:41.459208 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:12:41.459208 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m11:12:41.459759 [debug] [MainThread]: Connection 'list_postgres_dbo' was properly closed.
[0m11:12:41.459759 [debug] [MainThread]: Connection 'model.stgo_dbt.profile' was properly closed.
[0m11:12:41.477063 [info ] [MainThread]: 
[0m11:12:41.479085 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:12:41.480063 [info ] [MainThread]: 
[0m11:12:41.481097 [error] [MainThread]: [33mDatabase Error in model profile (models\profile.sql)[0m
[0m11:12:41.483061 [error] [MainThread]:   column "age_category" does not exist
[0m11:12:41.484061 [error] [MainThread]:   LINE 22: age_category[is_kids] as age_category,
[0m11:12:41.484061 [error] [MainThread]:            ^
[0m11:12:41.485077 [error] [MainThread]:   compiled Code at target\run\stgo_dbt\models\profile.sql
[0m11:12:41.486060 [info ] [MainThread]: 
[0m11:12:41.487062 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:12:41.488059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002825BE5C3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002825BE5CFA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002825BE4ECD0>]}
[0m11:12:41.488059 [debug] [MainThread]: Flushing usage events


============================== 2023-01-03 11:14:41.966326 | cbf1058f-cac9-48a8-b5ec-4b26ec25a11e ==============================
[0m11:14:41.966326 [info ] [MainThread]: Running with dbt=1.3.1
[0m11:14:41.967328 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'D:\\2023\\Cloudthought\\data-migration-dbt\\stgo_dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:14:41.968289 [debug] [MainThread]: Tracking: tracking
[0m11:14:42.011315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7622BB1C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7622BBDF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7622BB9D0>]}
[0m11:14:42.332917 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:14:42.333906 [debug] [MainThread]: Partial parsing: updated file: stgo_dbt://models\profile.sql
[0m11:14:42.351596 [debug] [MainThread]: 1603: static parser failed on profile.sql
[0m11:14:42.377611 [debug] [MainThread]: 1602: parser fallback to jinja rendering on profile.sql
[0m11:14:42.397611 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stgo_dbt.staging

[0m11:14:42.406639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cbf1058f-cac9-48a8-b5ec-4b26ec25a11e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7625D00D0>]}
[0m11:14:42.423661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cbf1058f-cac9-48a8-b5ec-4b26ec25a11e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7622A5D60>]}
[0m11:14:42.423661 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 703 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m11:14:42.424873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cbf1058f-cac9-48a8-b5ec-4b26ec25a11e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7625338E0>]}
[0m11:14:42.425893 [info ] [MainThread]: 
[0m11:14:42.427885 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m11:14:42.430954 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m11:14:42.446896 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m11:14:42.446896 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m11:14:42.446896 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:14:44.544146 [debug] [ThreadPool]: SQL status: SELECT 10 in 2.1 seconds
[0m11:14:44.548372 [debug] [ThreadPool]: On list_postgres: Close
[0m11:14:44.553950 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbo"
[0m11:14:44.573789 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m11:14:44.573789 [debug] [ThreadPool]: On list_postgres_dbo: BEGIN
[0m11:14:44.573789 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:14:46.662094 [debug] [ThreadPool]: SQL status: BEGIN in 2.09 seconds
[0m11:14:46.662628 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m11:14:46.662628 [debug] [ThreadPool]: On list_postgres_dbo: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres_dbo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo'
  
[0m11:14:46.667159 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m11:14:46.668923 [debug] [ThreadPool]: On list_postgres_dbo: ROLLBACK
[0m11:14:46.671076 [debug] [ThreadPool]: On list_postgres_dbo: Close
[0m11:14:46.678501 [debug] [MainThread]: Using postgres connection "master"
[0m11:14:46.678501 [debug] [MainThread]: On master: BEGIN
[0m11:14:46.679061 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:14:48.765504 [debug] [MainThread]: SQL status: BEGIN in 2.09 seconds
[0m11:14:48.765617 [debug] [MainThread]: Using postgres connection "master"
[0m11:14:48.766160 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:14:48.778221 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
[0m11:14:48.780261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cbf1058f-cac9-48a8-b5ec-4b26ec25a11e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7621D2EB0>]}
[0m11:14:48.780261 [debug] [MainThread]: On master: ROLLBACK
[0m11:14:48.782795 [debug] [MainThread]: Using postgres connection "master"
[0m11:14:48.782795 [debug] [MainThread]: On master: BEGIN
[0m11:14:48.787372 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:14:48.787372 [debug] [MainThread]: On master: COMMIT
[0m11:14:48.787916 [debug] [MainThread]: Using postgres connection "master"
[0m11:14:48.787916 [debug] [MainThread]: On master: COMMIT
[0m11:14:48.790196 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:14:48.790764 [debug] [MainThread]: On master: Close
[0m11:14:48.791863 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:14:48.792956 [info ] [MainThread]: 
[0m11:14:48.802230 [debug] [Thread-1  ]: Began running node model.stgo_dbt.profile
[0m11:14:48.802821 [info ] [Thread-1  ]: 1 of 1 START sql table model dbo.profile ....................................... [RUN]
[0m11:14:48.805080 [debug] [Thread-1  ]: Acquiring new postgres connection "model.stgo_dbt.profile"
[0m11:14:48.805626 [debug] [Thread-1  ]: Began compiling node model.stgo_dbt.profile
[0m11:14:48.805626 [debug] [Thread-1  ]: Compiling model.stgo_dbt.profile
[0m11:14:48.821684 [debug] [Thread-1  ]: Writing injected SQL for node "model.stgo_dbt.profile"
[0m11:14:48.822676 [debug] [Thread-1  ]: finished collecting timing info
[0m11:14:48.822676 [debug] [Thread-1  ]: Began executing node model.stgo_dbt.profile
[0m11:14:48.875244 [debug] [Thread-1  ]: Writing runtime sql for node "model.stgo_dbt.profile"
[0m11:14:48.876244 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m11:14:48.877246 [debug] [Thread-1  ]: On model.stgo_dbt.profile: BEGIN
[0m11:14:48.877246 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m11:14:50.983722 [debug] [Thread-1  ]: SQL status: BEGIN in 2.11 seconds
[0m11:14:50.984279 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m11:14:50.984279 [debug] [Thread-1  ]: On model.stgo_dbt.profile: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.profile"} */

  
    

  create  table "postgres"."dbo"."profile__dbt_tmp"
  as (
    
-- Final base SQL model



select
"id",
sid as account_id,
uuid,
"name",
gender,
bod as date_of_birth,
country,
mobile as phone_number,
case when is_kids = 0 then 'ADULT' when is_kids = 1 then 'KID' as age_category,
join_date as created_at,
join_date as updated_at,
deleted_at,
_airbyte_ab_id,
_airbyte_emitted_at,
now() as _airbyte_normalized_at,
_airbyte_users_7_hashid
from dbo.users_7



-- depends_on: dbo.users_7

-- users_7 from "postgres".dbo._airbyte_raw_users_7
where 1 = 1

  );
  
[0m11:14:50.985921 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "as"
LINE 22: ...kids = 0 then 'ADULT' when is_kids = 1 then 'KID' as age_cat...
                                                              ^

[0m11:14:50.986465 [debug] [Thread-1  ]: On model.stgo_dbt.profile: ROLLBACK
[0m11:14:50.988964 [debug] [Thread-1  ]: finished collecting timing info
[0m11:14:50.988964 [debug] [Thread-1  ]: On model.stgo_dbt.profile: Close
[0m11:14:50.990672 [debug] [Thread-1  ]: Database Error in model profile (models\profile.sql)
  syntax error at or near "as"
  LINE 22: ...kids = 0 then 'ADULT' when is_kids = 1 then 'KID' as age_cat...
                                                                ^
  compiled Code at target\run\stgo_dbt\models\profile.sql
[0m11:14:50.991240 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbf1058f-cac9-48a8-b5ec-4b26ec25a11e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7627D3D90>]}
[0m11:14:50.991240 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dbo.profile .............................. [[31mERROR[0m in 2.19s]
[0m11:14:50.993493 [debug] [Thread-1  ]: Finished running node model.stgo_dbt.profile
[0m11:14:50.995262 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m11:14:50.995874 [debug] [MainThread]: Using postgres connection "master"
[0m11:14:50.995874 [debug] [MainThread]: On master: BEGIN
[0m11:14:50.996466 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:14:53.084283 [debug] [MainThread]: SQL status: BEGIN in 2.09 seconds
[0m11:14:53.084888 [debug] [MainThread]: On master: COMMIT
[0m11:14:53.085931 [debug] [MainThread]: Using postgres connection "master"
[0m11:14:53.086101 [debug] [MainThread]: On master: COMMIT
[0m11:14:53.090494 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:14:53.091246 [debug] [MainThread]: On master: Close
[0m11:14:53.092658 [info ] [MainThread]: 
[0m11:14:53.095240 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.67 seconds (10.67s).
[0m11:14:53.097788 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:14:53.098974 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m11:14:53.098974 [debug] [MainThread]: Connection 'list_postgres_dbo' was properly closed.
[0m11:14:53.100028 [debug] [MainThread]: Connection 'model.stgo_dbt.profile' was properly closed.
[0m11:14:53.131841 [info ] [MainThread]: 
[0m11:14:53.132817 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:14:53.134817 [info ] [MainThread]: 
[0m11:14:53.135854 [error] [MainThread]: [33mDatabase Error in model profile (models\profile.sql)[0m
[0m11:14:53.137818 [error] [MainThread]:   syntax error at or near "as"
[0m11:14:53.139833 [error] [MainThread]:   LINE 22: ...kids = 0 then 'ADULT' when is_kids = 1 then 'KID' as age_cat...
[0m11:14:53.141823 [error] [MainThread]:                                                                 ^
[0m11:14:53.142863 [error] [MainThread]:   compiled Code at target\run\stgo_dbt\models\profile.sql
[0m11:14:53.143819 [info ] [MainThread]: 
[0m11:14:53.145817 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:14:53.146835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F76264DAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F76264D760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F76266AB20>]}
[0m11:14:53.147872 [debug] [MainThread]: Flushing usage events


============================== 2023-01-03 11:15:25.026231 | 69ca87d9-0f28-44c5-96d4-63a9de5dda81 ==============================
[0m11:15:25.026231 [info ] [MainThread]: Running with dbt=1.3.1
[0m11:15:25.027244 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'D:\\2023\\Cloudthought\\data-migration-dbt\\stgo_dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:15:25.027244 [debug] [MainThread]: Tracking: tracking
[0m11:15:25.075273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B352D4040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B352B6100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B352B63D0>]}
[0m11:15:25.425472 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:15:25.426471 [debug] [MainThread]: Partial parsing: updated file: stgo_dbt://models\profile.sql
[0m11:15:25.453469 [debug] [MainThread]: 1603: static parser failed on profile.sql
[0m11:15:25.489471 [debug] [MainThread]: 1602: parser fallback to jinja rendering on profile.sql
[0m11:15:25.513467 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stgo_dbt.staging

[0m11:15:25.527204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '69ca87d9-0f28-44c5-96d4-63a9de5dda81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B355CF0D0>]}
[0m11:15:25.547205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '69ca87d9-0f28-44c5-96d4-63a9de5dda81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B352A5B20>]}
[0m11:15:25.548206 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 703 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m11:15:25.549214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69ca87d9-0f28-44c5-96d4-63a9de5dda81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B32E433D0>]}
[0m11:15:25.552208 [info ] [MainThread]: 
[0m11:15:25.555207 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m11:15:25.558206 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m11:15:25.583778 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m11:15:25.583778 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m11:15:25.584779 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:15:27.665954 [debug] [ThreadPool]: SQL status: SELECT 10 in 2.08 seconds
[0m11:15:27.668363 [debug] [ThreadPool]: On list_postgres: Close
[0m11:15:27.671850 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbo"
[0m11:15:27.680961 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m11:15:27.680961 [debug] [ThreadPool]: On list_postgres_dbo: BEGIN
[0m11:15:27.680961 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:15:29.917254 [debug] [ThreadPool]: SQL status: BEGIN in 2.24 seconds
[0m11:15:29.917778 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m11:15:29.917973 [debug] [ThreadPool]: On list_postgres_dbo: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres_dbo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo'
  
[0m11:15:29.932406 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
[0m11:15:29.934606 [debug] [ThreadPool]: On list_postgres_dbo: ROLLBACK
[0m11:15:29.949064 [debug] [ThreadPool]: On list_postgres_dbo: Close
[0m11:15:29.965279 [debug] [MainThread]: Using postgres connection "master"
[0m11:15:29.965279 [debug] [MainThread]: On master: BEGIN
[0m11:15:29.966074 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:15:32.053247 [debug] [MainThread]: SQL status: BEGIN in 2.09 seconds
[0m11:15:32.053825 [debug] [MainThread]: Using postgres connection "master"
[0m11:15:32.053825 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:15:32.067406 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
[0m11:15:32.068404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69ca87d9-0f28-44c5-96d4-63a9de5dda81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B3553FE20>]}
[0m11:15:32.069415 [debug] [MainThread]: On master: ROLLBACK
[0m11:15:32.071183 [debug] [MainThread]: Using postgres connection "master"
[0m11:15:32.071733 [debug] [MainThread]: On master: BEGIN
[0m11:15:32.074977 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:15:32.074977 [debug] [MainThread]: On master: COMMIT
[0m11:15:32.075550 [debug] [MainThread]: Using postgres connection "master"
[0m11:15:32.075550 [debug] [MainThread]: On master: COMMIT
[0m11:15:32.077775 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:15:32.078335 [debug] [MainThread]: On master: Close
[0m11:15:32.079452 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:15:32.080584 [info ] [MainThread]: 
[0m11:15:32.091500 [debug] [Thread-1  ]: Began running node model.stgo_dbt.profile
[0m11:15:32.092066 [info ] [Thread-1  ]: 1 of 1 START sql table model dbo.profile ....................................... [RUN]
[0m11:15:32.093166 [debug] [Thread-1  ]: Acquiring new postgres connection "model.stgo_dbt.profile"
[0m11:15:32.094167 [debug] [Thread-1  ]: Began compiling node model.stgo_dbt.profile
[0m11:15:32.094167 [debug] [Thread-1  ]: Compiling model.stgo_dbt.profile
[0m11:15:32.107177 [debug] [Thread-1  ]: Writing injected SQL for node "model.stgo_dbt.profile"
[0m11:15:32.108179 [debug] [Thread-1  ]: finished collecting timing info
[0m11:15:32.109176 [debug] [Thread-1  ]: Began executing node model.stgo_dbt.profile
[0m11:15:32.181821 [debug] [Thread-1  ]: Writing runtime sql for node "model.stgo_dbt.profile"
[0m11:15:32.182819 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m11:15:32.183819 [debug] [Thread-1  ]: On model.stgo_dbt.profile: BEGIN
[0m11:15:32.183819 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m11:15:34.243994 [debug] [Thread-1  ]: SQL status: BEGIN in 2.06 seconds
[0m11:15:34.243994 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m11:15:34.244589 [debug] [Thread-1  ]: On model.stgo_dbt.profile: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.profile"} */

  
    

  create  table "postgres"."dbo"."profile__dbt_tmp"
  as (
    
-- Final base SQL model



select
"id",
sid as account_id,
uuid,
"name",
gender,
bod as date_of_birth,
country,
mobile as phone_number,
case when is_kids = 0 then 'ADULT' else 'KID' end as age_category,
join_date as created_at,
join_date as updated_at,
deleted_at,
_airbyte_ab_id,
_airbyte_emitted_at,
now() as _airbyte_normalized_at,
_airbyte_users_7_hashid
from dbo.users_7



-- depends_on: dbo.users_7

-- users_7 from "postgres".dbo._airbyte_raw_users_7
where 1 = 1

  );
  
[0m11:15:34.688911 [debug] [Thread-1  ]: SQL status: SELECT 54800 in 0.44 seconds
[0m11:15:34.695425 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m11:15:34.696424 [debug] [Thread-1  ]: On model.stgo_dbt.profile: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.profile"} */
alter table "postgres"."dbo"."profile" rename to "profile__dbt_backup"
[0m11:15:34.699009 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:15:34.703610 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m11:15:34.704152 [debug] [Thread-1  ]: On model.stgo_dbt.profile: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.profile"} */
alter table "postgres"."dbo"."profile__dbt_tmp" rename to "profile"
[0m11:15:34.706427 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:15:34.721052 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m11:15:34.721052 [debug] [Thread-1  ]: On model.stgo_dbt.profile: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.profile"} */

    create  index if not exists
  "a8a9b6527ee5b40f7fb722d363f59018"
  on "postgres"."dbo"."profile" using btree
  (_airbyte_emitted_at);
  
[0m11:15:34.831673 [debug] [Thread-1  ]: SQL status: CREATE INDEX in 0.11 seconds
[0m11:15:34.854139 [debug] [Thread-1  ]: On model.stgo_dbt.profile: COMMIT
[0m11:15:34.855139 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m11:15:34.855139 [debug] [Thread-1  ]: On model.stgo_dbt.profile: COMMIT
[0m11:15:34.981224 [debug] [Thread-1  ]: SQL status: COMMIT in 0.13 seconds
[0m11:15:34.996183 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m11:15:34.996183 [debug] [Thread-1  ]: On model.stgo_dbt.profile: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.profile"} */
drop table if exists "postgres"."dbo"."profile__dbt_backup" cascade
[0m11:15:35.035862 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.04 seconds
[0m11:15:35.039774 [debug] [Thread-1  ]: finished collecting timing info
[0m11:15:35.040358 [debug] [Thread-1  ]: On model.stgo_dbt.profile: Close
[0m11:15:35.043019 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69ca87d9-0f28-44c5-96d4-63a9de5dda81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B357E6B80>]}
[0m11:15:35.044015 [info ] [Thread-1  ]: 1 of 1 OK created sql table model dbo.profile .................................. [[32mSELECT 54800[0m in 2.95s]
[0m11:15:35.048144 [debug] [Thread-1  ]: Finished running node model.stgo_dbt.profile
[0m11:15:35.054464 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m11:15:35.055342 [debug] [MainThread]: Using postgres connection "master"
[0m11:15:35.056081 [debug] [MainThread]: On master: BEGIN
[0m11:15:35.056081 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:15:37.140065 [debug] [MainThread]: SQL status: BEGIN in 2.08 seconds
[0m11:15:37.140065 [debug] [MainThread]: On master: COMMIT
[0m11:15:37.140617 [debug] [MainThread]: Using postgres connection "master"
[0m11:15:37.140617 [debug] [MainThread]: On master: COMMIT
[0m11:15:37.142940 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:15:37.143492 [debug] [MainThread]: On master: Close
[0m11:15:37.144266 [info ] [MainThread]: 
[0m11:15:37.145412 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.59 seconds (11.59s).
[0m11:15:37.146589 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:15:37.147148 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m11:15:37.147703 [debug] [MainThread]: Connection 'list_postgres_dbo' was properly closed.
[0m11:15:37.147703 [debug] [MainThread]: Connection 'model.stgo_dbt.profile' was properly closed.
[0m11:15:37.165939 [info ] [MainThread]: 
[0m11:15:37.166940 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:15:37.167942 [info ] [MainThread]: 
[0m11:15:37.169941 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:15:37.171936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B35690A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B35690280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B35690DF0>]}
[0m11:15:37.171936 [debug] [MainThread]: Flushing usage events


============================== 2023-01-03 11:17:51.716651 | bc7d907c-eae8-4517-8ff0-6791faf3dbd7 ==============================
[0m11:17:51.716651 [info ] [MainThread]: Running with dbt=1.3.1
[0m11:17:51.717636 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'D:\\2023\\Cloudthought\\data-migration-dbt\\stgo_dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:17:51.718610 [debug] [MainThread]: Tracking: tracking
[0m11:17:51.767612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E78EA221C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E78EA22DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E78EA229D0>]}
[0m11:17:52.218268 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:17:52.218268 [debug] [MainThread]: Partial parsing: updated file: stgo_dbt://models\profile.sql
[0m11:17:52.243267 [debug] [MainThread]: 1603: static parser failed on profile.sql
[0m11:17:52.278276 [debug] [MainThread]: 1602: parser fallback to jinja rendering on profile.sql
[0m11:17:52.312270 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stgo_dbt.staging

[0m11:17:52.326267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc7d907c-eae8-4517-8ff0-6791faf3dbd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E78ED430D0>]}
[0m11:17:52.348915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc7d907c-eae8-4517-8ff0-6791faf3dbd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E78EA15CA0>]}
[0m11:17:52.348915 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 703 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m11:17:52.350918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc7d907c-eae8-4517-8ff0-6791faf3dbd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E78ECA28E0>]}
[0m11:17:52.352916 [info ] [MainThread]: 
[0m11:17:52.354918 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m11:17:52.358915 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m11:17:52.386915 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m11:17:52.386915 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m11:17:52.386915 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:17:54.467841 [debug] [ThreadPool]: SQL status: SELECT 10 in 2.08 seconds
[0m11:17:54.469035 [debug] [ThreadPool]: On list_postgres: Close
[0m11:17:54.472992 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbo"
[0m11:17:54.482558 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m11:17:54.482558 [debug] [ThreadPool]: On list_postgres_dbo: BEGIN
[0m11:17:54.482558 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:17:56.592196 [debug] [ThreadPool]: SQL status: BEGIN in 2.11 seconds
[0m11:17:56.592773 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m11:17:56.593598 [debug] [ThreadPool]: On list_postgres_dbo: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres_dbo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo'
  
[0m11:17:56.601739 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
[0m11:17:56.603408 [debug] [ThreadPool]: On list_postgres_dbo: ROLLBACK
[0m11:17:56.604546 [debug] [ThreadPool]: On list_postgres_dbo: Close
[0m11:17:56.612896 [debug] [MainThread]: Using postgres connection "master"
[0m11:17:56.612896 [debug] [MainThread]: On master: BEGIN
[0m11:17:56.613538 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:17:58.716441 [debug] [MainThread]: SQL status: BEGIN in 2.1 seconds
[0m11:17:58.717038 [debug] [MainThread]: Using postgres connection "master"
[0m11:17:58.717038 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:17:58.734102 [debug] [MainThread]: SQL status: SELECT 0 in 0.02 seconds
[0m11:17:58.735107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc7d907c-eae8-4517-8ff0-6791faf3dbd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E78ECAFDC0>]}
[0m11:17:58.735107 [debug] [MainThread]: On master: ROLLBACK
[0m11:17:58.738191 [debug] [MainThread]: Using postgres connection "master"
[0m11:17:58.738191 [debug] [MainThread]: On master: BEGIN
[0m11:17:58.742831 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:17:58.743365 [debug] [MainThread]: On master: COMMIT
[0m11:17:58.743365 [debug] [MainThread]: Using postgres connection "master"
[0m11:17:58.743365 [debug] [MainThread]: On master: COMMIT
[0m11:17:58.745524 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:17:58.745524 [debug] [MainThread]: On master: Close
[0m11:17:58.746719 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:17:58.747803 [info ] [MainThread]: 
[0m11:17:58.757780 [debug] [Thread-1  ]: Began running node model.stgo_dbt.profile
[0m11:17:58.757780 [info ] [Thread-1  ]: 1 of 1 START sql table model dbo.profile ....................................... [RUN]
[0m11:17:58.759777 [debug] [Thread-1  ]: Acquiring new postgres connection "model.stgo_dbt.profile"
[0m11:17:58.759777 [debug] [Thread-1  ]: Began compiling node model.stgo_dbt.profile
[0m11:17:58.760773 [debug] [Thread-1  ]: Compiling model.stgo_dbt.profile
[0m11:17:58.770772 [debug] [Thread-1  ]: Writing injected SQL for node "model.stgo_dbt.profile"
[0m11:17:58.771771 [debug] [Thread-1  ]: finished collecting timing info
[0m11:17:58.772782 [debug] [Thread-1  ]: Began executing node model.stgo_dbt.profile
[0m11:17:58.826773 [debug] [Thread-1  ]: Writing runtime sql for node "model.stgo_dbt.profile"
[0m11:17:58.827773 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m11:17:58.827773 [debug] [Thread-1  ]: On model.stgo_dbt.profile: BEGIN
[0m11:17:58.828774 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m11:18:00.909228 [debug] [Thread-1  ]: SQL status: BEGIN in 2.08 seconds
[0m11:18:00.909790 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m11:18:00.909790 [debug] [Thread-1  ]: On model.stgo_dbt.profile: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.profile"} */

  
    

  create  table "postgres"."dbo"."profile__dbt_tmp"
  as (
    
-- Final base SQL model



select
"id",
sid as account_id,
uuid,
"name",
gender,
bod as date_of_birth,
country,
mobile as phone_number,
case when is_kids = 0 then 'ADULT' else 'KID' end as age_category,
text::timestamp_tz join_date as created_at,
text::timestamp_tz join_date as updated_at,
text::timestamp_tz deleted_at,
_airbyte_ab_id,
_airbyte_emitted_at,
now() as _airbyte_normalized_at,
_airbyte_users_7_hashid
from dbo.users_7



-- depends_on: dbo.users_7

-- users_7 from "postgres".dbo._airbyte_raw_users_7
where 1 = 1

  );
  
[0m11:18:00.912535 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "as"
LINE 23: text::timestamp_tz join_date as created_at,
                                      ^

[0m11:18:00.913095 [debug] [Thread-1  ]: On model.stgo_dbt.profile: ROLLBACK
[0m11:18:00.915336 [debug] [Thread-1  ]: finished collecting timing info
[0m11:18:00.915895 [debug] [Thread-1  ]: On model.stgo_dbt.profile: Close
[0m11:18:00.917008 [debug] [Thread-1  ]: Database Error in model profile (models\profile.sql)
  syntax error at or near "as"
  LINE 23: text::timestamp_tz join_date as created_at,
                                        ^
  compiled Code at target\run\stgo_dbt\models\profile.sql
[0m11:18:00.917591 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc7d907c-eae8-4517-8ff0-6791faf3dbd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E78EF44D90>]}
[0m11:18:00.917591 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dbo.profile .............................. [[31mERROR[0m in 2.16s]
[0m11:18:00.919382 [debug] [Thread-1  ]: Finished running node model.stgo_dbt.profile
[0m11:18:00.922275 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m11:18:00.922811 [debug] [MainThread]: Using postgres connection "master"
[0m11:18:00.922916 [debug] [MainThread]: On master: BEGIN
[0m11:18:00.922916 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:18:03.023571 [debug] [MainThread]: SQL status: BEGIN in 2.1 seconds
[0m11:18:03.024105 [debug] [MainThread]: On master: COMMIT
[0m11:18:03.024105 [debug] [MainThread]: Using postgres connection "master"
[0m11:18:03.024105 [debug] [MainThread]: On master: COMMIT
[0m11:18:03.026265 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:18:03.026363 [debug] [MainThread]: On master: Close
[0m11:18:03.026912 [info ] [MainThread]: 
[0m11:18:03.028024 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.67 seconds (10.67s).
[0m11:18:03.029132 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:18:03.029677 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m11:18:03.029677 [debug] [MainThread]: Connection 'list_postgres_dbo' was properly closed.
[0m11:18:03.030384 [debug] [MainThread]: Connection 'model.stgo_dbt.profile' was properly closed.
[0m11:18:03.049146 [info ] [MainThread]: 
[0m11:18:03.050139 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:18:03.052214 [info ] [MainThread]: 
[0m11:18:03.053144 [error] [MainThread]: [33mDatabase Error in model profile (models\profile.sql)[0m
[0m11:18:03.055143 [error] [MainThread]:   syntax error at or near "as"
[0m11:18:03.056178 [error] [MainThread]:   LINE 23: text::timestamp_tz join_date as created_at,
[0m11:18:03.057142 [error] [MainThread]:                                         ^
[0m11:18:03.057142 [error] [MainThread]:   compiled Code at target\run\stgo_dbt\models\profile.sql
[0m11:18:03.059140 [info ] [MainThread]: 
[0m11:18:03.059140 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:18:03.060152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E78EDBFAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E78EDBF760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E78EDDBB20>]}
[0m11:18:03.061133 [debug] [MainThread]: Flushing usage events


============================== 2023-01-03 11:18:45.024683 | 4e2253db-21ee-4389-b859-a74e429d0d6b ==============================
[0m11:18:45.024683 [info ] [MainThread]: Running with dbt=1.3.1
[0m11:18:45.026674 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'D:\\2023\\Cloudthought\\data-migration-dbt\\stgo_dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:18:45.026674 [debug] [MainThread]: Tracking: tracking
[0m11:18:45.074703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4E3C7DF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4E3C7DD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4E3C7D0D0>]}
[0m11:18:45.412323 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:18:45.413322 [debug] [MainThread]: Partial parsing: updated file: stgo_dbt://models\profile.sql
[0m11:18:45.431349 [debug] [MainThread]: 1603: static parser failed on profile.sql
[0m11:18:45.459066 [debug] [MainThread]: 1602: parser fallback to jinja rendering on profile.sql
[0m11:18:45.478091 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stgo_dbt.staging

[0m11:18:45.487025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4e2253db-21ee-4389-b859-a74e429d0d6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4E3F920D0>]}
[0m11:18:45.504044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4e2253db-21ee-4389-b859-a74e429d0d6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4E3C65CA0>]}
[0m11:18:45.505033 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 703 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m11:18:45.506031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e2253db-21ee-4389-b859-a74e429d0d6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4E3EF28E0>]}
[0m11:18:45.508066 [info ] [MainThread]: 
[0m11:18:45.510029 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m11:18:45.513026 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m11:18:45.529892 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m11:18:45.529892 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m11:18:45.530895 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:18:47.600361 [debug] [ThreadPool]: SQL status: SELECT 10 in 2.07 seconds
[0m11:18:47.602095 [debug] [ThreadPool]: On list_postgres: Close
[0m11:18:47.604261 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbo"
[0m11:18:47.611913 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m11:18:47.611913 [debug] [ThreadPool]: On list_postgres_dbo: BEGIN
[0m11:18:47.612511 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:18:49.695057 [debug] [ThreadPool]: SQL status: BEGIN in 2.08 seconds
[0m11:18:49.695683 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m11:18:49.695683 [debug] [ThreadPool]: On list_postgres_dbo: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres_dbo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo'
  
[0m11:18:49.703753 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
[0m11:18:49.705529 [debug] [ThreadPool]: On list_postgres_dbo: ROLLBACK
[0m11:18:49.708044 [debug] [ThreadPool]: On list_postgres_dbo: Close
[0m11:18:49.718511 [debug] [MainThread]: Using postgres connection "master"
[0m11:18:49.718511 [debug] [MainThread]: On master: BEGIN
[0m11:18:49.719087 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:18:51.777980 [debug] [MainThread]: SQL status: BEGIN in 2.06 seconds
[0m11:18:51.778534 [debug] [MainThread]: Using postgres connection "master"
[0m11:18:51.778534 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:18:51.789527 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
[0m11:18:51.790041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e2253db-21ee-4389-b859-a74e429d0d6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4E3EFFE20>]}
[0m11:18:51.791097 [debug] [MainThread]: On master: ROLLBACK
[0m11:18:51.793519 [debug] [MainThread]: Using postgres connection "master"
[0m11:18:51.793519 [debug] [MainThread]: On master: BEGIN
[0m11:18:51.797073 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:18:51.797608 [debug] [MainThread]: On master: COMMIT
[0m11:18:51.797608 [debug] [MainThread]: Using postgres connection "master"
[0m11:18:51.797608 [debug] [MainThread]: On master: COMMIT
[0m11:18:51.799271 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:18:51.799863 [debug] [MainThread]: On master: Close
[0m11:18:51.800415 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:18:51.801575 [info ] [MainThread]: 
[0m11:18:51.810380 [debug] [Thread-1  ]: Began running node model.stgo_dbt.profile
[0m11:18:51.810449 [info ] [Thread-1  ]: 1 of 1 START sql table model dbo.profile ....................................... [RUN]
[0m11:18:51.812777 [debug] [Thread-1  ]: Acquiring new postgres connection "model.stgo_dbt.profile"
[0m11:18:51.813320 [debug] [Thread-1  ]: Began compiling node model.stgo_dbt.profile
[0m11:18:51.813320 [debug] [Thread-1  ]: Compiling model.stgo_dbt.profile
[0m11:18:51.821866 [debug] [Thread-1  ]: Writing injected SQL for node "model.stgo_dbt.profile"
[0m11:18:51.823861 [debug] [Thread-1  ]: finished collecting timing info
[0m11:18:51.823861 [debug] [Thread-1  ]: Began executing node model.stgo_dbt.profile
[0m11:18:51.890322 [debug] [Thread-1  ]: Writing runtime sql for node "model.stgo_dbt.profile"
[0m11:18:51.891369 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m11:18:51.892321 [debug] [Thread-1  ]: On model.stgo_dbt.profile: BEGIN
[0m11:18:51.892321 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m11:18:53.996886 [debug] [Thread-1  ]: SQL status: BEGIN in 2.1 seconds
[0m11:18:53.996886 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m11:18:53.997452 [debug] [Thread-1  ]: On model.stgo_dbt.profile: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.profile"} */

  
    

  create  table "postgres"."dbo"."profile__dbt_tmp"
  as (
    
-- Final base SQL model



select
"id",
sid as account_id,
uuid,
"name",
gender,
bod as date_of_birth,
country,
mobile as phone_number,
case when is_kids = 0 then 'ADULT' else 'KID' end as age_category,
join_date::timestamp_tz join_date as created_at,
join_date::timestamp_tz join_date as updated_at,
deleted_at::timestamp_tz as deleted_at,
_airbyte_ab_id,
_airbyte_emitted_at,
now() as _airbyte_normalized_at,
_airbyte_users_7_hashid
from dbo.users_7



-- depends_on: dbo.users_7

-- users_7 from "postgres".dbo._airbyte_raw_users_7
where 1 = 1

  );
  
[0m11:18:53.999205 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "as"
LINE 23: join_date::timestamp_tz join_date as created_at,
                                           ^

[0m11:18:53.999747 [debug] [Thread-1  ]: On model.stgo_dbt.profile: ROLLBACK
[0m11:18:54.001494 [debug] [Thread-1  ]: finished collecting timing info
[0m11:18:54.001494 [debug] [Thread-1  ]: On model.stgo_dbt.profile: Close
[0m11:18:54.002616 [debug] [Thread-1  ]: Database Error in model profile (models\profile.sql)
  syntax error at or near "as"
  LINE 23: join_date::timestamp_tz join_date as created_at,
                                             ^
  compiled Code at target\run\stgo_dbt\models\profile.sql
[0m11:18:54.003381 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e2253db-21ee-4389-b859-a74e429d0d6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4E4194D90>]}
[0m11:18:54.003950 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dbo.profile .............................. [[31mERROR[0m in 2.19s]
[0m11:18:54.005696 [debug] [Thread-1  ]: Finished running node model.stgo_dbt.profile
[0m11:18:54.008006 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m11:18:54.008006 [debug] [MainThread]: Using postgres connection "master"
[0m11:18:54.008511 [debug] [MainThread]: On master: BEGIN
[0m11:18:54.008692 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:18:56.080167 [debug] [MainThread]: SQL status: BEGIN in 2.07 seconds
[0m11:18:56.080736 [debug] [MainThread]: On master: COMMIT
[0m11:18:56.080736 [debug] [MainThread]: Using postgres connection "master"
[0m11:18:56.081360 [debug] [MainThread]: On master: COMMIT
[0m11:18:56.083092 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:18:56.083653 [debug] [MainThread]: On master: Close
[0m11:18:56.084721 [info ] [MainThread]: 
[0m11:18:56.085848 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.58 seconds (10.58s).
[0m11:18:56.086946 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:18:56.086946 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m11:18:56.087507 [debug] [MainThread]: Connection 'list_postgres_dbo' was properly closed.
[0m11:18:56.087507 [debug] [MainThread]: Connection 'model.stgo_dbt.profile' was properly closed.
[0m11:18:56.105288 [info ] [MainThread]: 
[0m11:18:56.106279 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:18:56.107270 [info ] [MainThread]: 
[0m11:18:56.109269 [error] [MainThread]: [33mDatabase Error in model profile (models\profile.sql)[0m
[0m11:18:56.110265 [error] [MainThread]:   syntax error at or near "as"
[0m11:18:56.111297 [error] [MainThread]:   LINE 23: join_date::timestamp_tz join_date as created_at,
[0m11:18:56.112296 [error] [MainThread]:                                              ^
[0m11:18:56.113292 [error] [MainThread]:   compiled Code at target\run\stgo_dbt\models\profile.sql
[0m11:18:56.114275 [info ] [MainThread]: 
[0m11:18:56.115299 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:18:56.116274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4E4010AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4E4010760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4E402CB20>]}
[0m11:18:56.116274 [debug] [MainThread]: Flushing usage events


============================== 2023-01-03 11:19:08.797712 | 1bb858ce-79bb-4db8-b517-34816e0b820d ==============================
[0m11:19:08.797712 [info ] [MainThread]: Running with dbt=1.3.1
[0m11:19:08.798713 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'D:\\2023\\Cloudthought\\data-migration-dbt\\stgo_dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:19:08.799713 [debug] [MainThread]: Tracking: tracking
[0m11:19:08.839717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F463034040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F463015100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4630153D0>]}
[0m11:19:09.159346 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:19:09.160346 [debug] [MainThread]: Partial parsing: updated file: stgo_dbt://models\profile.sql
[0m11:19:09.176345 [debug] [MainThread]: 1603: static parser failed on profile.sql
[0m11:19:09.203346 [debug] [MainThread]: 1602: parser fallback to jinja rendering on profile.sql
[0m11:19:09.223346 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stgo_dbt.staging

[0m11:19:09.234351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1bb858ce-79bb-4db8-b517-34816e0b820d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4633310D0>]}
[0m11:19:09.254346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1bb858ce-79bb-4db8-b517-34816e0b820d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F463005B20>]}
[0m11:19:09.254346 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 703 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m11:19:09.255346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1bb858ce-79bb-4db8-b517-34816e0b820d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F460BA33D0>]}
[0m11:19:09.256346 [info ] [MainThread]: 
[0m11:19:09.258347 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m11:19:09.261347 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m11:19:09.288001 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m11:19:09.288001 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m11:19:09.289001 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:19:11.404841 [debug] [ThreadPool]: SQL status: SELECT 10 in 2.12 seconds
[0m11:19:11.407529 [debug] [ThreadPool]: On list_postgres: Close
[0m11:19:11.411340 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbo"
[0m11:19:11.426338 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m11:19:11.427339 [debug] [ThreadPool]: On list_postgres_dbo: BEGIN
[0m11:19:11.427339 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:19:13.501032 [debug] [ThreadPool]: SQL status: BEGIN in 2.07 seconds
[0m11:19:13.501664 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m11:19:13.501664 [debug] [ThreadPool]: On list_postgres_dbo: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres_dbo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo'
  
[0m11:19:13.506125 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m11:19:13.507325 [debug] [ThreadPool]: On list_postgres_dbo: ROLLBACK
[0m11:19:13.509998 [debug] [ThreadPool]: On list_postgres_dbo: Close
[0m11:19:13.517435 [debug] [MainThread]: Using postgres connection "master"
[0m11:19:13.518004 [debug] [MainThread]: On master: BEGIN
[0m11:19:13.518004 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:19:15.596036 [debug] [MainThread]: SQL status: BEGIN in 2.08 seconds
[0m11:19:15.596036 [debug] [MainThread]: Using postgres connection "master"
[0m11:19:15.596646 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:19:15.609877 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
[0m11:19:15.611761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1bb858ce-79bb-4db8-b517-34816e0b820d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F46329FE20>]}
[0m11:19:15.611964 [debug] [MainThread]: On master: ROLLBACK
[0m11:19:15.614308 [debug] [MainThread]: Using postgres connection "master"
[0m11:19:15.614308 [debug] [MainThread]: On master: BEGIN
[0m11:19:15.618430 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:19:15.618430 [debug] [MainThread]: On master: COMMIT
[0m11:19:15.619016 [debug] [MainThread]: Using postgres connection "master"
[0m11:19:15.619016 [debug] [MainThread]: On master: COMMIT
[0m11:19:15.621299 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:19:15.621299 [debug] [MainThread]: On master: Close
[0m11:19:15.622985 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:19:15.624197 [info ] [MainThread]: 
[0m11:19:15.635218 [debug] [Thread-1  ]: Began running node model.stgo_dbt.profile
[0m11:19:15.635218 [info ] [Thread-1  ]: 1 of 1 START sql table model dbo.profile ....................................... [RUN]
[0m11:19:15.638218 [debug] [Thread-1  ]: Acquiring new postgres connection "model.stgo_dbt.profile"
[0m11:19:15.638218 [debug] [Thread-1  ]: Began compiling node model.stgo_dbt.profile
[0m11:19:15.638218 [debug] [Thread-1  ]: Compiling model.stgo_dbt.profile
[0m11:19:15.653219 [debug] [Thread-1  ]: Writing injected SQL for node "model.stgo_dbt.profile"
[0m11:19:15.654206 [debug] [Thread-1  ]: finished collecting timing info
[0m11:19:15.655224 [debug] [Thread-1  ]: Began executing node model.stgo_dbt.profile
[0m11:19:15.725217 [debug] [Thread-1  ]: Writing runtime sql for node "model.stgo_dbt.profile"
[0m11:19:15.726205 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m11:19:15.727205 [debug] [Thread-1  ]: On model.stgo_dbt.profile: BEGIN
[0m11:19:15.727205 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m11:19:17.811118 [debug] [Thread-1  ]: SQL status: BEGIN in 2.08 seconds
[0m11:19:17.811118 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m11:19:17.811694 [debug] [Thread-1  ]: On model.stgo_dbt.profile: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.profile"} */

  
    

  create  table "postgres"."dbo"."profile__dbt_tmp"
  as (
    
-- Final base SQL model



select
"id",
sid as account_id,
uuid,
"name",
gender,
bod as date_of_birth,
country,
mobile as phone_number,
case when is_kids = 0 then 'ADULT' else 'KID' end as age_category,
join_date::timestamp_tz join_date as created_at,
join_date::timestamp_tz join_date as updated_at,
deleted_at::timestamp_tz,
_airbyte_ab_id,
_airbyte_emitted_at,
now() as _airbyte_normalized_at,
_airbyte_users_7_hashid
from dbo.users_7



-- depends_on: dbo.users_7

-- users_7 from "postgres".dbo._airbyte_raw_users_7
where 1 = 1

  );
  
[0m11:19:17.813942 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "as"
LINE 23: join_date::timestamp_tz join_date as created_at,
                                           ^

[0m11:19:17.813989 [debug] [Thread-1  ]: On model.stgo_dbt.profile: ROLLBACK
[0m11:19:17.816279 [debug] [Thread-1  ]: finished collecting timing info
[0m11:19:17.816279 [debug] [Thread-1  ]: On model.stgo_dbt.profile: Close
[0m11:19:17.817388 [debug] [Thread-1  ]: Database Error in model profile (models\profile.sql)
  syntax error at or near "as"
  LINE 23: join_date::timestamp_tz join_date as created_at,
                                             ^
  compiled Code at target\run\stgo_dbt\models\profile.sql
[0m11:19:17.817936 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bb858ce-79bb-4db8-b517-34816e0b820d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F463533E50>]}
[0m11:19:17.818542 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dbo.profile .............................. [[31mERROR[0m in 2.18s]
[0m11:19:17.820297 [debug] [Thread-1  ]: Finished running node model.stgo_dbt.profile
[0m11:19:17.823339 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m11:19:17.823805 [debug] [MainThread]: Using postgres connection "master"
[0m11:19:17.824105 [debug] [MainThread]: On master: BEGIN
[0m11:19:17.824217 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:19:19.937316 [debug] [MainThread]: SQL status: BEGIN in 2.11 seconds
[0m11:19:19.937894 [debug] [MainThread]: On master: COMMIT
[0m11:19:19.937986 [debug] [MainThread]: Using postgres connection "master"
[0m11:19:19.938609 [debug] [MainThread]: On master: COMMIT
[0m11:19:19.941763 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:19:19.941763 [debug] [MainThread]: On master: Close
[0m11:19:19.943480 [info ] [MainThread]: 
[0m11:19:19.944308 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.69 seconds (10.69s).
[0m11:19:19.945399 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:19:19.945399 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m11:19:19.945936 [debug] [MainThread]: Connection 'list_postgres_dbo' was properly closed.
[0m11:19:19.945953 [debug] [MainThread]: Connection 'model.stgo_dbt.profile' was properly closed.
[0m11:19:19.963350 [info ] [MainThread]: 
[0m11:19:19.964367 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:19:19.965394 [info ] [MainThread]: 
[0m11:19:19.966390 [error] [MainThread]: [33mDatabase Error in model profile (models\profile.sql)[0m
[0m11:19:19.968353 [error] [MainThread]:   syntax error at or near "as"
[0m11:19:19.969350 [error] [MainThread]:   LINE 23: join_date::timestamp_tz join_date as created_at,
[0m11:19:19.970343 [error] [MainThread]:                                              ^
[0m11:19:19.972369 [error] [MainThread]:   compiled Code at target\run\stgo_dbt\models\profile.sql
[0m11:19:19.973358 [info ] [MainThread]: 
[0m11:19:19.974407 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:19:19.976363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4633CBC70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4633CBE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4633B58E0>]}
[0m11:19:19.977350 [debug] [MainThread]: Flushing usage events


============================== 2023-01-03 11:19:44.468563 | 4be25c5d-a063-4ab5-82c6-a1d73f37bedc ==============================
[0m11:19:44.468563 [info ] [MainThread]: Running with dbt=1.3.1
[0m11:19:44.469508 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'D:\\2023\\Cloudthought\\data-migration-dbt\\stgo_dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:19:44.469508 [debug] [MainThread]: Tracking: tracking
[0m11:19:44.509169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016802FD47F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016802FD4520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016802FD4760>]}
[0m11:19:44.813525 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:19:44.813525 [debug] [MainThread]: Partial parsing: updated file: stgo_dbt://models\profile.sql
[0m11:19:44.830529 [debug] [MainThread]: 1603: static parser failed on profile.sql
[0m11:19:44.858482 [debug] [MainThread]: 1602: parser fallback to jinja rendering on profile.sql
[0m11:19:44.877511 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stgo_dbt.staging

[0m11:19:44.886489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4be25c5d-a063-4ab5-82c6-a1d73f37bedc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168032D50D0>]}
[0m11:19:44.906530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4be25c5d-a063-4ab5-82c6-a1d73f37bedc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016802FA4250>]}
[0m11:19:44.906530 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 703 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m11:19:44.907527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4be25c5d-a063-4ab5-82c6-a1d73f37bedc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016803231850>]}
[0m11:19:44.908481 [info ] [MainThread]: 
[0m11:19:44.910546 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m11:19:44.913494 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m11:19:44.931492 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m11:19:44.931492 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m11:19:44.931492 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:19:47.020561 [debug] [ThreadPool]: SQL status: SELECT 10 in 2.09 seconds
[0m11:19:47.022848 [debug] [ThreadPool]: On list_postgres: Close
[0m11:19:47.026690 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbo"
[0m11:19:47.037816 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m11:19:47.038405 [debug] [ThreadPool]: On list_postgres_dbo: BEGIN
[0m11:19:47.038405 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:19:49.133759 [debug] [ThreadPool]: SQL status: BEGIN in 2.1 seconds
[0m11:19:49.134293 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m11:19:49.134293 [debug] [ThreadPool]: On list_postgres_dbo: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres_dbo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo'
  
[0m11:19:49.139195 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m11:19:49.140856 [debug] [ThreadPool]: On list_postgres_dbo: ROLLBACK
[0m11:19:49.143258 [debug] [ThreadPool]: On list_postgres_dbo: Close
[0m11:19:49.150916 [debug] [MainThread]: Using postgres connection "master"
[0m11:19:49.150916 [debug] [MainThread]: On master: BEGIN
[0m11:19:49.150916 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:19:51.219450 [debug] [MainThread]: SQL status: BEGIN in 2.07 seconds
[0m11:19:51.219450 [debug] [MainThread]: Using postgres connection "master"
[0m11:19:51.220030 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:19:51.231430 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
[0m11:19:51.232054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4be25c5d-a063-4ab5-82c6-a1d73f37bedc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001680323FD60>]}
[0m11:19:51.232054 [debug] [MainThread]: On master: ROLLBACK
[0m11:19:51.235018 [debug] [MainThread]: Using postgres connection "master"
[0m11:19:51.235552 [debug] [MainThread]: On master: BEGIN
[0m11:19:51.238832 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:19:51.239386 [debug] [MainThread]: On master: COMMIT
[0m11:19:51.239386 [debug] [MainThread]: Using postgres connection "master"
[0m11:19:51.239956 [debug] [MainThread]: On master: COMMIT
[0m11:19:51.241703 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:19:51.241703 [debug] [MainThread]: On master: Close
[0m11:19:51.242914 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:19:51.244168 [info ] [MainThread]: 
[0m11:19:51.254976 [debug] [Thread-1  ]: Began running node model.stgo_dbt.profile
[0m11:19:51.256055 [info ] [Thread-1  ]: 1 of 1 START sql table model dbo.profile ....................................... [RUN]
[0m11:19:51.258140 [debug] [Thread-1  ]: Acquiring new postgres connection "model.stgo_dbt.profile"
[0m11:19:51.258140 [debug] [Thread-1  ]: Began compiling node model.stgo_dbt.profile
[0m11:19:51.259135 [debug] [Thread-1  ]: Compiling model.stgo_dbt.profile
[0m11:19:51.270125 [debug] [Thread-1  ]: Writing injected SQL for node "model.stgo_dbt.profile"
[0m11:19:51.272126 [debug] [Thread-1  ]: finished collecting timing info
[0m11:19:51.272126 [debug] [Thread-1  ]: Began executing node model.stgo_dbt.profile
[0m11:19:51.377129 [debug] [Thread-1  ]: Writing runtime sql for node "model.stgo_dbt.profile"
[0m11:19:51.379128 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m11:19:51.379128 [debug] [Thread-1  ]: On model.stgo_dbt.profile: BEGIN
[0m11:19:51.380127 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m11:19:53.451055 [debug] [Thread-1  ]: SQL status: BEGIN in 2.07 seconds
[0m11:19:53.451658 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m11:19:53.451658 [debug] [Thread-1  ]: On model.stgo_dbt.profile: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.profile"} */

  
    

  create  table "postgres"."dbo"."profile__dbt_tmp"
  as (
    
-- Final base SQL model



select
"id",
sid as account_id,
uuid,
"name",
gender,
bod as date_of_birth,
country,
mobile as phone_number,
case when is_kids = 0 then 'ADULT' else 'KID' end as age_category,
join_date::timestamp_tz as created_at,
join_date::timestamp_tz as updated_at,
deleted_at::timestamp_tz as deleted_at,
_airbyte_ab_id,
_airbyte_emitted_at,
now() as _airbyte_normalized_at,
_airbyte_users_7_hashid
from dbo.users_7



-- depends_on: dbo.users_7

-- users_7 from "postgres".dbo._airbyte_raw_users_7
where 1 = 1

  );
  
[0m11:19:53.453999 [debug] [Thread-1  ]: Postgres adapter: Postgres error: type "timestamp_tz" does not exist
LINE 23: join_date::timestamp_tz as created_at,
                    ^

[0m11:19:53.454539 [debug] [Thread-1  ]: On model.stgo_dbt.profile: ROLLBACK
[0m11:19:53.456200 [debug] [Thread-1  ]: finished collecting timing info
[0m11:19:53.456200 [debug] [Thread-1  ]: On model.stgo_dbt.profile: Close
[0m11:19:53.457336 [debug] [Thread-1  ]: Database Error in model profile (models\profile.sql)
  type "timestamp_tz" does not exist
  LINE 23: join_date::timestamp_tz as created_at,
                      ^
  compiled Code at target\run\stgo_dbt\models\profile.sql
[0m11:19:53.457893 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4be25c5d-a063-4ab5-82c6-a1d73f37bedc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168034D4E20>]}
[0m11:19:53.458455 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dbo.profile .............................. [[31mERROR[0m in 2.20s]
[0m11:19:53.460138 [debug] [Thread-1  ]: Finished running node model.stgo_dbt.profile
[0m11:19:53.462368 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m11:19:53.462906 [debug] [MainThread]: Using postgres connection "master"
[0m11:19:53.462906 [debug] [MainThread]: On master: BEGIN
[0m11:19:53.463508 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:19:55.565541 [debug] [MainThread]: SQL status: BEGIN in 2.1 seconds
[0m11:19:55.566079 [debug] [MainThread]: On master: COMMIT
[0m11:19:55.566079 [debug] [MainThread]: Using postgres connection "master"
[0m11:19:55.566610 [debug] [MainThread]: On master: COMMIT
[0m11:19:55.568299 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:19:55.568908 [debug] [MainThread]: On master: Close
[0m11:19:55.570559 [info ] [MainThread]: 
[0m11:19:55.571667 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.66 seconds (10.66s).
[0m11:19:55.572816 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:19:55.573420 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m11:19:55.573420 [debug] [MainThread]: Connection 'list_postgres_dbo' was properly closed.
[0m11:19:55.573963 [debug] [MainThread]: Connection 'model.stgo_dbt.profile' was properly closed.
[0m11:19:55.598120 [info ] [MainThread]: 
[0m11:19:55.599107 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:19:55.601112 [info ] [MainThread]: 
[0m11:19:55.602107 [error] [MainThread]: [33mDatabase Error in model profile (models\profile.sql)[0m
[0m11:19:55.604102 [error] [MainThread]:   type "timestamp_tz" does not exist
[0m11:19:55.605127 [error] [MainThread]:   LINE 23: join_date::timestamp_tz as created_at,
[0m11:19:55.606109 [error] [MainThread]:                       ^
[0m11:19:55.607105 [error] [MainThread]:   compiled Code at target\run\stgo_dbt\models\profile.sql
[0m11:19:55.608118 [info ] [MainThread]: 
[0m11:19:55.610103 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:19:55.612106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016802FA4790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001680336DE20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001680335EB50>]}
[0m11:19:55.613105 [debug] [MainThread]: Flushing usage events


============================== 2023-01-03 11:20:17.341593 | 4fa75814-f779-4cfa-80bc-1257ca4f0dd1 ==============================
[0m11:20:17.341593 [info ] [MainThread]: Running with dbt=1.3.1
[0m11:20:17.343600 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'D:\\2023\\Cloudthought\\data-migration-dbt\\stgo_dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:20:17.343600 [debug] [MainThread]: Tracking: tracking
[0m11:20:17.385589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FE73421C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FE7342DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FE73429D0>]}
[0m11:20:17.708941 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:20:17.708941 [debug] [MainThread]: Partial parsing: updated file: stgo_dbt://models\profile.sql
[0m11:20:17.727931 [debug] [MainThread]: 1603: static parser failed on profile.sql
[0m11:20:17.756894 [debug] [MainThread]: 1602: parser fallback to jinja rendering on profile.sql
[0m11:20:17.775900 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stgo_dbt.staging

[0m11:20:17.784893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4fa75814-f779-4cfa-80bc-1257ca4f0dd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FE76630D0>]}
[0m11:20:17.802905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fa75814-f779-4cfa-80bc-1257ca4f0dd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FE7335D30>]}
[0m11:20:17.802905 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 703 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m11:20:17.804896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4fa75814-f779-4cfa-80bc-1257ca4f0dd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FE75C18E0>]}
[0m11:20:17.805900 [info ] [MainThread]: 
[0m11:20:17.807897 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m11:20:17.810911 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m11:20:17.828896 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m11:20:17.828896 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m11:20:17.828896 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:20:19.922264 [debug] [ThreadPool]: SQL status: SELECT 10 in 2.09 seconds
[0m11:20:19.923533 [debug] [ThreadPool]: On list_postgres: Close
[0m11:20:19.926517 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbo"
[0m11:20:19.934097 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m11:20:19.934730 [debug] [ThreadPool]: On list_postgres_dbo: BEGIN
[0m11:20:19.934730 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:20:22.011029 [debug] [ThreadPool]: SQL status: BEGIN in 2.08 seconds
[0m11:20:22.011564 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m11:20:22.011564 [debug] [ThreadPool]: On list_postgres_dbo: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres_dbo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo'
  
[0m11:20:22.017483 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
[0m11:20:22.019871 [debug] [ThreadPool]: On list_postgres_dbo: ROLLBACK
[0m11:20:22.022438 [debug] [ThreadPool]: On list_postgres_dbo: Close
[0m11:20:22.031628 [debug] [MainThread]: Using postgres connection "master"
[0m11:20:22.031628 [debug] [MainThread]: On master: BEGIN
[0m11:20:22.032163 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:20:24.119848 [debug] [MainThread]: SQL status: BEGIN in 2.09 seconds
[0m11:20:24.120385 [debug] [MainThread]: Using postgres connection "master"
[0m11:20:24.120895 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:20:24.134528 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
[0m11:20:24.136990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4fa75814-f779-4cfa-80bc-1257ca4f0dd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FE75CFDC0>]}
[0m11:20:24.137549 [debug] [MainThread]: On master: ROLLBACK
[0m11:20:24.139954 [debug] [MainThread]: Using postgres connection "master"
[0m11:20:24.140497 [debug] [MainThread]: On master: BEGIN
[0m11:20:24.144420 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:20:24.144983 [debug] [MainThread]: On master: COMMIT
[0m11:20:24.145532 [debug] [MainThread]: Using postgres connection "master"
[0m11:20:24.145532 [debug] [MainThread]: On master: COMMIT
[0m11:20:24.147795 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:20:24.148326 [debug] [MainThread]: On master: Close
[0m11:20:24.149996 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:20:24.151587 [info ] [MainThread]: 
[0m11:20:24.164321 [debug] [Thread-1  ]: Began running node model.stgo_dbt.profile
[0m11:20:24.164868 [info ] [Thread-1  ]: 1 of 1 START sql table model dbo.profile ....................................... [RUN]
[0m11:20:24.167384 [debug] [Thread-1  ]: Acquiring new postgres connection "model.stgo_dbt.profile"
[0m11:20:24.167384 [debug] [Thread-1  ]: Began compiling node model.stgo_dbt.profile
[0m11:20:24.167384 [debug] [Thread-1  ]: Compiling model.stgo_dbt.profile
[0m11:20:24.184388 [debug] [Thread-1  ]: Writing injected SQL for node "model.stgo_dbt.profile"
[0m11:20:24.185398 [debug] [Thread-1  ]: finished collecting timing info
[0m11:20:24.185398 [debug] [Thread-1  ]: Began executing node model.stgo_dbt.profile
[0m11:20:24.258958 [debug] [Thread-1  ]: Writing runtime sql for node "model.stgo_dbt.profile"
[0m11:20:24.260951 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m11:20:24.260951 [debug] [Thread-1  ]: On model.stgo_dbt.profile: BEGIN
[0m11:20:24.260951 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m11:20:26.353281 [debug] [Thread-1  ]: SQL status: BEGIN in 2.09 seconds
[0m11:20:26.353841 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m11:20:26.354451 [debug] [Thread-1  ]: On model.stgo_dbt.profile: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.profile"} */

  
    

  create  table "postgres"."dbo"."profile__dbt_tmp"
  as (
    
-- Final base SQL model



select
"id",
sid as account_id,
uuid,
"name",
gender,
bod as date_of_birth,
country,
mobile as phone_number,
case when is_kids = 0 then 'ADULT' else 'KID' end as age_category,
join_date::timestamp as created_at,
join_date::timestamp as updated_at,
deleted_at::timestamp as deleted_at,
_airbyte_ab_id,
_airbyte_emitted_at,
now() as _airbyte_normalized_at,
_airbyte_users_7_hashid
from dbo.users_7



-- depends_on: dbo.users_7

-- users_7 from "postgres".dbo._airbyte_raw_users_7
where 1 = 1

  );
  
[0m11:20:26.875487 [debug] [Thread-1  ]: SQL status: SELECT 54800 in 0.52 seconds
[0m11:20:26.886183 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m11:20:26.886724 [debug] [Thread-1  ]: On model.stgo_dbt.profile: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.profile"} */
alter table "postgres"."dbo"."profile" rename to "profile__dbt_backup"
[0m11:20:26.890085 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:20:26.896107 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m11:20:26.896107 [debug] [Thread-1  ]: On model.stgo_dbt.profile: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.profile"} */
alter table "postgres"."dbo"."profile__dbt_tmp" rename to "profile"
[0m11:20:26.898394 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:20:26.917984 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m11:20:26.918970 [debug] [Thread-1  ]: On model.stgo_dbt.profile: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.profile"} */

    create  index if not exists
  "f1cb6259d2c2af63362f0a9c181fce5d"
  on "postgres"."dbo"."profile" using btree
  (_airbyte_emitted_at);
  
[0m11:20:27.027918 [debug] [Thread-1  ]: SQL status: CREATE INDEX in 0.11 seconds
[0m11:20:27.063810 [debug] [Thread-1  ]: On model.stgo_dbt.profile: COMMIT
[0m11:20:27.063810 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m11:20:27.064781 [debug] [Thread-1  ]: On model.stgo_dbt.profile: COMMIT
[0m11:20:27.177463 [debug] [Thread-1  ]: SQL status: COMMIT in 0.11 seconds
[0m11:20:27.185544 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m11:20:27.185603 [debug] [Thread-1  ]: On model.stgo_dbt.profile: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.profile"} */
drop table if exists "postgres"."dbo"."profile__dbt_backup" cascade
[0m11:20:27.220659 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.04 seconds
[0m11:20:27.222225 [debug] [Thread-1  ]: finished collecting timing info
[0m11:20:27.222225 [debug] [Thread-1  ]: On model.stgo_dbt.profile: Close
[0m11:20:27.223840 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fa75814-f779-4cfa-80bc-1257ca4f0dd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FE7877BE0>]}
[0m11:20:27.224849 [info ] [Thread-1  ]: 1 of 1 OK created sql table model dbo.profile .................................. [[32mSELECT 54800[0m in 3.06s]
[0m11:20:27.226856 [debug] [Thread-1  ]: Finished running node model.stgo_dbt.profile
[0m11:20:27.229893 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m11:20:27.229989 [debug] [MainThread]: Using postgres connection "master"
[0m11:20:27.229989 [debug] [MainThread]: On master: BEGIN
[0m11:20:27.230569 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:20:29.299968 [debug] [MainThread]: SQL status: BEGIN in 2.07 seconds
[0m11:20:29.300529 [debug] [MainThread]: On master: COMMIT
[0m11:20:29.301716 [debug] [MainThread]: Using postgres connection "master"
[0m11:20:29.301716 [debug] [MainThread]: On master: COMMIT
[0m11:20:29.305102 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:20:29.305647 [debug] [MainThread]: On master: Close
[0m11:20:29.307344 [info ] [MainThread]: 
[0m11:20:29.308544 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.50 seconds (11.50s).
[0m11:20:29.310358 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:20:29.310411 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m11:20:29.310964 [debug] [MainThread]: Connection 'list_postgres_dbo' was properly closed.
[0m11:20:29.311501 [debug] [MainThread]: Connection 'model.stgo_dbt.profile' was properly closed.
[0m11:20:29.346539 [info ] [MainThread]: 
[0m11:20:29.347525 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:20:29.349526 [info ] [MainThread]: 
[0m11:20:29.350526 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:20:29.352531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FE7335250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FE7720DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FE7720EB0>]}
[0m11:20:29.352531 [debug] [MainThread]: Flushing usage events


============================== 2023-01-03 11:21:15.894202 | 4b0fbb9b-4aad-4b10-b9a3-3b1734ddc9fc ==============================
[0m11:21:15.894202 [info ] [MainThread]: Running with dbt=1.3.1
[0m11:21:15.895201 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'D:\\2023\\Cloudthought\\data-migration-dbt\\stgo_dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:21:15.895201 [debug] [MainThread]: Tracking: tracking
[0m11:21:15.930201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA127F90A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA127F9250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA127F9160>]}
[0m11:21:16.298689 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:21:16.299690 [debug] [MainThread]: Partial parsing: updated file: stgo_dbt://models\profile.sql
[0m11:21:16.335721 [debug] [MainThread]: 1603: static parser failed on profile.sql
[0m11:21:16.391710 [debug] [MainThread]: 1602: parser fallback to jinja rendering on profile.sql
[0m11:21:16.413709 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stgo_dbt.staging

[0m11:21:16.421708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b0fbb9b-4aad-4b10-b9a3-3b1734ddc9fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA12B110D0>]}
[0m11:21:16.442713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b0fbb9b-4aad-4b10-b9a3-3b1734ddc9fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA127E5760>]}
[0m11:21:16.442713 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 703 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m11:21:16.443711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b0fbb9b-4aad-4b10-b9a3-3b1734ddc9fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA12A728B0>]}
[0m11:21:16.445709 [info ] [MainThread]: 
[0m11:21:16.447710 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m11:21:16.449709 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m11:21:16.468380 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m11:21:16.468380 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m11:21:16.468380 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:21:18.599795 [debug] [ThreadPool]: SQL status: SELECT 10 in 2.13 seconds
[0m11:21:18.601627 [debug] [ThreadPool]: On list_postgres: Close
[0m11:21:18.604610 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbo"
[0m11:21:18.614192 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m11:21:18.615192 [debug] [ThreadPool]: On list_postgres_dbo: BEGIN
[0m11:21:18.615192 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:21:20.695915 [debug] [ThreadPool]: SQL status: BEGIN in 2.08 seconds
[0m11:21:20.696488 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m11:21:20.696488 [debug] [ThreadPool]: On list_postgres_dbo: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres_dbo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo'
  
[0m11:21:20.702772 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
[0m11:21:20.704723 [debug] [ThreadPool]: On list_postgres_dbo: ROLLBACK
[0m11:21:20.706441 [debug] [ThreadPool]: On list_postgres_dbo: Close
[0m11:21:20.716048 [debug] [MainThread]: Using postgres connection "master"
[0m11:21:20.716235 [debug] [MainThread]: On master: BEGIN
[0m11:21:20.716235 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:21:22.817016 [debug] [MainThread]: SQL status: BEGIN in 2.1 seconds
[0m11:21:22.817016 [debug] [MainThread]: Using postgres connection "master"
[0m11:21:22.817614 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:21:22.830635 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
[0m11:21:22.831170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b0fbb9b-4aad-4b10-b9a3-3b1734ddc9fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA12A7FDC0>]}
[0m11:21:22.832222 [debug] [MainThread]: On master: ROLLBACK
[0m11:21:22.834933 [debug] [MainThread]: Using postgres connection "master"
[0m11:21:22.835157 [debug] [MainThread]: On master: BEGIN
[0m11:21:22.839119 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:21:22.839685 [debug] [MainThread]: On master: COMMIT
[0m11:21:22.839685 [debug] [MainThread]: Using postgres connection "master"
[0m11:21:22.839685 [debug] [MainThread]: On master: COMMIT
[0m11:21:22.841890 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:21:22.842451 [debug] [MainThread]: On master: Close
[0m11:21:22.843010 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:21:22.844173 [info ] [MainThread]: 
[0m11:21:22.853283 [debug] [Thread-1  ]: Began running node model.stgo_dbt.profile
[0m11:21:22.854286 [info ] [Thread-1  ]: 1 of 1 START sql table model dbo.profile ....................................... [RUN]
[0m11:21:22.856277 [debug] [Thread-1  ]: Acquiring new postgres connection "model.stgo_dbt.profile"
[0m11:21:22.856277 [debug] [Thread-1  ]: Began compiling node model.stgo_dbt.profile
[0m11:21:22.857304 [debug] [Thread-1  ]: Compiling model.stgo_dbt.profile
[0m11:21:22.865288 [debug] [Thread-1  ]: Writing injected SQL for node "model.stgo_dbt.profile"
[0m11:21:22.867275 [debug] [Thread-1  ]: finished collecting timing info
[0m11:21:22.867275 [debug] [Thread-1  ]: Began executing node model.stgo_dbt.profile
[0m11:21:22.923998 [debug] [Thread-1  ]: Writing runtime sql for node "model.stgo_dbt.profile"
[0m11:21:22.925008 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m11:21:22.925999 [debug] [Thread-1  ]: On model.stgo_dbt.profile: BEGIN
[0m11:21:22.925999 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m11:21:24.991443 [debug] [Thread-1  ]: SQL status: BEGIN in 2.07 seconds
[0m11:21:24.991443 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m11:21:24.992007 [debug] [Thread-1  ]: On model.stgo_dbt.profile: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.profile"} */

  
    

  create  table "postgres"."dbo"."profile__dbt_tmp"
  as (
    
-- Final base SQL model



select
"id",
sid as account_id,
uuid,
"name",
gender,
bod as date_of_birth,
country,
mobile as phone_number,
case when is_kids = 0 then 'ADULT' else 'KID' end as age_category,
join_date::timestamp with time zone as created_at,
join_date::timestamp with time zone as updated_at,
deleted_at::timestamp with time zone as deleted_at,
_airbyte_ab_id,
_airbyte_emitted_at,
now() as _airbyte_normalized_at,
_airbyte_users_7_hashid
from dbo.users_7



-- depends_on: dbo.users_7

-- users_7 from "postgres".dbo._airbyte_raw_users_7
where 1 = 1

  );
  
[0m11:21:25.499348 [debug] [Thread-1  ]: SQL status: SELECT 54800 in 0.51 seconds
[0m11:21:25.507774 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m11:21:25.508306 [debug] [Thread-1  ]: On model.stgo_dbt.profile: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.profile"} */
alter table "postgres"."dbo"."profile" rename to "profile__dbt_backup"
[0m11:21:25.510484 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:21:25.514284 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m11:21:25.514791 [debug] [Thread-1  ]: On model.stgo_dbt.profile: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.profile"} */
alter table "postgres"."dbo"."profile__dbt_tmp" rename to "profile"
[0m11:21:25.516459 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:21:25.532094 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m11:21:25.532094 [debug] [Thread-1  ]: On model.stgo_dbt.profile: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.profile"} */

    create  index if not exists
  "f479e9a47d39320f27de2a57549ec3fd"
  on "postgres"."dbo"."profile" using btree
  (_airbyte_emitted_at);
  
[0m11:21:25.635285 [debug] [Thread-1  ]: SQL status: CREATE INDEX in 0.1 seconds
[0m11:21:25.659801 [debug] [Thread-1  ]: On model.stgo_dbt.profile: COMMIT
[0m11:21:25.659801 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m11:21:25.659801 [debug] [Thread-1  ]: On model.stgo_dbt.profile: COMMIT
[0m11:21:25.801622 [debug] [Thread-1  ]: SQL status: COMMIT in 0.14 seconds
[0m11:21:25.808989 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m11:21:25.808989 [debug] [Thread-1  ]: On model.stgo_dbt.profile: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.profile"} */
drop table if exists "postgres"."dbo"."profile__dbt_backup" cascade
[0m11:21:25.853370 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.04 seconds
[0m11:21:25.855118 [debug] [Thread-1  ]: finished collecting timing info
[0m11:21:25.855118 [debug] [Thread-1  ]: On model.stgo_dbt.profile: Close
[0m11:21:25.856236 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b0fbb9b-4aad-4b10-b9a3-3b1734ddc9fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA12D27BB0>]}
[0m11:21:25.856765 [info ] [Thread-1  ]: 1 of 1 OK created sql table model dbo.profile .................................. [[32mSELECT 54800[0m in 3.00s]
[0m11:21:25.858514 [debug] [Thread-1  ]: Finished running node model.stgo_dbt.profile
[0m11:21:25.860805 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m11:21:25.860805 [debug] [MainThread]: Using postgres connection "master"
[0m11:21:25.861332 [debug] [MainThread]: On master: BEGIN
[0m11:21:25.861332 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:21:27.932863 [debug] [MainThread]: SQL status: BEGIN in 2.07 seconds
[0m11:21:27.932863 [debug] [MainThread]: On master: COMMIT
[0m11:21:27.932863 [debug] [MainThread]: Using postgres connection "master"
[0m11:21:27.933526 [debug] [MainThread]: On master: COMMIT
[0m11:21:27.935298 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:21:27.935842 [debug] [MainThread]: On master: Close
[0m11:21:27.937504 [info ] [MainThread]: 
[0m11:21:27.938597 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.49 seconds (11.49s).
[0m11:21:27.939863 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:21:27.940464 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m11:21:27.940464 [debug] [MainThread]: Connection 'list_postgres_dbo' was properly closed.
[0m11:21:27.941061 [debug] [MainThread]: Connection 'model.stgo_dbt.profile' was properly closed.
[0m11:21:27.963364 [info ] [MainThread]: 
[0m11:21:27.965371 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:21:27.966374 [info ] [MainThread]: 
[0m11:21:27.968359 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:21:27.969393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA12BD0490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA12BD0040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA12BD0F40>]}
[0m11:21:27.969393 [debug] [MainThread]: Flushing usage events


============================== 2023-01-03 11:25:31.868007 | 809f47e6-bbb2-46b4-a752-eb86745d51bb ==============================
[0m11:25:31.868007 [info ] [MainThread]: Running with dbt=1.3.1
[0m11:25:31.869003 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'D:\\2023\\Cloudthought\\data-migration-dbt\\stgo_dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:25:31.870003 [debug] [MainThread]: Tracking: tracking
[0m11:25:31.912245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DA30C20A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DA30C2250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DA30C2160>]}
[0m11:25:32.526045 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:25:32.527047 [debug] [MainThread]: Partial parsing: updated file: stgo_dbt://models\profile.sql
[0m11:25:32.553047 [debug] [MainThread]: 1603: static parser failed on profile.sql
[0m11:25:32.588666 [debug] [MainThread]: 1602: parser fallback to jinja rendering on profile.sql
[0m11:25:32.609660 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stgo_dbt.staging

[0m11:25:32.619709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '809f47e6-bbb2-46b4-a752-eb86745d51bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DA33D80D0>]}
[0m11:25:32.634663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '809f47e6-bbb2-46b4-a752-eb86745d51bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DA30B5850>]}
[0m11:25:32.635662 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 703 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m11:25:32.636670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '809f47e6-bbb2-46b4-a752-eb86745d51bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DA33418B0>]}
[0m11:25:32.637676 [info ] [MainThread]: 
[0m11:25:32.639663 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m11:25:32.642674 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m11:25:32.657660 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m11:25:32.657660 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m11:25:32.657660 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:25:34.744162 [debug] [ThreadPool]: SQL status: SELECT 10 in 2.09 seconds
[0m11:25:34.745853 [debug] [ThreadPool]: On list_postgres: Close
[0m11:25:34.751785 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbo"
[0m11:25:34.767234 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m11:25:34.768244 [debug] [ThreadPool]: On list_postgres_dbo: BEGIN
[0m11:25:34.768244 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:25:36.858540 [debug] [ThreadPool]: SQL status: BEGIN in 2.09 seconds
[0m11:25:36.859108 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m11:25:36.859108 [debug] [ThreadPool]: On list_postgres_dbo: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres_dbo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo'
  
[0m11:25:36.864753 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
[0m11:25:36.866410 [debug] [ThreadPool]: On list_postgres_dbo: ROLLBACK
[0m11:25:36.869213 [debug] [ThreadPool]: On list_postgres_dbo: Close
[0m11:25:36.881384 [debug] [MainThread]: Using postgres connection "master"
[0m11:25:36.881915 [debug] [MainThread]: On master: BEGIN
[0m11:25:36.882570 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:25:38.951942 [debug] [MainThread]: SQL status: BEGIN in 2.07 seconds
[0m11:25:38.951942 [debug] [MainThread]: Using postgres connection "master"
[0m11:25:38.952498 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:25:38.962973 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
[0m11:25:38.964132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '809f47e6-bbb2-46b4-a752-eb86745d51bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DA30B5B80>]}
[0m11:25:38.964132 [debug] [MainThread]: On master: ROLLBACK
[0m11:25:38.966309 [debug] [MainThread]: Using postgres connection "master"
[0m11:25:38.966309 [debug] [MainThread]: On master: BEGIN
[0m11:25:38.970166 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:25:38.970166 [debug] [MainThread]: On master: COMMIT
[0m11:25:38.970166 [debug] [MainThread]: Using postgres connection "master"
[0m11:25:38.970723 [debug] [MainThread]: On master: COMMIT
[0m11:25:38.972334 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:25:38.972917 [debug] [MainThread]: On master: Close
[0m11:25:38.974003 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:25:38.975110 [info ] [MainThread]: 
[0m11:25:38.985977 [debug] [Thread-1  ]: Began running node model.stgo_dbt.profile
[0m11:25:38.986519 [info ] [Thread-1  ]: 1 of 1 START sql table model dbo.profile ....................................... [RUN]
[0m11:25:38.988643 [debug] [Thread-1  ]: Acquiring new postgres connection "model.stgo_dbt.profile"
[0m11:25:38.988643 [debug] [Thread-1  ]: Began compiling node model.stgo_dbt.profile
[0m11:25:38.989644 [debug] [Thread-1  ]: Compiling model.stgo_dbt.profile
[0m11:25:39.000639 [debug] [Thread-1  ]: Writing injected SQL for node "model.stgo_dbt.profile"
[0m11:25:39.002641 [debug] [Thread-1  ]: finished collecting timing info
[0m11:25:39.002641 [debug] [Thread-1  ]: Began executing node model.stgo_dbt.profile
[0m11:25:39.054651 [debug] [Thread-1  ]: Writing runtime sql for node "model.stgo_dbt.profile"
[0m11:25:39.056418 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m11:25:39.057430 [debug] [Thread-1  ]: On model.stgo_dbt.profile: BEGIN
[0m11:25:39.057430 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m11:25:41.144871 [debug] [Thread-1  ]: SQL status: BEGIN in 2.09 seconds
[0m11:25:41.145426 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m11:25:41.145426 [debug] [Thread-1  ]: On model.stgo_dbt.profile: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.profile"} */

  
    

  create  table "postgres"."dbo"."profile__dbt_tmp"
  as (
    
-- Final base SQL model



select
"id",
sid as account_id,
character_id as avatar_id,
uuid,
"name",
gender,
bod as date_of_birth,
country,
mobile as phone_number,
case when is_kids = 0 then 'ADULT' else 'KID' end as age_category,
join_date::timestamp with time zone as created_at,
join_date::timestamp with time zone as updated_at,
deleted_at::timestamp with time zone as deleted_at,
_airbyte_ab_id,
_airbyte_emitted_at,
now() as _airbyte_normalized_at,
_airbyte_users_7_hashid
from dbo.users_7



-- depends_on: dbo.users_7

-- users_7 from "postgres".dbo._airbyte_raw_users_7
where 1 = 1

  );
  
[0m11:25:41.731734 [debug] [Thread-1  ]: SQL status: SELECT 54800 in 0.59 seconds
[0m11:25:41.740320 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m11:25:41.741320 [debug] [Thread-1  ]: On model.stgo_dbt.profile: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.profile"} */
alter table "postgres"."dbo"."profile" rename to "profile__dbt_backup"
[0m11:25:41.744058 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:25:41.748899 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m11:25:41.748927 [debug] [Thread-1  ]: On model.stgo_dbt.profile: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.profile"} */
alter table "postgres"."dbo"."profile__dbt_tmp" rename to "profile"
[0m11:25:41.751741 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:25:41.764885 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m11:25:41.764885 [debug] [Thread-1  ]: On model.stgo_dbt.profile: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.profile"} */

    create  index if not exists
  "61560089a498ffe1b74520ce82a4a6b1"
  on "postgres"."dbo"."profile" using btree
  (_airbyte_emitted_at);
  
[0m11:25:41.866068 [debug] [Thread-1  ]: SQL status: CREATE INDEX in 0.1 seconds
[0m11:25:41.905001 [debug] [Thread-1  ]: On model.stgo_dbt.profile: COMMIT
[0m11:25:41.905563 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m11:25:41.905563 [debug] [Thread-1  ]: On model.stgo_dbt.profile: COMMIT
[0m11:25:42.040278 [debug] [Thread-1  ]: SQL status: COMMIT in 0.13 seconds
[0m11:25:42.049513 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m11:25:42.050061 [debug] [Thread-1  ]: On model.stgo_dbt.profile: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.profile"} */
drop table if exists "postgres"."dbo"."profile__dbt_backup" cascade
[0m11:25:42.092457 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.04 seconds
[0m11:25:42.094189 [debug] [Thread-1  ]: finished collecting timing info
[0m11:25:42.094772 [debug] [Thread-1  ]: On model.stgo_dbt.profile: Close
[0m11:25:42.095881 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '809f47e6-bbb2-46b4-a752-eb86745d51bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DA35F6BB0>]}
[0m11:25:42.096997 [info ] [Thread-1  ]: 1 of 1 OK created sql table model dbo.profile .................................. [[32mSELECT 54800[0m in 3.11s]
[0m11:25:42.098674 [debug] [Thread-1  ]: Finished running node model.stgo_dbt.profile
[0m11:25:42.101460 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m11:25:42.102020 [debug] [MainThread]: Using postgres connection "master"
[0m11:25:42.102020 [debug] [MainThread]: On master: BEGIN
[0m11:25:42.102532 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:25:44.189154 [debug] [MainThread]: SQL status: BEGIN in 2.09 seconds
[0m11:25:44.189713 [debug] [MainThread]: On master: COMMIT
[0m11:25:44.189877 [debug] [MainThread]: Using postgres connection "master"
[0m11:25:44.189877 [debug] [MainThread]: On master: COMMIT
[0m11:25:44.192038 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:25:44.192583 [debug] [MainThread]: On master: Close
[0m11:25:44.193691 [info ] [MainThread]: 
[0m11:25:44.195036 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.55 seconds (11.55s).
[0m11:25:44.196408 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:25:44.196922 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m11:25:44.197729 [debug] [MainThread]: Connection 'list_postgres_dbo' was properly closed.
[0m11:25:44.198287 [debug] [MainThread]: Connection 'model.stgo_dbt.profile' was properly closed.
[0m11:25:44.219391 [info ] [MainThread]: 
[0m11:25:44.220390 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:25:44.222389 [info ] [MainThread]: 
[0m11:25:44.223388 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:25:44.224386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DA34A03A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DA34A01F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DA34A0FA0>]}
[0m11:25:44.225390 [debug] [MainThread]: Flushing usage events


============================== 2023-01-03 11:48:36.140643 | 360146e9-9291-4836-b81d-9681c4d77a7c ==============================
[0m11:48:36.140643 [info ] [MainThread]: Running with dbt=1.3.1
[0m11:48:36.141679 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'D:\\2023\\Cloudthought\\data-migration-dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:48:36.141679 [debug] [MainThread]: Tracking: tracking
[0m11:48:36.194557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010FB92050A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010FB9205250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010FB9205160>]}
[0m11:48:36.566210 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:48:36.567160 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:48:36.567160 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stgo_dbt.staging

[0m11:48:36.583164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '360146e9-9291-4836-b81d-9681c4d77a7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010FB94BC0D0>]}
[0m11:48:36.606209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '360146e9-9291-4836-b81d-9681c4d77a7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010FB92B9280>]}
[0m11:48:36.606209 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 703 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m11:48:36.607744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '360146e9-9291-4836-b81d-9681c4d77a7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010FB92B93A0>]}
[0m11:48:36.608756 [info ] [MainThread]: 
[0m11:48:36.609755 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m11:48:36.612757 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres"
[0m11:48:36.633758 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m11:48:36.634760 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m11:48:36.634760 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:48:38.713478 [debug] [ThreadPool]: SQL status: SELECT 10 in 2.08 seconds
[0m11:48:38.714614 [debug] [ThreadPool]: On list_postgres: Close
[0m11:48:38.717019 [debug] [ThreadPool]: Acquiring new postgres connection "list_postgres_dbo"
[0m11:48:38.726444 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m11:48:38.727002 [debug] [ThreadPool]: On list_postgres_dbo: BEGIN
[0m11:48:38.727002 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:48:40.819689 [debug] [ThreadPool]: SQL status: BEGIN in 2.09 seconds
[0m11:48:40.820261 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbo"
[0m11:48:40.820261 [debug] [ThreadPool]: On list_postgres_dbo: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "list_postgres_dbo"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbo'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbo'
  
[0m11:48:40.826499 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.01 seconds
[0m11:48:40.829376 [debug] [ThreadPool]: On list_postgres_dbo: ROLLBACK
[0m11:48:40.832112 [debug] [ThreadPool]: On list_postgres_dbo: Close
[0m11:48:40.845031 [debug] [MainThread]: Using postgres connection "master"
[0m11:48:40.845031 [debug] [MainThread]: On master: BEGIN
[0m11:48:40.845589 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:48:42.915718 [debug] [MainThread]: SQL status: BEGIN in 2.07 seconds
[0m11:48:42.916255 [debug] [MainThread]: Using postgres connection "master"
[0m11:48:42.916255 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:48:42.929533 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
[0m11:48:42.930732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '360146e9-9291-4836-b81d-9681c4d77a7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010FB91F5C70>]}
[0m11:48:42.931300 [debug] [MainThread]: On master: ROLLBACK
[0m11:48:42.933733 [debug] [MainThread]: Using postgres connection "master"
[0m11:48:42.934290 [debug] [MainThread]: On master: BEGIN
[0m11:48:42.938069 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:48:42.938618 [debug] [MainThread]: On master: COMMIT
[0m11:48:42.939129 [debug] [MainThread]: Using postgres connection "master"
[0m11:48:42.939187 [debug] [MainThread]: On master: COMMIT
[0m11:48:42.941004 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:48:42.941556 [debug] [MainThread]: On master: Close
[0m11:48:42.943269 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:48:42.944320 [info ] [MainThread]: 
[0m11:48:42.955129 [debug] [Thread-1  ]: Began running node model.stgo_dbt.profile
[0m11:48:42.956216 [info ] [Thread-1  ]: 1 of 1 START sql table model dbo.profile ....................................... [RUN]
[0m11:48:42.958418 [debug] [Thread-1  ]: Acquiring new postgres connection "model.stgo_dbt.profile"
[0m11:48:42.959417 [debug] [Thread-1  ]: Began compiling node model.stgo_dbt.profile
[0m11:48:42.959417 [debug] [Thread-1  ]: Compiling model.stgo_dbt.profile
[0m11:48:42.987453 [debug] [Thread-1  ]: Writing injected SQL for node "model.stgo_dbt.profile"
[0m11:48:42.988452 [debug] [Thread-1  ]: finished collecting timing info
[0m11:48:42.989413 [debug] [Thread-1  ]: Began executing node model.stgo_dbt.profile
[0m11:48:43.052418 [debug] [Thread-1  ]: Writing runtime sql for node "model.stgo_dbt.profile"
[0m11:48:43.054417 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m11:48:43.054417 [debug] [Thread-1  ]: On model.stgo_dbt.profile: BEGIN
[0m11:48:43.054417 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m11:48:45.139190 [debug] [Thread-1  ]: SQL status: BEGIN in 2.08 seconds
[0m11:48:45.140332 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m11:48:45.140842 [debug] [Thread-1  ]: On model.stgo_dbt.profile: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.profile"} */

  
    

  create  table "postgres"."dbo"."profile__dbt_tmp"
  as (
    
-- Final base SQL model



select
"id",
sid as account_id,
character_id as avatar_id,
uuid,
"name",
gender,
bod as date_of_birth,
country,
mobile as phone_number,
case when is_kids = 0 then 'ADULT' else 'KID' end as age_category,
join_date::timestamp with time zone as created_at,
join_date::timestamp with time zone as updated_at,
deleted_at::timestamp with time zone as deleted_at,
_airbyte_ab_id,
_airbyte_emitted_at,
now() as _airbyte_normalized_at,
_airbyte_users_7_hashid
from dbo.users_7



-- depends_on: dbo.users_7

-- users_7 from "postgres".dbo._airbyte_raw_users_7
where 1 = 1

  );
  
[0m11:48:45.617649 [debug] [Thread-1  ]: SQL status: SELECT 54800 in 0.48 seconds
[0m11:48:45.630781 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m11:48:45.631779 [debug] [Thread-1  ]: On model.stgo_dbt.profile: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.profile"} */
alter table "postgres"."dbo"."profile" rename to "profile__dbt_backup"
[0m11:48:45.634178 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:48:45.640283 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m11:48:45.640792 [debug] [Thread-1  ]: On model.stgo_dbt.profile: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.profile"} */
alter table "postgres"."dbo"."profile__dbt_tmp" rename to "profile"
[0m11:48:45.643082 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:48:45.666489 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m11:48:45.666489 [debug] [Thread-1  ]: On model.stgo_dbt.profile: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.profile"} */

    create  index if not exists
  "9439e1ccc95eb25104e1e14ff05f6d37"
  on "postgres"."dbo"."profile" using btree
  (_airbyte_emitted_at);
  
[0m11:48:45.908119 [debug] [Thread-1  ]: SQL status: CREATE INDEX in 0.24 seconds
[0m11:48:45.932347 [debug] [Thread-1  ]: On model.stgo_dbt.profile: COMMIT
[0m11:48:45.932347 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m11:48:45.932347 [debug] [Thread-1  ]: On model.stgo_dbt.profile: COMMIT
[0m11:48:45.982714 [debug] [Thread-1  ]: SQL status: COMMIT in 0.05 seconds
[0m11:48:45.992473 [debug] [Thread-1  ]: Using postgres connection "model.stgo_dbt.profile"
[0m11:48:45.992981 [debug] [Thread-1  ]: On model.stgo_dbt.profile: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "stgo_dbt", "target_name": "dev", "node_id": "model.stgo_dbt.profile"} */
drop table if exists "postgres"."dbo"."profile__dbt_backup" cascade
[0m11:48:46.026599 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.03 seconds
[0m11:48:46.028234 [debug] [Thread-1  ]: finished collecting timing info
[0m11:48:46.028576 [debug] [Thread-1  ]: On model.stgo_dbt.profile: Close
[0m11:48:46.029302 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '360146e9-9291-4836-b81d-9681c4d77a7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010FB950AD30>]}
[0m11:48:46.029862 [info ] [Thread-1  ]: 1 of 1 OK created sql table model dbo.profile .................................. [[32mSELECT 54800[0m in 3.07s]
[0m11:48:46.031536 [debug] [Thread-1  ]: Finished running node model.stgo_dbt.profile
[0m11:48:46.033756 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m11:48:46.034295 [debug] [MainThread]: Using postgres connection "master"
[0m11:48:46.034295 [debug] [MainThread]: On master: BEGIN
[0m11:48:46.034835 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:48:48.113448 [debug] [MainThread]: SQL status: BEGIN in 2.08 seconds
[0m11:48:48.114039 [debug] [MainThread]: On master: COMMIT
[0m11:48:48.114039 [debug] [MainThread]: Using postgres connection "master"
[0m11:48:48.114039 [debug] [MainThread]: On master: COMMIT
[0m11:48:48.116241 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:48:48.116241 [debug] [MainThread]: On master: Close
[0m11:48:48.116906 [info ] [MainThread]: 
[0m11:48:48.118017 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.51 seconds (11.51s).
[0m11:48:48.119132 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:48:48.119132 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m11:48:48.119686 [debug] [MainThread]: Connection 'list_postgres_dbo' was properly closed.
[0m11:48:48.120239 [debug] [MainThread]: Connection 'model.stgo_dbt.profile' was properly closed.
[0m11:48:48.141532 [info ] [MainThread]: 
[0m11:48:48.142541 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:48:48.144539 [info ] [MainThread]: 
[0m11:48:48.145554 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:48:48.147528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010FB91F5730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010FB92B9040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010FB966F8B0>]}
[0m11:48:48.147528 [debug] [MainThread]: Flushing usage events
